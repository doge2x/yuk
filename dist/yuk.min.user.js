// ==UserScript==
// @name         yuk-client
// @version      0.3.2
// @author       doge2x
// @namespace    https://github.com/doge2x/yuk
// @match        https://examination.xuetangx.com/*
// @grant        GM.xmlHttpRequest
// @grant        GM_getValue
// @grant        GM_setValue
// @run-at       document-start
// ==/UserScript==

(()=>{"use strict";var e=[,(e,r,t)=>{t.r(r),t.d(r,{Client:()=>c});var n=t(2),i=t(8),o=t(9),a=t(14),u=function(e,r,t,n){return new(t||(t=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(a,u)}c((n=n.apply(e,r||[])).next())}))};class c{constructor(){this.onmsg=[],this.queue=new Map;const e=new n.JSONRPCClient((r=>u(this,void 0,void 0,(function*(){const t=a.SERVER.value;void 0!==t&&(yield new Promise(((n,o)=>u(this,void 0,void 0,(function*(){yield i.default.xhr({url:t,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(r),onload:r=>{200===r.status?(e.receive(JSON.parse(r.responseText)),n()):o(new Error(r.statusText))},onerror:e=>o(e.statusText)})})))))}))));this.client=e}watch(e){return u(this,void 0,void 0,(function*(){return new Promise(((r,t)=>{const n=setInterval((()=>{this.sendQueue().catch((e=>{clearInterval(n),alert("与服务器通信异常"),t(e)}))}),e)}))}))}sendQueue(){return u(this,void 0,void 0,(function*(){if(this.queue.size<1||void 0===a.USERNAME.value||void 0===a.SERVER.value||void 0===a.EXAM_ID.value||!1===a.SYNC_ANSWERS.value)return;let e=[...this.queue.values()];if(this.queue.clear(),void 0===a.TOKEN.value){(0,o.devLog)(`login to server: ${a.USERNAME.value}, ${a.EXAM_ID.value}`);const e=yield this.client.request("login",[a.USERNAME.value,a.EXAM_ID.value]);(0,o.devLog)("got token",e),a.TOKEN.value=e}this.postAnswers(a.TOKEN.value,e)}))}postAnswers(e,r){return u(this,void 0,void 0,(function*(){(0,o.devLog)("send answers",r);const t=yield this.client.request("answer_problem",[e,r]);(0,o.devLog)("receive answers",t),this.onmsg.forEach((e=>e(t)))}))}answerProblem(e){return u(this,void 0,void 0,(function*(){e.forEach((e=>{this.queue.set(e.problem_id,e)}))}))}onmessage(e){this.onmsg.push(e)}}},function(e,r,t){var n=this&&this.__createBinding||(Object.create?function(e,r,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]}),i=this&&this.__exportStar||function(e,r){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(r,t)||n(r,e,t)};Object.defineProperty(r,"__esModule",{value:!0}),i(t(3),r),i(t(4),r),i(t(6),r),i(t(7),r)},function(e,r,t){var n=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(a,u)}c((n=n.apply(e,r||[])).next())}))},i=this&&this.__generator||function(e,r){var t,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=r.call(e,a)}catch(e){o=[6,e],n=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.JSONRPCClient=void 0;var o=t(4),a=t(5),u=function(){function e(e,r){this._send=e,this.createID=r,this.idToResolveMap=new Map,this.id=0}return e.prototype._createID=function(){return this.createID?this.createID():++this.id},e.prototype.timeout=function(e,r){var t=this;void 0===r&&(r=function(e){return(0,o.createJSONRPCErrorResponse)(e,a.DefaultErrorCode,"Request timeout")});var n=function(n,i){var o=setTimeout((function(){n.forEach((function(e){var n=t.idToResolveMap.get(e);n&&(t.idToResolveMap.delete(e),n(r(e)))}))}),e);return i().then((function(e){return clearTimeout(o),e}),(function(e){return clearTimeout(o),Promise.reject(e)}))};return{request:function(e,r,i){var o=t._createID();return n([o],(function(){return t.requestWithID(e,r,i,o)}))},requestAdvanced:function(e,r){return function(e,r){var i=(Array.isArray(e)?e:[e]).map((function(e){return e.id})).filter(c);return n(i,(function(){return t.requestAdvanced(e,r)}))}(e,r)}}},e.prototype.request=function(e,r,t){return this.requestWithID(e,r,t,this._createID())},e.prototype.requestWithID=function(e,r,t,a){return n(this,void 0,void 0,(function(){var n,u;return i(this,(function(i){switch(i.label){case 0:return n={jsonrpc:o.JSONRPC,method:e,params:r,id:a},[4,this.requestAdvanced(n,t)];case 1:return void 0===(u=i.sent()).result||u.error?void 0===u.result&&u.error?[2,Promise.reject(new Error(u.error.message))]:[2,Promise.reject(new Error("An unexpected error occurred"))]:[2,u.result]}}))}))},e.prototype.requestAdvanced=function(e,r){var t=this,n=Array.isArray(e);Array.isArray(e)||(e=[e]);var i=e.filter((function(e){return c(e.id)})),u=i.map((function(e){return new Promise((function(r){return t.idToResolveMap.set(e.id,r)}))})),l=Promise.all(u).then((function(e){return n||!e.length?e:e[0]}));return this.send(n?e:e[0],r).then((function(){return l}),(function(e){return i.forEach((function(r){t.receive((0,o.createJSONRPCErrorResponse)(r.id,a.DefaultErrorCode,e&&e.message||"Failed to send a request"))})),l}))},e.prototype.notify=function(e,r,t){this.send({jsonrpc:o.JSONRPC,method:e,params:r},t).then(void 0,(function(){}))},e.prototype.send=function(e,r){return this._send(e,r)},e.prototype.rejectAllPendingRequests=function(e){this.idToResolveMap.forEach((function(r,t){return r((0,o.createJSONRPCErrorResponse)(t,a.DefaultErrorCode,e))})),this.idToResolveMap.clear()},e.prototype.receive=function(e){var r=this;Array.isArray(e)||(e=[e]),e.forEach((function(e){var t=r.idToResolveMap.get(e.id);t&&(r.idToResolveMap.delete(e.id),t(e))}))},e}();r.JSONRPCClient=u;var c=function(e){return null!=e}},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createJSONRPCErrorResponse=r.JSONRPCErrorCode=r.isJSONRPCResponses=r.isJSONRPCResponse=r.isJSONRPCRequests=r.isJSONRPCRequest=r.isJSONRPCID=r.JSONRPC=void 0,r.JSONRPC="2.0";r.isJSONRPCID=function(e){return"string"==typeof e||"number"==typeof e||null===e};r.isJSONRPCRequest=function(e){return e.jsonrpc===r.JSONRPC&&void 0!==e.method&&void 0===e.result&&void 0===e.error};r.isJSONRPCRequests=function(e){return Array.isArray(e)&&e.every(r.isJSONRPCRequest)};r.isJSONRPCResponse=function(e){return e.jsonrpc===r.JSONRPC&&void 0!==e.id&&(void 0!==e.result||void 0!==e.error)};r.isJSONRPCResponses=function(e){return Array.isArray(e)&&e.every(r.isJSONRPCResponse)},function(e){e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError"}(r.JSONRPCErrorCode||(r.JSONRPCErrorCode={}));r.createJSONRPCErrorResponse=function(e,t,n,i){var o={code:t,message:n};return i&&(o.data=i),{jsonrpc:r.JSONRPC,id:e,error:o}}},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultErrorCode=void 0,r.DefaultErrorCode=0},function(e,r,t){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(a,u)}c((n=n.apply(e,r||[])).next())}))},o=this&&this.__generator||function(e,r){var t,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=r.call(e,a)}catch(e){o=[6,e],n=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},a=this&&this.__spreadArray||function(e,r,t){if(t||2===arguments.length)for(var n,i=0,o=r.length;i<o;i++)!n&&i in r||(n||(n=Array.prototype.slice.call(r,0,i)),n[i]=r[i]);return e.concat(n||Array.prototype.slice.call(r))};Object.defineProperty(r,"__esModule",{value:!0}),r.JSONRPCServer=void 0;var u=t(4),c=t(5),l=function(e){return(0,u.createJSONRPCErrorResponse)((0,u.isJSONRPCID)(e.id)?e.id:null,u.JSONRPCErrorCode.InvalidRequest,"Invalid Request")},f=function(){function e(e){var r;void 0===e&&(e={}),this.mapErrorToJSONRPCErrorResponse=_,this.nameToMethodDictionary={},this.middleware=null,this.errorListener=null!==(r=e.errorListener)&&void 0!==r?r:console.warn}return e.prototype.addMethod=function(e,r){this.addMethodAdvanced(e,this.toJSONRPCMethod(r))},e.prototype.toJSONRPCMethod=function(e){return function(r,t){var n=e(r.params,t);return Promise.resolve(n).then((function(e){return v(r.id,e)}))}},e.prototype.addMethodAdvanced=function(e,r){var t;this.nameToMethodDictionary=n(n({},this.nameToMethodDictionary),((t={})[e]=r,t))},e.prototype.receiveJSON=function(e,r){var t=this.tryParseRequestJSON(e);return t?this.receive(t,r):Promise.resolve((0,u.createJSONRPCErrorResponse)(null,u.JSONRPCErrorCode.ParseError,"Parse error"))},e.prototype.tryParseRequestJSON=function(e){try{return JSON.parse(e)}catch(e){return null}},e.prototype.receive=function(e,r){return Array.isArray(e)?this.receiveMultiple(e,r):this.receiveSingle(e,r)},e.prototype.receiveMultiple=function(e,r){return i(this,void 0,void 0,(function(){var t,n=this;return o(this,(function(i){switch(i.label){case 0:return[4,Promise.all(e.map((function(e){return n.receiveSingle(e,r)})))];case 1:return 1===(t=i.sent().filter(s)).length?[2,t[0]]:t.length?[2,t]:[2,null]}}))}))},e.prototype.receiveSingle=function(e,r){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(i){switch(i.label){case 0:return t=this.nameToMethodDictionary[e.method],(0,u.isJSONRPCRequest)(e)?[3,1]:[2,l(e)];case 1:return t?[4,this.callMethod(t,e,r)]:[3,3];case 2:return n=i.sent(),[2,m(e,n)];case 3:return void 0!==e.id?[2,(o=e.id,(0,u.createJSONRPCErrorResponse)(o,u.JSONRPCErrorCode.MethodNotFound,"Method not found"))]:[2,null];case 4:return[2]}var o}))}))},e.prototype.applyMiddleware=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.middleware?this.middleware=this.combineMiddlewares(a([this.middleware],e,!0)):this.middleware=this.combineMiddlewares(e)},e.prototype.combineMiddlewares=function(e){return e.length?e.reduce(this.middlewareReducer):null},e.prototype.middlewareReducer=function(e,r){return function(t,n,i){return e((function(e,n){return r(t,e,n)}),n,i)}},e.prototype.callMethod=function(e,r,t){var n=this,i=function(e){return n.errorListener('An unexpected error occurred while executing "'.concat(r.method,'" JSON-RPC method:'),e),Promise.resolve(n.mapErrorToJSONRPCErrorResponseIfNecessary(r.id,e))};try{return(this.middleware||d)((function(r,t){return e(r,t)}),r,t).then(void 0,i)}catch(e){return i(e)}},e.prototype.mapErrorToJSONRPCErrorResponseIfNecessary=function(e,r){return void 0!==e?this.mapErrorToJSONRPCErrorResponse(e,r):null},e}();r.JSONRPCServer=f;var s=function(e){return null!==e},d=function(e,r,t){return e(r,t)},v=function(e,r){return void 0!==e?{jsonrpc:u.JSONRPC,id:e,result:void 0===r?null:r}:null},_=function(e,r){return(0,u.createJSONRPCErrorResponse)(e,c.DefaultErrorCode,r&&r.message||"An unexpected error occurred")},m=function(e,r){return r||(void 0!==e.id?(0,u.createJSONRPCErrorResponse)(e.id,u.JSONRPCErrorCode.InternalError,"Internal error"):null)}},function(e,r,t){var n=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(a,u)}c((n=n.apply(e,r||[])).next())}))},i=this&&this.__generator||function(e,r){var t,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=r.call(e,a)}catch(e){o=[6,e],n=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.JSONRPCServerAndClient=void 0;var o=t(4),a=function(){function e(e,r,t){var n;void 0===t&&(t={}),this.server=e,this.client=r,this.errorListener=null!==(n=t.errorListener)&&void 0!==n?n:console.warn}return e.prototype.applyServerMiddleware=function(){for(var e,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];(e=this.server).applyMiddleware.apply(e,r)},e.prototype.addMethod=function(e,r){this.server.addMethod(e,r)},e.prototype.addMethodAdvanced=function(e,r){this.server.addMethodAdvanced(e,r)},e.prototype.timeout=function(e){return this.client.timeout(e)},e.prototype.request=function(e,r,t){return this.client.request(e,r,t)},e.prototype.requestAdvanced=function(e,r){return this.client.requestAdvanced(e,r)},e.prototype.notify=function(e,r,t){this.client.notify(e,r,t)},e.prototype.rejectAllPendingRequests=function(e){this.client.rejectAllPendingRequests(e)},e.prototype.receiveAndSend=function(e,r,t){return n(this,void 0,void 0,(function(){var n,a;return i(this,(function(i){switch(i.label){case 0:return(0,o.isJSONRPCResponse)(e)||(0,o.isJSONRPCResponses)(e)?(this.client.receive(e),[3,4]):[3,1];case 1:return(0,o.isJSONRPCRequest)(e)||(0,o.isJSONRPCRequests)(e)?[4,this.server.receive(e,r)]:[3,3];case 2:return(n=i.sent())?[2,this.client.send(n,t)]:[3,4];case 3:return a="Received an invalid JSON-RPC message",this.errorListener(a,e),[2,Promise.reject(new Error(a))];case 4:return[2]}}))}))},e}();r.JSONRPCServerAndClient=a},(e,r,t)=>{t.r(r),t.d(r,{default:()=>n});const n={getValue:e=>GM_getValue(e),setValue:(e,r)=>GM_setValue(e,r),xhr:async e=>await GM.xmlHttpRequest(e)}},(e,r,t)=>{t.r(r),t.d(r,{Map2:()=>a,devLog:()=>o,newURL:()=>l,openWin:()=>c,percent:()=>u});var n=t(10),i=t(13);function o(e,...r){0}class a extends Map{constructor(e){super(),this.def=e}setWith(e,r){var t;super.set(e,r(null!==(t=super.get(e))&&void 0!==t?t:this.def()))}}function u(e){return`${Math.floor(100*e)}%`}function c(e,r){r=null!=r?r:{};const t=window.open(void 0,void 0,Object.entries({location:"no",height:r.height,width:r.width,left:r.left,top:r.top,resizable:"yes",menubar:"no",scrollbars:"yes",status:"no",titlebar:"no",toolbar:"no"}).map((([e,r])=>`${e}=${r}`)).join(","));return window.addEventListener("unload",(()=>t.close())),t.document.head.append(i.default.createElement(i.default.Fragment,null,i.default.createElement("title",null,e),i.default.createElement("style",null,n.default.toString()))),t}function l(e,r){const t=new URL(e,self.location.origin);for(const[e,n]of Object.entries(null!=r?r:{}))t.searchParams.set(e,n);return t}},(e,r,t)=>{t.r(r),t.d(r,{about:()=>m,answerDetail:()=>l,answerDetailShortAnswer:()=>f,clickable:()=>c,default:()=>y,mainBody:()=>u,settings:()=>s,settingsEntry:()=>d,settingsSubmit:()=>v,settingsSubmitTip:()=>_,uploadImg:()=>h,uploadImgConfirm:()=>g,uploadImgImage:()=>p});var n=t(11),i=t.n(n),o=t(12),a=t.n(o)()(i());a.push([e.id,".KtSQfh45DkzY1g4GTjHG {\n  font-size: 0.75rem;\n  opacity: 0.5;\n}\n.nl0fbl1STsJ1E_ijRd86 {\n  cursor: pointer;\n}\n.E2WC5WHEPccqZwiUT6nE p {\n  margin: 0;\n}\n.E2WC5WHEPccqZwiUT6nE ul {\n  margin: 0;\n  padding-left: 1.5rem;\n}\n.E2WC5WHEPccqZwiUT6nE img {\n  height: auto;\n  width: 80%;\n}\n.yZjHuTE6p_FgmbomqPFx {\n  border-style: groove;\n  border-width: thin;\n  margin: 0.2rem;\n  padding: 0.2rem;\n}\n._o1gebpEn7x9Td7Hes6g {\n  display: flex;\n  flex-direction: column;\n}\n.YalNJJWiNdYPl5FzO1a_ {\n  display: flex;\n  flex-direction: row;\n  margin-bottom: 0.5rem;\n  justify-content: space-between;\n  align-items: center;\n}\n.YalNJJWiNdYPl5FzO1a_ label {\n  font-weight: bold;\n}\n.YalNJJWiNdYPl5FzO1a_ input {\n  height: fit-content;\n  text-align: right;\n}\n.GkQ9CK5Dl58odGzSBLOP {\n  display: flex;\n  flex-direction: column;\n  justify-content: end;\n  align-items: end;\n}\n.CY2oPnMnonyamRy15TxZ {\n  margin-bottom: 0.5rem;\n}\n.GkQ9CK5Dl58odGzSBLOP button {\n  cursor: pointer;\n}\n.ssrv8ndZGNgvTL1Osr92 p {\n  margin-bottom: 0.25rem;\n}\n.ssrv8ndZGNgvTL1Osr92 ul {\n  padding-left: 1.5rem;\n  margin: 0 0 0.25rem 0;\n}\n.ssrv8ndZGNgvTL1Osr92 ul li {\n  margin-bottom: 0.25rem;\n}\n.UJVcq5yyVfeOtVL0dWlT {\n  display: flex;\n  flex-direction: column;\n}\n.UJVcq5yyVfeOtVL0dWlT img {\n  width: 100%;\n  height: auto;\n}\n.SB_KxqWR3Sju8ih5VCQj {\n  border-style: groove;\n  border-width: thin;\n  padding: 0.5rem;\n}\n.YM_eQySt5C11IITqy_br {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.5rem;\n}\n",""]);var u="KtSQfh45DkzY1g4GTjHG",c="nl0fbl1STsJ1E_ijRd86",l="E2WC5WHEPccqZwiUT6nE",f="yZjHuTE6p_FgmbomqPFx",s="_o1gebpEn7x9Td7Hes6g",d="YalNJJWiNdYPl5FzO1a_",v="GkQ9CK5Dl58odGzSBLOP",_="CY2oPnMnonyamRy15TxZ",m="ssrv8ndZGNgvTL1Osr92",h="UJVcq5yyVfeOtVL0dWlT",p="SB_KxqWR3Sju8ih5VCQj",g="YM_eQySt5C11IITqy_br";const y=a},e=>{e.exports=function(e){return e[1]}},e=>{e.exports=function(e){var r=[];return r.toString=function(){return this.map((function(r){var t="",n=void 0!==r[5];return r[4]&&(t+="@supports (".concat(r[4],") {")),r[2]&&(t+="@media ".concat(r[2]," {")),n&&(t+="@layer".concat(r[5].length>0?" ".concat(r[5]):""," {")),t+=e(r),n&&(t+="}"),r[2]&&(t+="}"),r[4]&&(t+="}"),t})).join("")},r.i=function(e,t,n,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(n)for(var u=0;u<this.length;u++){var c=this[u][0];null!=c&&(a[c]=!0)}for(var l=0;l<e.length;l++){var f=[].concat(e[l]);n&&a[f[0]]||(void 0!==o&&(void 0===f[5]||(f[1]="@layer".concat(f[5].length>0?" ".concat(f[5]):""," {").concat(f[1],"}")),f[5]=o),t&&(f[2]?(f[1]="@media ".concat(f[2]," {").concat(f[1],"}"),f[2]=t):f[2]=t),i&&(f[4]?(f[1]="@supports (".concat(f[4],") {").concat(f[1],"}"),f[4]=i):f[4]="".concat(i)),r.push(f))}},r}},(e,r,t)=>{function n(e){return Array.isArray(e)?(new Array).concat(...e.map(n)):e instanceof Node?[e]:null==e?[]:[document.createTextNode(String(e))]}function i(e,r){for(const t of r)e.appendChild(t)}function o(e,r){for(const[t,n]of Object.entries(r))t.startsWith("-")?e.style.setProperty(t,n):e.style[t]=n}function a(e,r,...t){r=null!=r?r:{};let a=n(t).concat(n(r.children));if("function"==typeof e)return e(Object.assign(Object.assign({},r),{children:a}));{const t=document.createElement(e);return i(t,a),function(e,r){for(const[t,n]of Object.entries(r))if(void 0!==n)switch(t){case"class":case"className":e.setAttribute("class",n);break;case"style":o(e,n);break;case"dangerouslySetInnerHTML":e.innerHTML=n.__html;break;default:t.startsWith("on")?e.addEventListener(t.slice(2).toLowerCase(),n):t in e?e[t]=n:e.setAttribute(t,n)}}(t,null!=r?r:{}),t}}function u(e){let r=document.createDocumentFragment();return i(r,n(e.children)),r}function c(e){return e instanceof Node?e:null}t.r(r),t.d(r,{Children:()=>l,Fragment:()=>u,createElement:()=>a,default:()=>f,toNode:()=>c});const l={toArray:n},f={createElement:a,Fragment:u}},(e,r,t)=>{t.r(r),t.d(r,{EXAM_ID:()=>s,NO_LEAVE_CHECK:()=>l,SERVER:()=>a,SORT_PROBLEMS:()=>c,SYNC_ANSWERS:()=>u,TOKEN:()=>f,USERNAME:()=>o});var n=t(58);class i{constructor(e){this._value=e}get value(){return this._value.get()}set value(e){this._value.set(e)}}const o=new i(n.Username),a=new i(n.Server),u=new i(n.SyncAnswers),c=new i(n.SortProblems),l=new i(n.NoLeaveCheck),f=new i(n.Token),s=new i(n.ExamId)},(e,r,t)=>{t.r(r),t.d(r,{hookXHR:()=>i});var n=t(9);function i(e){const r=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(t,i){const o=e.call(this,(0,n.newURL)(i)),a=this.send;this.send=function(e){void 0!==o?o(e).then((e=>{a.call(this,e),this.send=a})).catch(n.devLog):(a.call(this,e),this.send=a)},r.apply(this,arguments)}}},(e,r,t)=>{var n;function i(e){return e===n.SingleChoice||e===n.MultipleChoice||e===n.Polling}t.r(r),t.d(r,{ProblemType:()=>n,isChoice:()=>i}),function(e){e[e.SingleChoice=1]="SingleChoice",e[e.MultipleChoice=2]="MultipleChoice",e[e.Polling=3]="Polling",e[e.FillBlank=4]="FillBlank",e[e.ShortAnswer=5]="ShortAnswer",e[e.Judgement=6]="Judgement"}(n||(n={}))},(e,r,t)=>{t.r(r),t.d(r,{CHOICE_MAP:()=>c,UI:()=>l,showConfirmUpload:()=>f});var n=t(18),i=t(13),o=t(19),a=t(9),u=t(10);const c=new a.Map2((()=>new Map));class l{constructor(e){document.head.append(i.default.createElement("style",null,u.default.toString()));const r=document.body.querySelector(".header-title");r.classList.add(u.clickable),r.addEventListener("click",(()=>{(0,o.showSettings)()}));let t=[];!0===e.data.has_problem_dict?e.data.problems.forEach((e=>{t=t.concat(e.problems)})):t=e.data.problems;const a=new Map;document.body.querySelectorAll(".exam-main--body .subject-item").forEach(((e,r)=>{var i;const o=t[r],u=null!==(i=c.get(o.problem_id))&&void 0!==i?i:new Map;a.set(o.problem_id,new n.Card(o,e,(e=>{var r;return null!==(r=u.get(e))&&void 0!==r?r:e})))})),this.problems=a}updateAnswer({username:e,problem_id:r,result:t}){var n;null===(n=this.problems.get(r))||void 0===n||n.updateAnswer(e,t)}updateUI(){this.problems.forEach((e=>e.updateUI()))}}function f(e,r){const t=(0,a.openWin)("上传图片",{width:300,height:200});t.document.body.append(i.default.createElement("div",{className:[u.uploadImg,u.mainBody].join(" ")},i.default.createElement("div",{className:[u.uploadImgConfirm].join(" ")},i.default.createElement("button",{"on-click":()=>{r(),t.close()},className:[u.clickable].join(" ")},"确认上传"),i.default.createElement("span",null,i.default.createElement("i",null,"*关闭窗口以取消上传"))),i.default.createElement("div",{className:[u.uploadImgImage].join(" ")},i.default.createElement("img",{src:e}))))}},(e,r,t)=>{t.r(r),t.d(r,{Card:()=>o});var n=t(43),i=t(16);class o{constructor(e,r,t){let o,a;switch(e.ProblemType){case i.ProblemType.SingleChoice:case i.ProblemType.MultipleChoice:case i.ProblemType.Judgement:case i.ProblemType.Polling:o=n.ChoiceDetail.make(r,t),a=n.ChoiceDetail;break;case i.ProblemType.FillBlank:o=n.BlankDetail.make(r,void 0),a=n.BlankDetail;break;case i.ProblemType.ShortAnswer:o=n.TextDetail.make(r,void 0),a=n.TextDetail}this.updateUI=()=>a.updateUI(o),this.updateAnswer=(e,r)=>a.updateAnswer(o,e,r)}}},(e,r,t)=>{t.r(r),t.d(r,{showSettings:()=>u});var n=t(9),i=t(13),o=t(20),a=t(10);function u(){(0,n.openWin)("设置",{height:300,width:400}).document.body.appendChild(i.default.createElement("div",{className:[a.mainBody,a.settings].join(" ")},o.make()))}},(e,r,t)=>{t.r(r),t.d(r,{Entries:()=>_,React:()=>{},ReactDOMRe:()=>{},make:()=>m,style:()=>d});var n=t(22),i=t(21),o=t(26),a=t(58),u=t(27),c=t(31),l=t(24),f=t(10),s=t(57),d=f;function v(e){var r=u.reduce(e,[[],[]],(function(e,r){var t,o=r.ty,a=r.title,f=r.name;if(0===o.TAG){var v=o._0,_=v.onSubmit;t=["text",v.value,void 0,v.pattern,!0,function(e){return n._1(_,e.value)}]}else{var m=o._0,h=m.onSubmit;t=["checkbox",void 0,m.checked,void 0,!1,function(e){return n._1(h,e.checked)}]}var p=t[5],g={title:a,name:f,required:t[4],type:t[0]},y=t[2];void 0!==y&&(g.checked=l.valFromOption(y));var E=t[3];void 0!==E&&(g.pattern=l.valFromOption(E));var b=t[1];void 0!==b&&(g.value=l.valFromOption(b));var w=i.DOMRe.createDOMElementVariadic("input",l.some(g),[]);return[u.concat(e[0],[i.DOMRe.createDOMElementVariadic("div",{className:d.settingsEntry},[i.DOMRe.createDOMElementVariadic("label",{htmlFor:f},[a]),w])]),u.concat(e[1],[function(e){return c.forEach(c.flatMap(i.toNode(w),s.ofNode),p)}])]})),t=r[1];return[r[0],function(e){return u.forEach(t,(function(e){return n._1(e,void 0)}))}]}var _={make:v};function m(e){var r=v([{name:"username",title:"用户名",ty:{TAG:0,_0:{value:a.Username.get(void 0),pattern:"[a-z][_a-z0-9]*",onSubmit:function(e){return a.Username.set(e)}}}},{name:"server",title:"服务器",ty:{TAG:0,_0:{value:a.Server.get(void 0),pattern:"https?://.+",onSubmit:function(e){return a.Server.set(e)}}}},{name:"sync_answers",title:"同步答案",ty:{TAG:1,_0:{checked:a.SyncAnswers.get(void 0),onSubmit:function(e){return a.SyncAnswers.set(e)}}}},{name:"sort_problems",title:"排序答案",ty:{TAG:1,_0:{checked:a.SortProblems.get(void 0),onSubmit:function(e){return a.SortProblems.set(e)}}}},{name:"no_leave_check",title:"拦截切屏检测",ty:{TAG:1,_0:{checked:a.NoLeaveCheck.get(void 0),onSubmit:function(e){return a.NoLeaveCheck.set(e)}}}}]),t=r[1],u=function(e){var r=e.title,t=e.content;return i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,[r]),t])};return i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("form",{onSubmit:function(e){return e.preventDefault(),n._1(t,void 0)}},[i.DOMRe.createDOMElementVariadic("div",void 0,[r[0]]),i.DOMRe.createDOMElementVariadic("div",{className:d.settingsSubmit},[i.DOMRe.createDOMElementVariadic("div",{className:d.settingsSubmitTip},[i.DOMRe.createDOMElementVariadic("i",void 0,["*更改设置后请刷新页面"])]),i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("button",void 0,["提交"])])])]),i.DOMRe.createDOMElementVariadic("div",{className:d.about},[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,["功能特性："])]),i.createElementVariadic(o.UList.make,{children:null},[i.createElement(u,{title:"同步答案：",content:"点击题目显示详细答案，在选项/填空处悬停显示简略答案"}),i.createElement(u,{title:"排序题目：",content:"根据 ID 对题目和选项进行重新排序"}),i.createElement(u,{title:"拦截切屏检测：",content:"随意切换页面、窗口不会被发现"}),i.createElement(u,{title:"拦截上传截图：",content:"仅当用户确认后，才会上传截图"}),i.createElement(u,{title:"拦截异常状态：",content:"即使本地显示异常也不会推送到服务器"})])])])}},(e,r,t)=>{t.r(r),t.d(r,{Children:()=>c,DOMRe:()=>s,Fragment:()=>d,Props:()=>{},createElement:()=>f,createElementVariadic:()=>l,recks:()=>a,toNode:()=>u});var n=t(13),i=t(24),o=t(25),a=n;function u(e){return i.nullable_to_opt(a.toNode(e))}var c={toArray:function(e){return a.Children.toArray(e)}};function l(e,r,t){return o.spliceApply(n.createElement,[e,r,t])}function f(e,r){return n.createElement(e,r)}var s={createDOMElementVariadic:function(e,r,t){return o.spliceApply(n.createElement,[e,void 0!==r?i.valFromOption(r):void 0,t])},createElement:function(e,r,t){return o.spliceApply(n.createElement,[e,void 0!==r?i.valFromOption(r):void 0,t])}};var d={make:function(e){var r=e.children;return a.Fragment({children:r})}}},(e,r,t)=>{t.r(r),t.d(r,{_1:()=>o,_2:()=>u,_3:()=>l,_4:()=>s,_5:()=>v,_6:()=>m,_7:()=>p,_8:()=>y,__1:()=>a,__2:()=>c,__3:()=>f,__4:()=>d,__5:()=>_,__6:()=>h,__7:()=>g,__8:()=>E,app:()=>i});var n=t(23);function i(e,r){for(;;){var t=r,o=e,a=o.length,u=0===a?1:a,c=u-t.length|0;if(0===c)return o.apply(null,t);if(c>=0)return function(e,r){return function(t){return i(e,r.concat([t]))}}(o,t);r=n.sub(t,u,0|-c),e=o.apply(null,n.sub(t,0,u))}}function o(e,r){var t=e.length;if(1===t)return e(r);switch(t){case 1:return e(r);case 2:return function(t){return e(r,t)};case 3:return function(t,n){return e(r,t,n)};case 4:return function(t,n,i){return e(r,t,n,i)};case 5:return function(t,n,i,o){return e(r,t,n,i,o)};case 6:return function(t,n,i,o,a){return e(r,t,n,i,o,a)};case 7:return function(t,n,i,o,a,u){return e(r,t,n,i,o,a,u)};default:return i(e,[r])}}function a(e){return 1===e.length?e:function(r){return o(e,r)}}function u(e,r,t){var n=e.length;if(2===n)return e(r,t);switch(n){case 1:return i(e(r),[t]);case 2:return e(r,t);case 3:return function(n){return e(r,t,n)};case 4:return function(n,i){return e(r,t,n,i)};case 5:return function(n,i,o){return e(r,t,n,i,o)};case 6:return function(n,i,o,a){return e(r,t,n,i,o,a)};case 7:return function(n,i,o,a,u){return e(r,t,n,i,o,a,u)};default:return i(e,[r,t])}}function c(e){return 2===e.length?e:function(r,t){return u(e,r,t)}}function l(e,r,t,n){var o=e.length;if(3===o)return e(r,t,n);switch(o){case 1:return i(e(r),[t,n]);case 2:return i(e(r,t),[n]);case 3:return e(r,t,n);case 4:return function(i){return e(r,t,n,i)};case 5:return function(i,o){return e(r,t,n,i,o)};case 6:return function(i,o,a){return e(r,t,n,i,o,a)};case 7:return function(i,o,a,u){return e(r,t,n,i,o,a,u)};default:return i(e,[r,t,n])}}function f(e){return 3===e.length?e:function(r,t,n){return l(e,r,t,n)}}function s(e,r,t,n,o){var a=e.length;if(4===a)return e(r,t,n,o);switch(a){case 1:return i(e(r),[t,n,o]);case 2:return i(e(r,t),[n,o]);case 3:return i(e(r,t,n),[o]);case 4:return e(r,t,n,o);case 5:return function(i){return e(r,t,n,o,i)};case 6:return function(i,a){return e(r,t,n,o,i,a)};case 7:return function(i,a,u){return e(r,t,n,o,i,a,u)};default:return i(e,[r,t,n,o])}}function d(e){return 4===e.length?e:function(r,t,n,i){return s(e,r,t,n,i)}}function v(e,r,t,n,o,a){var u=e.length;if(5===u)return e(r,t,n,o,a);switch(u){case 1:return i(e(r),[t,n,o,a]);case 2:return i(e(r,t),[n,o,a]);case 3:return i(e(r,t,n),[o,a]);case 4:return i(e(r,t,n,o),[a]);case 5:return e(r,t,n,o,a);case 6:return function(i){return e(r,t,n,o,a,i)};case 7:return function(i,u){return e(r,t,n,o,a,i,u)};default:return i(e,[r,t,n,o,a])}}function _(e){return 5===e.length?e:function(r,t,n,i,o){return v(e,r,t,n,i,o)}}function m(e,r,t,n,o,a,u){var c=e.length;if(6===c)return e(r,t,n,o,a,u);switch(c){case 1:return i(e(r),[t,n,o,a,u]);case 2:return i(e(r,t),[n,o,a,u]);case 3:return i(e(r,t,n),[o,a,u]);case 4:return i(e(r,t,n,o),[a,u]);case 5:return i(e(r,t,n,o,a),[u]);case 6:return e(r,t,n,o,a,u);case 7:return function(i){return e(r,t,n,o,a,u,i)};default:return i(e,[r,t,n,o,a,u])}}function h(e){return 6===e.length?e:function(r,t,n,i,o,a){return m(e,r,t,n,i,o,a)}}function p(e,r,t,n,o,a,u,c){var l=e.length;if(7===l)return e(r,t,n,o,a,u,c);switch(l){case 1:return i(e(r),[t,n,o,a,u,c]);case 2:return i(e(r,t),[n,o,a,u,c]);case 3:return i(e(r,t,n),[o,a,u,c]);case 4:return i(e(r,t,n,o),[a,u,c]);case 5:return i(e(r,t,n,o,a),[u,c]);case 6:return i(e(r,t,n,o,a,u),[c]);case 7:return e(r,t,n,o,a,u,c);default:return i(e,[r,t,n,o,a,u,c])}}function g(e){return 7===e.length?e:function(r,t,n,i,o,a,u){return p(e,r,t,n,i,o,a,u)}}function y(e,r,t,n,o,a,u,c,l){var f=e.length;if(8===f)return e(r,t,n,o,a,u,c,l);switch(f){case 1:return i(e(r),[t,n,o,a,u,c,l]);case 2:return i(e(r,t),[n,o,a,u,c,l]);case 3:return i(e(r,t,n),[o,a,u,c,l]);case 4:return i(e(r,t,n,o),[a,u,c,l]);case 5:return i(e(r,t,n,o,a),[u,c,l]);case 6:return i(e(r,t,n,o,a,u),[c,l]);case 7:return i(e(r,t,n,o,a,u,c),[l]);default:return i(e,[r,t,n,o,a,u,c,l])}}function E(e){return 8===e.length?e:function(r,t,n,i,o,a,u,c){return y(e,r,t,n,i,o,a,u,c)}}},(e,r,t)=>{function n(e,r,t){for(var n=new Array(t),i=0,o=r;i<t;)n[i]=e[o],i=i+1|0,o=o+1|0;return n}function i(e){var r=function(e,r){for(;;){var t=r,n=e;if(!t)return n;r=t.tl,e=t.hd.length+n|0}}(0,e),t=new Array(r);return function(e,r,t){for(;;){var n=t,i=r;if(!n)return;for(var o=n.hd,a=o.length,u=i,c=0;c<a;)e[u]=o[c],u=u+1|0,c=c+1|0;t=n.tl,r=u}}(t,0,e),t}function o(e,r,t){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};e[r]=t}function a(e,r){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return e[r]}function u(e,r){for(var t=new Array(e),n=0;n<e;++n)t[n]=r;return t}function c(e){for(var r=new Array(e),t=0;t<e;++t)r[t]=0;return r}function l(e,r,t,n,i){if(n<=r)for(var o=0;o<i;++o)t[o+n|0]=e[o+r|0];else for(var a=i-1|0;a>=0;--a)t[a+n|0]=e[a+r|0]}function f(e){return e.slice(0)}t.r(r),t.d(r,{blit:()=>l,concat:()=>i,dup:()=>f,get:()=>a,make:()=>u,make_float:()=>c,set:()=>o,sub:()=>n})},(e,r,t)=>{function n(e){return void 0!==e.BS_PRIVATE_NESTED_SOME_NONE}function i(e){return void 0===e?{BS_PRIVATE_NESTED_SOME_NONE:0}:null!==e&&void 0!==e.BS_PRIVATE_NESTED_SOME_NONE?{BS_PRIVATE_NESTED_SOME_NONE:e.BS_PRIVATE_NESTED_SOME_NONE+1|0}:e}function o(e){return null==e?void 0:i(e)}function a(e){return void 0===e?void 0:i(e)}function u(e){return null===e?void 0:i(e)}function c(e){if(null===e||void 0===e.BS_PRIVATE_NESTED_SOME_NONE)return e;var r=e.BS_PRIVATE_NESTED_SOME_NONE;return 0===r?void 0:{BS_PRIVATE_NESTED_SOME_NONE:r-1|0}}function l(e){return void 0===e?void 0:c(e)}function f(e){return void 0!==e?e.VAL:e}t.r(r),t.d(r,{isNested:()=>n,null_to_opt:()=>u,nullable_to_opt:()=>o,option_get:()=>l,option_unwrap:()=>f,some:()=>i,undefined_to_opt:()=>a,valFromOption:()=>c})},(e,r,t)=>{t.r(r),t.d(r,{spliceApply:()=>n,spliceObjApply:()=>i});var n=function(e,r){var t,n;n=r.length;var i=[];for(t=0;t<n-1;++t)i.push(r[t]);var o=r[n-1];for(t=0;t<o.length;++t)i.push(o[t]);return e.apply(null,i)},i=function(e,r,t){var n,i;i=t.length;var o=[];for(n=0;n<i-1;++n)o.push(t[n]);var a=t[i-1];for(n=0;n<a.length;++n)o.push(a[n]);return e[r].apply(e,o)}},(e,r,t)=>{t.r(r),t.d(r,{React:()=>{},ReactDOMRe:()=>{},UList:()=>d,openWin:()=>v,querySelectorAllElements:()=>s,styleCss:()=>f});var n=t(21),i=t(27),o=t(31),a=t(24),u=t(10),c=t(32),l=t(41),f=u.default;function s(e,r){return i.keepMap(Array.prototype.slice.call(e.querySelectorAll(r)),c.ofNode)}var d={make:function(e){var r=e.children;return n.DOMRe.createDOMElementVariadic("ul",void 0,[n.Children.toArray(r).map((function(e){return n.DOMRe.createDOMElementVariadic("li",void 0,[e])}))])}};function v(e,r,t,u,c,s){return o.flatMap(a.nullable_to_opt(window.open("","",i.joinWith([["location","no"],["height",String(r)],["width",String(t)],["left",String(o.getWithDefault(u,0))],["top",String(o.getWithDefault(c,0))]],",",(function(e){return e[0]+"="+e[1]})))),(function(r){return o.map(l.asHtmlDocument(r.document),(function(t){return o.forEach(n.toNode(n.createElementVariadic(n.Fragment.make,{children:null},[n.DOMRe.createDOMElementVariadic("title",void 0,[e]),n.DOMRe.createDOMElementVariadic("style",void 0,[f.toString()])])),(function(e){t.head.appendChild(e)})),[r,t]}))}))}},(e,r,t)=>{t.r(r),t.d(r,{blit:()=>x,blitUnsafe:()=>I,cmp:()=>pe,cmpU:()=>he,concat:()=>A,concatMany:()=>M,eq:()=>me,eqU:()=>_e,every:()=>ae,every2:()=>se,every2U:()=>fe,everyU:()=>oe,fill:()=>k,forEach:()=>P,forEachU:()=>C,forEachWithIndex:()=>G,forEachWithIndexU:()=>z,get:()=>u,getBy:()=>V,getByU:()=>L,getExn:()=>c,getIndexBy:()=>j,getIndexByU:()=>q,joinWith:()=>we,joinWithU:()=>be,keep:()=>B,keepMap:()=>H,keepMapU:()=>F,keepU:()=>J,keepWithIndex:()=>X,keepWithIndexU:()=>W,make:()=>h,makeBy:()=>g,makeByAndShuffle:()=>E,makeByAndShuffleU:()=>y,makeByU:()=>p,map:()=>T,mapU:()=>U,mapWithIndex:()=>Y,mapWithIndexU:()=>K,partition:()=>ye,partitionU:()=>ge,range:()=>b,rangeBy:()=>w,reduce:()=>Q,reduceReverse:()=>ee,reduceReverse2:()=>te,reduceReverse2U:()=>re,reduceReverseU:()=>$,reduceU:()=>Z,reduceWithIndex:()=>ie,reduceWithIndexU:()=>ne,reverse:()=>m,reverseInPlace:()=>_,set:()=>l,setExn:()=>f,shuffle:()=>v,shuffleInPlace:()=>d,slice:()=>D,sliceToEnd:()=>N,some:()=>ce,some2:()=>ve,some2U:()=>de,someU:()=>ue,unzip:()=>Ee,zip:()=>S,zipBy:()=>O,zipByU:()=>R});var n=t(28),i=t(22),o=t(29),a=t(24);function u(e,r){if(r>=0&&r<e.length)return a.some(e[r])}function c(e,r){if(!(r>=0&&r<e.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.ml",27,4],Error:new Error};return e[r]}function l(e,r,t){return r>=0&&r<e.length&&(e[r]=t,!0)}function f(e,r,t){if(!(r>=0&&r<e.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.ml",33,2],Error:new Error};e[r]=t}function s(e,r,t){var n=e[r];e[r]=e[t],e[t]=n}function d(e){for(var r=e.length,t=0;t<r;++t)s(e,t,o.random_int(t,r))}function v(e){var r=e.slice(0);return d(r),r}function _(e){for(var r=e.length,t=0,n=r/2|0;t<n;++t)s(e,0+t|0,((0+r|0)-t|0)-1|0)}function m(e){for(var r=e.length,t=new Array(r),n=0;n<r;++n)t[n]=e[(r-1|0)-n|0];return t}function h(e,r){if(e<=0)return[];for(var t=new Array(e),n=0;n<e;++n)t[n]=r;return t}function p(e,r){if(e<=0)return[];for(var t=new Array(e),n=0;n<e;++n)t[n]=r(n);return t}function g(e,r){return p(e,i.__1(r))}function y(e,r){var t=p(e,r);return d(t),t}function E(e,r){return y(e,i.__1(r))}function b(e,r){var t=r-e|0;if(t<0)return[];for(var n=new Array(t+1|0),i=0;i<=t;++i)n[i]=e+i|0;return n}function w(e,r,t){var n=r-e|0;if(n<0||t<=0)return[];for(var i=1+(n/t|0)|0,o=new Array(i),a=e,u=0;u<i;++u)o[u]=a,a=a+t|0;return o}function S(e,r){for(var t=e.length,n=r.length,i=t<n?t:n,o=new Array(i),a=0;a<i;++a)o[a]=[e[a],r[a]];return o}function R(e,r,t){for(var n=e.length,i=r.length,o=n<i?n:i,a=new Array(o),u=0;u<o;++u)a[u]=t(e[u],r[u]);return a}function O(e,r,t){return R(e,r,i.__2(t))}function A(e,r){for(var t=e.length,n=r.length,i=new Array(t+n|0),o=0;o<t;++o)i[o]=e[o];for(var a=0;a<n;++a)i[t+a|0]=r[a];return i}function M(e){for(var r=e.length,t=0,n=0;n<r;++n)t=t+e[n].length|0;var i=new Array(t);t=0;for(var o=0;o<r;++o)for(var a=e[o],u=0,c=a.length;u<c;++u)i[t]=a[u],t=t+1|0;return i}function D(e,r,t){if(t<=0)return[];var i=e.length,o=r<0?n.caml_int_max(i+r|0,0):r,a=i-o|0,u=a<t?a:t;if(u<=0)return[];for(var c=new Array(u),l=0;l<u;++l)c[l]=e[o+l|0];return c}function N(e,r){for(var t=e.length,i=r<0?n.caml_int_max(t+r|0,0):r,o=t-i|0,a=new Array(o),u=0;u<o;++u)a[u]=e[i+u|0];return a}function k(e,r,t,i){if(!(t<=0)){var o=e.length,a=r<0?n.caml_int_max(o+r|0,0):r,u=o-a|0,c=u<t?u:t;if(!(c<=0))for(var l=a,f=a+c|0;l<f;++l)e[l]=i}}function I(e,r,t,n,i){if(n<=r)for(var o=0;o<i;++o)t[o+n|0]=e[o+r|0];else for(var a=i-1|0;a>=0;--a)t[a+n|0]=e[a+r|0]}function x(e,r,t,i,o){var a=e.length,u=t.length,c=r<0?n.caml_int_max(a+r|0,0):r,l=i<0?n.caml_int_max(u+i|0,0):i,f=n.caml_int_min(o,n.caml_int_min(a-c|0,u-l|0));if(l<=c)for(var s=0;s<f;++s)t[s+l|0]=e[s+c|0];else for(var d=f-1|0;d>=0;--d)t[d+l|0]=e[d+c|0]}function C(e,r){for(var t=0,n=e.length;t<n;++t)r(e[t])}function P(e,r){return C(e,i.__1(r))}function U(e,r){for(var t=e.length,n=new Array(t),i=0;i<t;++i)n[i]=r(e[i]);return n}function T(e,r){return U(e,i.__1(r))}function L(e,r){for(var t,n=e.length,i=0;void 0===t&&i<n;){var o=e[i];r(o)&&(t=a.some(o)),i=i+1|0}return t}function V(e,r){return L(e,i.__1(r))}function q(e,r){for(var t,n=e.length,i=0;void 0===t&&i<n;){r(e[i])&&(t=i),i=i+1|0}return t}function j(e,r){return q(e,i.__1(r))}function J(e,r){for(var t=e.length,n=new Array(t),i=0,o=0;o<t;++o){var a=e[o];r(a)&&(n[i]=a,i=i+1|0)}return n.length=i,n}function B(e,r){return J(e,i.__1(r))}function W(e,r){for(var t=e.length,n=new Array(t),i=0,o=0;o<t;++o){var a=e[o];r(a,o)&&(n[i]=a,i=i+1|0)}return n.length=i,n}function X(e,r){return W(e,i.__2(r))}function F(e,r){for(var t=e.length,n=new Array(t),i=0,o=0;o<t;++o){var u=r(e[o]);void 0!==u&&(n[i]=a.valFromOption(u),i=i+1|0)}return n.length=i,n}function H(e,r){return F(e,i.__1(r))}function z(e,r){for(var t=0,n=e.length;t<n;++t)r(t,e[t])}function G(e,r){return z(e,i.__2(r))}function K(e,r){for(var t=e.length,n=new Array(t),i=0;i<t;++i)n[i]=r(i,e[i]);return n}function Y(e,r){return K(e,i.__2(r))}function Z(e,r,t){for(var n=r,i=0,o=e.length;i<o;++i)n=t(n,e[i]);return n}function Q(e,r,t){return Z(e,r,i.__2(t))}function $(e,r,t){for(var n=r,i=e.length-1|0;i>=0;--i)n=t(n,e[i]);return n}function ee(e,r,t){return $(e,r,i.__2(t))}function re(e,r,t,i){for(var o=t,a=n.caml_int_min(e.length,r.length)-1|0;a>=0;--a)o=i(o,e[a],r[a]);return o}function te(e,r,t,n){return re(e,r,t,i.__3(n))}function ne(e,r,t){for(var n=r,i=0,o=e.length;i<o;++i)n=t(n,e[i],i);return n}function ie(e,r,t){return ne(e,r,i.__3(t))}function oe(e,r){for(var t=e.length,n=0;;){var i=n;if(i===t)return!0;if(!r(e[i]))return!1;n=i+1|0}}function ae(e,r){return oe(e,i.__1(r))}function ue(e,r){for(var t=e.length,n=0;;){var i=n;if(i===t)return!1;if(r(e[i]))return!0;n=i+1|0}}function ce(e,r){return ue(e,i.__1(r))}function le(e,r,t,n,i){for(;;){var o=t;if(o===i)return!0;if(!n(e[o],r[o]))return!1;t=o+1|0}}function fe(e,r,t){return le(e,r,0,t,n.caml_int_min(e.length,r.length))}function se(e,r,t){return fe(e,r,i.__2(t))}function de(e,r,t){for(var i=0,o=n.caml_int_min(e.length,r.length);;){var a=i;if(a===o)return!1;if(t(e[a],r[a]))return!0;i=a+1|0}}function ve(e,r,t){return de(e,r,i.__2(t))}function _e(e,r,t){var n=e.length;return n===r.length&&le(e,r,0,t,n)}function me(e,r,t){return _e(e,r,i.__2(t))}function he(e,r,t){var n=e.length,i=r.length;if(n>i)return 1;if(n<i)return-1;for(var o=0;;){var a=o;if(a===n)return 0;var u=t(e[a],r[a]);if(0!==u)return u;o=a+1|0}}function pe(e,r,t){return he(e,r,i.__2(t))}function ge(e,r){for(var t=e.length,n=0,i=0,o=new Array(t),a=new Array(t),u=0;u<t;++u){var c=e[u];r(c)?(o[n]=c,n=n+1|0):(a[i]=c,i=i+1|0)}return o.length=n,a.length=i,[o,a]}function ye(e,r){return ge(e,i.__1(r))}function Ee(e){for(var r=e.length,t=new Array(r),n=new Array(r),i=0;i<r;++i){var o=e[i];t[i]=o[0],n[i]=o[1]}return[t,n]}function be(e,r,t){var n=e.length;if(0===n)return"";for(var i=n-1|0,o=0,a="";;){var u=a,c=o;if(c===i)return u+t(e[c]);a=u+(t(e[c])+r),o=c+1|0}}function we(e,r,t){return be(e,r,i.__1(t))}},(e,r,t)=>{function n(e,r){return e<r?-1:e===r?0:1}function i(e,r){return e?r?0:1:r?-1:0}function o(e,r){return e===r?0:e<r?-1:e>r||e==e?1:r==r?-1:0}function a(e,r){return e===r?0:e<r?-1:1}function u(e,r){return e?r:e}function c(e,r){return e<r?e:r}function l(e,r){return e<r?e:r}function f(e,r){return e<r?e:r}function s(e,r){return e<r?e:r}function d(e,r){return e||r}function v(e,r){return e>r?e:r}function _(e,r){return e>r?e:r}function m(e,r){return e>r?e:r}function h(e,r){return e>r?e:r}function p(e,r){return e[1]===r[1]&&e[0]===r[0]}function g(e,r){var t=r[0],n=e[0];return n>t||!(n<t)&&e[1]>=r[1]}function y(e,r){return!p(e,r)}function E(e,r){return!g(e,r)}function b(e,r){return e[0]>r[0]||!(e[0]<r[0])&&e[1]>r[1]}function w(e,r){return!b(e,r)}function S(e,r){return g(e,r)?r:e}function R(e,r){return b(e,r)?e:r}t.r(r),t.d(r,{caml_bool_compare:()=>i,caml_bool_max:()=>d,caml_bool_min:()=>u,caml_float_compare:()=>o,caml_float_max:()=>_,caml_float_min:()=>l,caml_int32_max:()=>h,caml_int32_min:()=>s,caml_int_compare:()=>n,caml_int_max:()=>v,caml_int_min:()=>c,caml_string_compare:()=>a,caml_string_max:()=>m,caml_string_min:()=>f,i64_eq:()=>p,i64_ge:()=>g,i64_gt:()=>b,i64_le:()=>w,i64_lt:()=>E,i64_max:()=>R,i64_min:()=>S,i64_neq:()=>y})},(e,r,t)=>{t.r(r),t.d(r,{ceil:()=>l,ceil_int:()=>o,floor:()=>f,floor_int:()=>u,random_int:()=>c,unsafe_ceil:()=>i,unsafe_floor:()=>a});var n=t(30);function i(e){return Math.ceil(e)}function o(e){return e>n.max?n.max:e<n.min?n.min:Math.ceil(e)}function a(e){return Math.floor(e)}function u(e){return e>n.max?n.max:e<n.min?n.min:Math.floor(e)}function c(e,r){return u(Math.random()*(r-e|0))+e|0}var l=o,f=u},(e,r,t)=>{function n(e,r){return e===r}t.r(r),t.d(r,{equal:()=>n,max:()=>i,min:()=>o});var i=2147483647,o=-2147483648},(e,r,t)=>{t.r(r),t.d(r,{cmp:()=>w,cmpU:()=>b,eq:()=>E,eqU:()=>y,flatMap:()=>m,flatMapU:()=>_,forEach:()=>c,forEachU:()=>u,getExn:()=>l,getWithDefault:()=>h,isNone:()=>g,isSome:()=>p,keep:()=>a,keepU:()=>o,map:()=>v,mapU:()=>d,mapWithDefault:()=>s,mapWithDefaultU:()=>f});var n=t(22),i=t(24);function o(e,r){if(void 0!==e&&r(i.valFromOption(e)))return e}function a(e,r){return o(e,n.__1(r))}function u(e,r){if(void 0!==e)return r(i.valFromOption(e))}function c(e,r){return u(e,n.__1(r))}function l(e){if(void 0!==e)return i.valFromOption(e);throw{RE_EXN_ID:"Not_found",Error:new Error}}function f(e,r,t){return void 0!==e?t(i.valFromOption(e)):r}function s(e,r,t){return f(e,r,n.__1(t))}function d(e,r){if(void 0!==e)return i.some(r(i.valFromOption(e)))}function v(e,r){return d(e,n.__1(r))}function _(e,r){if(void 0!==e)return r(i.valFromOption(e))}function m(e,r){return _(e,n.__1(r))}function h(e,r){return void 0!==e?i.valFromOption(e):r}function p(e){return void 0!==e}function g(e){return void 0===e}function y(e,r,t){return void 0!==e?void 0!==r&&t(i.valFromOption(e),i.valFromOption(r)):void 0===r}function E(e,r,t){return y(e,r,n.__2(t))}function b(e,r,t){return void 0!==e?void 0!==r?t(i.valFromOption(e),i.valFromOption(r)):1:void 0!==r?-1:0}function w(e,r,t){return b(e,r,n.__2(t))}},(e,r,t)=>{t.r(r),t.d(r,{Impl:()=>_,asHtmlElement:()=>v,insertAdjacentElement:()=>h,insertAdjacentHTML:()=>p,insertAdjacentText:()=>g,nodeType:()=>y,ofNode:()=>d});var n=t(24),i=t(33),o=t(34),a=t(36),u=t(37),c=t(38),l=t(35),f=t(39),s=t(40);function d(e){if(0===i.nodeType(e))return n.some(e)}var v=function(e){if(void 0!==window.constructor.name&&/^HTML\w*Element$/.test(e.constructor.name)||/^\[object HTML\w*Element\]$/.test(e.constructor.toString()))return e};function _(e){return{asHtmlElement:v,ofNode:d,insertAdjacentElement:function(e,r,t){e.insertAdjacentElement(o.encodeInsertPosition(r),t)},insertAdjacentHTML:function(e,r,t){e.insertAdjacentHTML(o.encodeInsertPosition(r),t)},insertAdjacentText:function(e,r,t){e.insertAdjacentText(o.encodeInsertPosition(r),t)}}}var m=i.Impl({});function h(e,r,t){e.insertAdjacentElement(o.encodeInsertPosition(r),t)}function p(e,r,t){e.insertAdjacentHTML(o.encodeInsertPosition(r),t)}function g(e,r,t){e.insertAdjacentText(o.encodeInsertPosition(r),t)}l.Impl({}),f.Impl({}),c.Impl({}),s.Impl({}),u.Impl({}),a.Impl({});var y=m.nodeType},(e,r,t)=>{t.r(r),t.d(r,{Impl:()=>i,nodeType:()=>o});var n=t(34);function i(e){return{nodeType:function(e){return n.decodeNodeType(e.nodeType)}}}function o(e){return n.decodeNodeType(e.nodeType)}t(35).Impl({})},(e,r,t)=>{function n(e){return e}function i(e){return e+1>>>0>2?3:e+1|0}function o(e){switch(e){case"BackCompat":return 0;case"CSS1Compat":return 1;default:return 2}}function a(e){switch(e){case 0:return"true";case 1:return"false";case 2:return"inherit";case 3:return""}}function u(e){switch(e){case"false":return 1;case"inherit":return 2;case"true":return 0;default:return 3}}function c(e){if(e>2||e<0)throw{RE_EXN_ID:"Invalid_argument",_1:"invalid deltaMode",Error:new Error};return e}function l(e){switch(e){case 0:return"on";case 1:return"off";case 2:return""}}function f(e){switch(e){case"off":return 1;case"on":return 0;default:return 2}}function s(e){switch(e){case 0:return"ltr";case 1:return"rtl";case 2:return""}}function d(e){switch(e){case"ltr":return 0;case"rtl":return 1;default:return 2}}t.r(r),t.d(r,{EventPhase:()=>v,WhatToShow:()=>w,decodeCompareResult:()=>i,decodeCompatMode:()=>o,decodeContentEditable:()=>u,decodeDeltaMode:()=>c,decodeDesignMode:()=>f,decodeDir:()=>d,decodeNodeType:()=>p,decodePointerType:()=>g,decodeReadyState:()=>y,decodeShadowRootMode:()=>E,decodeVisibilityState:()=>b,encodeCompareHow:()=>n,encodeContentEditable:()=>a,encodeDesignMode:()=>l,encodeDir:()=>s,encodeFilterAction:()=>_,encodeInsertPosition:()=>m,encodeModifierKey:()=>h});var v={decode:function(e){return e>3||e<0?4:e}};function _(e){return e+1|0}function m(e){switch(e){case 0:return"beforebegin";case 1:return"afterbegin";case 2:return"beforeend";case 3:return"afterend"}}function h(e){switch(e){case 0:return"Alt";case 1:return"AltGraph";case 2:return"CapsLock";case 3:return"Control";case 4:return"Fn";case 5:return"FnLock";case 6:return"Hyper";case 7:return"Meta";case 8:return"NumLock";case 9:return"ScrollLock";case 10:return"Shift";case 11:return"Super";case 12:return"Symbol";case 13:return"SymbolLock"}}function p(e){return e>12||e<1?12:e-1|0}function g(e){switch(e){case"mouse":return 0;case"pen":return 1;case"touch|":return 2;default:return 3}}function y(e){switch(e){case"complete":return 2;case"interactive":return 1;case"loading":return 0;default:return 3}}function E(e){switch(e){case"closed":return 1;case"open":return 0;default:throw{RE_EXN_ID:"Invalid_argument",_1:"Unknown shadowRootMode",Error:new Error}}}function b(e){switch(e){case"hidden":return 1;case"prerender":return 2;case"unloaded":return 3;case"visible":return 0;default:return 4}}var w={_All:-1,_Element:1,_Attribute:2,_Text:4,_CDATASection:8,_EntityReference:16,_Entity:32,_ProcessingInstruction:64,_Comment:128,_Document:256,_DocumentType:512,_DocumentFragment:1024,_Notation:2048,many:function e(r){return r?r.hd|e(r.tl):0}}},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{t.r(r),t.d(r,{Impl:()=>l,asHtmlDocument:()=>s,compatMode:()=>v,nodeType:()=>m,ofNode:()=>d,visibilityState:()=>_});var n=t(24),i=t(33),o=t(34),a=t(38),u=t(35),c=t(42);function l(e){return{asHtmlDocument:function(e){var r=e.defaultView;if(null!=r){var t=r.HTMLDocument;if(null!=t&&e instanceof t)return e}},ofNode:function(e){if(8===i.nodeType(e))return n.some(e)},compatMode:function(e){return o.decodeCompatMode(e.compatMode)},visibilityState:function(e){return o.decodeVisibilityState(e.visibilityState)}}}var f=i.Impl({});u.Impl({}),c.Impl({}),a.Impl({});var s=function(e){var r=e.defaultView;if(null!=r){var t=r.HTMLDocument;if(null!=t&&e instanceof t)return e}};function d(e){if(8===i.nodeType(e))return n.some(e)}function v(e){return o.decodeCompatMode(e.compatMode)}function _(e){return o.decodeVisibilityState(e.visibilityState)}var m=f.nodeType},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{t.r(r),t.d(r,{Answer:()=>h,BlankDetail:()=>O,ChoiceDetail:()=>S,Detail:()=>y,React:()=>{},ReactDOMRe:()=>{},TextDetail:()=>M,Tooltip:()=>g,percent:()=>E,sortByKey:()=>b,style:()=>m});var n=t(22),i=t(21),o=t(26),a=t(44),u=t(27),c=t(52),l=t(31),f=t(24),s=t(53),d=t(55),v=t(10),_=t(60),m=v,h={};function p(e,r){e.ele.setAttribute("title",r)}var g={make:function(e){return{ele:e}},setContent:p};var y={Make:function(e){var r=function(e,r,t){return l.forEach(o.openWin("详细答案",200,300,t,r,void 0),(function(r){var t=r[1];return l.forEach(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:u.joinWith([m.mainBody,m.answerDetail]," ",(function(e){return e}))},[e.detailHtml])),(function(e){return l.forEach(f.nullable_to_opt(t.body),(function(r){r.appendChild(e)}))}))}))};return{updateAnswer:function(e,r,t){e.detail=s.set(e.detail,r,t)},updateUI:function(r){r.detailHtml=n._2(e.updateUI,r.detail,r.context)},showDetail:r,make:function(t,i){var o={detail:void 0,detailHtml:null,context:n._2(e.make,t,i)};return l.forEach(f.nullable_to_opt(t.querySelector(".item-type")),(function(e){e.classList.add(m.clickable);var t=e.getBoundingClientRect();e.addEventListener("click",(function(e){return r(o,0|t.top,0|t.left)}))})),o}}}};function E(e,r){return String(c.div(Math.imul(e,100),r))+"%"}function b(e){return d.stableSortBy(e,(function(e,r){return a.compare(e[0],r[0])}))}function w(e,r,t){return l.forEach(o.openWin("详细答案",200,300,t,r,void 0),(function(r){var t=r[1];return l.forEach(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:u.joinWith([m.mainBody,m.answerDetail]," ",(function(e){return e}))},[e.detailHtml])),(function(e){return l.forEach(f.nullable_to_opt(t.body),(function(r){r.appendChild(e)}))}))}))}var S={updateAnswer:function(e,r,t){e.detail=s.set(e.detail,r,t)},updateUI:function(e){var r,t;e.detailHtml=(r=e.detail,t=e.context,u.map(b(u.map(s.toArray(s.reduce(r,void 0,(function(e,r,t){return u.reduce(t,e,(function(e,t){return s.update(e,t,(function(e){return u.concat(l.getWithDefault(e,[]),[r])}))}))}))),(function(e){return[n._1(t.choiceMap,e[0]),e[1]]}))),(function(e){var n=e[1],a=e[0];return l.forEach(s.get(t.tooltips,a),(function(e){return p(e,E(n.length,s.size(r)))})),i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,[a])]),i.createElement(o.UList.make,{children:u.map(_.stableSort(n),(function(e){return i.DOMRe.createDOMElementVariadic("p",void 0,[e])}))})])})))},showDetail:w,make:function(e,r){var t=function(e,r){return{tooltips:u.reduceWithIndex(o.querySelectorAllElements(e,".item-body .checkboxInput, .item-body .radioInput"),void 0,(function(e,r,t){return s.set(e,String.fromCharCode(t+65|0),{ele:r})})),choiceMap:r}}(e,r),n={detail:void 0,detailHtml:null,context:t};return l.forEach(f.nullable_to_opt(e.querySelector(".item-type")),(function(e){e.classList.add(m.clickable);var r=e.getBoundingClientRect();e.addEventListener("click",(function(e){return w(n,0|r.top,0|r.left)}))})),n}};function R(e,r,t){return l.forEach(o.openWin("详细答案",200,300,t,r,void 0),(function(r){var t=r[1];return l.forEach(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:u.joinWith([m.mainBody,m.answerDetail]," ",(function(e){return e}))},[e.detailHtml])),(function(e){return l.forEach(f.nullable_to_opt(t.body),(function(r){r.appendChild(e)}))}))}))}var O={updateAnswer:function(e,r,t){e.detail=s.set(e.detail,r,t)},updateUI:function(e){var r,t;e.detailHtml=(r=e.detail,t=e.context,u.map(b(s.toArray(s.reduce(r,void 0,(function(e,r,t){return u.reduce(t,e,(function(e,t){var n=t[1];return s.update(e,t[0],(function(e){return f.some(s.update(l.getWithDefault(e,void 0),n,(function(e){return u.concat(l.getWithDefault(e,[]),[r])})))}))}))})))),(function(e){var n=e[0],a=b(s.toArray(e[1]));return l.forEach(s.get(t.tooltips,n),(function(e){return l.forEach(u.get(d.stableSortBy(u.map(a,(function(e){return[e[0],e[1].length]})),(function(e,r){return r[1]-e[1]|0})),0),(function(t){return p(e,"("+E(t[1],s.size(r))+") "+t[0])}))})),i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,["#"+n])]),i.createElement(o.UList.make,{children:u.map(a,(function(e){return i.createElementVariadic(i.Fragment.make,{children:null},[i.DOMRe.createDOMElementVariadic("p",void 0,[e[0]]),i.createElement(o.UList.make,{children:u.map(_.stableSort(e[1]),(function(e){return i.DOMRe.createDOMElementVariadic("p",void 0,[e])}))})])}))})])})))},showDetail:R,make:function(e,r){var t=function(e,r){return{tooltips:u.reduceWithIndex(o.querySelectorAllElements(e,".item-body .checkboxInput, .item-body .radioInput"),void 0,(function(e,r,t){return s.set(e,String.fromCharCode(t+65|0),{ele:r})}))}}(e),n={detail:void 0,detailHtml:null,context:t};return l.forEach(f.nullable_to_opt(e.querySelector(".item-type")),(function(e){e.classList.add(m.clickable);var r=e.getBoundingClientRect();e.addEventListener("click",(function(e){return R(n,0|r.top,0|r.left)}))})),n}};function A(e,r,t){return l.forEach(o.openWin("详细答案",200,300,t,r,void 0),(function(r){var t=r[1];return l.forEach(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:u.joinWith([m.mainBody,m.answerDetail]," ",(function(e){return e}))},[e.detailHtml])),(function(e){return l.forEach(f.nullable_to_opt(t.body),(function(r){r.appendChild(e)}))}))}))}var M={updateAnswer:function(e,r,t){e.detail=s.set(e.detail,r,t)},updateUI:function(e){var r;e.detailHtml=(r=e.detail,e.context,u.map(b(s.toArray(r)),(function(e){var r=e[1];return i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,[e[0]])]),l.mapWithDefault(r.content,null,(function(e){return i.DOMRe.createDOMElementVariadic("div",{className:m.answerDetailShortAnswer,dangerouslySetInnerHTML:{__html:e}},[])})),l.mapWithDefault(l.flatMap(r.attachments,(function(e){return e.filelist})),null,(function(e){return i.createElement(o.UList.make,{children:u.map(e,(function(e){return i.DOMRe.createDOMElementVariadic("a",{href:e.fileUrl},[e.fileName])}))})})),i.DOMRe.createDOMElementVariadic("div",void 0,[])])})))},showDetail:A,make:function(e,r){var t={detail:void 0,detailHtml:null,context:undefined};return l.forEach(f.nullable_to_opt(e.querySelector(".item-type")),(function(e){e.classList.add(m.clickable);var r=e.getBoundingClientRect();e.addEventListener("click",(function(e){return A(t,0|r.top,0|r.left)}))})),t}}},(e,r,t)=>{t.r(r),t.d(r,{blit:()=>H,capitalize:()=>W,capitalize_ascii:()=>L,compare:()=>q,concat:()=>d,contains:()=>C,contains_from:()=>x,equal:()=>z,escaped:()=>y,index:()=>b,index_from:()=>R,index_from_opt:()=>O,index_opt:()=>S,init:()=>l,iter:()=>v,iteri:()=>_,lowercase:()=>B,lowercase_ascii:()=>T,make:()=>F,map:()=>m,mapi:()=>h,rcontains_from:()=>P,rindex:()=>M,rindex_from:()=>D,rindex_from_opt:()=>I,rindex_opt:()=>k,split_on_char:()=>j,sub:()=>f,trim:()=>g,uncapitalize:()=>X,uncapitalize_ascii:()=>V,uppercase:()=>J,uppercase_ascii:()=>U});var n=t(28),i=t(45),o=t(22),a=t(47),u=t(50),c=t(48);function l(e,r){return a.bytes_to_string(i.init(e,r))}function f(e,r,t){return a.bytes_to_string(i.sub(a.bytes_of_string(e),r,t))}function s(e,r){if(e>=r)return e;throw{RE_EXN_ID:"Invalid_argument",_1:"String.concat",Error:new Error}}function d(e,r){if(!r)return"";var t=e.length;return a.bytes_to_string(function(e,r,t,n,i){for(;;){var o=i,u=r;if(!o)return e;var c=o.tl,l=o.hd;if(!c)return a.caml_blit_string(l,0,e,u,l.length),e;a.caml_blit_string(l,0,e,u,l.length),a.caml_blit_string(t,0,e,u+l.length|0,n),i=c,r=(u+l.length|0)+n|0}}(a.caml_create_bytes(function(e,r,t){for(;;){var n=t,i=e;if(!n)return i;var o=n.tl,a=n.hd;if(!o)return a.length+i|0;t=o,e=s((a.length+r|0)+i|0,i)}}(0,t,r)),0,e,t,r))}function v(e,r){for(var t=0,n=r.length;t<n;++t)o._1(e,r.charCodeAt(t))}function _(e,r){for(var t=0,n=r.length;t<n;++t)o._2(e,t,r.charCodeAt(t))}function m(e,r){return a.bytes_to_string(i.map(e,a.bytes_of_string(r)))}function h(e,r){return a.bytes_to_string(i.mapi(e,a.bytes_of_string(r)))}function p(e){return e>13||e<9?32===e:11!==e}function g(e){return""===e||!p(e.charCodeAt(0))&&!p(e.charCodeAt(e.length-1|0))?e:a.bytes_to_string(i.trim(a.bytes_of_string(e)))}function y(e){return function(r){for(;;){var t=r;if(t>=e.length)return!1;var n=e.charCodeAt(t);if(n<32)return!0;if(n>92||n<34){if(n>=127)return!0;r=t+1|0}else{if(n>91||n<35)return!0;r=t+1|0}}}(0)?a.bytes_to_string(i.escaped(a.bytes_of_string(e))):e}function E(e,r,t,n){for(;;){var i=t;if(i>=r)throw{RE_EXN_ID:"Not_found",Error:new Error};if(e.charCodeAt(i)===n)return i;t=i+1|0}}function b(e,r){return E(e,e.length,0,r)}function w(e,r,t,n){for(;;){var i=t;if(i>=r)return;if(e.charCodeAt(i)===n)return i;t=i+1|0}}function S(e,r){return w(e,e.length,0,r)}function R(e,r,t){var n=e.length;if(r<0||r>n)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from / Bytes.index_from",Error:new Error};return E(e,n,r,t)}function O(e,r,t){var n=e.length;if(r<0||r>n)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from_opt / Bytes.index_from_opt",Error:new Error};return w(e,n,r,t)}function A(e,r,t){for(;;){var n=r;if(n<0)throw{RE_EXN_ID:"Not_found",Error:new Error};if(e.charCodeAt(n)===t)return n;r=n-1|0}}function M(e,r){return A(e,e.length-1|0,r)}function D(e,r,t){if(r<-1||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from / Bytes.rindex_from",Error:new Error};return A(e,r,t)}function N(e,r,t){for(;;){var n=r;if(n<0)return;if(e.charCodeAt(n)===t)return n;r=n-1|0}}function k(e,r){return N(e,e.length-1|0,r)}function I(e,r,t){if(r<-1||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from_opt / Bytes.rindex_from_opt",Error:new Error};return N(e,r,t)}function x(e,r,t){var n=e.length;if(r<0||r>n)throw{RE_EXN_ID:"Invalid_argument",_1:"String.contains_from / Bytes.contains_from",Error:new Error};try{return E(e,n,r,t),!0}catch(e){var i=c.internalToOCamlException(e);if("Not_found"===i.RE_EXN_ID)return!1;throw i}}function C(e,r){return x(e,0,r)}function P(e,r,t){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rcontains_from / Bytes.rcontains_from",Error:new Error};try{return A(e,r,t),!0}catch(e){var n=c.internalToOCamlException(e);if("Not_found"===n.RE_EXN_ID)return!1;throw n}}function U(e){return a.bytes_to_string(i.uppercase_ascii(a.bytes_of_string(e)))}function T(e){return a.bytes_to_string(i.lowercase_ascii(a.bytes_of_string(e)))}function L(e){return a.bytes_to_string(i.capitalize_ascii(a.bytes_of_string(e)))}function V(e){return a.bytes_to_string(i.uncapitalize_ascii(a.bytes_of_string(e)))}var q=n.caml_string_compare;function j(e,r){for(var t=0,n=r.length,i=r.length-1|0;i>=0;--i)r.charCodeAt(i)===e&&(t={hd:f(r,i+1|0,(n-i|0)-1|0),tl:t},n=i);return{hd:f(r,0,n),tl:t}}function J(e){return a.bytes_to_string(i.uppercase(a.bytes_of_string(e)))}function B(e){return a.bytes_to_string(i.lowercase(a.bytes_of_string(e)))}function W(e){return a.bytes_to_string(i.capitalize(a.bytes_of_string(e)))}function X(e){return a.bytes_to_string(i.uncapitalize(a.bytes_of_string(e)))}var F=u.make,H=i.blit_string;function z(e,r){return e===r}},(e,r,t)=>{t.r(r),t.d(r,{blit:()=>y,blit_string:()=>E,capitalize:()=>ee,capitalize_ascii:()=>P,cat:()=>O,compare:()=>Z,concat:()=>R,contains:()=>K,contains_from:()=>G,copy:()=>s,empty:()=>f,equal:()=>te,escaped:()=>D,extend:()=>p,fill:()=>g,index:()=>L,index_from:()=>j,index_from_opt:()=>J,index_opt:()=>q,init:()=>l,iter:()=>b,iteri:()=>w,lowercase:()=>$,lowercase_ascii:()=>x,make:()=>c,map:()=>N,mapi:()=>k,of_string:()=>v,rcontains_from:()=>Y,rindex:()=>W,rindex_from:()=>X,rindex_from_opt:()=>z,rindex_opt:()=>H,sub:()=>_,sub_string:()=>m,to_string:()=>d,trim:()=>M,uncapitalize:()=>re,uncapitalize_ascii:()=>U,unsafe_of_string:()=>ie,unsafe_to_string:()=>ne,uppercase:()=>Q,uppercase_ascii:()=>I});var n=t(28),i=t(46),o=t(22),a=t(47),u=t(48);function c(e,r){var t=a.caml_create_bytes(e);return a.caml_fill_bytes(t,0,e,r),t}function l(e,r){for(var t=a.caml_create_bytes(e),n=0;n<e;++n)t[n]=o._1(r,n);return t}var f=[];function s(e){var r=e.length,t=a.caml_create_bytes(r);return a.caml_blit_bytes(e,0,t,0,r),t}function d(e){return a.bytes_to_string(s(e))}function v(e){return s(a.bytes_of_string(e))}function _(e,r,t){if(r<0||t<0||r>(e.length-t|0))throw{RE_EXN_ID:"Invalid_argument",_1:"String.sub / Bytes.sub",Error:new Error};var n=a.caml_create_bytes(t);return a.caml_blit_bytes(e,r,n,0,t),n}function m(e,r,t){return a.bytes_to_string(_(e,r,t))}function h(e,r){var t=e+r|0,n=r<0,i=t<0;if(e<0){if(!n)return t;if(i)return t;throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.extend",Error:new Error}}if(n)return t;if(i)throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.extend",Error:new Error};return t}function p(e,r,t){var i=h(h(e.length,r),t),o=a.caml_create_bytes(i),u=r<0?[0|-r,0]:[0,r],c=u[1],l=u[0],f=n.caml_int_min(e.length-l|0,i-c|0);return f>0&&a.caml_blit_bytes(e,l,o,c,f),o}function g(e,r,t,n){if(r<0||t<0||r>(e.length-t|0))throw{RE_EXN_ID:"Invalid_argument",_1:"String.fill / Bytes.fill",Error:new Error};return a.caml_fill_bytes(e,r,t,n)}function y(e,r,t,n,i){if(i<0||r<0||r>(e.length-i|0)||n<0||n>(t.length-i|0))throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.blit",Error:new Error};return a.caml_blit_bytes(e,r,t,n,i)}function E(e,r,t,n,i){if(i<0||r<0||r>(e.length-i|0)||n<0||n>(t.length-i|0))throw{RE_EXN_ID:"Invalid_argument",_1:"String.blit / Bytes.blit_string",Error:new Error};return a.caml_blit_string(e,r,t,n,i)}function b(e,r){for(var t=0,n=r.length;t<n;++t)o._1(e,r[t])}function w(e,r){for(var t=0,n=r.length;t<n;++t)o._2(e,t,r[t])}function S(e,r){if(e>=r)return e;throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.concat",Error:new Error}}function R(e,r){if(!r)return f;for(var t=e.length,n=a.caml_create_bytes(function(e,r,t){for(;;){var n=t,i=e;if(!n)return i;var o=n.tl,a=n.hd;if(!o)return a.length+i|0;t=o,e=S((a.length+r|0)+i|0,i)}}(0,t,r)),i=0,o=r;;){var u=o,c=i;if(!u)return n;var l=u.tl,s=u.hd;if(!l)return a.caml_blit_bytes(s,0,n,c,s.length),n;a.caml_blit_bytes(s,0,n,c,s.length),a.caml_blit_bytes(e,0,n,c+s.length|0,t),o=l,i=(c+s.length|0)+t|0}}function O(e,r){var t=e.length,n=r.length,i=a.caml_create_bytes(t+n|0);return a.caml_blit_bytes(e,0,i,0,t),a.caml_blit_bytes(r,0,i,t,n),i}function A(e){return e>13||e<9?32===e:11!==e}function M(e){for(var r=e.length,t=0;t<r&&A(e[t]);)t=t+1|0;for(var n=r-1|0;n>=t&&A(e[n]);)n=n-1|0;return n>=t?_(e,t,1+(n-t|0)|0):f}function D(e){for(var r=0,t=0,n=e.length;t<n;++t){var i=e[t];r=r+(i>=32?i>92||i<34?i>=127?4:1:i>91||i<35?2:1:i>=11?13!==i?4:2:i>=8?2:4)|0}if(r===e.length)return s(e);var o=a.caml_create_bytes(r);r=0;for(var u=0,c=e.length;u<c;++u){var l=e[u],f=0;if(l>=35)92!==l?l>=127?f=1:o[r]=l:f=2;else if(l>=32)l>=34?f=2:o[r]=l;else if(l>=14)f=1;else switch(l){case 8:o[r]=92,o[r=r+1|0]=98;break;case 9:o[r]=92,o[r=r+1|0]=116;break;case 10:o[r]=92,o[r=r+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:f=1;break;case 13:o[r]=92,o[r=r+1|0]=114}switch(f){case 1:o[r]=92,o[r=r+1|0]=48+(l/100|0)|0,o[r=r+1|0]=48+(l/10|0)%10|0,o[r=r+1|0]=48+l%10|0;break;case 2:o[r]=92,o[r=r+1|0]=l}r=r+1|0}return o}function N(e,r){var t=r.length;if(0===t)return r;for(var n=a.caml_create_bytes(t),i=0;i<t;++i)n[i]=o._1(e,r[i]);return n}function k(e,r){var t=r.length;if(0===t)return r;for(var n=a.caml_create_bytes(t),i=0;i<t;++i)n[i]=o._2(e,i,r[i]);return n}function I(e){return N(i.uppercase_ascii,e)}function x(e){return N(i.lowercase_ascii,e)}function C(e,r){if(0===r.length)return r;var t=s(r);return t[0]=o._1(e,r[0]),t}function P(e){return C(i.uppercase_ascii,e)}function U(e){return C(i.lowercase_ascii,e)}function T(e,r,t,n){for(;;){var i=t;if(i>=r)throw{RE_EXN_ID:"Not_found",Error:new Error};if(e[i]===n)return i;t=i+1|0}}function L(e,r){return T(e,e.length,0,r)}function V(e,r,t,n){for(;;){var i=t;if(i>=r)return;if(e[i]===n)return i;t=i+1|0}}function q(e,r){return V(e,e.length,0,r)}function j(e,r,t){var n=e.length;if(r<0||r>n)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from / Bytes.index_from",Error:new Error};return T(e,n,r,t)}function J(e,r,t){var n=e.length;if(r<0||r>n)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from_opt / Bytes.index_from_opt",Error:new Error};return V(e,n,r,t)}function B(e,r,t){for(;;){var n=r;if(n<0)throw{RE_EXN_ID:"Not_found",Error:new Error};if(e[n]===t)return n;r=n-1|0}}function W(e,r){return B(e,e.length-1|0,r)}function X(e,r,t){if(r<-1||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from / Bytes.rindex_from",Error:new Error};return B(e,r,t)}function F(e,r,t){for(;;){var n=r;if(n<0)return;if(e[n]===t)return n;r=n-1|0}}function H(e,r){return F(e,e.length-1|0,r)}function z(e,r,t){if(r<-1||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from_opt / Bytes.rindex_from_opt",Error:new Error};return F(e,r,t)}function G(e,r,t){var n=e.length;if(r<0||r>n)throw{RE_EXN_ID:"Invalid_argument",_1:"String.contains_from / Bytes.contains_from",Error:new Error};try{return T(e,n,r,t),!0}catch(e){var i=u.internalToOCamlException(e);if("Not_found"===i.RE_EXN_ID)return!1;throw i}}function K(e,r){return G(e,0,r)}function Y(e,r,t){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rcontains_from / Bytes.rcontains_from",Error:new Error};try{return B(e,r,t),!0}catch(e){var n=u.internalToOCamlException(e);if("Not_found"===n.RE_EXN_ID)return!1;throw n}}var Z=a.caml_bytes_compare;function Q(e){return N(i.uppercase,e)}function $(e){return N(i.lowercase,e)}function ee(e){return C(i.uppercase,e)}function re(e){return C(i.lowercase,e)}var te=a.caml_bytes_equal,ne=a.bytes_to_string,ie=a.bytes_of_string},(e,r,t)=>{t.r(r),t.d(r,{chr:()=>i,compare:()=>f,equal:()=>s,escaped:()=>o,lowercase:()=>a,lowercase_ascii:()=>c,uppercase:()=>u,uppercase_ascii:()=>l});var n=t(47);function i(e){if(e<0||e>255)throw{RE_EXN_ID:"Invalid_argument",_1:"Char.chr",Error:new Error};return e}function o(e){var r=0;if(e>=40){if(92===e)return"\\\\";r=e>=127?1:2}else if(e>=32){if(e>=39)return"\\'";r=2}else if(e>=14)r=1;else switch(e){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:r=1;break;case 13:return"\\r"}switch(r){case 1:var t=[0,0,0,0];return t[0]=92,t[1]=48+(e/100|0)|0,t[2]=48+(e/10|0)%10|0,t[3]=48+e%10|0,n.bytes_to_string(t);case 2:var i=[0];return i[0]=e,n.bytes_to_string(i)}}function a(e){return e>=65&&e<=90||e>=192&&e<=214||e>=216&&e<=222?e+32|0:e}function u(e){return e>=97&&e<=122||e>=224&&e<=246||e>=248&&e<=254?e-32|0:e}function c(e){return e>=65&&e<=90?e+32|0:e}function l(e){return e>=97&&e<=122?e-32|0:e}function f(e,r){return e-r|0}function s(e,r){return 0==(e-r|0)}},(e,r,t)=>{function n(e,r,t){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};e[r]=t}function i(e,r){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return e[r]}function o(e,r,t,n){if(!(t<=0))for(var i=r,o=t+r|0;i<o;++i)e[i]=n}function a(e){if(e<0)throw{RE_EXN_ID:"Invalid_argument",_1:"String.create",Error:new Error};for(var r=new Array(e),t=0;t<e;++t)r[t]=0;return r}function u(e,r,t,n,i){if(!(i<=0))if(e!==t){var o=e.length-r|0;if(i<=o)for(var a=0;a<i;++a)t[n+a|0]=e[r+a|0];else{for(var u=0;u<o;++u)t[n+u|0]=e[r+u|0];for(var c=o;c<i;++c)t[n+c|0]=0}}else{if(r<n){for(var l=(e.length-n|0)-1|0,f=i-1|0,s=l>f?f:l;s>=0;--s)e[n+s|0]=e[r+s|0];return}if(r<=n)return;for(var d=(e.length-r|0)-1|0,v=i-1|0,_=d>v?v:d,m=0;m<=_;++m)e[n+m|0]=e[r+m|0]}}function c(e){var r=e.length,t="",n=r;if(r<=4096&&r===e.length)return String.fromCharCode.apply(null,e);for(var i=0;n>0;){for(var o=n<1024?n:1024,a=new Array(o),u=0;u<o;++u)a[u]=e[u+i|0];t+=String.fromCharCode.apply(null,a),n=n-o|0,i=i+o|0}return t}function l(e,r,t,n,i){if(!(i<=0)){var o=e.length-r|0;if(i<=o)for(var a=0;a<i;++a)t[n+a|0]=e.charCodeAt(r+a|0);else{for(var u=0;u<o;++u)t[n+u|0]=e.charCodeAt(r+u|0);for(var c=o;c<i;++c)t[n+c|0]=0}}}function f(e){for(var r=e.length,t=new Array(r),n=0;n<r;++n)t[n]=e.charCodeAt(n);return t}function s(e,r,t,n,i){for(;;){var o=t;if(o>=n)return i;var a=e[o],u=r[o];if(a>u)return 1;if(a<u)return-1;t=o+1|0}}function d(e,r){var t=e.length,n=r.length;return t===n?s(e,r,0,t,0):t<n?s(e,r,0,t,-1):s(e,r,0,n,1)}function v(e,r){var t=e.length;if(t!==r.length)return!1;for(var n=0;;){var i=n;if(i===t)return!0;if(e[i]!==r[i])return!1;n=i+1|0}}function _(e,r){return d(e,r)>0}function m(e,r){return d(e,r)>=0}function h(e,r){return d(e,r)<0}function p(e,r){return d(e,r)<=0}t.r(r),t.d(r,{bytes_of_string:()=>f,bytes_to_string:()=>c,caml_blit_bytes:()=>u,caml_blit_string:()=>l,caml_bytes_compare:()=>d,caml_bytes_equal:()=>v,caml_bytes_greaterequal:()=>m,caml_bytes_greaterthan:()=>_,caml_bytes_lessequal:()=>p,caml_bytes_lessthan:()=>h,caml_create_bytes:()=>a,caml_fill_bytes:()=>o,get:()=>i,set:()=>n})},(e,r,t)=>{t.r(r),t.d(r,{$$Error:()=>o,caml_as_js_exn:()=>u,internalToOCamlException:()=>a});var n=t(24),i=t(49),o=i.create("Caml_js_exceptions.Error");function a(e){return i.caml_is_extension(e)?e:{RE_EXN_ID:o,_1:e}}function u(e){if(e.RE_EXN_ID===o)return n.some(e._1)}},(e,r,t)=>{t.r(r),t.d(r,{caml_exn_slot_name:()=>a,caml_is_extension:()=>o,create:()=>i,id:()=>n});var n={contents:0};function i(e){return n.contents=n.contents+1|0,e+"/"+n.contents}function o(e){return null!=e&&"string"==typeof e.RE_EXN_ID}function a(e){return e.RE_EXN_ID}},(e,r,t)=>{function n(e,r){if(r>=e.length||r<0)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return e.charCodeAt(r)}function i(e,r){return String.fromCharCode(r).repeat(e)}t.r(r),t.d(r,{get:()=>n,make:()=>i})},,(e,r,t)=>{function n(e,r){if(0===r)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return e/r|0}function i(e,r){if(0===r)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return e%r}t.r(r),t.d(r,{div:()=>n,mod_:()=>i})},(e,r,t)=>{t.r(r),t.d(r,{checkInvariantInternal:()=>G,cmp:()=>p,cmpU:()=>h,empty:()=>{},eq:()=>y,eqU:()=>g,every:()=>M,everyU:()=>A,findFirstBy:()=>b,findFirstByU:()=>E,forEach:()=>S,forEachU:()=>w,fromArray:()=>C,get:()=>X,getExn:()=>z,getUndefined:()=>F,getWithDefault:()=>H,has:()=>m,isEmpty:()=>_,keep:()=>Q,keepU:()=>Z,keysToArray:()=>P,map:()=>ne,mapU:()=>te,mapWithKey:()=>oe,mapWithKeyU:()=>ie,maxKey:()=>V,maxKeyUndefined:()=>q,maxUndefined:()=>W,maximum:()=>B,merge:()=>Y,mergeMany:()=>v,mergeU:()=>K,minKey:()=>T,minKeyUndefined:()=>L,minUndefined:()=>J,minimum:()=>j,partition:()=>ee,partitionU:()=>$,reduce:()=>O,reduceU:()=>R,remove:()=>s,removeMany:()=>d,set:()=>u,size:()=>k,some:()=>N,someU:()=>D,split:()=>re,toArray:()=>x,toList:()=>I,update:()=>l,updateU:()=>c,valuesToArray:()=>U});var n=t(22),i=t(24),o=t(54),a=t(56);function u(e,r,t){if(void 0===e)return o.singleton(r,t);var n=e.k;if(r===n)return o.updateValue(e,t);var i=e.v;return r<n?o.bal(u(e.l,r,t),n,i,e.r):o.bal(e.l,n,i,u(e.r,r,t))}function c(e,r,t){if(void 0!==e){var n=e.k;if(r===n){var a=t(i.some(e.v));if(void 0!==a)return o.updateValue(e,i.valFromOption(a));var u=e.l,l=e.r;if(void 0===u)return l;if(void 0===l)return u;var f={contents:l.k},s={contents:l.v},d=o.removeMinAuxWithRef(l,f,s);return o.bal(u,f.contents,s.contents,d)}var v=e.v,_=e.l,m=e.r;if(r<n){var h=c(_,r,t);return _===h?e:o.bal(h,n,v,m)}var p=c(m,r,t);return m===p?e:o.bal(_,n,v,p)}var g=t(void 0);return void 0!==g?o.singleton(r,i.valFromOption(g)):e}function l(e,r,t){return c(e,r,n.__1(t))}function f(e,r){var t=e.k,n=e.l,i=e.r;if(r===t){if(void 0===n)return i;if(void 0===i)return n;var a={contents:i.k},u={contents:i.v},c=o.removeMinAuxWithRef(i,a,u);return o.bal(n,a.contents,u.contents,c)}if(r<t){if(void 0===n)return e;var l=f(n,r);return l===n?e:o.bal(l,t,e.v,i)}if(void 0===i)return e;var s=f(i,r);return o.bal(n,t,e.v,s)}function s(e,r){if(void 0!==e)return f(e,r)}function d(e,r){var t=r.length;if(void 0!==e)for(var n=e,i=0;;){var o=i;if(o>=t)return n;var a=f(n,r[o]);if(void 0===a)return a;i=o+1|0,n=a}}function v(e,r){for(var t=r.length,n=e,i=0;i<t;++i){var o=r[i];n=u(n,o[0],o[1])}return n}var _=o.isEmpty,m=a.has,h=a.cmpU,p=a.cmp,g=a.eqU,y=a.eq,E=o.findFirstByU,b=o.findFirstBy,w=o.forEachU,S=o.forEach,R=o.reduceU,O=o.reduce,A=o.everyU,M=o.every,D=o.someU,N=o.some,k=o.size,I=o.toList,x=o.toArray,C=a.fromArray,P=o.keysToArray,U=o.valuesToArray,T=o.minKey,L=o.minKeyUndefined,V=o.maxKey,q=o.maxKeyUndefined,j=o.minimum,J=o.minUndefined,B=o.maximum,W=o.maxUndefined,X=a.get,F=a.getUndefined,H=a.getWithDefault,z=a.getExn,G=o.checkInvariantInternal,K=a.mergeU,Y=a.merge,Z=o.keepSharedU,Q=o.keepShared,$=o.partitionSharedU,ee=o.partitionShared,re=a.split,te=o.mapU,ne=o.map,ie=o.mapWithKeyU,oe=o.mapWithKey},(e,r,t)=>{t.r(r),t.d(r,{bal:()=>d,balMutate:()=>Oe,checkInvariantInternal:()=>ne,cmp:()=>_e,cmpU:()=>ve,concat:()=>F,concatOrJoin:()=>H,copy:()=>u,create:()=>c,eq:()=>he,eqU:()=>me,every:()=>q,everyU:()=>V,fillArray:()=>ae,findFirstBy:()=>N,findFirstByU:()=>D,forEach:()=>I,forEachU:()=>k,fromArray:()=>Me,fromSortedArrayAux:()=>se,fromSortedArrayRevAux:()=>fe,fromSortedArrayUnsafe:()=>de,get:()=>pe,getExn:()=>ye,getUndefined:()=>ge,getWithDefault:()=>Ee,has:()=>be,isEmpty:()=>A,join:()=>X,keepMap:()=>Y,keepMapU:()=>K,keepShared:()=>G,keepSharedU:()=>z,keysToArray:()=>ce,lengthNode:()=>$,map:()=>C,mapU:()=>x,mapWithKey:()=>U,mapWithKeyU:()=>P,maxKey:()=>p,maxKeyUndefined:()=>g,maxUndefined:()=>R,maximum:()=>S,minKey:()=>_,minKeyUndefined:()=>m,minUndefined:()=>b,minimum:()=>E,partitionShared:()=>Q,partitionSharedU:()=>Z,reduce:()=>L,reduceU:()=>T,removeMinAuxWithRef:()=>O,removeMinAuxWithRootMutate:()=>De,singleton:()=>l,size:()=>ee,some:()=>J,someU:()=>j,stackAllLeft:()=>M,toArray:()=>ue,toList:()=>te,updateMutate:()=>Ae,updateValue:()=>s,valuesToArray:()=>le});var n=t(22),i=t(24),o=t(55);function a(e){return void 0!==e?e.h:0}function u(e){return void 0!==e?{k:e.k,v:e.v,h:e.h,l:u(e.l),r:u(e.r)}:e}function c(e,r,t,n){var i=a(e),o=a(n);return{k:r,v:t,h:i>=o?i+1|0:o+1|0,l:e,r:n}}function l(e,r){return{k:e,v:r,h:1,l:void 0,r:void 0}}function f(e,r){return void 0===r||void 0!==e&&e.h>=r.h}function s(e,r){return e.v===r?e:{k:e.k,v:r,h:e.h,l:e.l,r:e.r}}function d(e,r,t,n){var i=void 0!==e?e.h:0,o=void 0!==n?n.h:0;if(i>(o+2|0)){var u=e.l,l=e.r;return a(u)>=a(l)?c(u,e.k,e.v,c(l,r,t,n)):c(c(u,e.k,e.v,l.l),l.k,l.v,c(l.r,r,t,n))}if(o<=(i+2|0))return{k:r,v:t,h:i>=o?i+1|0:o+1|0,l:e,r:n};var f=n.l,s=n.r;return a(s)>=a(f)?c(c(e,r,t,f),n.k,n.v,s):c(c(e,r,t,f.l),f.k,f.v,c(f.r,n.k,n.v,s))}function v(e){for(;;){var r=e,t=r.l;if(void 0===t)return r.k;e=t}}function _(e){if(void 0!==e)return i.some(v(e))}function m(e){if(void 0!==e)return v(e)}function h(e){for(;;){var r=e,t=r.r;if(void 0===t)return r.k;e=t}}function p(e){if(void 0!==e)return i.some(h(e))}function g(e){if(void 0!==e)return h(e)}function y(e){for(;;){var r=e,t=r.l;if(void 0===t)return[r.k,r.v];e=t}}function E(e){if(void 0!==e)return y(e)}function b(e){if(void 0!==e)return y(e)}function w(e){for(;;){var r=e,t=r.r;if(void 0===t)return[r.k,r.v];e=t}}function S(e){if(void 0!==e)return w(e)}function R(e){if(void 0!==e)return w(e)}function O(e,r,t){var n=e.l;return void 0!==n?d(O(n,r,t),e.k,e.v,e.r):(r.contents=e.k,t.contents=e.v,e.r)}function A(e){return void 0===e}function M(e,r){for(;;){if(void 0===e)return r;r={hd:e,tl:r},e=e.l}}function D(e,r){if(void 0!==e){var t=D(e.l,r);if(void 0!==t)return t;var n=e.k,i=e.v;if(r(n,i))return[n,i];var o=D(e.r,r);return void 0!==o?o:void 0}}function N(e,r){return D(e,n.__2(r))}function k(e,r){for(;;){var t=e;if(void 0===t)return;k(t.l,r),r(t.k,t.v),e=t.r}}function I(e,r){return k(e,n.__2(r))}function x(e,r){if(void 0!==e){var t=x(e.l,r),n=r(e.v),i=x(e.r,r);return{k:e.k,v:n,h:e.h,l:t,r:i}}}function C(e,r){return x(e,n.__1(r))}function P(e,r){if(void 0!==e){var t=e.k,n=P(e.l,r),i=r(t,e.v),o=P(e.r,r);return{k:t,v:i,h:e.h,l:n,r:o}}}function U(e,r){return P(e,n.__2(r))}function T(e,r,t){for(;;){var n=r,i=e;if(void 0===i)return n;var o=i.k,a=i.v,u=i.l,c=i.r;r=t(T(u,n,t),o,a),e=c}}function L(e,r,t){return T(e,r,n.__3(t))}function V(e,r){for(;;){var t=e;if(void 0===t)return!0;if(!r(t.k,t.v))return!1;if(!V(t.l,r))return!1;e=t.r}}function q(e,r){return V(e,n.__2(r))}function j(e,r){for(;;){var t=e;if(void 0===t)return!1;if(r(t.k,t.v))return!0;if(j(t.l,r))return!0;e=t.r}}function J(e,r){return j(e,n.__2(r))}function B(e,r,t){return void 0!==e?d(B(e.l,r,t),e.k,e.v,e.r):l(r,t)}function W(e,r,t){return void 0!==e?d(e.l,e.k,e.v,W(e.r,r,t)):l(r,t)}function X(e,r,t,n){if(void 0===e)return B(n,r,t);if(void 0===n)return W(e,r,t);var i=e.k,o=e.v,a=e.h,u=e.l,l=e.r,f=n.k,s=n.v,v=n.h,_=n.l,m=n.r;return a>(v+2|0)?d(u,i,o,X(l,r,t,n)):v>(a+2|0)?d(X(e,r,t,_),f,s,m):c(e,r,t,n)}function F(e,r){if(void 0===e)return r;if(void 0===r)return e;var t={contents:r.k},n={contents:r.v},i=O(r,t,n);return X(e,t.contents,n.contents,i)}function H(e,r,t,n){return void 0!==t?X(e,r,i.valFromOption(t),n):F(e,n)}function z(e,r){if(void 0!==e){var t=e.k,n=e.v,i=z(e.l,r),o=r(t,n),a=z(e.r,r);return o?X(i,t,n,a):F(i,a)}}function G(e,r){return z(e,n.__2(r))}function K(e,r){if(void 0!==e){var t=e.k,n=e.v,o=K(e.l,r),a=r(t,n),u=K(e.r,r);return void 0!==a?X(o,t,i.valFromOption(a),u):F(o,u)}}function Y(e,r){return K(e,n.__2(r))}function Z(e,r){if(void 0===e)return[void 0,void 0];var t=e.k,n=e.v,i=Z(e.l,r),o=i[1],a=i[0],u=r(t,n),c=Z(e.r,r),l=c[1],f=c[0];return u?[X(a,t,n,f),F(o,l)]:[F(a,f),X(o,t,n,l)]}function Q(e,r){return Z(e,n.__2(r))}function $(e){var r=e.l,t=e.r;return(1+(void 0!==r?$(r):0)|0)+(void 0!==t?$(t):0)|0}function ee(e){return void 0!==e?$(e):0}function re(e,r){for(;;){var t=r,n=e;if(void 0===n)return t;var i=n.k,o=n.v,a=n.l;r={hd:[i,o],tl:re(n.r,t)},e=a}}function te(e){return re(e,0)}function ne(e){for(;;){var r=e;if(void 0===r)return;var t=r.l,n=r.r,i=a(t)-a(n)|0;if(!(i<=2&&i>=-2))throw{RE_EXN_ID:"Assert_failure",_1:["belt_internalAVLtree.ml",373,4],Error:new Error};ne(t),e=n}}function ie(e,r,t){for(;;){var n=r,i=e,o=i.k,a=i.l,u=i.r,c=void 0!==a?ie(a,n,t):n;t[c]=o;var l=c+1|0;if(void 0===u)return l;r=l,e=u}}function oe(e,r,t){for(;;){var n=r,i=e,o=i.l,a=i.r,u=void 0!==o?oe(o,n,t):n;t[u]=i.v;var c=u+1|0;if(void 0===a)return c;r=c,e=a}}function ae(e,r,t){for(;;){var n=r,i=e,o=i.l,a=i.k,u=i.r,c=void 0!==o?ae(o,n,t):n;t[c]=[a,i.v];var l=c+1|0;if(void 0===u)return l;r=l,e=u}}function ue(e){if(void 0===e)return[];var r=$(e),t=new Array(r);return ae(e,0,t),t}function ce(e){if(void 0===e)return[];var r=$(e),t=new Array(r);return ie(e,0,t),t}function le(e){if(void 0===e)return[];var r=$(e),t=new Array(r);return oe(e,0,t),t}function fe(e,r,t){switch(t){case 0:return;case 1:var n=e[r];return l(n[0],n[1]);case 2:var i=e[r],o=e[r-1|0],a=i;return{k:o[0],v:o[1],h:2,l:l(a[0],a[1]),r:void 0};case 3:var u=e[r],f=e[r-1|0],s=e[r-2|0],d=f,v=u;return{k:d[0],v:d[1],h:2,l:l(v[0],v[1]),r:l(s[0],s[1])};default:var _=t/2|0,m=fe(e,r,_),h=e[r-_|0],p=fe(e,(r-_|0)-1|0,(t-_|0)-1|0);return c(m,h[0],h[1],p)}}function se(e,r,t){switch(t){case 0:return;case 1:var n=e[r];return l(n[0],n[1]);case 2:var i=e[r],o=e[r+1|0],a=i;return{k:o[0],v:o[1],h:2,l:l(a[0],a[1]),r:void 0};case 3:var u=e[r],f=e[r+1|0],s=e[r+2|0],d=f,v=u;return{k:d[0],v:d[1],h:2,l:l(v[0],v[1]),r:l(s[0],s[1])};default:var _=t/2|0,m=se(e,r,_),h=e[r+_|0],p=se(e,1+(r+_|0)|0,(t-_|0)-1|0);return c(m,h[0],h[1],p)}}function de(e){return se(e,0,e.length)}function ve(e,r,t,n){var i=ee(e),o=ee(r);if(i!==o)return i<o?-1:1;for(var a=M(e,0),u=M(r,0);;){var c=u,l=a;if(!l)return 0;if(!c)return 0;var f=c.hd,s=l.hd,d=t(s.k,f.k);if(0!==d)return d;var v=n(s.v,f.v);if(0!==v)return v;u=M(f.r,c.tl),a=M(s.r,l.tl)}}function _e(e,r,t,i){return ve(e,r,t,n.__2(i))}function me(e,r,t,n){if(ee(e)!==ee(r))return!1;for(var i=M(e,0),o=M(r,0);;){var a=o,u=i;if(!u)return!0;if(!a)return!0;var c=a.hd,l=u.hd;if(0!==t(l.k,c.k)||!n(l.v,c.v))return!1;o=M(c.r,a.tl),i=M(l.r,u.tl)}}function he(e,r,t,i){return me(e,r,t,n.__2(i))}function pe(e,r,t){for(;;){var n=e;if(void 0===n)return;var o=t(r,n.k);if(0===o)return i.some(n.v);e=o<0?n.l:n.r}}function ge(e,r,t){for(;;){var n=e;if(void 0===n)return;var i=t(r,n.k);if(0===i)return n.v;e=i<0?n.l:n.r}}function ye(e,r,t){for(;;){var n=e;if(void 0===n)throw{RE_EXN_ID:"Not_found",Error:new Error};var i=t(r,n.k);if(0===i)return n.v;e=i<0?n.l:n.r}}function Ee(e,r,t,n){for(;;){var i=e;if(void 0===i)return t;var o=n(r,i.k);if(0===o)return i.v;e=o<0?i.l:i.r}}function be(e,r,t){for(;;){var n=e;if(void 0===n)return!1;var i=t(r,n.k);if(0===i)return!0;e=i<0?n.l:n.r}}function we(e){var r=e.l;e.l=r.r,r.r=e;var t=a(e.l),n=a(e.r);e.h=(t>n?t:n)+1|0;var i=a(r.l),o=e.h;return r.h=(i>o?i:o)+1|0,r}function Se(e){var r=e.r;e.r=r.l,r.l=e;var t=a(e.l),n=a(e.r);e.h=(t>n?t:n)+1|0;var i=a(r.r),o=e.h;return r.h=(i>o?i:o)+1|0,r}function Re(e){var r=a(e.l),t=a(e.r);return e.h=(r>t?r:t)+1|0,e}function Oe(e){var r,t,n=e.l,i=e.r,o=a(n),u=a(i);if(o>(2+u|0))return f(n.l,n.r)?Re(we(e)):Re((t=Se((r=e).l),r.l=t,we(r)));if(u>(2+o|0)){var c=i.l;return f(i.r,c)?Re(Se(e)):Re(function(e){var r=we(e.r);return e.r=r,Se(e)}(e))}return e.h=(o>u?o:u)+1|0,e}function Ae(e,r,t,n){if(void 0===e)return l(r,t);var i=n(r,e.k);if(0===i)return e.v=t,e;var o=e.l,a=e.r;if(i<0){var u=Ae(o,r,t,n);e.l=u}else e.r=Ae(a,r,t,n);return Oe(e)}function Me(e,r){var t=e.length;if(0!==t){var n,i=o.strictlySortedLengthU(e,(function(e,t){return r(e[0],t[0])<0}));n=i>=0?se(e,0,i):fe(e,(i=0|-i)-1|0,i);for(var a=i;a<t;++a){var u=e[a];n=Ae(n,u[0],u[1],r)}return n}}function De(e,r){var t=r.r,n=r.l;return void 0!==n?(r.l=De(e,n),Oe(r)):(e.k=r.k,e.v=r.v,t)}},(e,r,t)=>{t.r(r),t.d(r,{$$String:()=>{},Int:()=>{},binarySearchBy:()=>S,binarySearchByU:()=>w,diff:()=>m,diffU:()=>_,intersect:()=>v,intersectU:()=>d,isSorted:()=>c,isSortedU:()=>u,stableSortBy:()=>b,stableSortByU:()=>E,stableSortInPlaceBy:()=>y,stableSortInPlaceByU:()=>g,strictlySortedLength:()=>a,strictlySortedLengthU:()=>o,union:()=>s,unionU:()=>f});var n=t(22),i=t(27);function o(e,r){var t=e.length;if(0===t||1===t)return t;var n=e[0],i=e[1];if(!r(n,i))return r(i,n)?0|-function(e,r,t,n,i){for(;;){var o=t,a=r;if(o>=n)return o;var u=e[o];if(!i(u,a))return o;t=o+1|0,r=u}}(e,i,2,t,r):1;for(var o=i,a=2;;){var u=a,c=o;if(u>=t)return u;var l=e[u];if(!r(c,l))return u;a=u+1|0,o=l}}function a(e,r){return o(e,n.__2(r))}function u(e,r){var t=e.length;if(0===t)return!0;for(var n=0,i=t-1|0;;){var o=n;if(o===i)return!0;if(r(e[o],e[o+1|0])>0)return!1;n=o+1|0}}function c(e,r){return u(e,n.__2(r))}function l(e,r,t,n,o,a,u,c,l){for(var f=r+t|0,s=o+a|0,d=r,v=e[r],_=o,m=n[o],h=c;;){var p=h,g=m,y=_,E=v,b=d;if(l(E,g)<=0){u[p]=E;var w=b+1|0;if(w>=f)return i.blitUnsafe(n,y,u,p+1|0,s-y|0);h=p+1|0,v=e[w],d=w}else{u[p]=g;var S=y+1|0;if(S>=s)return i.blitUnsafe(e,b,u,p+1|0,f-b|0);h=p+1|0,m=n[S],_=S}}}function f(e,r,t,n,o,a,u,c,l){for(var f=r+t|0,s=o+a|0,d=r,v=e[r],_=o,m=n[o],h=c;;){var p=h,g=m,y=_,E=v,b=d,w=l(E,g);if(w<0){u[p]=E;var S=b+1|0,R=p+1|0;if(S<f){h=R,v=e[S],d=S;continue}return i.blitUnsafe(n,y,u,R,s-y|0),(R+s|0)-y|0}if(0!==w){u[p]=g;var O=y+1|0,A=p+1|0;if(!(O<s))return i.blitUnsafe(e,b,u,A,f-b|0),(A+f|0)-b|0;h=A,m=n[O],_=O}else{u[p]=E;var M=b+1|0,D=y+1|0,N=p+1|0;if(!(M<f&&D<s))return M===f?(i.blitUnsafe(n,D,u,N,s-D|0),(N+s|0)-D|0):(i.blitUnsafe(e,M,u,N,f-M|0),(N+f|0)-M|0);h=N,m=n[D],_=D,v=e[M],d=M}}}function s(e,r,t,i,o,a,u,c,l){return f(e,r,t,i,o,a,u,c,n.__2(l))}function d(e,r,t,n,i,o,a,u,c){for(var l=r+t|0,f=i+o|0,s=r,d=e[r],v=i,_=n[i],m=u;;){var h=m,p=v,g=d,y=s,E=c(g,_);if(E<0){var b=y+1|0;if(b>=l)return h;d=e[b],s=b}else if(0!==E){var w=p+1|0;if(w>=f)return h;_=n[w],v=w}else{a[h]=g;var S=y+1|0,R=p+1|0,O=h+1|0;if(!(S<l&&R<f))return O;m=O,_=n[R],v=R,d=e[S],s=S}}}function v(e,r,t,i,o,a,u,c,l){return d(e,r,t,i,o,a,u,c,n.__2(l))}function _(e,r,t,n,o,a,u,c,l){for(var f=r+t|0,s=o+a|0,d=r,v=e[r],_=o,m=n[o],h=c;;){var p=h,g=_,y=v,E=d,b=l(y,m);if(b<0){u[p]=y;var w=p+1|0,S=E+1|0;if(S>=f)return w;h=w,v=e[S],d=S}else if(0!==b){var R=g+1|0;if(!(R<s))return i.blitUnsafe(e,E,u,p,f-E|0),(p+f|0)-E|0;m=n[R],_=R}else{var O=E+1|0,A=g+1|0;if(!(O<f&&A<s))return O===f?p:(i.blitUnsafe(e,O,u,p,f-O|0),(p+f|0)-O|0);m=n[A],_=A,v=e[O],d=O}}}function m(e,r,t,i,o,a,u,c,l){return _(e,r,t,i,o,a,u,c,n.__2(l))}function h(e,r,t,n,i,o){for(var a=0;a<i;++a){for(var u=e[r+a|0],c=(n+a|0)-1|0;c>=n&&o(t[c],u)>0;)t[c+1|0]=t[c],c=c-1|0;t[c+1|0]=u}}function p(e,r,t,n,i,o){if(i<=5)return h(e,r,t,n,i,o);var a=i/2|0,u=i-a|0;return p(e,r+a|0,t,n+a|0,u,o),p(e,r,e,r+u|0,a,o),l(e,r+u|0,a,t,n+a|0,u,t,n,o)}function g(e,r){var t=e.length;if(t<=5)return h(e,0,e,0,t,r);var n=t/2|0,i=t-n|0,o=new Array(i);return p(e,n,o,0,i,r),p(e,0,e,i,n,r),l(e,i,n,o,0,i,e,0,r)}function y(e,r){return g(e,n.__2(r))}function E(e,r){var t=e.slice(0);return g(t,r),t}function b(e,r){return E(e,n.__2(r))}function w(e,r,t){var n=e.length;if(0===n)return-1;if(t(r,e[0])<0)return-1;if(t(r,e[n-1|0])>0)return 0|-(n+1|0);for(var i=0,o=n-1|0;;){var a=o,u=i,c=(u+a|0)/2|0,l=t(r,e[c]);if(0===l)return c;if(l<0){if(a===c)return 0===t(e[u],r)?u:0|-(a+1|0);o=c}else{if(u===c)return 0===t(e[a],r)?a:0|-(a+1|0);i=c}}}function S(e,r,t){return w(e,r,n.__2(t))}},(e,r,t)=>{t.r(r),t.d(r,{A:()=>{},N:()=>{},S:()=>{},add:()=>c,addMutate:()=>O,cmp:()=>b,cmpU:()=>E,compareAux:()=>y,eq:()=>R,eqAux:()=>w,eqU:()=>S,fromArray:()=>A,get:()=>l,getExn:()=>s,getUndefined:()=>f,getWithDefault:()=>d,has:()=>v,merge:()=>g,mergeU:()=>p,remove:()=>_,split:()=>h,splitAux:()=>m});var n=t(28),i=t(22),o=t(24),a=t(55),u=t(54);function c(e,r,t){if(void 0===e)return u.singleton(r,t);var n=e.k;if(r===n)return u.updateValue(e,t);var i=e.v;return r<n?u.bal(c(e.l,r,t),n,i,e.r):u.bal(e.l,n,i,c(e.r,r,t))}function l(e,r){for(;;){var t=e;if(void 0===t)return;var n=t.k;if(r===n)return o.some(t.v);e=r<n?t.l:t.r}}function f(e,r){for(;;){var t=e;if(void 0===t)return;var n=t.k;if(r===n)return t.v;e=r<n?t.l:t.r}}function s(e,r){for(;;){var t=e;if(void 0===t)throw{RE_EXN_ID:"Not_found",Error:new Error};var n=t.k;if(r===n)return t.v;e=r<n?t.l:t.r}}function d(e,r,t){for(;;){var n=e;if(void 0===n)return t;var i=n.k;if(r===i)return n.v;e=r<i?n.l:n.r}}function v(e,r){for(;;){var t=e;if(void 0===t)return!1;var n=t.k;if(r===n)return!0;e=r<n?t.l:t.r}}function _(e,r){if(void 0===e)return e;var t=e.k,n=e.l,i=e.r;if(r!==t)return r<t?u.bal(_(n,r),t,e.v,i):u.bal(n,t,e.v,_(i,r));if(void 0===n)return i;if(void 0===i)return n;var o={contents:i.k},a={contents:i.v},c=u.removeMinAuxWithRef(i,o,a);return u.bal(n,o.contents,a.contents,c)}function m(e,r){var t=r.k,n=r.v,i=r.l,a=r.r;if(e===t)return[i,o.some(n),a];if(e<t){if(void 0===i)return[void 0,void 0,r];var c=m(e,i);return[c[0],c[1],u.join(c[2],t,n,a)]}if(void 0===a)return[r,void 0,void 0];var l=m(e,a);return[u.join(i,t,n,l[0]),l[1],l[2]]}function h(e,r){return void 0!==r?m(e,r):[void 0,void 0,void 0]}function p(e,r,t){if(void 0!==e){if(e.h>=(void 0!==r?r.h:0)){var n=e.k,i=e.v,a=e.l,c=e.r,l=h(n,r);return u.concatOrJoin(p(a,l[0],t),n,t(n,o.some(i),l[1]),p(c,l[2],t))}}else if(void 0===r)return;var f=r.k,s=r.v,d=r.l,v=r.r,_=h(f,e);return u.concatOrJoin(p(_[0],d,t),f,t(f,_[1],o.some(s)),p(_[2],v,t))}function g(e,r,t){return p(e,r,i.__3(t))}function y(e,r,t){for(;;){var i=r,o=e;if(!o)return 0;if(!i)return 0;var a=i.hd,c=o.hd,l=n.caml_string_compare(c.k,a.k);if(0!==l)return l;var f=t(c.v,a.v);if(0!==f)return f;r=u.stackAllLeft(a.r,i.tl),e=u.stackAllLeft(c.r,o.tl)}}function E(e,r,t){var n=u.size(e),i=u.size(r);return n===i?y(u.stackAllLeft(e,0),u.stackAllLeft(r,0),t):n<i?-1:1}function b(e,r,t){return E(e,r,i.__2(t))}function w(e,r,t){for(;;){var n=r,i=e;if(!i)return!0;if(!n)return!0;var o=n.hd,a=i.hd;if(a.k!==o.k||!t(a.v,o.v))return!1;r=u.stackAllLeft(o.r,n.tl),e=u.stackAllLeft(a.r,i.tl)}}function S(e,r,t){return u.size(e)===u.size(r)&&w(u.stackAllLeft(e,0),u.stackAllLeft(r,0),t)}function R(e,r,t){return S(e,r,i.__2(t))}function O(e,r,t){if(void 0===e)return u.singleton(r,t);var n=e.k;if(r===n)return e.k=r,e.v=t,e;var i=e.l,o=e.r;if(r<n){var a=O(i,r,t);e.l=a}else e.r=O(o,r,t);return u.balMutate(e)}function A(e){var r=e.length;if(0!==r){var t,n=a.strictlySortedLengthU(e,(function(e,r){return e[0]<r[0]}));n>=0?t=u.fromSortedArrayAux(e,0,n):(n=0|-n,t=u.fromSortedArrayRevAux(e,n-1|0,n));for(var i=n;i<r;++i){var o=e[i];t=O(t,o[0],o[1])}return t}}},(e,r,t)=>{t.r(r),t.d(r,{Impl:()=>c,asHtmlElement:()=>h,contentEditable:()=>s,dir:()=>v,insertAdjacentElement:()=>g,insertAdjacentHTML:()=>y,insertAdjacentText:()=>E,nodeType:()=>m,ofElement:()=>b,ofNode:()=>p,setContentEditable:()=>d,setDir:()=>_});var n=t(33),i=t(34),o=t(32),a=t(35),u=t(39);function c(e){return{ofElement:o.asHtmlElement,contentEditable:function(e){return i.decodeContentEditable(e.contentEditable)},setContentEditable:function(e,r){e.contentEditable=i.encodeContentEditable(r)},dir:function(e){return i.decodeDir(e.dir)},setDir:function(e,r){e.dir=i.encodeDir(r)}}}var l=n.Impl({});a.Impl({}),u.Impl({});var f=o.Impl({});function s(e){return i.decodeContentEditable(e.contentEditable)}function d(e,r){e.contentEditable=i.encodeContentEditable(r)}function v(e){return i.decodeDir(e.dir)}function _(e,r){e.dir=i.encodeDir(r)}var m=l.nodeType,h=f.asHtmlElement,p=f.ofNode,g=f.insertAdjacentElement,y=f.insertAdjacentHTML,E=f.insertAdjacentText,b=o.asHtmlElement},(e,r,t)=>{t.r(r),t.d(r,{ExamId:()=>A,GMEntry:()=>a,NoLeaveCheck:()=>y,Option2:()=>u,Server:()=>v,SortProblems:()=>w,SyncAnswers:()=>h,Token:()=>R,Username:()=>f});var n=t(59),i=t(24),o=t(61);var a={Make:function(e){var r={contents:{LAZY_DONE:!1,VAL:function(){var r=GM_getValue(e.name);return null==r?(GM_setValue(e.name,e.init),e.init):i.some(r)}}};return{v:r,get:function(e){return o.force(r.contents)},set:function(t){r.contents=n.from_val(t),GM_setValue(e.name,t)}}}};var u={Make:function(e){var r={contents:void 0};return{v:r,get:function(e){return r.contents},set:function(e){r.contents=e}}}},c="username",l={contents:{LAZY_DONE:!1,VAL:function(){var e=GM_getValue(c);return null==e?void GM_setValue(c,void 0):i.some(e)}}};var f={v:l,get:function(e){return o.force(l.contents)},set:function(e){l.contents=n.from_val(e),GM_setValue(c,e)}},s="server",d={contents:{LAZY_DONE:!1,VAL:function(){var e=GM_getValue(s);return null==e?void GM_setValue(s,void 0):i.some(e)}}};var v={v:d,get:function(e){return o.force(d.contents)},set:function(e){d.contents=n.from_val(e),GM_setValue(s,e)}},_="sync_answers",m={contents:{LAZY_DONE:!1,VAL:function(){var e=GM_getValue(_);return null==e?(GM_setValue(_,true),true):i.some(e)}}};var h={v:m,get:function(e){return o.force(m.contents)},set:function(e){m.contents=n.from_val(e),GM_setValue(_,e)}},p="nol_eavecheck",g={contents:{LAZY_DONE:!1,VAL:function(){var e=GM_getValue(p);return null==e?(GM_setValue(p,true),true):i.some(e)}}};var y={v:g,get:function(e){return o.force(g.contents)},set:function(e){g.contents=n.from_val(e),GM_setValue(p,e)}},E="sort_problems",b={contents:{LAZY_DONE:!1,VAL:function(){var e=GM_getValue(E);return null==e?(GM_setValue(E,false),false):i.some(e)}}};var w={v:b,get:function(e){return o.force(b.contents)},set:function(e){b.contents=n.from_val(e),GM_setValue(E,e)}},S={contents:void 0};var R={v:S,get:function(e){return S.contents},set:function(e){S.contents=e}},O={contents:void 0};var A={v:O,get:function(e){return O.contents},set:function(e){O.contents=e}}},(e,r,t)=>{t.r(r),t.d(r,{Undefined:()=>u,force_val:()=>c,from_fun:()=>o,from_val:()=>a,is_val:()=>l,lazy_from_fun:()=>f,lazy_from_val:()=>s,lazy_is_val:()=>d});var n=t(22),i=t(61);function o(e){return{LAZY_DONE:!1,VAL:function(){return n._1(e,void 0)}}}function a(e){return{LAZY_DONE:!0,VAL:e}}var u=i.Undefined,c=i.force_val,l=i.is_val,f=o,s=a,d=i.is_val},(e,r,t)=>{t.r(r),t.d(r,{binarySearch:()=>_,diff:()=>l,intersect:()=>c,isSorted:()=>o,stableSort:()=>v,stableSortInPlace:()=>d,strictlySortedLength:()=>i,union:()=>u});var n=t(27);function i(e){var r=e.length;if(0===r||1===r)return r;var t=e[0],n=e[1];if(!(t<n))return t>n?0|-function(e,r,t,n){for(;;){var i=t,o=r;if(i>=n)return i;var a=e[i];if(o<=a)return i;t=i+1|0,r=a}}(e,n,2,r):1;for(var i=n,o=2;;){var a=o,u=i;if(a>=r)return a;var c=e[a];if(u>=c)return a;o=a+1|0,i=c}}function o(e){var r=e.length;if(0===r)return!0;for(var t=0,n=r-1|0;;){var i=t;if(i===n)return!0;if(e[i]>e[i+1|0])return!1;t=i+1|0}}function a(e,r,t,i,o,a,u,c){for(var l=r+t|0,f=o+a|0,s=r,d=e[r],v=o,_=i[o],m=c;;){var h=m,p=_,g=v,y=d,E=s;if(y<=p){u[h]=y;var b=E+1|0;if(b>=l)return n.blitUnsafe(i,g,u,h+1|0,f-g|0);m=h+1|0,d=e[b],s=b}else{u[h]=p;var w=g+1|0;if(w>=f)return n.blitUnsafe(e,E,u,h+1|0,l-E|0);m=h+1|0,_=i[w],v=w}}}function u(e,r,t,i,o,a,u,c){for(var l=r+t|0,f=o+a|0,s=r,d=e[r],v=o,_=i[o],m=c;;){var h=m,p=_,g=v,y=d,E=s;if(y<p){u[h]=y;var b=E+1|0,w=h+1|0;if(b<l){m=w,d=e[b],s=b;continue}return n.blitUnsafe(i,g,u,w,f-g|0),(w+f|0)-g|0}if(y!==p){u[h]=p;var S=g+1|0,R=h+1|0;if(!(S<f))return n.blitUnsafe(e,E,u,R,l-E|0),(R+l|0)-E|0;m=R,_=i[S],v=S}else{u[h]=y;var O=E+1|0,A=g+1|0,M=h+1|0;if(!(O<l&&A<f))return O===l?(n.blitUnsafe(i,A,u,M,f-A|0),(M+f|0)-A|0):(n.blitUnsafe(e,O,u,M,l-O|0),(M+l|0)-O|0);m=M,_=i[A],v=A,d=e[O],s=O}}}function c(e,r,t,n,i,o,a,u){for(var c=r+t|0,l=i+o|0,f=r,s=e[r],d=i,v=n[i],_=u;;){var m=_,h=v,p=d,g=s,y=f;if(g<h){var E=y+1|0;if(E>=c)return m;s=e[E],f=E}else if(g!==h){var b=p+1|0;if(b>=l)return m;v=n[b],d=b}else{a[m]=g;var w=y+1|0,S=p+1|0,R=m+1|0;if(!(w<c&&S<l))return R;_=R,v=n[S],d=S,s=e[w],f=w}}}function l(e,r,t,i,o,a,u,c){for(var l=r+t|0,f=o+a|0,s=r,d=e[r],v=o,_=i[o],m=c;;){var h=m,p=_,g=v,y=d,E=s;if(y<p){u[h]=y;var b=h+1|0,w=E+1|0;if(w>=l)return b;m=b,d=e[w],s=w}else if(y!==p){var S=g+1|0;if(!(S<f))return n.blitUnsafe(e,E,u,h,l-E|0),(h+l|0)-E|0;_=i[S],v=S}else{var R=E+1|0,O=g+1|0;if(!(R<l&&O<f))return R===l?h:(n.blitUnsafe(e,R,u,h,l-R|0),(h+l|0)-R|0);_=i[O],v=O,d=e[R],s=R}}}function f(e,r,t,n,i){for(var o=0;o<i;++o){for(var a=e[r+o|0],u=(n+o|0)-1|0;u>=n&&t[u]>a;)t[u+1|0]=t[u],u=u-1|0;t[u+1|0]=a}}function s(e,r,t,n,i){if(i<=5)return f(e,r,t,n,i);var o=i/2|0,u=i-o|0;return s(e,r+o|0,t,n+o|0,u),s(e,r,e,r+u|0,o),a(e,r+u|0,o,t,n+o|0,u,t,n)}function d(e){var r=e.length;if(r<=5)return f(e,0,e,0,r);var t=r/2|0,n=r-t|0,i=new Array(n);return s(e,t,i,0,n),s(e,0,e,n,t),a(e,n,t,i,0,n,e,0)}function v(e){var r=e.slice(0);return d(r),r}function _(e,r){var t=e.length;if(0===t)return-1;if(r<e[0])return-1;if(r>e[t-1|0])return 0|-(t+1|0);for(var n=0,i=t-1|0;;){var o=i,a=n,u=(a+o|0)/2|0,c=e[u];if(r===c)return u;if(r<c){if(o===u)return e[a]===r?a:0|-(o+1|0);i=u}else{if(a===u)return e[o]===r?o:0|-(o+1|0);n=u}}}},(e,r,t)=>{function n(e){return e.LAZY_DONE}t.r(r),t.d(r,{Undefined:()=>i,force:()=>u,force_val:()=>c,is_val:()=>n});var i=t(49).create("CamlinternalLazy.Undefined");function o(e,r){var t=r();return e.VAL=t,e.LAZY_DONE=!0,t}function a(){throw{RE_EXN_ID:i,Error:new Error}}function u(e){if(e.LAZY_DONE)return e.VAL;var r=e.VAL;e.VAL=a;try{return o(e,r)}catch(r){throw e.VAL=function(){throw r},r}}function c(e){if(e.LAZY_DONE)return e.VAL;var r=e.VAL;return e.VAL=a,o(e,r)}}],r={};function t(n){var i=r[n];if(void 0!==i)return i.exports;var o=r[n]={id:n,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.exports}t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{t.r(n);var e=t(1),r=t(15),i=t(16),o=t(17),a=t(9),u=t(14),c=function(e,r,t,n){return new(t||(t=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(a,u)}c((n=n.apply(e,r||[])).next())}))};function l(e){return!0===u.SORT_PROBLEMS.value&&e.sort(((e,r)=>e.problem_id-r.problem_id)),e.forEach((e=>{if((0,i.isChoice)(e.ProblemType)){const r=e.Options;!0===u.SORT_PROBLEMS.value&&r.sort(((e,r)=>e.key<r.key?-1:1)),r.forEach(((r,t)=>{o.CHOICE_MAP.setWith(e.problem_id,(e=>e.set(r.key,String.fromCharCode(65+t))))}))}})),e}(function(){return c(this,void 0,void 0,(function*(){!0===u.NO_LEAVE_CHECK.value&&(document.addEventListener("visibilitychange",(e=>{e.preventDefault(),e.stopImmediatePropagation()}),!0),window.addEventListener("visibilitychange",(e=>{e.preventDefault(),e.stopImmediatePropagation()}),!0));const t=new e.Client;(0,r.hookXHR)((function(e){switch(e.pathname){case"/exam_room/show_paper":this.addEventListener("readystatechange",(()=>{if(this.readyState==XMLHttpRequest.DONE){const r=JSON.stringify((!0===(e=JSON.parse(this.responseText)).data.has_problem_dict?e.data.problems=e.data.problems.sort(((e,r)=>e.id-r.id)).map((e=>(e.problems=l(e.problems),e))):e.data.problems=l(e.data.problems),(0,a.devLog)(o.CHOICE_MAP),e));Object.defineProperties(this,{responseText:{get:()=>r}})}var e})),this.addEventListener("load",(()=>{const r=JSON.parse(this.responseText);(0,a.devLog)("intercept paper",r);const n=new o.UI(r);t.onmessage((e=>{e.forEach((e=>n.updateAnswer(e))),n.updateUI()})),(()=>c(this,void 0,void 0,(function*(){u.EXAM_ID.value=parseInt(e.searchParams.get("exam_id"));const r=yield fetch((0,a.newURL)("/exam_room/cache_results",{exam_id:u.EXAM_ID.value.toString()}).toString()).then((e=>e.json()));t.answerProblem(r.data.results)})))().catch(a.devLog)}));break;case"/exam_room/answer_problem":return e=>c(this,void 0,void 0,(function*(){var r;if("string"==typeof e){const n=JSON.parse(e);if("action"in n)switch(n.action){case 1:case 17:break;default:return console.log("intercept action",n),new Promise((()=>{}))}else"results"in n&&((0,a.devLog)("intercept answers",n),t.answerProblem(null!==(r=n.results)&&void 0!==r?r:[]).catch(a.devLog))}return e}));default:if("upload-z1.qiniup.com"===e.hostname)return e=>c(this,void 0,void 0,(function*(){return e instanceof FormData&&e.get("file")instanceof File?new Promise((r=>{const t=new FileReader;t.onload=()=>(0,o.showConfirmUpload)(t.result,(()=>r(e))),t.readAsDataURL(e.get("file"))})):e}))}})),yield t.watch(1e4)}))})().catch(console.error)})()})();