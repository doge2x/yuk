// ==UserScript==
// @name         yuk-client
// @version      0.6.0
// @author       doge2x
// @icon         https://www.yuketang.cn/static/images/favicon.ico
// @match        https://examination.xuetangx.com/*
// @grant        GM.xmlHttpRequest
// @grant        GM_getValue
// @grant        GM_setValue
// @run-at       document-start
// ==/UserScript==

(()=>{"use strict";var e=[,(e,r,t)=>{t.r(r),t.d(r,{CLIENT:()=>u});var n=t(2),i=t(8),o=t(9),a=function(e,r,t,n){return new(t||(t=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(a,u)}c((n=n.apply(e,r||[])).next())}))};const u=new class{constructor(){this.queue=new Map,this.onmsg=[]}onmessage(e){this.onmsg.push(e)}updateQueue(e,r){let t=this.queue.get(e);void 0!==t?r(t):(t={},r(t),this.queue.set(e,t))}updateAnswer(e,r){this.updateQueue(e,(e=>e.result=r))}updateState(e,r){this.updateQueue(e,(e=>{var t;e.context=null!==(t=e.context)&&void 0!==t?t:{},e.context.state=r}))}updateMsg(e,r){this.updateQueue(e,(e=>{var t;e.context=null!==(t=e.context)&&void 0!==t?t:{},e.context.msg=r}))}watch(e){return a(this,void 0,void 0,(function*(){return new Promise(((r,t)=>{const n=setInterval((()=>{this.sendQueue().catch((e=>{clearInterval(n),alert("与服务器通信异常"),t(e)}))}),e)}))}))}login(e,r){return a(this,void 0,void 0,(function*(){this.examId=e,this.paper=r}))}sendQueue(){return a(this,void 0,void 0,(function*(){if(!0!==o.SYNC_ANSWERS.value||this.queue.size<1||void 0===o.SERVER.value||void 0===o.USERNAME.value||void 0===this.examId||void 0===this.paper)return;let e=[...this.queue.entries()];if(this.queue.clear(),void 0===this.client){const e=o.SERVER.value,r=new n.JSONRPCClient((t=>new Promise(((n,i)=>{GM.xmlHttpRequest({url:e,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(t),onload:e=>{200===e.status?(r.receive(JSON.parse(e.responseText)),n()):i(new Error(e.statusText))},onerror:e=>i(e.statusText)})}))));this.client=r}if(void 0===this.token){(0,i.devLog)(`login to server: ${o.USERNAME.value}, ${this.examId}`);const e=yield this.client.request("login",[o.USERNAME.value,this.examId,this.paper]);(0,i.devLog)("got token",e),this.token=e}(0,i.devLog)("send answers",e);const r=yield this.client.request("answer_problem",[this.token,e.map((([e,{result:r,context:t}])=>({problem_id:e,result:r,context:t})))]);(0,i.devLog)("receive answers",r),this.onmsg.forEach((e=>e(r)))}))}}},function(e,r,t){var n=this&&this.__createBinding||(Object.create?function(e,r,t,n){void 0===n&&(n=t),Object.defineProperty(e,n,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]}),i=this&&this.__exportStar||function(e,r){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(r,t)||n(r,e,t)};Object.defineProperty(r,"__esModule",{value:!0}),i(t(3),r),i(t(4),r),i(t(6),r),i(t(7),r)},function(e,r,t){var n=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(a,u)}c((n=n.apply(e,r||[])).next())}))},i=this&&this.__generator||function(e,r){var t,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=r.call(e,a)}catch(e){o=[6,e],n=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.JSONRPCClient=void 0;var o=t(4),a=t(5),u=function(){function e(e,r){this._send=e,this.createID=r,this.idToResolveMap=new Map,this.id=0}return e.prototype._createID=function(){return this.createID?this.createID():++this.id},e.prototype.timeout=function(e,r){var t=this;void 0===r&&(r=function(e){return(0,o.createJSONRPCErrorResponse)(e,a.DefaultErrorCode,"Request timeout")});var n=function(n,i){var o=setTimeout((function(){n.forEach((function(e){var n=t.idToResolveMap.get(e);n&&(t.idToResolveMap.delete(e),n(r(e)))}))}),e);return i().then((function(e){return clearTimeout(o),e}),(function(e){return clearTimeout(o),Promise.reject(e)}))};return{request:function(e,r,i){var o=t._createID();return n([o],(function(){return t.requestWithID(e,r,i,o)}))},requestAdvanced:function(e,r){return function(e,r){var i=(Array.isArray(e)?e:[e]).map((function(e){return e.id})).filter(c);return n(i,(function(){return t.requestAdvanced(e,r)}))}(e,r)}}},e.prototype.request=function(e,r,t){return this.requestWithID(e,r,t,this._createID())},e.prototype.requestWithID=function(e,r,t,a){return n(this,void 0,void 0,(function(){var n,u;return i(this,(function(i){switch(i.label){case 0:return n={jsonrpc:o.JSONRPC,method:e,params:r,id:a},[4,this.requestAdvanced(n,t)];case 1:return void 0===(u=i.sent()).result||u.error?void 0===u.result&&u.error?[2,Promise.reject(new Error(u.error.message))]:[2,Promise.reject(new Error("An unexpected error occurred"))]:[2,u.result]}}))}))},e.prototype.requestAdvanced=function(e,r){var t=this,n=Array.isArray(e);Array.isArray(e)||(e=[e]);var i=e.filter((function(e){return c(e.id)})),u=i.map((function(e){return new Promise((function(r){return t.idToResolveMap.set(e.id,r)}))})),l=Promise.all(u).then((function(e){return n||!e.length?e:e[0]}));return this.send(n?e:e[0],r).then((function(){return l}),(function(e){return i.forEach((function(r){t.receive((0,o.createJSONRPCErrorResponse)(r.id,a.DefaultErrorCode,e&&e.message||"Failed to send a request"))})),l}))},e.prototype.notify=function(e,r,t){this.send({jsonrpc:o.JSONRPC,method:e,params:r},t).then(void 0,(function(){}))},e.prototype.send=function(e,r){return this._send(e,r)},e.prototype.rejectAllPendingRequests=function(e){this.idToResolveMap.forEach((function(r,t){return r((0,o.createJSONRPCErrorResponse)(t,a.DefaultErrorCode,e))})),this.idToResolveMap.clear()},e.prototype.receive=function(e){var r=this;Array.isArray(e)||(e=[e]),e.forEach((function(e){var t=r.idToResolveMap.get(e.id);t&&(r.idToResolveMap.delete(e.id),t(e))}))},e}();r.JSONRPCClient=u;var c=function(e){return null!=e}},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createJSONRPCErrorResponse=r.JSONRPCErrorCode=r.isJSONRPCResponses=r.isJSONRPCResponse=r.isJSONRPCRequests=r.isJSONRPCRequest=r.isJSONRPCID=r.JSONRPC=void 0,r.JSONRPC="2.0";r.isJSONRPCID=function(e){return"string"==typeof e||"number"==typeof e||null===e};r.isJSONRPCRequest=function(e){return e.jsonrpc===r.JSONRPC&&void 0!==e.method&&void 0===e.result&&void 0===e.error};r.isJSONRPCRequests=function(e){return Array.isArray(e)&&e.every(r.isJSONRPCRequest)};r.isJSONRPCResponse=function(e){return e.jsonrpc===r.JSONRPC&&void 0!==e.id&&(void 0!==e.result||void 0!==e.error)};r.isJSONRPCResponses=function(e){return Array.isArray(e)&&e.every(r.isJSONRPCResponse)},function(e){e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError"}(r.JSONRPCErrorCode||(r.JSONRPCErrorCode={}));r.createJSONRPCErrorResponse=function(e,t,n,i){var o={code:t,message:n};return i&&(o.data=i),{jsonrpc:r.JSONRPC,id:e,error:o}}},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultErrorCode=void 0,r.DefaultErrorCode=0},function(e,r,t){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(a,u)}c((n=n.apply(e,r||[])).next())}))},o=this&&this.__generator||function(e,r){var t,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=r.call(e,a)}catch(e){o=[6,e],n=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},a=this&&this.__spreadArray||function(e,r,t){if(t||2===arguments.length)for(var n,i=0,o=r.length;i<o;i++)!n&&i in r||(n||(n=Array.prototype.slice.call(r,0,i)),n[i]=r[i]);return e.concat(n||Array.prototype.slice.call(r))};Object.defineProperty(r,"__esModule",{value:!0}),r.JSONRPCServer=void 0;var u=t(4),c=t(5),l=function(e){return(0,u.createJSONRPCErrorResponse)((0,u.isJSONRPCID)(e.id)?e.id:null,u.JSONRPCErrorCode.InvalidRequest,"Invalid Request")},s=function(){function e(e){var r;void 0===e&&(e={}),this.mapErrorToJSONRPCErrorResponse=m,this.nameToMethodDictionary={},this.middleware=null,this.errorListener=null!==(r=e.errorListener)&&void 0!==r?r:console.warn}return e.prototype.addMethod=function(e,r){this.addMethodAdvanced(e,this.toJSONRPCMethod(r))},e.prototype.toJSONRPCMethod=function(e){return function(r,t){var n=e(r.params,t);return Promise.resolve(n).then((function(e){return v(r.id,e)}))}},e.prototype.addMethodAdvanced=function(e,r){var t;this.nameToMethodDictionary=n(n({},this.nameToMethodDictionary),((t={})[e]=r,t))},e.prototype.receiveJSON=function(e,r){var t=this.tryParseRequestJSON(e);return t?this.receive(t,r):Promise.resolve((0,u.createJSONRPCErrorResponse)(null,u.JSONRPCErrorCode.ParseError,"Parse error"))},e.prototype.tryParseRequestJSON=function(e){try{return JSON.parse(e)}catch(e){return null}},e.prototype.receive=function(e,r){return Array.isArray(e)?this.receiveMultiple(e,r):this.receiveSingle(e,r)},e.prototype.receiveMultiple=function(e,r){return i(this,void 0,void 0,(function(){var t,n=this;return o(this,(function(i){switch(i.label){case 0:return[4,Promise.all(e.map((function(e){return n.receiveSingle(e,r)})))];case 1:return 1===(t=i.sent().filter(f)).length?[2,t[0]]:t.length?[2,t]:[2,null]}}))}))},e.prototype.receiveSingle=function(e,r){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(i){switch(i.label){case 0:return t=this.nameToMethodDictionary[e.method],(0,u.isJSONRPCRequest)(e)?[3,1]:[2,l(e)];case 1:return t?[4,this.callMethod(t,e,r)]:[3,3];case 2:return n=i.sent(),[2,p(e,n)];case 3:return void 0!==e.id?[2,(o=e.id,(0,u.createJSONRPCErrorResponse)(o,u.JSONRPCErrorCode.MethodNotFound,"Method not found"))]:[2,null];case 4:return[2]}var o}))}))},e.prototype.applyMiddleware=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.middleware?this.middleware=this.combineMiddlewares(a([this.middleware],e,!0)):this.middleware=this.combineMiddlewares(e)},e.prototype.combineMiddlewares=function(e){return e.length?e.reduce(this.middlewareReducer):null},e.prototype.middlewareReducer=function(e,r){return function(t,n,i){return e((function(e,n){return r(t,e,n)}),n,i)}},e.prototype.callMethod=function(e,r,t){var n=this,i=function(e){return n.errorListener('An unexpected error occurred while executing "'.concat(r.method,'" JSON-RPC method:'),e),Promise.resolve(n.mapErrorToJSONRPCErrorResponseIfNecessary(r.id,e))};try{return(this.middleware||d)((function(r,t){return e(r,t)}),r,t).then(void 0,i)}catch(e){return i(e)}},e.prototype.mapErrorToJSONRPCErrorResponseIfNecessary=function(e,r){return void 0!==e?this.mapErrorToJSONRPCErrorResponse(e,r):null},e}();r.JSONRPCServer=s;var f=function(e){return null!==e},d=function(e,r,t){return e(r,t)},v=function(e,r){return void 0!==e?{jsonrpc:u.JSONRPC,id:e,result:void 0===r?null:r}:null},m=function(e,r){return(0,u.createJSONRPCErrorResponse)(e,c.DefaultErrorCode,r&&r.message||"An unexpected error occurred")},p=function(e,r){return r||(void 0!==e.id?(0,u.createJSONRPCErrorResponse)(e.id,u.JSONRPCErrorCode.InternalError,"Internal error"):null)}},function(e,r,t){var n=this&&this.__awaiter||function(e,r,t,n){return new(t||(t=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(a,u)}c((n=n.apply(e,r||[])).next())}))},i=this&&this.__generator||function(e,r){var t,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=r.call(e,a)}catch(e){o=[6,e],n=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.JSONRPCServerAndClient=void 0;var o=t(4),a=function(){function e(e,r,t){var n;void 0===t&&(t={}),this.server=e,this.client=r,this.errorListener=null!==(n=t.errorListener)&&void 0!==n?n:console.warn}return e.prototype.applyServerMiddleware=function(){for(var e,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];(e=this.server).applyMiddleware.apply(e,r)},e.prototype.addMethod=function(e,r){this.server.addMethod(e,r)},e.prototype.addMethodAdvanced=function(e,r){this.server.addMethodAdvanced(e,r)},e.prototype.timeout=function(e){return this.client.timeout(e)},e.prototype.request=function(e,r,t){return this.client.request(e,r,t)},e.prototype.requestAdvanced=function(e,r){return this.client.requestAdvanced(e,r)},e.prototype.notify=function(e,r,t){this.client.notify(e,r,t)},e.prototype.rejectAllPendingRequests=function(e){this.client.rejectAllPendingRequests(e)},e.prototype.receiveAndSend=function(e,r,t){return n(this,void 0,void 0,(function(){var n,a;return i(this,(function(i){switch(i.label){case 0:return(0,o.isJSONRPCResponse)(e)||(0,o.isJSONRPCResponses)(e)?(this.client.receive(e),[3,4]):[3,1];case 1:return(0,o.isJSONRPCRequest)(e)||(0,o.isJSONRPCRequests)(e)?[4,this.server.receive(e,r)]:[3,3];case 2:return(n=i.sent())?[2,this.client.send(n,t)]:[3,4];case 3:return a="Received an invalid JSON-RPC message",this.errorListener(a,e),[2,Promise.reject(new Error(a))];case 4:return[2]}}))}))},e}();r.JSONRPCServerAndClient=a},(e,r,t)=>{function n(e,...r){0}function i(e,r){const t=new URL(e,self.location.origin);for(const[e,n]of Object.entries(null!=r?r:{}))t.searchParams.set(e,n);return t}t.r(r),t.d(r,{devLog:()=>n,newURL:()=>i})},(e,r,t)=>{t.r(r),t.d(r,{NO_LEAVE_CHECK:()=>l,SERVER:()=>a,SORT_PROBLEMS:()=>c,SYNC_ANSWERS:()=>u,USERNAME:()=>o});var n=t(10);class i{constructor(e){this._value=e}get value(){return this._value.get()}}const o=new i(n.Username),a=new i(n.Server),u=new i(n.SyncAnswers),c=new i(n.SortProblems),l=new i(n.NoLeaveCheck)},(e,r,t)=>{t.r(r),t.d(r,{GM:()=>u,GMEntry:()=>c,NoLeaveCheck:()=>b,Option2:()=>l,Server:()=>p,SortProblems:()=>M,SyncAnswers:()=>g,Username:()=>d});var n=t(11),i=t(12),o=t(17),a=t(15);var u={getValue:function(e){return o.nullable_to_opt(n.getValue(e))},setValue:function(e,r){n.setValue(e,r)}};var c={Make:function(e){var r={contents:{LAZY_DONE:!1,VAL:function(){var r=n.getValue(e.name);return null==r?(n.setValue(e.name,e.init),e.init):o.some(r)}}};return{v:r,get:function(e){return a.force(r.contents)},set:function(t){var a=o.some(t);r.contents=i.from_val(a),n.setValue(e.name,a)}}}};var l={Make:function(e){var r={contents:void 0};return{v:r,get:function(e){return r.contents},set:function(e){r.contents=o.some(e)}}}},s="username",f={contents:{LAZY_DONE:!1,VAL:function(){var e=n.getValue(s);return null==e?void n.setValue(s,void 0):o.some(e)}}};var d={v:f,get:function(e){return a.force(f.contents)},set:function(e){var r=o.some(e);f.contents=i.from_val(r),n.setValue(s,r)}},v="server",m={contents:{LAZY_DONE:!1,VAL:function(){var e=n.getValue(v);return null==e?void n.setValue(v,void 0):o.some(e)}}};var p={v:m,get:function(e){return a.force(m.contents)},set:function(e){var r=o.some(e);m.contents=i.from_val(r),n.setValue(v,r)}},h="sync_answers",_={contents:{LAZY_DONE:!1,VAL:function(){var e=n.getValue(h);return null==e?(n.setValue(h,true),true):o.some(e)}}};var g={v:_,get:function(e){return a.force(_.contents)},set:function(e){var r=o.some(e);_.contents=i.from_val(r),n.setValue(h,r)}},E="no_leave_check",y={contents:{LAZY_DONE:!1,VAL:function(){var e=n.getValue(E);return null==e?(n.setValue(E,true),true):o.some(e)}}};var b={v:y,get:function(e){return a.force(y.contents)},set:function(e){var r=o.some(e);y.contents=i.from_val(r),n.setValue(E,r)}},w="sort_problems",O={contents:{LAZY_DONE:!1,VAL:function(){var e=n.getValue(w);return null==e?(n.setValue(w,false),false):o.some(e)}}};var M={v:O,get:function(e){return a.force(O.contents)},set:function(e){var r=o.some(e);O.contents=i.from_val(r),n.setValue(w,r)}}},(e,r,t)=>{t.r(r),t.d(r,{getValue:()=>i,migrate:()=>a,setValue:()=>o});var n=t(8);function i(e){const r=GM_getValue(e);if(void 0!==r)return r.contents}function o(e,r){GM_setValue(e,{contents:r})}function a(){var e;const r=[{name:"202205231915_gm_value",up(){o("no_leave_check",GM_getValue("nol_eavecheck")),GM_setValue("nol_eavecheck",void 0);for(const e of["username","server","sync_answers","sort_problems"])o(e,GM_getValue(e))}}],t=null!==(e=i("migrations"))&&void 0!==e?e:[];for(const{name:e,idx:n}of t)if(e!==r[n].name)throw new Error("bad migrations");for(const{name:e,up:i}of r.slice(t.length))(0,n.devLog)(`apply migration: ${e}`),i();o("migrations",r.map(((e,r)=>({name:e.name,idx:r}))))}},(e,r,t)=>{t.r(r),t.d(r,{Undefined:()=>u,force_val:()=>c,from_fun:()=>o,from_val:()=>a,is_val:()=>l,lazy_from_fun:()=>s,lazy_from_val:()=>f,lazy_is_val:()=>d});var n=t(13),i=t(15);function o(e){return{LAZY_DONE:!1,VAL:function(){return n._1(e,void 0)}}}function a(e){return{LAZY_DONE:!0,VAL:e}}var u=i.Undefined,c=i.force_val,l=i.is_val,s=o,f=a,d=i.is_val},(e,r,t)=>{t.r(r),t.d(r,{_1:()=>o,_2:()=>u,_3:()=>l,_4:()=>f,_5:()=>v,_6:()=>p,_7:()=>_,_8:()=>E,__1:()=>a,__2:()=>c,__3:()=>s,__4:()=>d,__5:()=>m,__6:()=>h,__7:()=>g,__8:()=>y,app:()=>i});var n=t(14);function i(e,r){for(;;){var t=r,o=e,a=o.length,u=0===a?1:a,c=u-t.length|0;if(0===c)return o.apply(null,t);if(c>=0)return function(e,r){return function(t){return i(e,r.concat([t]))}}(o,t);r=n.sub(t,u,0|-c),e=o.apply(null,n.sub(t,0,u))}}function o(e,r){var t=e.length;if(1===t)return e(r);switch(t){case 1:return e(r);case 2:return function(t){return e(r,t)};case 3:return function(t,n){return e(r,t,n)};case 4:return function(t,n,i){return e(r,t,n,i)};case 5:return function(t,n,i,o){return e(r,t,n,i,o)};case 6:return function(t,n,i,o,a){return e(r,t,n,i,o,a)};case 7:return function(t,n,i,o,a,u){return e(r,t,n,i,o,a,u)};default:return i(e,[r])}}function a(e){return 1===e.length?e:function(r){return o(e,r)}}function u(e,r,t){var n=e.length;if(2===n)return e(r,t);switch(n){case 1:return i(e(r),[t]);case 2:return e(r,t);case 3:return function(n){return e(r,t,n)};case 4:return function(n,i){return e(r,t,n,i)};case 5:return function(n,i,o){return e(r,t,n,i,o)};case 6:return function(n,i,o,a){return e(r,t,n,i,o,a)};case 7:return function(n,i,o,a,u){return e(r,t,n,i,o,a,u)};default:return i(e,[r,t])}}function c(e){return 2===e.length?e:function(r,t){return u(e,r,t)}}function l(e,r,t,n){var o=e.length;if(3===o)return e(r,t,n);switch(o){case 1:return i(e(r),[t,n]);case 2:return i(e(r,t),[n]);case 3:return e(r,t,n);case 4:return function(i){return e(r,t,n,i)};case 5:return function(i,o){return e(r,t,n,i,o)};case 6:return function(i,o,a){return e(r,t,n,i,o,a)};case 7:return function(i,o,a,u){return e(r,t,n,i,o,a,u)};default:return i(e,[r,t,n])}}function s(e){return 3===e.length?e:function(r,t,n){return l(e,r,t,n)}}function f(e,r,t,n,o){var a=e.length;if(4===a)return e(r,t,n,o);switch(a){case 1:return i(e(r),[t,n,o]);case 2:return i(e(r,t),[n,o]);case 3:return i(e(r,t,n),[o]);case 4:return e(r,t,n,o);case 5:return function(i){return e(r,t,n,o,i)};case 6:return function(i,a){return e(r,t,n,o,i,a)};case 7:return function(i,a,u){return e(r,t,n,o,i,a,u)};default:return i(e,[r,t,n,o])}}function d(e){return 4===e.length?e:function(r,t,n,i){return f(e,r,t,n,i)}}function v(e,r,t,n,o,a){var u=e.length;if(5===u)return e(r,t,n,o,a);switch(u){case 1:return i(e(r),[t,n,o,a]);case 2:return i(e(r,t),[n,o,a]);case 3:return i(e(r,t,n),[o,a]);case 4:return i(e(r,t,n,o),[a]);case 5:return e(r,t,n,o,a);case 6:return function(i){return e(r,t,n,o,a,i)};case 7:return function(i,u){return e(r,t,n,o,a,i,u)};default:return i(e,[r,t,n,o,a])}}function m(e){return 5===e.length?e:function(r,t,n,i,o){return v(e,r,t,n,i,o)}}function p(e,r,t,n,o,a,u){var c=e.length;if(6===c)return e(r,t,n,o,a,u);switch(c){case 1:return i(e(r),[t,n,o,a,u]);case 2:return i(e(r,t),[n,o,a,u]);case 3:return i(e(r,t,n),[o,a,u]);case 4:return i(e(r,t,n,o),[a,u]);case 5:return i(e(r,t,n,o,a),[u]);case 6:return e(r,t,n,o,a,u);case 7:return function(i){return e(r,t,n,o,a,u,i)};default:return i(e,[r,t,n,o,a,u])}}function h(e){return 6===e.length?e:function(r,t,n,i,o,a){return p(e,r,t,n,i,o,a)}}function _(e,r,t,n,o,a,u,c){var l=e.length;if(7===l)return e(r,t,n,o,a,u,c);switch(l){case 1:return i(e(r),[t,n,o,a,u,c]);case 2:return i(e(r,t),[n,o,a,u,c]);case 3:return i(e(r,t,n),[o,a,u,c]);case 4:return i(e(r,t,n,o),[a,u,c]);case 5:return i(e(r,t,n,o,a),[u,c]);case 6:return i(e(r,t,n,o,a,u),[c]);case 7:return e(r,t,n,o,a,u,c);default:return i(e,[r,t,n,o,a,u,c])}}function g(e){return 7===e.length?e:function(r,t,n,i,o,a,u){return _(e,r,t,n,i,o,a,u)}}function E(e,r,t,n,o,a,u,c,l){var s=e.length;if(8===s)return e(r,t,n,o,a,u,c,l);switch(s){case 1:return i(e(r),[t,n,o,a,u,c,l]);case 2:return i(e(r,t),[n,o,a,u,c,l]);case 3:return i(e(r,t,n),[o,a,u,c,l]);case 4:return i(e(r,t,n,o),[a,u,c,l]);case 5:return i(e(r,t,n,o,a),[u,c,l]);case 6:return i(e(r,t,n,o,a,u),[c,l]);case 7:return i(e(r,t,n,o,a,u,c),[l]);default:return i(e,[r,t,n,o,a,u,c,l])}}function y(e){return 8===e.length?e:function(r,t,n,i,o,a,u,c){return E(e,r,t,n,i,o,a,u,c)}}},(e,r,t)=>{function n(e,r,t){for(var n=new Array(t),i=0,o=r;i<t;)n[i]=e[o],i=i+1|0,o=o+1|0;return n}function i(e){var r=function(e,r){for(;;){var t=r,n=e;if(!t)return n;r=t.tl,e=t.hd.length+n|0}}(0,e),t=new Array(r);return function(e,r,t){for(;;){var n=t,i=r;if(!n)return;for(var o=n.hd,a=o.length,u=i,c=0;c<a;)e[u]=o[c],u=u+1|0,c=c+1|0;t=n.tl,r=u}}(t,0,e),t}function o(e,r,t){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};e[r]=t}function a(e,r){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return e[r]}function u(e,r){for(var t=new Array(e),n=0;n<e;++n)t[n]=r;return t}function c(e){for(var r=new Array(e),t=0;t<e;++t)r[t]=0;return r}function l(e,r,t,n,i){if(n<=r)for(var o=0;o<i;++o)t[o+n|0]=e[o+r|0];else for(var a=i-1|0;a>=0;--a)t[a+n|0]=e[a+r|0]}function s(e){return e.slice(0)}t.r(r),t.d(r,{blit:()=>l,concat:()=>i,dup:()=>s,get:()=>a,make:()=>u,make_float:()=>c,set:()=>o,sub:()=>n})},(e,r,t)=>{function n(e){return e.LAZY_DONE}t.r(r),t.d(r,{Undefined:()=>i,force:()=>u,force_val:()=>c,is_val:()=>n});var i=t(16).create("CamlinternalLazy.Undefined");function o(e,r){var t=r();return e.VAL=t,e.LAZY_DONE=!0,t}function a(){throw{RE_EXN_ID:i,Error:new Error}}function u(e){if(e.LAZY_DONE)return e.VAL;var r=e.VAL;e.VAL=a;try{return o(e,r)}catch(r){throw e.VAL=function(){throw r},r}}function c(e){if(e.LAZY_DONE)return e.VAL;var r=e.VAL;return e.VAL=a,o(e,r)}},(e,r,t)=>{t.r(r),t.d(r,{caml_exn_slot_name:()=>a,caml_is_extension:()=>o,create:()=>i,id:()=>n});var n={contents:0};function i(e){return n.contents=n.contents+1|0,e+"/"+n.contents}function o(e){return null!=e&&"string"==typeof e.RE_EXN_ID}function a(e){return e.RE_EXN_ID}},(e,r,t)=>{function n(e){return void 0!==e.BS_PRIVATE_NESTED_SOME_NONE}function i(e){return void 0===e?{BS_PRIVATE_NESTED_SOME_NONE:0}:null!==e&&void 0!==e.BS_PRIVATE_NESTED_SOME_NONE?{BS_PRIVATE_NESTED_SOME_NONE:e.BS_PRIVATE_NESTED_SOME_NONE+1|0}:e}function o(e){return null==e?void 0:i(e)}function a(e){return void 0===e?void 0:i(e)}function u(e){return null===e?void 0:i(e)}function c(e){if(null===e||void 0===e.BS_PRIVATE_NESTED_SOME_NONE)return e;var r=e.BS_PRIVATE_NESTED_SOME_NONE;return 0===r?void 0:{BS_PRIVATE_NESTED_SOME_NONE:r-1|0}}function l(e){return void 0===e?void 0:c(e)}function s(e){return void 0!==e?e.VAL:e}t.r(r),t.d(r,{isNested:()=>n,null_to_opt:()=>u,nullable_to_opt:()=>o,option_get:()=>l,option_unwrap:()=>s,some:()=>i,undefined_to_opt:()=>a,valFromOption:()=>c})},(e,r,t)=>{t.r(r),t.d(r,{hookXHR:()=>i});var n=t(8);function i(e){const r=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(t,i){const o=e.call(this,(0,n.newURL)(i)),a=this.send;this.send=function(e){void 0!==o?o(e).then((e=>{a.call(this,e),this.send=a})).catch(n.devLog):(a.call(this,e),this.send=a)},r.apply(this,arguments)}}},(e,r,t)=>{var n;t.r(r),t.d(r,{ProblemType:()=>n}),function(e){e[e.SingleChoice=1]="SingleChoice",e[e.MultipleChoice=2]="MultipleChoice",e[e.Polling=3]="Polling",e[e.FillBlank=4]="FillBlank",e[e.ShortAnswer=5]="ShortAnswer",e[e.Judgement=6]="Judgement"}(n||(n={}))},(e,r,t)=>{t.r(r),t.d(r,{UI:()=>i,showConfirmUpload:()=>o});var n=t(21);class i{constructor(e){this.inner=n.UI.make(e)}updateAnswer({username:e,problem_id:r,result:t,context:i}){n.UI.updateAnswer(this.inner,r,e,{answer:t,context:i})}updateUI(){n.UI.updateUI(this.inner)}}function o(e,r){n.showConfirmUpload(e,r)}},(e,r,t)=>{t.r(r),t.d(r,{Problem:()=>w,React:()=>{},ReactDOMRe:()=>{},UI:()=>M,showConfirmUpload:()=>y,style:()=>E,styleCss:()=>g});var n=t(13),i=t(22),o=t(25),a=t(45),u=t(58),c=t(59),l=t(26),s=t(60),f=t(30),d=t(17),v=t(54),m=t(31),p=t(34),h=t(43),_=t(62),g=m.default,E=m;function y(e,r){var t=o.openWin("上传图片",200,300,void 0,void 0,void 0),a=t[0];t[1].appendChild(f.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:o.joinStrings([E.mainBody,E.uploadImg]," ")},[i.DOMRe.createDOMElementVariadic("div",{className:E.uploadImgConfirm},[i.DOMRe.createDOMElementVariadic("button",{className:E.clickable,onClick:function(e){n._1(r,void 0),a.close()}},["确认上传"]),i.DOMRe.createDOMElementVariadic("span",void 0,[i.DOMRe.createDOMElementVariadic("i",void 0,["*关闭窗口以取消上传"])])]),i.DOMRe.createDOMElementVariadic("div",{className:E.uploadImgImage},[i.DOMRe.createDOMElementVariadic("img",{src:e},[])])]))))}function b(e){if(e<=6&&1<=e)return e-1|0}var w={probelmTypeToJs:function(e){return e+1|0},probelmTypeFromJs:b};function O(e,r){return{updateUI:function(t){return n._1(e.updateUI,r)},updateAnswer:function(t,i){return n._3(e.updateAnswer,r,t,{context:i.context,answer:f.map(i.answer,(function(e){return e}))})}}}var M={unsafeConvertUpdateDetail:O,make:function(e){var r=f.getExn(f.flatMap(h.asHtmlDocument(document),(function(e){return f.map(d.nullable_to_opt(e.body),(function(r){return[e.head,r]}))}))),t=r[1];r[0].appendChild(f.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("style",void 0,[g.toString()]))));var n=f.getExn(f.flatMap(d.nullable_to_opt(t.querySelector(".header-title")),_.ofElement));n.classList.add(E.clickable),n.addEventListener("click",(function(e){return c.showSettings(void 0)}));var o=l.map(Array.prototype.slice.call(t.querySelectorAll(".exam-main--body .subject-item")),(function(e){return f.getExn(p.ofNode(e))}));return o.length!==e.length&&u.raiseError("wrong number of subject items"),{details:l.reduce(l.zip(e,o),void 0,(function(e,r){var t,n=r[1],i=r[0],o=f.getExn(b(i.ProblemType)),u=0;if(o>=3)switch(o){case 3:t=O({updateUI:a.Blank.updateUI,updateAnswer:a.Blank.updateAnswer},a.Blank.make(i.ProblemID,n,void 0));break;case 4:t=O({updateUI:a.ShortAnswer.updateUI,updateAnswer:a.ShortAnswer.updateAnswer},a.ShortAnswer.make(i.ProblemID,n,void 0));break;case 5:u=1}else u=1;if(1===u){var c=v.fromArray(l.mapWithIndex(f.getExn(i.Options),(function(e,r){return[r.key,String.fromCharCode(65+e|0)]})));t=O({updateUI:a.Choice.updateUI,updateAnswer:a.Choice.updateAnswer},a.Choice.make(i.ProblemID,n,(function(e){return v.getExn(c,e)})))}return s.set(e,i.ProblemID,t)}))}},updateAnswer:function(e,r,t,i){return f.forEach(s.get(e.details,r),(function(e){return n._2(e.updateAnswer,t,i)}))},updateUI:function(e){return s.forEach(e.details,(function(e,r){return n._1(r.updateUI,void 0)}))}}},(e,r,t)=>{t.r(r),t.d(r,{Children:()=>u,DOMRe:()=>s,Props:()=>{},createElement:()=>l,createElementVariadic:()=>c,toNode:()=>a});var n=t(23),i=t(17),o=t(24);function a(e){return i.nullable_to_opt(n.toNode(e))}var u={toArray:function(e){return n.Children.toArray(e)}};function c(e,r,t){return o.spliceApply(n.createElement,[e,r,t])}function l(e,r){return n.createElement(e,r)}var s={createDOMElementVariadic:function(e,r,t){return o.spliceApply(n.createElement,[e,void 0!==r?i.valFromOption(r):void 0,t])},createElement:function(e,r,t){return o.spliceApply(n.createElement,[e,void 0!==r?i.valFromOption(r):void 0,t])}}},(e,r,t)=>{function n(e){return Array.isArray(e)?(new Array).concat(...e.map(n)):e instanceof Node?[e]:null==e?[]:[document.createTextNode(String(e))]}function i(e,r){for(const t of r)e.appendChild(t)}function o(e,r){for(const[t,n]of Object.entries(r))t.startsWith("-")?e.style.setProperty(t,n):e.style[t]=n}function a(e,r,...t){r=null!=r?r:{};let a=n(t).concat(n(r.children));if("function"==typeof e)return e(Object.assign(Object.assign({},r),{children:a}));{const t=document.createElement(e);return i(t,a),function(e,r){for(const[t,n]of Object.entries(r))if(void 0!==n)switch(t){case"class":case"className":e.setAttribute("class",n);break;case"style":o(e,n);break;case"dangerouslySetInnerHTML":e.innerHTML=n.__html;break;default:t.startsWith("on")?e.addEventListener(t.slice(2).toLowerCase(),n):t in e?e[t]=n:e.setAttribute(t,n)}}(t,null!=r?r:{}),t}}function u(e){let r=document.createDocumentFragment();return i(r,n(e.children)),r}function c(e){return e instanceof Node?e:null}t.r(r),t.d(r,{Children:()=>l,Fragment:()=>u,createElement:()=>a,default:()=>s,toNode:()=>c});const l={toArray:n},s={createElement:a,Fragment:u}},(e,r,t)=>{t.r(r),t.d(r,{spliceApply:()=>n,spliceObjApply:()=>i});var n=function(e,r){var t,n;n=r.length;var i=[];for(t=0;t<n-1;++t)i.push(r[t]);var o=r[n-1];for(t=0;t<o.length;++t)i.push(o[t]);return e.apply(null,i)},i=function(e,r,t){var n,i;i=t.length;var o=[];for(n=0;n<i-1;++n)o.push(t[n]);var a=t[i-1];for(n=0;n<a.length;++n)o.push(a[n]);return e[r].apply(e,o)}},(e,r,t)=>{t.r(r),t.d(r,{React:()=>{},ReactDOMRe:()=>{},UList:()=>v,joinStrings:()=>f,openWin:()=>m,querySelectorAllElements:()=>d,styleCss:()=>s});var n=t(22),i=t(26),o=t(30),a=t(17),u=t(31),c=t(34),l=t(43),s=u.default;function f(e,r){return i.joinWith(e,r,(function(e){return e}))}function d(e,r){return i.keepMap(Array.prototype.slice.call(e.querySelectorAll(r)),c.ofNode)}var v={make:function(e){var r=e.children;return n.DOMRe.createDOMElementVariadic("ul",void 0,[n.Children.toArray(r).map((function(e){return n.DOMRe.createDOMElementVariadic("li",void 0,[e])}))])}};function m(e,r,t,u,c,f){var d=o.getExn(a.nullable_to_opt(window.open("","",i.joinWith([["location","no"],["height",String(r)],["width",String(t)],["left",o.mapWithDefault(u,"0",(function(e){return String(e)}))],["top",o.mapWithDefault(c,"0",(function(e){return String(e)}))]],",",(function(e){return e[0]+"="+e[1]})))));window.addEventListener("unload",(function(e){d.close()}));var v=o.getExn(l.asHtmlDocument(d.document));return v.head.appendChild(o.getExn(n.toNode(n.DOMRe.createDOMElementVariadic("title",void 0,[e])))),v.head.appendChild(o.getExn(n.toNode(n.DOMRe.createDOMElementVariadic("style",void 0,[s.toString()])))),[d,o.getExn(a.nullable_to_opt(v.body))]}},(e,r,t)=>{t.r(r),t.d(r,{blit:()=>I,blitUnsafe:()=>x,cmp:()=>_e,cmpU:()=>he,concat:()=>R,concatMany:()=>N,eq:()=>pe,eqU:()=>me,every:()=>ae,every2:()=>fe,every2U:()=>se,everyU:()=>oe,fill:()=>A,forEach:()=>U,forEachU:()=>C,forEachWithIndex:()=>K,forEachWithIndexU:()=>z,get:()=>u,getBy:()=>L,getByU:()=>P,getExn:()=>c,getIndexBy:()=>W,getIndexByU:()=>q,joinWith:()=>we,joinWithU:()=>be,keep:()=>B,keepMap:()=>H,keepMapU:()=>X,keepU:()=>J,keepWithIndex:()=>F,keepWithIndexU:()=>j,make:()=>h,makeBy:()=>g,makeByAndShuffle:()=>y,makeByAndShuffleU:()=>E,makeByU:()=>_,map:()=>T,mapU:()=>V,mapWithIndex:()=>G,mapWithIndexU:()=>Y,partition:()=>Ee,partitionU:()=>ge,range:()=>b,rangeBy:()=>w,reduce:()=>Z,reduceReverse:()=>ee,reduceReverse2:()=>te,reduceReverse2U:()=>re,reduceReverseU:()=>$,reduceU:()=>Q,reduceWithIndex:()=>ie,reduceWithIndexU:()=>ne,reverse:()=>p,reverseInPlace:()=>m,set:()=>l,setExn:()=>s,shuffle:()=>v,shuffleInPlace:()=>d,slice:()=>S,sliceToEnd:()=>k,some:()=>ce,some2:()=>ve,some2U:()=>de,someU:()=>ue,unzip:()=>ye,zip:()=>O,zipBy:()=>D,zipByU:()=>M});var n=t(27),i=t(13),o=t(28),a=t(17);function u(e,r){if(r>=0&&r<e.length)return a.some(e[r])}function c(e,r){if(!(r>=0&&r<e.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.ml",27,4],Error:new Error};return e[r]}function l(e,r,t){return r>=0&&r<e.length&&(e[r]=t,!0)}function s(e,r,t){if(!(r>=0&&r<e.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.ml",33,2],Error:new Error};e[r]=t}function f(e,r,t){var n=e[r];e[r]=e[t],e[t]=n}function d(e){for(var r=e.length,t=0;t<r;++t)f(e,t,o.random_int(t,r))}function v(e){var r=e.slice(0);return d(r),r}function m(e){for(var r=e.length,t=0,n=r/2|0;t<n;++t)f(e,0+t|0,((0+r|0)-t|0)-1|0)}function p(e){for(var r=e.length,t=new Array(r),n=0;n<r;++n)t[n]=e[(r-1|0)-n|0];return t}function h(e,r){if(e<=0)return[];for(var t=new Array(e),n=0;n<e;++n)t[n]=r;return t}function _(e,r){if(e<=0)return[];for(var t=new Array(e),n=0;n<e;++n)t[n]=r(n);return t}function g(e,r){return _(e,i.__1(r))}function E(e,r){var t=_(e,r);return d(t),t}function y(e,r){return E(e,i.__1(r))}function b(e,r){var t=r-e|0;if(t<0)return[];for(var n=new Array(t+1|0),i=0;i<=t;++i)n[i]=e+i|0;return n}function w(e,r,t){var n=r-e|0;if(n<0||t<=0)return[];for(var i=1+(n/t|0)|0,o=new Array(i),a=e,u=0;u<i;++u)o[u]=a,a=a+t|0;return o}function O(e,r){for(var t=e.length,n=r.length,i=t<n?t:n,o=new Array(i),a=0;a<i;++a)o[a]=[e[a],r[a]];return o}function M(e,r,t){for(var n=e.length,i=r.length,o=n<i?n:i,a=new Array(o),u=0;u<o;++u)a[u]=t(e[u],r[u]);return a}function D(e,r,t){return M(e,r,i.__2(t))}function R(e,r){for(var t=e.length,n=r.length,i=new Array(t+n|0),o=0;o<t;++o)i[o]=e[o];for(var a=0;a<n;++a)i[t+a|0]=r[a];return i}function N(e){for(var r=e.length,t=0,n=0;n<r;++n)t=t+e[n].length|0;var i=new Array(t);t=0;for(var o=0;o<r;++o)for(var a=e[o],u=0,c=a.length;u<c;++u)i[t]=a[u],t=t+1|0;return i}function S(e,r,t){if(t<=0)return[];var i=e.length,o=r<0?n.caml_int_max(i+r|0,0):r,a=i-o|0,u=a<t?a:t;if(u<=0)return[];for(var c=new Array(u),l=0;l<u;++l)c[l]=e[o+l|0];return c}function k(e,r){for(var t=e.length,i=r<0?n.caml_int_max(t+r|0,0):r,o=t-i|0,a=new Array(o),u=0;u<o;++u)a[u]=e[i+u|0];return a}function A(e,r,t,i){if(!(t<=0)){var o=e.length,a=r<0?n.caml_int_max(o+r|0,0):r,u=o-a|0,c=u<t?u:t;if(!(c<=0))for(var l=a,s=a+c|0;l<s;++l)e[l]=i}}function x(e,r,t,n,i){if(n<=r)for(var o=0;o<i;++o)t[o+n|0]=e[o+r|0];else for(var a=i-1|0;a>=0;--a)t[a+n|0]=e[a+r|0]}function I(e,r,t,i,o){var a=e.length,u=t.length,c=r<0?n.caml_int_max(a+r|0,0):r,l=i<0?n.caml_int_max(u+i|0,0):i,s=n.caml_int_min(o,n.caml_int_min(a-c|0,u-l|0));if(l<=c)for(var f=0;f<s;++f)t[f+l|0]=e[f+c|0];else for(var d=s-1|0;d>=0;--d)t[d+l|0]=e[d+c|0]}function C(e,r){for(var t=0,n=e.length;t<n;++t)r(e[t])}function U(e,r){return C(e,i.__1(r))}function V(e,r){for(var t=e.length,n=new Array(t),i=0;i<t;++i)n[i]=r(e[i]);return n}function T(e,r){return V(e,i.__1(r))}function P(e,r){for(var t,n=e.length,i=0;void 0===t&&i<n;){var o=e[i];r(o)&&(t=a.some(o)),i=i+1|0}return t}function L(e,r){return P(e,i.__1(r))}function q(e,r){for(var t,n=e.length,i=0;void 0===t&&i<n;){r(e[i])&&(t=i),i=i+1|0}return t}function W(e,r){return q(e,i.__1(r))}function J(e,r){for(var t=e.length,n=new Array(t),i=0,o=0;o<t;++o){var a=e[o];r(a)&&(n[i]=a,i=i+1|0)}return n.length=i,n}function B(e,r){return J(e,i.__1(r))}function j(e,r){for(var t=e.length,n=new Array(t),i=0,o=0;o<t;++o){var a=e[o];r(a,o)&&(n[i]=a,i=i+1|0)}return n.length=i,n}function F(e,r){return j(e,i.__2(r))}function X(e,r){for(var t=e.length,n=new Array(t),i=0,o=0;o<t;++o){var u=r(e[o]);void 0!==u&&(n[i]=a.valFromOption(u),i=i+1|0)}return n.length=i,n}function H(e,r){return X(e,i.__1(r))}function z(e,r){for(var t=0,n=e.length;t<n;++t)r(t,e[t])}function K(e,r){return z(e,i.__2(r))}function Y(e,r){for(var t=e.length,n=new Array(t),i=0;i<t;++i)n[i]=r(i,e[i]);return n}function G(e,r){return Y(e,i.__2(r))}function Q(e,r,t){for(var n=r,i=0,o=e.length;i<o;++i)n=t(n,e[i]);return n}function Z(e,r,t){return Q(e,r,i.__2(t))}function $(e,r,t){for(var n=r,i=e.length-1|0;i>=0;--i)n=t(n,e[i]);return n}function ee(e,r,t){return $(e,r,i.__2(t))}function re(e,r,t,i){for(var o=t,a=n.caml_int_min(e.length,r.length)-1|0;a>=0;--a)o=i(o,e[a],r[a]);return o}function te(e,r,t,n){return re(e,r,t,i.__3(n))}function ne(e,r,t){for(var n=r,i=0,o=e.length;i<o;++i)n=t(n,e[i],i);return n}function ie(e,r,t){return ne(e,r,i.__3(t))}function oe(e,r){for(var t=e.length,n=0;;){var i=n;if(i===t)return!0;if(!r(e[i]))return!1;n=i+1|0}}function ae(e,r){return oe(e,i.__1(r))}function ue(e,r){for(var t=e.length,n=0;;){var i=n;if(i===t)return!1;if(r(e[i]))return!0;n=i+1|0}}function ce(e,r){return ue(e,i.__1(r))}function le(e,r,t,n,i){for(;;){var o=t;if(o===i)return!0;if(!n(e[o],r[o]))return!1;t=o+1|0}}function se(e,r,t){return le(e,r,0,t,n.caml_int_min(e.length,r.length))}function fe(e,r,t){return se(e,r,i.__2(t))}function de(e,r,t){for(var i=0,o=n.caml_int_min(e.length,r.length);;){var a=i;if(a===o)return!1;if(t(e[a],r[a]))return!0;i=a+1|0}}function ve(e,r,t){return de(e,r,i.__2(t))}function me(e,r,t){var n=e.length;return n===r.length&&le(e,r,0,t,n)}function pe(e,r,t){return me(e,r,i.__2(t))}function he(e,r,t){var n=e.length,i=r.length;if(n>i)return 1;if(n<i)return-1;for(var o=0;;){var a=o;if(a===n)return 0;var u=t(e[a],r[a]);if(0!==u)return u;o=a+1|0}}function _e(e,r,t){return he(e,r,i.__2(t))}function ge(e,r){for(var t=e.length,n=0,i=0,o=new Array(t),a=new Array(t),u=0;u<t;++u){var c=e[u];r(c)?(o[n]=c,n=n+1|0):(a[i]=c,i=i+1|0)}return o.length=n,a.length=i,[o,a]}function Ee(e,r){return ge(e,i.__1(r))}function ye(e){for(var r=e.length,t=new Array(r),n=new Array(r),i=0;i<r;++i){var o=e[i];t[i]=o[0],n[i]=o[1]}return[t,n]}function be(e,r,t){var n=e.length;if(0===n)return"";for(var i=n-1|0,o=0,a="";;){var u=a,c=o;if(c===i)return u+t(e[c]);a=u+(t(e[c])+r),o=c+1|0}}function we(e,r,t){return be(e,r,i.__1(t))}},(e,r,t)=>{function n(e,r){return e<r?-1:e===r?0:1}function i(e,r){return e?r?0:1:r?-1:0}function o(e,r){return e===r?0:e<r?-1:e>r||e==e?1:r==r?-1:0}function a(e,r){return e===r?0:e<r?-1:1}function u(e,r){return e?r:e}function c(e,r){return e<r?e:r}function l(e,r){return e<r?e:r}function s(e,r){return e<r?e:r}function f(e,r){return e<r?e:r}function d(e,r){return e||r}function v(e,r){return e>r?e:r}function m(e,r){return e>r?e:r}function p(e,r){return e>r?e:r}function h(e,r){return e>r?e:r}function _(e,r){return e[1]===r[1]&&e[0]===r[0]}function g(e,r){var t=r[0],n=e[0];return n>t||!(n<t)&&e[1]>=r[1]}function E(e,r){return!_(e,r)}function y(e,r){return!g(e,r)}function b(e,r){return e[0]>r[0]||!(e[0]<r[0])&&e[1]>r[1]}function w(e,r){return!b(e,r)}function O(e,r){return g(e,r)?r:e}function M(e,r){return b(e,r)?e:r}t.r(r),t.d(r,{caml_bool_compare:()=>i,caml_bool_max:()=>d,caml_bool_min:()=>u,caml_float_compare:()=>o,caml_float_max:()=>m,caml_float_min:()=>l,caml_int32_max:()=>h,caml_int32_min:()=>f,caml_int_compare:()=>n,caml_int_max:()=>v,caml_int_min:()=>c,caml_string_compare:()=>a,caml_string_max:()=>p,caml_string_min:()=>s,i64_eq:()=>_,i64_ge:()=>g,i64_gt:()=>b,i64_le:()=>w,i64_lt:()=>y,i64_max:()=>M,i64_min:()=>O,i64_neq:()=>E})},(e,r,t)=>{t.r(r),t.d(r,{ceil:()=>l,ceil_int:()=>o,floor:()=>s,floor_int:()=>u,random_int:()=>c,unsafe_ceil:()=>i,unsafe_floor:()=>a});var n=t(29);function i(e){return Math.ceil(e)}function o(e){return e>n.max?n.max:e<n.min?n.min:Math.ceil(e)}function a(e){return Math.floor(e)}function u(e){return e>n.max?n.max:e<n.min?n.min:Math.floor(e)}function c(e,r){return u(Math.random()*(r-e|0))+e|0}var l=o,s=u},(e,r,t)=>{function n(e,r){return e===r}t.r(r),t.d(r,{equal:()=>n,max:()=>i,min:()=>o});var i=2147483647,o=-2147483648},(e,r,t)=>{t.r(r),t.d(r,{cmp:()=>w,cmpU:()=>b,eq:()=>y,eqU:()=>E,flatMap:()=>p,flatMapU:()=>m,forEach:()=>c,forEachU:()=>u,getExn:()=>l,getWithDefault:()=>h,isNone:()=>g,isSome:()=>_,keep:()=>a,keepU:()=>o,map:()=>v,mapU:()=>d,mapWithDefault:()=>f,mapWithDefaultU:()=>s});var n=t(13),i=t(17);function o(e,r){if(void 0!==e&&r(i.valFromOption(e)))return e}function a(e,r){return o(e,n.__1(r))}function u(e,r){if(void 0!==e)return r(i.valFromOption(e))}function c(e,r){return u(e,n.__1(r))}function l(e){if(void 0!==e)return i.valFromOption(e);throw{RE_EXN_ID:"Not_found",Error:new Error}}function s(e,r,t){return void 0!==e?t(i.valFromOption(e)):r}function f(e,r,t){return s(e,r,n.__1(t))}function d(e,r){if(void 0!==e)return i.some(r(i.valFromOption(e)))}function v(e,r){return d(e,n.__1(r))}function m(e,r){if(void 0!==e)return r(i.valFromOption(e))}function p(e,r){return m(e,n.__1(r))}function h(e,r){return void 0!==e?i.valFromOption(e):r}function _(e){return void 0!==e}function g(e){return void 0===e}function E(e,r,t){return void 0!==e?void 0!==r&&t(i.valFromOption(e),i.valFromOption(r)):void 0===r}function y(e,r,t){return E(e,r,n.__2(t))}function b(e,r,t){return void 0!==e?void 0!==r?t(i.valFromOption(e),i.valFromOption(r)):1:void 0!==r?-1:0}function w(e,r,t){return b(e,r,n.__2(t))}},(e,r,t)=>{t.r(r),t.d(r,{about:()=>b,answerDetail:()=>p,answerDetailShortAnswer:()=>h,answerMark:()=>m,answerMsg:()=>d,answerMsgName:()=>v,clickable:()=>c,default:()=>D,mainBody:()=>u,settings:()=>_,settingsEntry:()=>g,settingsSubmit:()=>E,settingsSubmitTip:()=>y,stateNotSure:()=>f,stateSure:()=>s,stateWorkingOn:()=>l,uploadImg:()=>w,uploadImgConfirm:()=>M,uploadImgImage:()=>O});var n=t(32),i=t.n(n),o=t(33),a=t.n(o)()(i());a.push([e.id,".KtSQfh45DkzY1g4GTjHG {\n  opacity: 0.5;\n}\n.KtSQfh45DkzY1g4GTjHG * {\n  font-size: 0.75rem;\n  margin: 0;\n}\n.KtSQfh45DkzY1g4GTjHG button {\n  cursor: pointer;\n}\n.nl0fbl1STsJ1E_ijRd86 {\n  cursor: pointer;\n}\n.RWbunk2kQrtNJ0m8aBQ1 {\n  color: blue;\n}\n.xFTx0TcOk7czFIM7Y7XU {\n  color: green;\n}\n.m13F3VKGlt0QbaYvFZwq {\n  color: red;\n}\n.G0hX28B0fzB612BG5GVh {\n  border-style: groove;\n  border-width: thin;\n  opacity: 0.75;\n  margin-bottom: 0.5rem;\n}\n.G0hX28B0fzB612BG5GVh ul {\n  padding-left: 1rem;\n}\n.AleYAgJXUjzQT0tY9tgw {\n  font-weight: bold;\n}\n.aSdxCJr5F7gYQ84HMbUA {\n  display: flex;\n  justify-content: end;\n  align-items: center;\n  border-style: groove;\n  border-width: thin;\n  margin-bottom: 0.5rem;\n  opacity: 0.75;\n}\n.aSdxCJr5F7gYQ84HMbUA button {\n  padding: 0;\n  margin-left: 0.5rem;\n  white-space: nowrap;\n}\n.aSdxCJr5F7gYQ84HMbUA input {\n  height: max-content;\n  width: 100%;\n}\n.E2WC5WHEPccqZwiUT6nE .RWbunk2kQrtNJ0m8aBQ1,\n.E2WC5WHEPccqZwiUT6nE .xFTx0TcOk7czFIM7Y7XU,\n.E2WC5WHEPccqZwiUT6nE .m13F3VKGlt0QbaYvFZwq {\n  font-weight: bold;\n}\n.E2WC5WHEPccqZwiUT6nE ul {\n  padding-left: 1.5rem;\n}\n.E2WC5WHEPccqZwiUT6nE img {\n  height: auto;\n  width: 80%;\n}\n.yZjHuTE6p_FgmbomqPFx {\n  border-style: groove;\n  border-width: thin;\n  margin: 0.2rem;\n  padding: 0.2rem;\n}\n._o1gebpEn7x9Td7Hes6g {\n  border-style: groove;\n  border-width: thin;\n  display: flex;\n  flex-direction: column;\n  padding: 0.5rem;\n  margin-bottom: 0.5rem;\n}\n.YalNJJWiNdYPl5FzO1a_ {\n  display: flex;\n  flex-direction: row;\n  margin-bottom: 0.5rem;\n  justify-content: space-between;\n  align-items: center;\n}\n.YalNJJWiNdYPl5FzO1a_ label {\n  font-weight: bold;\n}\n.YalNJJWiNdYPl5FzO1a_ input {\n  height: max-content;\n  text-align: right;\n}\n.GkQ9CK5Dl58odGzSBLOP {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: end;\n}\n.CY2oPnMnonyamRy15TxZ {\n  margin-right: 0.5rem;\n}\n.ssrv8ndZGNgvTL1Osr92 p {\n  margin-bottom: 0.25rem;\n}\n.ssrv8ndZGNgvTL1Osr92 ul {\n  padding-left: 1.5rem;\n  margin-bottom: 0.25rem;\n}\n.ssrv8ndZGNgvTL1Osr92 ul li {\n  margin-bottom: 0.25rem;\n}\n.UJVcq5yyVfeOtVL0dWlT {\n  display: flex;\n  flex-direction: column;\n}\n.UJVcq5yyVfeOtVL0dWlT img {\n  width: 100%;\n  height: auto;\n}\n.SB_KxqWR3Sju8ih5VCQj {\n  border-style: groove;\n  border-width: thin;\n  padding: 0.5rem;\n}\n.YM_eQySt5C11IITqy_br {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.5rem;\n}\n",""]);var u="KtSQfh45DkzY1g4GTjHG",c="nl0fbl1STsJ1E_ijRd86",l="RWbunk2kQrtNJ0m8aBQ1",s="xFTx0TcOk7czFIM7Y7XU",f="m13F3VKGlt0QbaYvFZwq",d="G0hX28B0fzB612BG5GVh",v="AleYAgJXUjzQT0tY9tgw",m="aSdxCJr5F7gYQ84HMbUA",p="E2WC5WHEPccqZwiUT6nE",h="yZjHuTE6p_FgmbomqPFx",_="_o1gebpEn7x9Td7Hes6g",g="YalNJJWiNdYPl5FzO1a_",E="GkQ9CK5Dl58odGzSBLOP",y="CY2oPnMnonyamRy15TxZ",b="ssrv8ndZGNgvTL1Osr92",w="UJVcq5yyVfeOtVL0dWlT",O="SB_KxqWR3Sju8ih5VCQj",M="YM_eQySt5C11IITqy_br";const D=a},e=>{e.exports=function(e){return e[1]}},e=>{e.exports=function(e){var r=[];return r.toString=function(){return this.map((function(r){var t="",n=void 0!==r[5];return r[4]&&(t+="@supports (".concat(r[4],") {")),r[2]&&(t+="@media ".concat(r[2]," {")),n&&(t+="@layer".concat(r[5].length>0?" ".concat(r[5]):""," {")),t+=e(r),n&&(t+="}"),r[2]&&(t+="}"),r[4]&&(t+="}"),t})).join("")},r.i=function(e,t,n,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(n)for(var u=0;u<this.length;u++){var c=this[u][0];null!=c&&(a[c]=!0)}for(var l=0;l<e.length;l++){var s=[].concat(e[l]);n&&a[s[0]]||(void 0!==o&&(void 0===s[5]||(s[1]="@layer".concat(s[5].length>0?" ".concat(s[5]):""," {").concat(s[1],"}")),s[5]=o),t&&(s[2]?(s[1]="@media ".concat(s[2]," {").concat(s[1],"}"),s[2]=t):s[2]=t),i&&(s[4]?(s[1]="@supports (".concat(s[4],") {").concat(s[1],"}"),s[4]=i):s[4]="".concat(i)),r.push(s))}},r}},(e,r,t)=>{t.r(r),t.d(r,{Impl:()=>m,asHtmlElement:()=>v,insertAdjacentElement:()=>h,insertAdjacentHTML:()=>_,insertAdjacentText:()=>g,nodeType:()=>E,ofNode:()=>d});var n=t(17),i=t(35),o=t(36),a=t(38),u=t(39),c=t(40),l=t(37),s=t(41),f=t(42);function d(e){if(0===i.nodeType(e))return n.some(e)}var v=function(e){if(void 0!==window.constructor.name&&/^HTML\w*Element$/.test(e.constructor.name)||/^\[object HTML\w*Element\]$/.test(e.constructor.toString()))return e};function m(e){return{asHtmlElement:v,ofNode:d,insertAdjacentElement:function(e,r,t){e.insertAdjacentElement(o.encodeInsertPosition(r),t)},insertAdjacentHTML:function(e,r,t){e.insertAdjacentHTML(o.encodeInsertPosition(r),t)},insertAdjacentText:function(e,r,t){e.insertAdjacentText(o.encodeInsertPosition(r),t)}}}var p=i.Impl({});function h(e,r,t){e.insertAdjacentElement(o.encodeInsertPosition(r),t)}function _(e,r,t){e.insertAdjacentHTML(o.encodeInsertPosition(r),t)}function g(e,r,t){e.insertAdjacentText(o.encodeInsertPosition(r),t)}l.Impl({}),s.Impl({}),c.Impl({}),f.Impl({}),u.Impl({}),a.Impl({});var E=p.nodeType},(e,r,t)=>{t.r(r),t.d(r,{Impl:()=>i,nodeType:()=>o});var n=t(36);function i(e){return{nodeType:function(e){return n.decodeNodeType(e.nodeType)}}}function o(e){return n.decodeNodeType(e.nodeType)}t(37).Impl({})},(e,r,t)=>{function n(e){return e}function i(e){return e+1>>>0>2?3:e+1|0}function o(e){switch(e){case"BackCompat":return 0;case"CSS1Compat":return 1;default:return 2}}function a(e){switch(e){case 0:return"true";case 1:return"false";case 2:return"inherit";case 3:return""}}function u(e){switch(e){case"false":return 1;case"inherit":return 2;case"true":return 0;default:return 3}}function c(e){if(e>2||e<0)throw{RE_EXN_ID:"Invalid_argument",_1:"invalid deltaMode",Error:new Error};return e}function l(e){switch(e){case 0:return"on";case 1:return"off";case 2:return""}}function s(e){switch(e){case"off":return 1;case"on":return 0;default:return 2}}function f(e){switch(e){case 0:return"ltr";case 1:return"rtl";case 2:return""}}function d(e){switch(e){case"ltr":return 0;case"rtl":return 1;default:return 2}}t.r(r),t.d(r,{EventPhase:()=>v,WhatToShow:()=>w,decodeCompareResult:()=>i,decodeCompatMode:()=>o,decodeContentEditable:()=>u,decodeDeltaMode:()=>c,decodeDesignMode:()=>s,decodeDir:()=>d,decodeNodeType:()=>_,decodePointerType:()=>g,decodeReadyState:()=>E,decodeShadowRootMode:()=>y,decodeVisibilityState:()=>b,encodeCompareHow:()=>n,encodeContentEditable:()=>a,encodeDesignMode:()=>l,encodeDir:()=>f,encodeFilterAction:()=>m,encodeInsertPosition:()=>p,encodeModifierKey:()=>h});var v={decode:function(e){return e>3||e<0?4:e}};function m(e){return e+1|0}function p(e){switch(e){case 0:return"beforebegin";case 1:return"afterbegin";case 2:return"beforeend";case 3:return"afterend"}}function h(e){switch(e){case 0:return"Alt";case 1:return"AltGraph";case 2:return"CapsLock";case 3:return"Control";case 4:return"Fn";case 5:return"FnLock";case 6:return"Hyper";case 7:return"Meta";case 8:return"NumLock";case 9:return"ScrollLock";case 10:return"Shift";case 11:return"Super";case 12:return"Symbol";case 13:return"SymbolLock"}}function _(e){return e>12||e<1?12:e-1|0}function g(e){switch(e){case"mouse":return 0;case"pen":return 1;case"touch|":return 2;default:return 3}}function E(e){switch(e){case"complete":return 2;case"interactive":return 1;case"loading":return 0;default:return 3}}function y(e){switch(e){case"closed":return 1;case"open":return 0;default:throw{RE_EXN_ID:"Invalid_argument",_1:"Unknown shadowRootMode",Error:new Error}}}function b(e){switch(e){case"hidden":return 1;case"prerender":return 2;case"unloaded":return 3;case"visible":return 0;default:return 4}}var w={_All:-1,_Element:1,_Attribute:2,_Text:4,_CDATASection:8,_EntityReference:16,_Entity:32,_ProcessingInstruction:64,_Comment:128,_Document:256,_DocumentType:512,_DocumentFragment:1024,_Notation:2048,many:function e(r){return r?r.hd|e(r.tl):0}}},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{t.r(r),t.d(r,{Impl:()=>l,asHtmlDocument:()=>f,compatMode:()=>v,nodeType:()=>p,ofNode:()=>d,visibilityState:()=>m});var n=t(17),i=t(35),o=t(36),a=t(40),u=t(37),c=t(44);function l(e){return{asHtmlDocument:function(e){var r=e.defaultView;if(null!=r){var t=r.HTMLDocument;if(null!=t&&e instanceof t)return e}},ofNode:function(e){if(8===i.nodeType(e))return n.some(e)},compatMode:function(e){return o.decodeCompatMode(e.compatMode)},visibilityState:function(e){return o.decodeVisibilityState(e.visibilityState)}}}var s=i.Impl({});u.Impl({}),c.Impl({}),a.Impl({});var f=function(e){var r=e.defaultView;if(null!=r){var t=r.HTMLDocument;if(null!=t&&e instanceof t)return e}};function d(e){if(8===i.nodeType(e))return n.some(e)}function v(e){return o.decodeCompatMode(e.compatMode)}function m(e){return o.decodeVisibilityState(e.visibilityState)}var p=s.nodeType},(e,r,t)=>{function n(e){return{}}t.r(r),t.d(r,{Impl:()=>n})},(e,r,t)=>{t.r(r),t.d(r,{Answer:()=>h,Blank:()=>V,Choice:()=>I,React:()=>{},ReactDOMRe:()=>{},ShortAnswer:()=>P,T:()=>k,Tooltip:()=>S,answerState:()=>w,cmpWithState:()=>M,percent:()=>E,sortByKey:()=>y,sortByNameWithAnswerContext:()=>R,sortByNameWithContext:()=>D,stateClass:()=>b,stateToPriv:()=>O,style:()=>p,updateMsg:()=>g,updateState:()=>_});var n=t(13),i=t(22),o=t(25),a=t(46),u=t(52),c=t(1),l=t(26),s=t(53),f=t(30),d=t(17),v=t(54),m=t(56),p=t(31),h={};function _(e,r){c.CLIENT.updateState(e,r)}function g(e,r){c.CLIENT.updateMsg(e,r)}function E(e,r){return String(s.div(Math.imul(e,100),r))+"%"}function y(e){return m.stableSortBy(e,(function(e,r){return a.compare(e[0],r[0])}))}function b(e){return f.map(e,(function(e){switch(e){case 0:return p.stateWorkingOn;case 1:return p.stateSure;case 2:return p.stateNotSure}}))}function w(e){return b(f.flatMap(e,(function(e){return e.state})))}function O(e){switch(e){case 0:return 1;case 1:return 0;case 2:return 2}}function M(e,r){var t=r[1],n=e[1];return void 0!==n?void 0!==t?O(t)-O(n)|0:-1:void 0!==t?1:a.compare(e[0],r[0])}function D(e){return m.stableSortBy(e,(function(e,r){return M([e[0],f.flatMap(e[1],(function(e){return e.state}))],[r[0],f.flatMap(r[1],(function(e){return e.state}))])}))}function R(e){return m.stableSortBy(e,(function(e,r){return M([e[0],f.flatMap(e[1].context,(function(e){return e.state}))],[r[0],f.flatMap(r[1].context,(function(e){return e.state}))])}))}function N(e,r){e.ele.setAttribute("title",r)}var S={make:function(e){return{ele:e}},setContent:N};var k={Make:function(e){var r=function(e,r,t){o.openWin("详细答案",200,300,t,r,void 0)[1].appendChild(f.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:p.mainBody},[i.DOMRe.createDOMElementVariadic("fieldset",{className:p.answerMark},[i.DOMRe.createDOMElementVariadic("legend",void 0,["标记"]),i.DOMRe.createDOMElementVariadic("input",{placeholder:"输入留言",type:"text",onChange:function(r){var t=r.target.value;c.CLIENT.updateMsg(e.id,t)}},[]),i.DOMRe.createDOMElementVariadic("button",{className:p.stateWorkingOn,type:"button",onClick:function(r){c.CLIENT.updateState(e.id,0)}},["我正在做"]),i.DOMRe.createDOMElementVariadic("button",{className:p.stateSure,type:"button",onClick:function(r){c.CLIENT.updateState(e.id,1)}},["我很确定"]),i.DOMRe.createDOMElementVariadic("button",{className:p.stateNotSure,type:"button",onClick:function(r){c.CLIENT.updateState(e.id,2)}},["我不确定"])]),e.detailHtml]))))};return{showDetail:r,make:function(t,i,o){var a={details:void 0,detailHtml:null,context:n._2(e.make,i,o),id:t},u=f.getExn(d.nullable_to_opt(i.querySelector(".item-type")));return u.classList.add(p.clickable),u.addEventListener("click",(function(e){var t=u.getBoundingClientRect();return r(a,0|t.top,0|t.left)})),a},updateAnswer:function(e,r,t){e.details=v.set(e.details,r,t)},updateUI:function(r){r.detailHtml=i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("fieldset",{className:p.answerMsg},[i.DOMRe.createDOMElementVariadic("legend",void 0,["留言"]),i.createElement(o.UList.make,{children:l.map(l.keepMap(R(v.toArray(r.details)),(function(e){var r=e[0];return f.flatMap(e[1].context,(function(e){var t=0===e.state?f.getWithDefault(e.msg,"我正在做"):e.msg;return f.map(t,(function(t){return[r,e.state,t]}))}))})),(function(e){var r={},t=b(e[1]);return void 0!==t&&(r.className=d.valFromOption(t)),i.DOMRe.createDOMElementVariadic("p",d.some(r),[i.DOMRe.createDOMElementVariadic("span",{className:p.answerMsgName},[e[0]+": "]),e[2]])}))})]),i.DOMRe.createDOMElementVariadic("div",{className:p.answerDetail},[n._2(e.updateUI,r.details,r.context)])])}}}};function A(e,r){return{tooltips:l.reduceWithIndex(o.querySelectorAllElements(e,".item-body .checkboxInput, .item-body .radioInput"),void 0,(function(e,r,t){return v.set(e,String.fromCharCode(t+65|0),{ele:r})})),choiceMap:r}}function x(e,r,t){o.openWin("详细答案",200,300,t,r,void 0)[1].appendChild(f.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:p.mainBody},[i.DOMRe.createDOMElementVariadic("fieldset",{className:p.answerMark},[i.DOMRe.createDOMElementVariadic("legend",void 0,["标记"]),i.DOMRe.createDOMElementVariadic("input",{placeholder:"输入留言",type:"text",onChange:function(r){var t=r.target.value;c.CLIENT.updateMsg(e.id,t)}},[]),i.DOMRe.createDOMElementVariadic("button",{className:p.stateWorkingOn,type:"button",onClick:function(r){c.CLIENT.updateState(e.id,0)}},["我正在做"]),i.DOMRe.createDOMElementVariadic("button",{className:p.stateSure,type:"button",onClick:function(r){c.CLIENT.updateState(e.id,1)}},["我很确定"]),i.DOMRe.createDOMElementVariadic("button",{className:p.stateNotSure,type:"button",onClick:function(r){c.CLIENT.updateState(e.id,2)}},["我不确定"])]),e.detailHtml]))))}var I={showDetail:x,make:function(e,r,t){var n={details:void 0,detailHtml:null,context:A(r,t),id:e},i=f.getExn(d.nullable_to_opt(r.querySelector(".item-type")));return i.classList.add(p.clickable),i.addEventListener("click",(function(e){var r=i.getBoundingClientRect();return x(n,0|r.top,0|r.left)})),n},updateAnswer:function(e,r,t){e.details=v.set(e.details,r,t)},updateUI:function(e){var r,t;e.detailHtml=i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("fieldset",{className:p.answerMsg},[i.DOMRe.createDOMElementVariadic("legend",void 0,["留言"]),i.createElement(o.UList.make,{children:l.map(l.keepMap(R(v.toArray(e.details)),(function(e){var r=e[0];return f.flatMap(e[1].context,(function(e){var t=0===e.state?f.getWithDefault(e.msg,"我正在做"):e.msg;return f.map(t,(function(t){return[r,e.state,t]}))}))})),(function(e){var r={},t=b(e[1]);return void 0!==t&&(r.className=d.valFromOption(t)),i.DOMRe.createDOMElementVariadic("p",d.some(r),[i.DOMRe.createDOMElementVariadic("span",{className:p.answerMsgName},[e[0]+": "]),e[2]])}))})]),i.DOMRe.createDOMElementVariadic("div",{className:p.answerDetail},[(r=e.details,t=e.context,l.map(y(l.map(v.toArray(v.reduce(r,void 0,(function(e,r,t){var n=t.context;return f.mapWithDefault(t.answer,e,(function(t){return l.reduce(t,e,(function(e,t){return v.update(e,t,(function(e){return l.concat(f.getWithDefault(e,[]),[[r,n]])}))}))}))}))),(function(e){return[n._1(t.choiceMap,e[0]),e[1]]}))),(function(e){var n=e[1],a=e[0];return f.forEach(v.get(t.tooltips,a),(function(e){return N(e,E(n.length,v.size(r)))})),i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,[a])]),i.createElement(o.UList.make,{children:l.map(D(n),(function(e){var r={},t=w(e[1]);return void 0!==t&&(r.className=d.valFromOption(t)),i.DOMRe.createDOMElementVariadic("p",d.some(r),[e[0]])}))})])})))])])}};function C(e,r){return{tooltips:l.reduceWithIndex(o.querySelectorAllElements(e,".item-body .blank-item-dynamic"),void 0,(function(e,r,t){return v.set(e,String.fromCharCode(49+t|0),{ele:r})}))}}function U(e,r,t){o.openWin("详细答案",200,300,t,r,void 0)[1].appendChild(f.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:p.mainBody},[i.DOMRe.createDOMElementVariadic("fieldset",{className:p.answerMark},[i.DOMRe.createDOMElementVariadic("legend",void 0,["标记"]),i.DOMRe.createDOMElementVariadic("input",{placeholder:"输入留言",type:"text",onChange:function(r){var t=r.target.value;c.CLIENT.updateMsg(e.id,t)}},[]),i.DOMRe.createDOMElementVariadic("button",{className:p.stateWorkingOn,type:"button",onClick:function(r){c.CLIENT.updateState(e.id,0)}},["我正在做"]),i.DOMRe.createDOMElementVariadic("button",{className:p.stateSure,type:"button",onClick:function(r){c.CLIENT.updateState(e.id,1)}},["我很确定"]),i.DOMRe.createDOMElementVariadic("button",{className:p.stateNotSure,type:"button",onClick:function(r){c.CLIENT.updateState(e.id,2)}},["我不确定"])]),e.detailHtml]))))}var V={showDetail:U,make:function(e,r,t){var n={details:void 0,detailHtml:null,context:C(r),id:e},i=f.getExn(d.nullable_to_opt(r.querySelector(".item-type")));return i.classList.add(p.clickable),i.addEventListener("click",(function(e){var r=i.getBoundingClientRect();return U(n,0|r.top,0|r.left)})),n},updateAnswer:function(e,r,t){e.details=v.set(e.details,r,t)},updateUI:function(e){var r,t;e.detailHtml=i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("fieldset",{className:p.answerMsg},[i.DOMRe.createDOMElementVariadic("legend",void 0,["留言"]),i.createElement(o.UList.make,{children:l.map(l.keepMap(R(v.toArray(e.details)),(function(e){var r=e[0];return f.flatMap(e[1].context,(function(e){var t=0===e.state?f.getWithDefault(e.msg,"我正在做"):e.msg;return f.map(t,(function(t){return[r,e.state,t]}))}))})),(function(e){var r={},t=b(e[1]);return void 0!==t&&(r.className=d.valFromOption(t)),i.DOMRe.createDOMElementVariadic("p",d.some(r),[i.DOMRe.createDOMElementVariadic("span",{className:p.answerMsgName},[e[0]+": "]),e[2]])}))})]),i.DOMRe.createDOMElementVariadic("div",{className:p.answerDetail},[(r=e.details,t=e.context,l.map(y(v.toArray(v.reduce(r,void 0,(function(e,r,t){var n=t.context;return f.mapWithDefault(t.answer,e,(function(t){return l.reduce(u.entries(t),e,(function(e,t){var i=t[1];return v.update(e,t[0],(function(e){return d.some(v.update(f.getWithDefault(e,void 0),i,(function(e){return l.concat(f.getWithDefault(e,[]),[[r,n]])})))}))}))}))})))),(function(e){var n=e[0],a=y(v.toArray(e[1]));return f.forEach(v.get(t.tooltips,n),(function(e){return N(e,f.mapWithDefault(l.get(m.stableSortBy(l.map(a,(function(e){return[e[0],e[1].length]})),(function(e,r){return r[1]-e[1]|0})),0),"",(function(e){return"("+E(e[1],v.size(r))+") "+e[0]})))})),i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,["#"+n])]),i.createElement(o.UList.make,{children:l.map(a,(function(e){return i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",void 0,[e[0]]),i.createElement(o.UList.make,{children:l.map(D(e[1]),(function(e){var r={},t=w(e[1]);return void 0!==t&&(r.className=d.valFromOption(t)),i.DOMRe.createDOMElementVariadic("p",d.some(r),[e[0]])}))})])}))})])})))])])}};function T(e,r,t){o.openWin("详细答案",200,300,t,r,void 0)[1].appendChild(f.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:p.mainBody},[i.DOMRe.createDOMElementVariadic("fieldset",{className:p.answerMark},[i.DOMRe.createDOMElementVariadic("legend",void 0,["标记"]),i.DOMRe.createDOMElementVariadic("input",{placeholder:"输入留言",type:"text",onChange:function(r){var t=r.target.value;c.CLIENT.updateMsg(e.id,t)}},[]),i.DOMRe.createDOMElementVariadic("button",{className:p.stateWorkingOn,type:"button",onClick:function(r){c.CLIENT.updateState(e.id,0)}},["我正在做"]),i.DOMRe.createDOMElementVariadic("button",{className:p.stateSure,type:"button",onClick:function(r){c.CLIENT.updateState(e.id,1)}},["我很确定"]),i.DOMRe.createDOMElementVariadic("button",{className:p.stateNotSure,type:"button",onClick:function(r){c.CLIENT.updateState(e.id,2)}},["我不确定"])]),e.detailHtml]))))}var P={showDetail:T,make:function(e,r,t){var n={details:void 0,detailHtml:null,context:void 0,id:e},i=f.getExn(d.nullable_to_opt(r.querySelector(".item-type")));return i.classList.add(p.clickable),i.addEventListener("click",(function(e){var r=i.getBoundingClientRect();return T(n,0|r.top,0|r.left)})),n},updateAnswer:function(e,r,t){e.details=v.set(e.details,r,t)},updateUI:function(e){var r;e.detailHtml=i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("fieldset",{className:p.answerMsg},[i.DOMRe.createDOMElementVariadic("legend",void 0,["留言"]),i.createElement(o.UList.make,{children:l.map(l.keepMap(R(v.toArray(e.details)),(function(e){var r=e[0];return f.flatMap(e[1].context,(function(e){var t=0===e.state?f.getWithDefault(e.msg,"我正在做"):e.msg;return f.map(t,(function(t){return[r,e.state,t]}))}))})),(function(e){var r={},t=b(e[1]);return void 0!==t&&(r.className=d.valFromOption(t)),i.DOMRe.createDOMElementVariadic("p",d.some(r),[i.DOMRe.createDOMElementVariadic("span",{className:p.answerMsgName},[e[0]+": "]),e[2]])}))})]),i.DOMRe.createDOMElementVariadic("div",{className:p.answerDetail},[(r=e.details,e.context,l.map(R(v.toArray(r)),(function(e){var r=e[1],t=r.answer,n={},a=w(r.context);return void 0!==a&&(n.className=d.valFromOption(a)),i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",d.some(n),[i.DOMRe.createDOMElementVariadic("strong",void 0,[e[0]])]),i.DOMRe.createDOMElementVariadic("div",{className:p.answerDetailShortAnswer,dangerouslySetInnerHTML:{__html:f.getWithDefault(f.flatMap(t,(function(e){return e.content})),"")}},[]),i.createElement(o.UList.make,{children:l.map(f.getWithDefault(f.flatMap(f.flatMap(t,(function(e){return e.attachments})),(function(e){return e.filelist})),[]),(function(e){return i.DOMRe.createDOMElementVariadic("a",{href:e.fileUrl},[e.fileName])}))}),i.DOMRe.createDOMElementVariadic("div",void 0,[])])})))])])}}},(e,r,t)=>{t.r(r),t.d(r,{blit:()=>H,capitalize:()=>j,capitalize_ascii:()=>P,compare:()=>q,concat:()=>d,contains:()=>C,contains_from:()=>I,equal:()=>z,escaped:()=>E,index:()=>b,index_from:()=>M,index_from_opt:()=>D,index_opt:()=>O,init:()=>l,iter:()=>v,iteri:()=>m,lowercase:()=>B,lowercase_ascii:()=>T,make:()=>X,map:()=>p,mapi:()=>h,rcontains_from:()=>U,rindex:()=>N,rindex_from:()=>S,rindex_from_opt:()=>x,rindex_opt:()=>A,split_on_char:()=>W,sub:()=>s,trim:()=>g,uncapitalize:()=>F,uncapitalize_ascii:()=>L,uppercase:()=>J,uppercase_ascii:()=>V});var n=t(27),i=t(47),o=t(13),a=t(49),u=t(51),c=t(50);function l(e,r){return a.bytes_to_string(i.init(e,r))}function s(e,r,t){return a.bytes_to_string(i.sub(a.bytes_of_string(e),r,t))}function f(e,r){if(e>=r)return e;throw{RE_EXN_ID:"Invalid_argument",_1:"String.concat",Error:new Error}}function d(e,r){if(!r)return"";var t=e.length;return a.bytes_to_string(function(e,r,t,n,i){for(;;){var o=i,u=r;if(!o)return e;var c=o.tl,l=o.hd;if(!c)return a.caml_blit_string(l,0,e,u,l.length),e;a.caml_blit_string(l,0,e,u,l.length),a.caml_blit_string(t,0,e,u+l.length|0,n),i=c,r=(u+l.length|0)+n|0}}(a.caml_create_bytes(function(e,r,t){for(;;){var n=t,i=e;if(!n)return i;var o=n.tl,a=n.hd;if(!o)return a.length+i|0;t=o,e=f((a.length+r|0)+i|0,i)}}(0,t,r)),0,e,t,r))}function v(e,r){for(var t=0,n=r.length;t<n;++t)o._1(e,r.charCodeAt(t))}function m(e,r){for(var t=0,n=r.length;t<n;++t)o._2(e,t,r.charCodeAt(t))}function p(e,r){return a.bytes_to_string(i.map(e,a.bytes_of_string(r)))}function h(e,r){return a.bytes_to_string(i.mapi(e,a.bytes_of_string(r)))}function _(e){return e>13||e<9?32===e:11!==e}function g(e){return""===e||!_(e.charCodeAt(0))&&!_(e.charCodeAt(e.length-1|0))?e:a.bytes_to_string(i.trim(a.bytes_of_string(e)))}function E(e){return function(r){for(;;){var t=r;if(t>=e.length)return!1;var n=e.charCodeAt(t);if(n<32)return!0;if(n>92||n<34){if(n>=127)return!0;r=t+1|0}else{if(n>91||n<35)return!0;r=t+1|0}}}(0)?a.bytes_to_string(i.escaped(a.bytes_of_string(e))):e}function y(e,r,t,n){for(;;){var i=t;if(i>=r)throw{RE_EXN_ID:"Not_found",Error:new Error};if(e.charCodeAt(i)===n)return i;t=i+1|0}}function b(e,r){return y(e,e.length,0,r)}function w(e,r,t,n){for(;;){var i=t;if(i>=r)return;if(e.charCodeAt(i)===n)return i;t=i+1|0}}function O(e,r){return w(e,e.length,0,r)}function M(e,r,t){var n=e.length;if(r<0||r>n)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from / Bytes.index_from",Error:new Error};return y(e,n,r,t)}function D(e,r,t){var n=e.length;if(r<0||r>n)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from_opt / Bytes.index_from_opt",Error:new Error};return w(e,n,r,t)}function R(e,r,t){for(;;){var n=r;if(n<0)throw{RE_EXN_ID:"Not_found",Error:new Error};if(e.charCodeAt(n)===t)return n;r=n-1|0}}function N(e,r){return R(e,e.length-1|0,r)}function S(e,r,t){if(r<-1||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from / Bytes.rindex_from",Error:new Error};return R(e,r,t)}function k(e,r,t){for(;;){var n=r;if(n<0)return;if(e.charCodeAt(n)===t)return n;r=n-1|0}}function A(e,r){return k(e,e.length-1|0,r)}function x(e,r,t){if(r<-1||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from_opt / Bytes.rindex_from_opt",Error:new Error};return k(e,r,t)}function I(e,r,t){var n=e.length;if(r<0||r>n)throw{RE_EXN_ID:"Invalid_argument",_1:"String.contains_from / Bytes.contains_from",Error:new Error};try{return y(e,n,r,t),!0}catch(e){var i=c.internalToOCamlException(e);if("Not_found"===i.RE_EXN_ID)return!1;throw i}}function C(e,r){return I(e,0,r)}function U(e,r,t){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rcontains_from / Bytes.rcontains_from",Error:new Error};try{return R(e,r,t),!0}catch(e){var n=c.internalToOCamlException(e);if("Not_found"===n.RE_EXN_ID)return!1;throw n}}function V(e){return a.bytes_to_string(i.uppercase_ascii(a.bytes_of_string(e)))}function T(e){return a.bytes_to_string(i.lowercase_ascii(a.bytes_of_string(e)))}function P(e){return a.bytes_to_string(i.capitalize_ascii(a.bytes_of_string(e)))}function L(e){return a.bytes_to_string(i.uncapitalize_ascii(a.bytes_of_string(e)))}var q=n.caml_string_compare;function W(e,r){for(var t=0,n=r.length,i=r.length-1|0;i>=0;--i)r.charCodeAt(i)===e&&(t={hd:s(r,i+1|0,(n-i|0)-1|0),tl:t},n=i);return{hd:s(r,0,n),tl:t}}function J(e){return a.bytes_to_string(i.uppercase(a.bytes_of_string(e)))}function B(e){return a.bytes_to_string(i.lowercase(a.bytes_of_string(e)))}function j(e){return a.bytes_to_string(i.capitalize(a.bytes_of_string(e)))}function F(e){return a.bytes_to_string(i.uncapitalize(a.bytes_of_string(e)))}var X=u.make,H=i.blit_string;function z(e,r){return e===r}},(e,r,t)=>{t.r(r),t.d(r,{blit:()=>E,blit_string:()=>y,capitalize:()=>ee,capitalize_ascii:()=>U,cat:()=>D,compare:()=>Q,concat:()=>M,contains:()=>Y,contains_from:()=>K,copy:()=>f,empty:()=>s,equal:()=>te,escaped:()=>S,extend:()=>_,fill:()=>g,index:()=>P,index_from:()=>W,index_from_opt:()=>J,index_opt:()=>q,init:()=>l,iter:()=>b,iteri:()=>w,lowercase:()=>$,lowercase_ascii:()=>I,make:()=>c,map:()=>k,mapi:()=>A,of_string:()=>v,rcontains_from:()=>G,rindex:()=>j,rindex_from:()=>F,rindex_from_opt:()=>z,rindex_opt:()=>H,sub:()=>m,sub_string:()=>p,to_string:()=>d,trim:()=>N,uncapitalize:()=>re,uncapitalize_ascii:()=>V,unsafe_of_string:()=>ie,unsafe_to_string:()=>ne,uppercase:()=>Z,uppercase_ascii:()=>x});var n=t(27),i=t(48),o=t(13),a=t(49),u=t(50);function c(e,r){var t=a.caml_create_bytes(e);return a.caml_fill_bytes(t,0,e,r),t}function l(e,r){for(var t=a.caml_create_bytes(e),n=0;n<e;++n)t[n]=o._1(r,n);return t}var s=[];function f(e){var r=e.length,t=a.caml_create_bytes(r);return a.caml_blit_bytes(e,0,t,0,r),t}function d(e){return a.bytes_to_string(f(e))}function v(e){return f(a.bytes_of_string(e))}function m(e,r,t){if(r<0||t<0||r>(e.length-t|0))throw{RE_EXN_ID:"Invalid_argument",_1:"String.sub / Bytes.sub",Error:new Error};var n=a.caml_create_bytes(t);return a.caml_blit_bytes(e,r,n,0,t),n}function p(e,r,t){return a.bytes_to_string(m(e,r,t))}function h(e,r){var t=e+r|0,n=r<0,i=t<0;if(e<0){if(!n)return t;if(i)return t;throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.extend",Error:new Error}}if(n)return t;if(i)throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.extend",Error:new Error};return t}function _(e,r,t){var i=h(h(e.length,r),t),o=a.caml_create_bytes(i),u=r<0?[0|-r,0]:[0,r],c=u[1],l=u[0],s=n.caml_int_min(e.length-l|0,i-c|0);return s>0&&a.caml_blit_bytes(e,l,o,c,s),o}function g(e,r,t,n){if(r<0||t<0||r>(e.length-t|0))throw{RE_EXN_ID:"Invalid_argument",_1:"String.fill / Bytes.fill",Error:new Error};return a.caml_fill_bytes(e,r,t,n)}function E(e,r,t,n,i){if(i<0||r<0||r>(e.length-i|0)||n<0||n>(t.length-i|0))throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.blit",Error:new Error};return a.caml_blit_bytes(e,r,t,n,i)}function y(e,r,t,n,i){if(i<0||r<0||r>(e.length-i|0)||n<0||n>(t.length-i|0))throw{RE_EXN_ID:"Invalid_argument",_1:"String.blit / Bytes.blit_string",Error:new Error};return a.caml_blit_string(e,r,t,n,i)}function b(e,r){for(var t=0,n=r.length;t<n;++t)o._1(e,r[t])}function w(e,r){for(var t=0,n=r.length;t<n;++t)o._2(e,t,r[t])}function O(e,r){if(e>=r)return e;throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.concat",Error:new Error}}function M(e,r){if(!r)return s;for(var t=e.length,n=a.caml_create_bytes(function(e,r,t){for(;;){var n=t,i=e;if(!n)return i;var o=n.tl,a=n.hd;if(!o)return a.length+i|0;t=o,e=O((a.length+r|0)+i|0,i)}}(0,t,r)),i=0,o=r;;){var u=o,c=i;if(!u)return n;var l=u.tl,f=u.hd;if(!l)return a.caml_blit_bytes(f,0,n,c,f.length),n;a.caml_blit_bytes(f,0,n,c,f.length),a.caml_blit_bytes(e,0,n,c+f.length|0,t),o=l,i=(c+f.length|0)+t|0}}function D(e,r){var t=e.length,n=r.length,i=a.caml_create_bytes(t+n|0);return a.caml_blit_bytes(e,0,i,0,t),a.caml_blit_bytes(r,0,i,t,n),i}function R(e){return e>13||e<9?32===e:11!==e}function N(e){for(var r=e.length,t=0;t<r&&R(e[t]);)t=t+1|0;for(var n=r-1|0;n>=t&&R(e[n]);)n=n-1|0;return n>=t?m(e,t,1+(n-t|0)|0):s}function S(e){for(var r=0,t=0,n=e.length;t<n;++t){var i=e[t];r=r+(i>=32?i>92||i<34?i>=127?4:1:i>91||i<35?2:1:i>=11?13!==i?4:2:i>=8?2:4)|0}if(r===e.length)return f(e);var o=a.caml_create_bytes(r);r=0;for(var u=0,c=e.length;u<c;++u){var l=e[u],s=0;if(l>=35)92!==l?l>=127?s=1:o[r]=l:s=2;else if(l>=32)l>=34?s=2:o[r]=l;else if(l>=14)s=1;else switch(l){case 8:o[r]=92,o[r=r+1|0]=98;break;case 9:o[r]=92,o[r=r+1|0]=116;break;case 10:o[r]=92,o[r=r+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:s=1;break;case 13:o[r]=92,o[r=r+1|0]=114}switch(s){case 1:o[r]=92,o[r=r+1|0]=48+(l/100|0)|0,o[r=r+1|0]=48+(l/10|0)%10|0,o[r=r+1|0]=48+l%10|0;break;case 2:o[r]=92,o[r=r+1|0]=l}r=r+1|0}return o}function k(e,r){var t=r.length;if(0===t)return r;for(var n=a.caml_create_bytes(t),i=0;i<t;++i)n[i]=o._1(e,r[i]);return n}function A(e,r){var t=r.length;if(0===t)return r;for(var n=a.caml_create_bytes(t),i=0;i<t;++i)n[i]=o._2(e,i,r[i]);return n}function x(e){return k(i.uppercase_ascii,e)}function I(e){return k(i.lowercase_ascii,e)}function C(e,r){if(0===r.length)return r;var t=f(r);return t[0]=o._1(e,r[0]),t}function U(e){return C(i.uppercase_ascii,e)}function V(e){return C(i.lowercase_ascii,e)}function T(e,r,t,n){for(;;){var i=t;if(i>=r)throw{RE_EXN_ID:"Not_found",Error:new Error};if(e[i]===n)return i;t=i+1|0}}function P(e,r){return T(e,e.length,0,r)}function L(e,r,t,n){for(;;){var i=t;if(i>=r)return;if(e[i]===n)return i;t=i+1|0}}function q(e,r){return L(e,e.length,0,r)}function W(e,r,t){var n=e.length;if(r<0||r>n)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from / Bytes.index_from",Error:new Error};return T(e,n,r,t)}function J(e,r,t){var n=e.length;if(r<0||r>n)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from_opt / Bytes.index_from_opt",Error:new Error};return L(e,n,r,t)}function B(e,r,t){for(;;){var n=r;if(n<0)throw{RE_EXN_ID:"Not_found",Error:new Error};if(e[n]===t)return n;r=n-1|0}}function j(e,r){return B(e,e.length-1|0,r)}function F(e,r,t){if(r<-1||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from / Bytes.rindex_from",Error:new Error};return B(e,r,t)}function X(e,r,t){for(;;){var n=r;if(n<0)return;if(e[n]===t)return n;r=n-1|0}}function H(e,r){return X(e,e.length-1|0,r)}function z(e,r,t){if(r<-1||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from_opt / Bytes.rindex_from_opt",Error:new Error};return X(e,r,t)}function K(e,r,t){var n=e.length;if(r<0||r>n)throw{RE_EXN_ID:"Invalid_argument",_1:"String.contains_from / Bytes.contains_from",Error:new Error};try{return T(e,n,r,t),!0}catch(e){var i=u.internalToOCamlException(e);if("Not_found"===i.RE_EXN_ID)return!1;throw i}}function Y(e,r){return K(e,0,r)}function G(e,r,t){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rcontains_from / Bytes.rcontains_from",Error:new Error};try{return B(e,r,t),!0}catch(e){var n=u.internalToOCamlException(e);if("Not_found"===n.RE_EXN_ID)return!1;throw n}}var Q=a.caml_bytes_compare;function Z(e){return k(i.uppercase,e)}function $(e){return k(i.lowercase,e)}function ee(e){return C(i.uppercase,e)}function re(e){return C(i.lowercase,e)}var te=a.caml_bytes_equal,ne=a.bytes_to_string,ie=a.bytes_of_string},(e,r,t)=>{t.r(r),t.d(r,{chr:()=>i,compare:()=>s,equal:()=>f,escaped:()=>o,lowercase:()=>a,lowercase_ascii:()=>c,uppercase:()=>u,uppercase_ascii:()=>l});var n=t(49);function i(e){if(e<0||e>255)throw{RE_EXN_ID:"Invalid_argument",_1:"Char.chr",Error:new Error};return e}function o(e){var r=0;if(e>=40){if(92===e)return"\\\\";r=e>=127?1:2}else if(e>=32){if(e>=39)return"\\'";r=2}else if(e>=14)r=1;else switch(e){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:r=1;break;case 13:return"\\r"}switch(r){case 1:var t=[0,0,0,0];return t[0]=92,t[1]=48+(e/100|0)|0,t[2]=48+(e/10|0)%10|0,t[3]=48+e%10|0,n.bytes_to_string(t);case 2:var i=[0];return i[0]=e,n.bytes_to_string(i)}}function a(e){return e>=65&&e<=90||e>=192&&e<=214||e>=216&&e<=222?e+32|0:e}function u(e){return e>=97&&e<=122||e>=224&&e<=246||e>=248&&e<=254?e-32|0:e}function c(e){return e>=65&&e<=90?e+32|0:e}function l(e){return e>=97&&e<=122?e-32|0:e}function s(e,r){return e-r|0}function f(e,r){return 0==(e-r|0)}},(e,r,t)=>{function n(e,r,t){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};e[r]=t}function i(e,r){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return e[r]}function o(e,r,t,n){if(!(t<=0))for(var i=r,o=t+r|0;i<o;++i)e[i]=n}function a(e){if(e<0)throw{RE_EXN_ID:"Invalid_argument",_1:"String.create",Error:new Error};for(var r=new Array(e),t=0;t<e;++t)r[t]=0;return r}function u(e,r,t,n,i){if(!(i<=0))if(e!==t){var o=e.length-r|0;if(i<=o)for(var a=0;a<i;++a)t[n+a|0]=e[r+a|0];else{for(var u=0;u<o;++u)t[n+u|0]=e[r+u|0];for(var c=o;c<i;++c)t[n+c|0]=0}}else{if(r<n){for(var l=(e.length-n|0)-1|0,s=i-1|0,f=l>s?s:l;f>=0;--f)e[n+f|0]=e[r+f|0];return}if(r<=n)return;for(var d=(e.length-r|0)-1|0,v=i-1|0,m=d>v?v:d,p=0;p<=m;++p)e[n+p|0]=e[r+p|0]}}function c(e){var r=e.length,t="",n=r;if(r<=4096&&r===e.length)return String.fromCharCode.apply(null,e);for(var i=0;n>0;){for(var o=n<1024?n:1024,a=new Array(o),u=0;u<o;++u)a[u]=e[u+i|0];t+=String.fromCharCode.apply(null,a),n=n-o|0,i=i+o|0}return t}function l(e,r,t,n,i){if(!(i<=0)){var o=e.length-r|0;if(i<=o)for(var a=0;a<i;++a)t[n+a|0]=e.charCodeAt(r+a|0);else{for(var u=0;u<o;++u)t[n+u|0]=e.charCodeAt(r+u|0);for(var c=o;c<i;++c)t[n+c|0]=0}}}function s(e){for(var r=e.length,t=new Array(r),n=0;n<r;++n)t[n]=e.charCodeAt(n);return t}function f(e,r,t,n,i){for(;;){var o=t;if(o>=n)return i;var a=e[o],u=r[o];if(a>u)return 1;if(a<u)return-1;t=o+1|0}}function d(e,r){var t=e.length,n=r.length;return t===n?f(e,r,0,t,0):t<n?f(e,r,0,t,-1):f(e,r,0,n,1)}function v(e,r){var t=e.length;if(t!==r.length)return!1;for(var n=0;;){var i=n;if(i===t)return!0;if(e[i]!==r[i])return!1;n=i+1|0}}function m(e,r){return d(e,r)>0}function p(e,r){return d(e,r)>=0}function h(e,r){return d(e,r)<0}function _(e,r){return d(e,r)<=0}t.r(r),t.d(r,{bytes_of_string:()=>s,bytes_to_string:()=>c,caml_blit_bytes:()=>u,caml_blit_string:()=>l,caml_bytes_compare:()=>d,caml_bytes_equal:()=>v,caml_bytes_greaterequal:()=>p,caml_bytes_greaterthan:()=>m,caml_bytes_lessequal:()=>_,caml_bytes_lessthan:()=>h,caml_create_bytes:()=>a,caml_fill_bytes:()=>o,get:()=>i,set:()=>n})},(e,r,t)=>{t.r(r),t.d(r,{$$Error:()=>o,caml_as_js_exn:()=>u,internalToOCamlException:()=>a});var n=t(17),i=t(16),o=i.create("Caml_js_exceptions.Error");function a(e){return i.caml_is_extension(e)?e:{RE_EXN_ID:o,_1:e}}function u(e){if(e.RE_EXN_ID===o)return n.some(e._1)}},(e,r,t)=>{function n(e,r){if(r>=e.length||r<0)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return e.charCodeAt(r)}function i(e,r){return String.fromCharCode(r).repeat(e)}t.r(r),t.d(r,{get:()=>n,make:()=>i})},(e,r,t)=>{t.r(r),t.d(r,{entries:()=>a,fromArray:()=>l,fromList:()=>c,get:()=>i,map:()=>s,unsafeDeleteKey:()=>o,values:()=>u});var n=t(17);function i(e,r){if(r in e)return n.some(e[r])}var o=function(e,r){delete e[r]};function a(e){for(var r=Object.keys(e),t=r.length,n=new Array(t),i=0;i<t;++i){var o=r[i];n[i]=[o,e[o]]}return n}function u(e){for(var r=Object.keys(e),t=r.length,n=new Array(t),i=0;i<t;++i)n[i]=e[r[i]];return n}function c(e){for(var r={},t=e;;){var n=t;if(!n)return r;var i=n.hd;r[i[0]]=i[1],t=n.tl}}function l(e){for(var r={},t=e.length,n=0;n<t;++n){var i=e[n];r[i[0]]=i[1]}return r}function s(e,r){for(var t={},n=Object.keys(r),i=n.length,o=0;o<i;++o){var a=n[o];t[a]=e(r[a])}return t}},(e,r,t)=>{function n(e,r){if(0===r)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return e/r|0}function i(e,r){if(0===r)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return e%r}t.r(r),t.d(r,{div:()=>n,mod_:()=>i})},(e,r,t)=>{t.r(r),t.d(r,{checkInvariantInternal:()=>K,cmp:()=>_,cmpU:()=>h,empty:()=>{},eq:()=>E,eqU:()=>g,every:()=>N,everyU:()=>R,findFirstBy:()=>b,findFirstByU:()=>y,forEach:()=>O,forEachU:()=>w,fromArray:()=>C,get:()=>F,getExn:()=>z,getUndefined:()=>X,getWithDefault:()=>H,has:()=>p,isEmpty:()=>m,keep:()=>Z,keepU:()=>Q,keysToArray:()=>U,map:()=>ne,mapU:()=>te,mapWithKey:()=>oe,mapWithKeyU:()=>ie,maxKey:()=>L,maxKeyUndefined:()=>q,maxUndefined:()=>j,maximum:()=>B,merge:()=>G,mergeMany:()=>v,mergeU:()=>Y,minKey:()=>T,minKeyUndefined:()=>P,minUndefined:()=>J,minimum:()=>W,partition:()=>ee,partitionU:()=>$,reduce:()=>D,reduceU:()=>M,remove:()=>f,removeMany:()=>d,set:()=>u,size:()=>A,some:()=>k,someU:()=>S,split:()=>re,toArray:()=>I,toList:()=>x,update:()=>l,updateU:()=>c,valuesToArray:()=>V});var n=t(13),i=t(17),o=t(55),a=t(57);function u(e,r,t){if(void 0===e)return o.singleton(r,t);var n=e.k;if(r===n)return o.updateValue(e,t);var i=e.v;return r<n?o.bal(u(e.l,r,t),n,i,e.r):o.bal(e.l,n,i,u(e.r,r,t))}function c(e,r,t){if(void 0!==e){var n=e.k;if(r===n){var a=t(i.some(e.v));if(void 0!==a)return o.updateValue(e,i.valFromOption(a));var u=e.l,l=e.r;if(void 0===u)return l;if(void 0===l)return u;var s={contents:l.k},f={contents:l.v},d=o.removeMinAuxWithRef(l,s,f);return o.bal(u,s.contents,f.contents,d)}var v=e.v,m=e.l,p=e.r;if(r<n){var h=c(m,r,t);return m===h?e:o.bal(h,n,v,p)}var _=c(p,r,t);return p===_?e:o.bal(m,n,v,_)}var g=t(void 0);return void 0!==g?o.singleton(r,i.valFromOption(g)):e}function l(e,r,t){return c(e,r,n.__1(t))}function s(e,r){var t=e.k,n=e.l,i=e.r;if(r===t){if(void 0===n)return i;if(void 0===i)return n;var a={contents:i.k},u={contents:i.v},c=o.removeMinAuxWithRef(i,a,u);return o.bal(n,a.contents,u.contents,c)}if(r<t){if(void 0===n)return e;var l=s(n,r);return l===n?e:o.bal(l,t,e.v,i)}if(void 0===i)return e;var f=s(i,r);return o.bal(n,t,e.v,f)}function f(e,r){if(void 0!==e)return s(e,r)}function d(e,r){var t=r.length;if(void 0!==e)for(var n=e,i=0;;){var o=i;if(o>=t)return n;var a=s(n,r[o]);if(void 0===a)return a;i=o+1|0,n=a}}function v(e,r){for(var t=r.length,n=e,i=0;i<t;++i){var o=r[i];n=u(n,o[0],o[1])}return n}var m=o.isEmpty,p=a.has,h=a.cmpU,_=a.cmp,g=a.eqU,E=a.eq,y=o.findFirstByU,b=o.findFirstBy,w=o.forEachU,O=o.forEach,M=o.reduceU,D=o.reduce,R=o.everyU,N=o.every,S=o.someU,k=o.some,A=o.size,x=o.toList,I=o.toArray,C=a.fromArray,U=o.keysToArray,V=o.valuesToArray,T=o.minKey,P=o.minKeyUndefined,L=o.maxKey,q=o.maxKeyUndefined,W=o.minimum,J=o.minUndefined,B=o.maximum,j=o.maxUndefined,F=a.get,X=a.getUndefined,H=a.getWithDefault,z=a.getExn,K=o.checkInvariantInternal,Y=a.mergeU,G=a.merge,Q=o.keepSharedU,Z=o.keepShared,$=o.partitionSharedU,ee=o.partitionShared,re=a.split,te=o.mapU,ne=o.map,ie=o.mapWithKeyU,oe=o.mapWithKey},(e,r,t)=>{t.r(r),t.d(r,{bal:()=>d,balMutate:()=>De,checkInvariantInternal:()=>ne,cmp:()=>me,cmpU:()=>ve,concat:()=>X,concatOrJoin:()=>H,copy:()=>u,create:()=>c,eq:()=>he,eqU:()=>pe,every:()=>q,everyU:()=>L,fillArray:()=>ae,findFirstBy:()=>k,findFirstByU:()=>S,forEach:()=>x,forEachU:()=>A,fromArray:()=>Ne,fromSortedArrayAux:()=>fe,fromSortedArrayRevAux:()=>se,fromSortedArrayUnsafe:()=>de,get:()=>_e,getExn:()=>Ee,getUndefined:()=>ge,getWithDefault:()=>ye,has:()=>be,isEmpty:()=>R,join:()=>F,keepMap:()=>G,keepMapU:()=>Y,keepShared:()=>K,keepSharedU:()=>z,keysToArray:()=>ce,lengthNode:()=>$,map:()=>C,mapU:()=>I,mapWithKey:()=>V,mapWithKeyU:()=>U,maxKey:()=>_,maxKeyUndefined:()=>g,maxUndefined:()=>M,maximum:()=>O,minKey:()=>m,minKeyUndefined:()=>p,minUndefined:()=>b,minimum:()=>y,partitionShared:()=>Z,partitionSharedU:()=>Q,reduce:()=>P,reduceU:()=>T,removeMinAuxWithRef:()=>D,removeMinAuxWithRootMutate:()=>Se,singleton:()=>l,size:()=>ee,some:()=>J,someU:()=>W,stackAllLeft:()=>N,toArray:()=>ue,toList:()=>te,updateMutate:()=>Re,updateValue:()=>f,valuesToArray:()=>le});var n=t(13),i=t(17),o=t(56);function a(e){return void 0!==e?e.h:0}function u(e){return void 0!==e?{k:e.k,v:e.v,h:e.h,l:u(e.l),r:u(e.r)}:e}function c(e,r,t,n){var i=a(e),o=a(n);return{k:r,v:t,h:i>=o?i+1|0:o+1|0,l:e,r:n}}function l(e,r){return{k:e,v:r,h:1,l:void 0,r:void 0}}function s(e,r){return void 0===r||void 0!==e&&e.h>=r.h}function f(e,r){return e.v===r?e:{k:e.k,v:r,h:e.h,l:e.l,r:e.r}}function d(e,r,t,n){var i=void 0!==e?e.h:0,o=void 0!==n?n.h:0;if(i>(o+2|0)){var u=e.l,l=e.r;return a(u)>=a(l)?c(u,e.k,e.v,c(l,r,t,n)):c(c(u,e.k,e.v,l.l),l.k,l.v,c(l.r,r,t,n))}if(o<=(i+2|0))return{k:r,v:t,h:i>=o?i+1|0:o+1|0,l:e,r:n};var s=n.l,f=n.r;return a(f)>=a(s)?c(c(e,r,t,s),n.k,n.v,f):c(c(e,r,t,s.l),s.k,s.v,c(s.r,n.k,n.v,f))}function v(e){for(;;){var r=e,t=r.l;if(void 0===t)return r.k;e=t}}function m(e){if(void 0!==e)return i.some(v(e))}function p(e){if(void 0!==e)return v(e)}function h(e){for(;;){var r=e,t=r.r;if(void 0===t)return r.k;e=t}}function _(e){if(void 0!==e)return i.some(h(e))}function g(e){if(void 0!==e)return h(e)}function E(e){for(;;){var r=e,t=r.l;if(void 0===t)return[r.k,r.v];e=t}}function y(e){if(void 0!==e)return E(e)}function b(e){if(void 0!==e)return E(e)}function w(e){for(;;){var r=e,t=r.r;if(void 0===t)return[r.k,r.v];e=t}}function O(e){if(void 0!==e)return w(e)}function M(e){if(void 0!==e)return w(e)}function D(e,r,t){var n=e.l;return void 0!==n?d(D(n,r,t),e.k,e.v,e.r):(r.contents=e.k,t.contents=e.v,e.r)}function R(e){return void 0===e}function N(e,r){for(;;){if(void 0===e)return r;r={hd:e,tl:r},e=e.l}}function S(e,r){if(void 0!==e){var t=S(e.l,r);if(void 0!==t)return t;var n=e.k,i=e.v;if(r(n,i))return[n,i];var o=S(e.r,r);return void 0!==o?o:void 0}}function k(e,r){return S(e,n.__2(r))}function A(e,r){for(;;){var t=e;if(void 0===t)return;A(t.l,r),r(t.k,t.v),e=t.r}}function x(e,r){return A(e,n.__2(r))}function I(e,r){if(void 0!==e){var t=I(e.l,r),n=r(e.v),i=I(e.r,r);return{k:e.k,v:n,h:e.h,l:t,r:i}}}function C(e,r){return I(e,n.__1(r))}function U(e,r){if(void 0!==e){var t=e.k,n=U(e.l,r),i=r(t,e.v),o=U(e.r,r);return{k:t,v:i,h:e.h,l:n,r:o}}}function V(e,r){return U(e,n.__2(r))}function T(e,r,t){for(;;){var n=r,i=e;if(void 0===i)return n;var o=i.k,a=i.v,u=i.l,c=i.r;r=t(T(u,n,t),o,a),e=c}}function P(e,r,t){return T(e,r,n.__3(t))}function L(e,r){for(;;){var t=e;if(void 0===t)return!0;if(!r(t.k,t.v))return!1;if(!L(t.l,r))return!1;e=t.r}}function q(e,r){return L(e,n.__2(r))}function W(e,r){for(;;){var t=e;if(void 0===t)return!1;if(r(t.k,t.v))return!0;if(W(t.l,r))return!0;e=t.r}}function J(e,r){return W(e,n.__2(r))}function B(e,r,t){return void 0!==e?d(B(e.l,r,t),e.k,e.v,e.r):l(r,t)}function j(e,r,t){return void 0!==e?d(e.l,e.k,e.v,j(e.r,r,t)):l(r,t)}function F(e,r,t,n){if(void 0===e)return B(n,r,t);if(void 0===n)return j(e,r,t);var i=e.k,o=e.v,a=e.h,u=e.l,l=e.r,s=n.k,f=n.v,v=n.h,m=n.l,p=n.r;return a>(v+2|0)?d(u,i,o,F(l,r,t,n)):v>(a+2|0)?d(F(e,r,t,m),s,f,p):c(e,r,t,n)}function X(e,r){if(void 0===e)return r;if(void 0===r)return e;var t={contents:r.k},n={contents:r.v},i=D(r,t,n);return F(e,t.contents,n.contents,i)}function H(e,r,t,n){return void 0!==t?F(e,r,i.valFromOption(t),n):X(e,n)}function z(e,r){if(void 0!==e){var t=e.k,n=e.v,i=z(e.l,r),o=r(t,n),a=z(e.r,r);return o?F(i,t,n,a):X(i,a)}}function K(e,r){return z(e,n.__2(r))}function Y(e,r){if(void 0!==e){var t=e.k,n=e.v,o=Y(e.l,r),a=r(t,n),u=Y(e.r,r);return void 0!==a?F(o,t,i.valFromOption(a),u):X(o,u)}}function G(e,r){return Y(e,n.__2(r))}function Q(e,r){if(void 0===e)return[void 0,void 0];var t=e.k,n=e.v,i=Q(e.l,r),o=i[1],a=i[0],u=r(t,n),c=Q(e.r,r),l=c[1],s=c[0];return u?[F(a,t,n,s),X(o,l)]:[X(a,s),F(o,t,n,l)]}function Z(e,r){return Q(e,n.__2(r))}function $(e){var r=e.l,t=e.r;return(1+(void 0!==r?$(r):0)|0)+(void 0!==t?$(t):0)|0}function ee(e){return void 0!==e?$(e):0}function re(e,r){for(;;){var t=r,n=e;if(void 0===n)return t;var i=n.k,o=n.v,a=n.l;r={hd:[i,o],tl:re(n.r,t)},e=a}}function te(e){return re(e,0)}function ne(e){for(;;){var r=e;if(void 0===r)return;var t=r.l,n=r.r,i=a(t)-a(n)|0;if(!(i<=2&&i>=-2))throw{RE_EXN_ID:"Assert_failure",_1:["belt_internalAVLtree.ml",373,4],Error:new Error};ne(t),e=n}}function ie(e,r,t){for(;;){var n=r,i=e,o=i.k,a=i.l,u=i.r,c=void 0!==a?ie(a,n,t):n;t[c]=o;var l=c+1|0;if(void 0===u)return l;r=l,e=u}}function oe(e,r,t){for(;;){var n=r,i=e,o=i.l,a=i.r,u=void 0!==o?oe(o,n,t):n;t[u]=i.v;var c=u+1|0;if(void 0===a)return c;r=c,e=a}}function ae(e,r,t){for(;;){var n=r,i=e,o=i.l,a=i.k,u=i.r,c=void 0!==o?ae(o,n,t):n;t[c]=[a,i.v];var l=c+1|0;if(void 0===u)return l;r=l,e=u}}function ue(e){if(void 0===e)return[];var r=$(e),t=new Array(r);return ae(e,0,t),t}function ce(e){if(void 0===e)return[];var r=$(e),t=new Array(r);return ie(e,0,t),t}function le(e){if(void 0===e)return[];var r=$(e),t=new Array(r);return oe(e,0,t),t}function se(e,r,t){switch(t){case 0:return;case 1:var n=e[r];return l(n[0],n[1]);case 2:var i=e[r],o=e[r-1|0],a=i;return{k:o[0],v:o[1],h:2,l:l(a[0],a[1]),r:void 0};case 3:var u=e[r],s=e[r-1|0],f=e[r-2|0],d=s,v=u;return{k:d[0],v:d[1],h:2,l:l(v[0],v[1]),r:l(f[0],f[1])};default:var m=t/2|0,p=se(e,r,m),h=e[r-m|0],_=se(e,(r-m|0)-1|0,(t-m|0)-1|0);return c(p,h[0],h[1],_)}}function fe(e,r,t){switch(t){case 0:return;case 1:var n=e[r];return l(n[0],n[1]);case 2:var i=e[r],o=e[r+1|0],a=i;return{k:o[0],v:o[1],h:2,l:l(a[0],a[1]),r:void 0};case 3:var u=e[r],s=e[r+1|0],f=e[r+2|0],d=s,v=u;return{k:d[0],v:d[1],h:2,l:l(v[0],v[1]),r:l(f[0],f[1])};default:var m=t/2|0,p=fe(e,r,m),h=e[r+m|0],_=fe(e,1+(r+m|0)|0,(t-m|0)-1|0);return c(p,h[0],h[1],_)}}function de(e){return fe(e,0,e.length)}function ve(e,r,t,n){var i=ee(e),o=ee(r);if(i!==o)return i<o?-1:1;for(var a=N(e,0),u=N(r,0);;){var c=u,l=a;if(!l)return 0;if(!c)return 0;var s=c.hd,f=l.hd,d=t(f.k,s.k);if(0!==d)return d;var v=n(f.v,s.v);if(0!==v)return v;u=N(s.r,c.tl),a=N(f.r,l.tl)}}function me(e,r,t,i){return ve(e,r,t,n.__2(i))}function pe(e,r,t,n){if(ee(e)!==ee(r))return!1;for(var i=N(e,0),o=N(r,0);;){var a=o,u=i;if(!u)return!0;if(!a)return!0;var c=a.hd,l=u.hd;if(0!==t(l.k,c.k)||!n(l.v,c.v))return!1;o=N(c.r,a.tl),i=N(l.r,u.tl)}}function he(e,r,t,i){return pe(e,r,t,n.__2(i))}function _e(e,r,t){for(;;){var n=e;if(void 0===n)return;var o=t(r,n.k);if(0===o)return i.some(n.v);e=o<0?n.l:n.r}}function ge(e,r,t){for(;;){var n=e;if(void 0===n)return;var i=t(r,n.k);if(0===i)return n.v;e=i<0?n.l:n.r}}function Ee(e,r,t){for(;;){var n=e;if(void 0===n)throw{RE_EXN_ID:"Not_found",Error:new Error};var i=t(r,n.k);if(0===i)return n.v;e=i<0?n.l:n.r}}function ye(e,r,t,n){for(;;){var i=e;if(void 0===i)return t;var o=n(r,i.k);if(0===o)return i.v;e=o<0?i.l:i.r}}function be(e,r,t){for(;;){var n=e;if(void 0===n)return!1;var i=t(r,n.k);if(0===i)return!0;e=i<0?n.l:n.r}}function we(e){var r=e.l;e.l=r.r,r.r=e;var t=a(e.l),n=a(e.r);e.h=(t>n?t:n)+1|0;var i=a(r.l),o=e.h;return r.h=(i>o?i:o)+1|0,r}function Oe(e){var r=e.r;e.r=r.l,r.l=e;var t=a(e.l),n=a(e.r);e.h=(t>n?t:n)+1|0;var i=a(r.r),o=e.h;return r.h=(i>o?i:o)+1|0,r}function Me(e){var r=a(e.l),t=a(e.r);return e.h=(r>t?r:t)+1|0,e}function De(e){var r,t,n=e.l,i=e.r,o=a(n),u=a(i);if(o>(2+u|0))return s(n.l,n.r)?Me(we(e)):Me((t=Oe((r=e).l),r.l=t,we(r)));if(u>(2+o|0)){var c=i.l;return s(i.r,c)?Me(Oe(e)):Me(function(e){var r=we(e.r);return e.r=r,Oe(e)}(e))}return e.h=(o>u?o:u)+1|0,e}function Re(e,r,t,n){if(void 0===e)return l(r,t);var i=n(r,e.k);if(0===i)return e.v=t,e;var o=e.l,a=e.r;if(i<0){var u=Re(o,r,t,n);e.l=u}else e.r=Re(a,r,t,n);return De(e)}function Ne(e,r){var t=e.length;if(0!==t){var n,i=o.strictlySortedLengthU(e,(function(e,t){return r(e[0],t[0])<0}));n=i>=0?fe(e,0,i):se(e,(i=0|-i)-1|0,i);for(var a=i;a<t;++a){var u=e[a];n=Re(n,u[0],u[1],r)}return n}}function Se(e,r){var t=r.r,n=r.l;return void 0!==n?(r.l=Se(e,n),De(r)):(e.k=r.k,e.v=r.v,t)}},(e,r,t)=>{t.r(r),t.d(r,{$$String:()=>{},Int:()=>{},binarySearchBy:()=>O,binarySearchByU:()=>w,diff:()=>p,diffU:()=>m,intersect:()=>v,intersectU:()=>d,isSorted:()=>c,isSortedU:()=>u,stableSortBy:()=>b,stableSortByU:()=>y,stableSortInPlaceBy:()=>E,stableSortInPlaceByU:()=>g,strictlySortedLength:()=>a,strictlySortedLengthU:()=>o,union:()=>f,unionU:()=>s});var n=t(13),i=t(26);function o(e,r){var t=e.length;if(0===t||1===t)return t;var n=e[0],i=e[1];if(!r(n,i))return r(i,n)?0|-function(e,r,t,n,i){for(;;){var o=t,a=r;if(o>=n)return o;var u=e[o];if(!i(u,a))return o;t=o+1|0,r=u}}(e,i,2,t,r):1;for(var o=i,a=2;;){var u=a,c=o;if(u>=t)return u;var l=e[u];if(!r(c,l))return u;a=u+1|0,o=l}}function a(e,r){return o(e,n.__2(r))}function u(e,r){var t=e.length;if(0===t)return!0;for(var n=0,i=t-1|0;;){var o=n;if(o===i)return!0;if(r(e[o],e[o+1|0])>0)return!1;n=o+1|0}}function c(e,r){return u(e,n.__2(r))}function l(e,r,t,n,o,a,u,c,l){for(var s=r+t|0,f=o+a|0,d=r,v=e[r],m=o,p=n[o],h=c;;){var _=h,g=p,E=m,y=v,b=d;if(l(y,g)<=0){u[_]=y;var w=b+1|0;if(w>=s)return i.blitUnsafe(n,E,u,_+1|0,f-E|0);h=_+1|0,v=e[w],d=w}else{u[_]=g;var O=E+1|0;if(O>=f)return i.blitUnsafe(e,b,u,_+1|0,s-b|0);h=_+1|0,p=n[O],m=O}}}function s(e,r,t,n,o,a,u,c,l){for(var s=r+t|0,f=o+a|0,d=r,v=e[r],m=o,p=n[o],h=c;;){var _=h,g=p,E=m,y=v,b=d,w=l(y,g);if(w<0){u[_]=y;var O=b+1|0,M=_+1|0;if(O<s){h=M,v=e[O],d=O;continue}return i.blitUnsafe(n,E,u,M,f-E|0),(M+f|0)-E|0}if(0!==w){u[_]=g;var D=E+1|0,R=_+1|0;if(!(D<f))return i.blitUnsafe(e,b,u,R,s-b|0),(R+s|0)-b|0;h=R,p=n[D],m=D}else{u[_]=y;var N=b+1|0,S=E+1|0,k=_+1|0;if(!(N<s&&S<f))return N===s?(i.blitUnsafe(n,S,u,k,f-S|0),(k+f|0)-S|0):(i.blitUnsafe(e,N,u,k,s-N|0),(k+s|0)-N|0);h=k,p=n[S],m=S,v=e[N],d=N}}}function f(e,r,t,i,o,a,u,c,l){return s(e,r,t,i,o,a,u,c,n.__2(l))}function d(e,r,t,n,i,o,a,u,c){for(var l=r+t|0,s=i+o|0,f=r,d=e[r],v=i,m=n[i],p=u;;){var h=p,_=v,g=d,E=f,y=c(g,m);if(y<0){var b=E+1|0;if(b>=l)return h;d=e[b],f=b}else if(0!==y){var w=_+1|0;if(w>=s)return h;m=n[w],v=w}else{a[h]=g;var O=E+1|0,M=_+1|0,D=h+1|0;if(!(O<l&&M<s))return D;p=D,m=n[M],v=M,d=e[O],f=O}}}function v(e,r,t,i,o,a,u,c,l){return d(e,r,t,i,o,a,u,c,n.__2(l))}function m(e,r,t,n,o,a,u,c,l){for(var s=r+t|0,f=o+a|0,d=r,v=e[r],m=o,p=n[o],h=c;;){var _=h,g=m,E=v,y=d,b=l(E,p);if(b<0){u[_]=E;var w=_+1|0,O=y+1|0;if(O>=s)return w;h=w,v=e[O],d=O}else if(0!==b){var M=g+1|0;if(!(M<f))return i.blitUnsafe(e,y,u,_,s-y|0),(_+s|0)-y|0;p=n[M],m=M}else{var D=y+1|0,R=g+1|0;if(!(D<s&&R<f))return D===s?_:(i.blitUnsafe(e,D,u,_,s-D|0),(_+s|0)-D|0);p=n[R],m=R,v=e[D],d=D}}}function p(e,r,t,i,o,a,u,c,l){return m(e,r,t,i,o,a,u,c,n.__2(l))}function h(e,r,t,n,i,o){for(var a=0;a<i;++a){for(var u=e[r+a|0],c=(n+a|0)-1|0;c>=n&&o(t[c],u)>0;)t[c+1|0]=t[c],c=c-1|0;t[c+1|0]=u}}function _(e,r,t,n,i,o){if(i<=5)return h(e,r,t,n,i,o);var a=i/2|0,u=i-a|0;return _(e,r+a|0,t,n+a|0,u,o),_(e,r,e,r+u|0,a,o),l(e,r+u|0,a,t,n+a|0,u,t,n,o)}function g(e,r){var t=e.length;if(t<=5)return h(e,0,e,0,t,r);var n=t/2|0,i=t-n|0,o=new Array(i);return _(e,n,o,0,i,r),_(e,0,e,i,n,r),l(e,i,n,o,0,i,e,0,r)}function E(e,r){return g(e,n.__2(r))}function y(e,r){var t=e.slice(0);return g(t,r),t}function b(e,r){return y(e,n.__2(r))}function w(e,r,t){var n=e.length;if(0===n)return-1;if(t(r,e[0])<0)return-1;if(t(r,e[n-1|0])>0)return 0|-(n+1|0);for(var i=0,o=n-1|0;;){var a=o,u=i,c=(u+a|0)/2|0,l=t(r,e[c]);if(0===l)return c;if(l<0){if(a===c)return 0===t(e[u],r)?u:0|-(a+1|0);o=c}else{if(u===c)return 0===t(e[a],r)?a:0|-(a+1|0);i=c}}}function O(e,r,t){return w(e,r,n.__2(t))}},(e,r,t)=>{t.r(r),t.d(r,{A:()=>{},N:()=>{},S:()=>{},add:()=>c,addMutate:()=>D,cmp:()=>b,cmpU:()=>y,compareAux:()=>E,eq:()=>M,eqAux:()=>w,eqU:()=>O,fromArray:()=>R,get:()=>l,getExn:()=>f,getUndefined:()=>s,getWithDefault:()=>d,has:()=>v,merge:()=>g,mergeU:()=>_,remove:()=>m,split:()=>h,splitAux:()=>p});var n=t(27),i=t(13),o=t(17),a=t(56),u=t(55);function c(e,r,t){if(void 0===e)return u.singleton(r,t);var n=e.k;if(r===n)return u.updateValue(e,t);var i=e.v;return r<n?u.bal(c(e.l,r,t),n,i,e.r):u.bal(e.l,n,i,c(e.r,r,t))}function l(e,r){for(;;){var t=e;if(void 0===t)return;var n=t.k;if(r===n)return o.some(t.v);e=r<n?t.l:t.r}}function s(e,r){for(;;){var t=e;if(void 0===t)return;var n=t.k;if(r===n)return t.v;e=r<n?t.l:t.r}}function f(e,r){for(;;){var t=e;if(void 0===t)throw{RE_EXN_ID:"Not_found",Error:new Error};var n=t.k;if(r===n)return t.v;e=r<n?t.l:t.r}}function d(e,r,t){for(;;){var n=e;if(void 0===n)return t;var i=n.k;if(r===i)return n.v;e=r<i?n.l:n.r}}function v(e,r){for(;;){var t=e;if(void 0===t)return!1;var n=t.k;if(r===n)return!0;e=r<n?t.l:t.r}}function m(e,r){if(void 0===e)return e;var t=e.k,n=e.l,i=e.r;if(r!==t)return r<t?u.bal(m(n,r),t,e.v,i):u.bal(n,t,e.v,m(i,r));if(void 0===n)return i;if(void 0===i)return n;var o={contents:i.k},a={contents:i.v},c=u.removeMinAuxWithRef(i,o,a);return u.bal(n,o.contents,a.contents,c)}function p(e,r){var t=r.k,n=r.v,i=r.l,a=r.r;if(e===t)return[i,o.some(n),a];if(e<t){if(void 0===i)return[void 0,void 0,r];var c=p(e,i);return[c[0],c[1],u.join(c[2],t,n,a)]}if(void 0===a)return[r,void 0,void 0];var l=p(e,a);return[u.join(i,t,n,l[0]),l[1],l[2]]}function h(e,r){return void 0!==r?p(e,r):[void 0,void 0,void 0]}function _(e,r,t){if(void 0!==e){if(e.h>=(void 0!==r?r.h:0)){var n=e.k,i=e.v,a=e.l,c=e.r,l=h(n,r);return u.concatOrJoin(_(a,l[0],t),n,t(n,o.some(i),l[1]),_(c,l[2],t))}}else if(void 0===r)return;var s=r.k,f=r.v,d=r.l,v=r.r,m=h(s,e);return u.concatOrJoin(_(m[0],d,t),s,t(s,m[1],o.some(f)),_(m[2],v,t))}function g(e,r,t){return _(e,r,i.__3(t))}function E(e,r,t){for(;;){var i=r,o=e;if(!o)return 0;if(!i)return 0;var a=i.hd,c=o.hd,l=n.caml_string_compare(c.k,a.k);if(0!==l)return l;var s=t(c.v,a.v);if(0!==s)return s;r=u.stackAllLeft(a.r,i.tl),e=u.stackAllLeft(c.r,o.tl)}}function y(e,r,t){var n=u.size(e),i=u.size(r);return n===i?E(u.stackAllLeft(e,0),u.stackAllLeft(r,0),t):n<i?-1:1}function b(e,r,t){return y(e,r,i.__2(t))}function w(e,r,t){for(;;){var n=r,i=e;if(!i)return!0;if(!n)return!0;var o=n.hd,a=i.hd;if(a.k!==o.k||!t(a.v,o.v))return!1;r=u.stackAllLeft(o.r,n.tl),e=u.stackAllLeft(a.r,i.tl)}}function O(e,r,t){return u.size(e)===u.size(r)&&w(u.stackAllLeft(e,0),u.stackAllLeft(r,0),t)}function M(e,r,t){return O(e,r,i.__2(t))}function D(e,r,t){if(void 0===e)return u.singleton(r,t);var n=e.k;if(r===n)return e.k=r,e.v=t,e;var i=e.l,o=e.r;if(r<n){var a=D(i,r,t);e.l=a}else e.r=D(o,r,t);return u.balMutate(e)}function R(e){var r=e.length;if(0!==r){var t,n=a.strictlySortedLengthU(e,(function(e,r){return e[0]<r[0]}));n>=0?t=u.fromSortedArrayAux(e,0,n):(n=0|-n,t=u.fromSortedArrayRevAux(e,n-1|0,n));for(var i=n;i<r;++i){var o=e[i];t=D(t,o[0],o[1])}return t}}},(e,r,t)=>{t.r(r),t.d(r,{$$Error:()=>d,anyToExnInternal:()=>i,raiseError:()=>o,raiseEvalError:()=>a,raiseRangeError:()=>u,raiseReferenceError:()=>c,raiseSyntaxError:()=>l,raiseTypeError:()=>s,raiseUriError:()=>f});var n=t(50),i=n.internalToOCamlException;function o(e){throw new Error(e)}function a(e){throw new EvalError(e)}function u(e){throw new RangeError(e)}function c(e){throw new ReferenceError(e)}function l(e){throw new SyntaxError(e)}function s(e){throw new TypeError(e)}function f(e){throw new URIError(e)}var d=n.$$Error},(e,r,t)=>{t.r(r),t.d(r,{React:()=>{},ReactDOMRe:()=>{},Settings:()=>f,showSettings:()=>d,style:()=>l});var n=t(13),i=t(22),o=t(25),a=t(10),u=t(30),c=t(17),l=t(31);function s(e){var r=e.onSubmit,t=function(e){var r=e.name,t=e.title,n=e.props,o=Object.assign(n,{name:r});return i.DOMRe.createDOMElementVariadic("div",{className:l.settingsEntry},[i.DOMRe.createDOMElementVariadic("label",{htmlFor:r},[t]),i.DOMRe.createDOMElementVariadic("input",c.some(o),[])])},s=function(e){var r=e.title,t=e.content;return i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,[r]),t])},f={},d={title:"小写字母、数字、下划线",pattern:"^[a-z][a-z0-9_]*$",required:!0,type:"text",onChange:function(e){var r=e.target.value;f.username=r}},v=a.Username.get(void 0);void 0!==v&&(d.value=c.valFromOption(v));var m={required:!0,type:"url",onChange:function(e){var r=e.target.value;f.server=r}},p=a.Server.get(void 0);void 0!==p&&(m.value=c.valFromOption(p));var h={type:"checkbox",onChange:function(e){var r=e.target.checked;f.syncAnswers=r}},_=a.SyncAnswers.get(void 0);void 0!==_&&(h.checked=c.valFromOption(_));var g={type:"checkbox",onChange:function(e){var r=e.target.checked;f.sortProblems=r}},E=a.SortProblems.get(void 0);void 0!==E&&(g.checked=c.valFromOption(E));var y={type:"checkbox",onChange:function(e){var r=e.target.checked;f.noLeaveCheck=r}},b=a.NoLeaveCheck.get(void 0);return void 0!==b&&(y.checked=c.valFromOption(b)),i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("form",{className:l.settings,onSubmit:function(e){return e.preventDefault(),u.forEach(c.undefined_to_opt(f.username),a.Username.set),u.forEach(c.undefined_to_opt(f.server),a.Server.set),u.forEach(c.undefined_to_opt(f.syncAnswers),a.SyncAnswers.set),u.forEach(c.undefined_to_opt(f.noLeaveCheck),a.NoLeaveCheck.set),u.forEach(c.undefined_to_opt(f.sortProblems),a.SortProblems.set),n._1(r,void 0)}},[i.createElement(t,{name:"username",title:"用户名",props:d}),i.createElement(t,{name:"server",title:"服务器",props:m}),i.createElement(t,{name:"sync_answers",title:"同步答案",props:h}),i.createElement(t,{name:"sort_problems",title:"排序题目",props:g}),i.createElement(t,{name:"no_leave_check",title:"拦截切屏检测",props:y}),i.DOMRe.createDOMElementVariadic("div",{className:l.settingsSubmit},[i.DOMRe.createDOMElementVariadic("p",{className:l.settingsSubmitTip},[i.DOMRe.createDOMElementVariadic("i",void 0,["*更改设置后请刷新页面"])]),i.DOMRe.createDOMElementVariadic("button",{type:"submit"},["提交"])])]),i.DOMRe.createDOMElementVariadic("div",{className:l.about},[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,["功能特性："])]),i.createElementVariadic(o.UList.make,{children:null},[i.createElement(s,{title:"同步答案：",content:"点击题目显示详细答案，在选项/填空处悬停显示简略答案"}),i.createElement(s,{title:"排序题目：",content:"根据 ID 对题目和选项进行重新排序"}),i.createElement(s,{title:"拦截切屏检测：",content:"随意切换页面、窗口不会被发现"}),i.createElement(s,{title:"拦截上传截图：",content:"仅当用户确认后，才会上传截图"}),i.createElement(s,{title:"拦截异常状态：",content:"即使本地显示异常也不会推送到服务器"})])])])}var f={make:s};function d(e){var r=o.openWin("设置",300,400,void 0,void 0,void 0),t=r[0];r[1].appendChild(u.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:l.mainBody},[i.createElement(s,{onSubmit:function(e){t.close()}})]))))}},(e,r,t)=>{t.r(r),t.d(r,{checkInvariantInternal:()=>K,cmp:()=>_,cmpU:()=>h,empty:()=>{},eq:()=>E,eqU:()=>g,every:()=>N,everyU:()=>R,findFirstBy:()=>b,findFirstByU:()=>y,forEach:()=>O,forEachU:()=>w,fromArray:()=>C,get:()=>F,getExn:()=>z,getUndefined:()=>X,getWithDefault:()=>H,has:()=>p,isEmpty:()=>m,keep:()=>Z,keepU:()=>Q,keysToArray:()=>U,map:()=>ne,mapU:()=>te,mapWithKey:()=>oe,mapWithKeyU:()=>ie,maxKey:()=>L,maxKeyUndefined:()=>q,maxUndefined:()=>j,maximum:()=>B,merge:()=>G,mergeMany:()=>v,mergeU:()=>Y,minKey:()=>T,minKeyUndefined:()=>P,minUndefined:()=>J,minimum:()=>W,partition:()=>ee,partitionU:()=>$,reduce:()=>D,reduceU:()=>M,remove:()=>f,removeMany:()=>d,set:()=>u,size:()=>A,some:()=>k,someU:()=>S,split:()=>re,toArray:()=>I,toList:()=>x,update:()=>l,updateU:()=>c,valuesToArray:()=>V});var n=t(13),i=t(17),o=t(61),a=t(55);function u(e,r,t){if(void 0===e)return a.singleton(r,t);var n=e.k;if(r===n)return a.updateValue(e,t);var i=e.v;return r<n?a.bal(u(e.l,r,t),n,i,e.r):a.bal(e.l,n,i,u(e.r,r,t))}function c(e,r,t){if(void 0!==e){var n=e.k;if(r===n){var o=t(i.some(e.v));if(void 0!==o)return a.updateValue(e,i.valFromOption(o));var u=e.l,l=e.r;if(void 0===u)return l;if(void 0===l)return u;var s={contents:l.k},f={contents:l.v},d=a.removeMinAuxWithRef(l,s,f);return a.bal(u,s.contents,f.contents,d)}var v=e.v,m=e.l,p=e.r;if(r<n){var h=c(m,r,t);return m===h?e:a.bal(h,n,v,p)}var _=c(p,r,t);return p===_?e:a.bal(m,n,v,_)}var g=t(void 0);return void 0!==g?a.singleton(r,i.valFromOption(g)):e}function l(e,r,t){return c(e,r,n.__1(t))}function s(e,r){var t=e.k,n=e.l,i=e.r;if(r===t){if(void 0===n)return i;if(void 0===i)return n;var o={contents:i.k},u={contents:i.v},c=a.removeMinAuxWithRef(i,o,u);return a.bal(n,o.contents,u.contents,c)}if(r<t){if(void 0===n)return e;var l=s(n,r);return l===n?e:a.bal(l,t,e.v,i)}if(void 0===i)return e;var f=s(i,r);return a.bal(n,t,e.v,f)}function f(e,r){if(void 0!==e)return s(e,r)}function d(e,r){var t=r.length;if(void 0!==e)for(var n=e,i=0;;){var o=i;if(o>=t)return n;var a=s(n,r[o]);if(void 0===a)return a;i=o+1|0,n=a}}function v(e,r){for(var t=r.length,n=e,i=0;i<t;++i){var o=r[i];n=u(n,o[0],o[1])}return n}var m=a.isEmpty,p=o.has,h=o.cmpU,_=o.cmp,g=o.eqU,E=o.eq,y=a.findFirstByU,b=a.findFirstBy,w=a.forEachU,O=a.forEach,M=a.reduceU,D=a.reduce,R=a.everyU,N=a.every,S=a.someU,k=a.some,A=a.size,x=a.toList,I=a.toArray,C=o.fromArray,U=a.keysToArray,V=a.valuesToArray,T=a.minKey,P=a.minKeyUndefined,L=a.maxKey,q=a.maxKeyUndefined,W=a.minimum,J=a.minUndefined,B=a.maximum,j=a.maxUndefined,F=o.get,X=o.getUndefined,H=o.getWithDefault,z=o.getExn,K=a.checkInvariantInternal,Y=o.mergeU,G=o.merge,Q=a.keepSharedU,Z=a.keepShared,$=a.partitionSharedU,ee=a.partitionShared,re=o.split,te=a.mapU,ne=a.map,ie=a.mapWithKeyU,oe=a.mapWithKey},(e,r,t)=>{t.r(r),t.d(r,{A:()=>{},N:()=>{},S:()=>{},add:()=>c,addMutate:()=>D,cmp:()=>b,cmpU:()=>y,compareAux:()=>E,eq:()=>M,eqAux:()=>w,eqU:()=>O,fromArray:()=>R,get:()=>l,getExn:()=>f,getUndefined:()=>s,getWithDefault:()=>d,has:()=>v,merge:()=>g,mergeU:()=>_,remove:()=>m,split:()=>h,splitAux:()=>p});var n=t(27),i=t(13),o=t(17),a=t(56),u=t(55);function c(e,r,t){if(void 0===e)return u.singleton(r,t);var n=e.k;if(r===n)return u.updateValue(e,t);var i=e.v;return r<n?u.bal(c(e.l,r,t),n,i,e.r):u.bal(e.l,n,i,c(e.r,r,t))}function l(e,r){for(;;){var t=e;if(void 0===t)return;var n=t.k;if(r===n)return o.some(t.v);e=r<n?t.l:t.r}}function s(e,r){for(;;){var t=e;if(void 0===t)return;var n=t.k;if(r===n)return t.v;e=r<n?t.l:t.r}}function f(e,r){for(;;){var t=e;if(void 0===t)throw{RE_EXN_ID:"Not_found",Error:new Error};var n=t.k;if(r===n)return t.v;e=r<n?t.l:t.r}}function d(e,r,t){for(;;){var n=e;if(void 0===n)return t;var i=n.k;if(r===i)return n.v;e=r<i?n.l:n.r}}function v(e,r){for(;;){var t=e;if(void 0===t)return!1;var n=t.k;if(r===n)return!0;e=r<n?t.l:t.r}}function m(e,r){if(void 0===e)return e;var t=e.k,n=e.l,i=e.r;if(r!==t)return r<t?u.bal(m(n,r),t,e.v,i):u.bal(n,t,e.v,m(i,r));if(void 0===n)return i;if(void 0===i)return n;var o={contents:i.k},a={contents:i.v},c=u.removeMinAuxWithRef(i,o,a);return u.bal(n,o.contents,a.contents,c)}function p(e,r){var t=r.k,n=r.v,i=r.l,a=r.r;if(e===t)return[i,o.some(n),a];if(e<t){if(void 0===i)return[void 0,void 0,r];var c=p(e,i);return[c[0],c[1],u.join(c[2],t,n,a)]}if(void 0===a)return[r,void 0,void 0];var l=p(e,a);return[u.join(i,t,n,l[0]),l[1],l[2]]}function h(e,r){return void 0!==r?p(e,r):[void 0,void 0,void 0]}function _(e,r,t){if(void 0!==e){if(e.h>=(void 0!==r?r.h:0)){var n=e.k,i=e.v,a=e.l,c=e.r,l=h(n,r);return u.concatOrJoin(_(a,l[0],t),n,t(n,o.some(i),l[1]),_(c,l[2],t))}}else if(void 0===r)return;var s=r.k,f=r.v,d=r.l,v=r.r,m=h(s,e);return u.concatOrJoin(_(m[0],d,t),s,t(s,m[1],o.some(f)),_(m[2],v,t))}function g(e,r,t){return _(e,r,i.__3(t))}function E(e,r,t){for(;;){var i=r,o=e;if(!o)return 0;if(!i)return 0;var a=i.hd,c=o.hd,l=n.caml_int_compare(c.k,a.k);if(0!==l)return l;var s=t(c.v,a.v);if(0!==s)return s;r=u.stackAllLeft(a.r,i.tl),e=u.stackAllLeft(c.r,o.tl)}}function y(e,r,t){var n=u.size(e),i=u.size(r);return n===i?E(u.stackAllLeft(e,0),u.stackAllLeft(r,0),t):n<i?-1:1}function b(e,r,t){return y(e,r,i.__2(t))}function w(e,r,t){for(;;){var n=r,i=e;if(!i)return!0;if(!n)return!0;var o=n.hd,a=i.hd;if(a.k!==o.k||!t(a.v,o.v))return!1;r=u.stackAllLeft(o.r,n.tl),e=u.stackAllLeft(a.r,i.tl)}}function O(e,r,t){return u.size(e)===u.size(r)&&w(u.stackAllLeft(e,0),u.stackAllLeft(r,0),t)}function M(e,r,t){return O(e,r,i.__2(t))}function D(e,r,t){if(void 0===e)return u.singleton(r,t);var n=e.k;if(r===n)return e.k=r,e.v=t,e;var i=e.l,o=e.r;if(r<n){var a=D(i,r,t);e.l=a}else e.r=D(o,r,t);return u.balMutate(e)}function R(e){var r=e.length;if(0!==r){var t,n=a.strictlySortedLengthU(e,(function(e,r){return e[0]<r[0]}));n>=0?t=u.fromSortedArrayAux(e,0,n):(n=0|-n,t=u.fromSortedArrayRevAux(e,n-1|0,n));for(var i=n;i<r;++i){var o=e[i];t=D(t,o[0],o[1])}return t}}},(e,r,t)=>{t.r(r),t.d(r,{Impl:()=>c,asHtmlElement:()=>h,contentEditable:()=>f,dir:()=>v,insertAdjacentElement:()=>g,insertAdjacentHTML:()=>E,insertAdjacentText:()=>y,nodeType:()=>p,ofElement:()=>b,ofNode:()=>_,setContentEditable:()=>d,setDir:()=>m});var n=t(35),i=t(36),o=t(34),a=t(37),u=t(41);function c(e){return{ofElement:o.asHtmlElement,contentEditable:function(e){return i.decodeContentEditable(e.contentEditable)},setContentEditable:function(e,r){e.contentEditable=i.encodeContentEditable(r)},dir:function(e){return i.decodeDir(e.dir)},setDir:function(e,r){e.dir=i.encodeDir(r)}}}var l=n.Impl({});a.Impl({}),u.Impl({});var s=o.Impl({});function f(e){return i.decodeContentEditable(e.contentEditable)}function d(e,r){e.contentEditable=i.encodeContentEditable(r)}function v(e){return i.decodeDir(e.dir)}function m(e,r){e.dir=i.encodeDir(r)}var p=l.nodeType,h=s.asHtmlElement,_=s.ofNode,g=s.insertAdjacentElement,E=s.insertAdjacentHTML,y=s.insertAdjacentText,b=o.asHtmlElement}],r={};function t(n){var i=r[n];if(void 0!==i)return i.exports;var o=r[n]={id:n,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.exports}t.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{t.r(n);var e=t(1),r=t(18),i=t(19),o=t(20),a=t(8),u=t(9),c=t(11),l=function(e,r,t,n){return new(t||(t=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(a,u)}c((n=n.apply(e,r||[])).next())}))};function s(e){return e.forEach((e=>{switch(e.ProblemType){case i.ProblemType.SingleChoice:case i.ProblemType.MultipleChoice:case i.ProblemType.Polling:e.Options.sort(((e,r)=>e.key<r.key?-1:1));break}})),e.sort(((e,r)=>e.ProblemID-r.ProblemID)),e}(function(){return l(this,void 0,void 0,(function*(){(0,c.migrate)(),!0===u.NO_LEAVE_CHECK.value&&(document.addEventListener("visibilitychange",(e=>{e.preventDefault(),e.stopImmediatePropagation()}),!0),window.addEventListener("visibilitychange",(e=>{e.preventDefault(),e.stopImmediatePropagation()}),!0)),(0,r.hookXHR)((function(r){switch(r.pathname){case"/exam_room/show_paper":this.addEventListener("readystatechange",(()=>{if(this.readyState==XMLHttpRequest.DONE){const r=JSON.stringify((e=JSON.parse(this.responseText),!0===u.SORT_PROBLEMS.value&&(!0===e.data.has_problem_dict?e.data.problems=e.data.problems.sort(((e,r)=>e.id-r.id)).map((e=>(e.problems=s(e.problems),e))):e.data.problems=s(e.data.problems)),e));Object.defineProperties(this,{responseText:{get:()=>r}})}var e})),this.addEventListener("load",(()=>{const t=JSON.parse(this.responseText);(0,a.devLog)("intercept paper",t);let n=[];!0===t.data.has_problem_dict?t.data.problems.forEach((e=>{n=n.concat(e.problems)})):n=t.data.problems;const i=new o.UI(n);e.CLIENT.onmessage((e=>{e.forEach((e=>i.updateAnswer(e))),i.updateUI()}));const u=parseInt(r.searchParams.get("exam_id"));e.CLIENT.login(u,{title:t.data.title,problems:n}),fetch((0,a.newURL)("/exam_room/cache_results",{exam_id:u.toString()}).toString()).then((e=>e.json())).then((r=>r.data.results.forEach((({problem_id:r,result:t})=>e.CLIENT.updateAnswer(r,t))))).catch(a.devLog)}));break;case"/exam_room/answer_problem":return r=>l(this,void 0,void 0,(function*(){var t;if("string"==typeof r){const n=JSON.parse(r);if("action"in n)switch(n.action){case 1:case 17:break;default:return console.log("intercept action",n),new Promise((()=>{}))}else"results"in n&&((0,a.devLog)("intercept answers",n),null===(t=n.results)||void 0===t||t.forEach((({problem_id:r,result:t})=>e.CLIENT.updateAnswer(r,t))))}return r}));default:if("upload-z1.qiniup.com"===r.hostname)return e=>l(this,void 0,void 0,(function*(){return e instanceof FormData&&e.get("file")instanceof File?new Promise((r=>{const t=new FileReader;t.onload=()=>(0,o.showConfirmUpload)(t.result,(()=>r(e))),t.readAsDataURL(e.get("file"))})):e}))}})),yield e.CLIENT.watch(1e4)}))})().catch(console.error)})()})();