// ==UserScript==
// @name         yuk-client
// @version      0.6.1
// @author       doge2x
// @icon         https://www.yuketang.cn/static/images/favicon.ico
// @match        https://examination.xuetangx.com/*
// @grant        GM.xmlHttpRequest
// @grant        GM_getValue
// @grant        GM_setValue
// @run-at       document-start
// ==/UserScript==
(function(v){typeof define=="function"&&define.amd?define(v):v()})(function(){"use strict";var _a=Object.defineProperty,da=Object.defineProperties;var pa=Object.getOwnPropertyDescriptors;var Ko=Object.getOwnPropertySymbols;var va=Object.prototype.hasOwnProperty,ya=Object.prototype.propertyIsEnumerable;var kn=(v,C,k)=>C in v?_a(v,C,{enumerable:!0,configurable:!0,writable:!0,value:k}):v[C]=k,Fo=(v,C)=>{for(var k in C||(C={}))va.call(C,k)&&kn(v,k,C[k]);if(Ko)for(var k of Ko(C))ya.call(C,k)&&kn(v,k,C[k]);return v},Ho=(v,C)=>da(v,pa(C));var et=(v,C,k)=>(kn(v,typeof C!="symbol"?C+"":C,k),k);var v=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},C={},k={},ce={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createJSONRPCErrorResponse=e.JSONRPCErrorCode=e.isJSONRPCResponses=e.isJSONRPCResponse=e.isJSONRPCRequests=e.isJSONRPCRequest=e.isJSONRPCID=e.JSONRPC=void 0,e.JSONRPC="2.0";var t=function(u){return typeof u=="string"||typeof u=="number"||u===null};e.isJSONRPCID=t;var r=function(u){return u.jsonrpc===e.JSONRPC&&u.method!==void 0&&u.result===void 0&&u.error===void 0};e.isJSONRPCRequest=r;var n=function(u){return Array.isArray(u)&&u.every(e.isJSONRPCRequest)};e.isJSONRPCRequests=n;var i=function(u){return u.jsonrpc===e.JSONRPC&&u.id!==void 0&&(u.result!==void 0||u.error!==void 0)};e.isJSONRPCResponse=i;var o=function(u){return Array.isArray(u)&&u.every(e.isJSONRPCResponse)};e.isJSONRPCResponses=o,function(u){u[u.ParseError=-32700]="ParseError",u[u.InvalidRequest=-32600]="InvalidRequest",u[u.MethodNotFound=-32601]="MethodNotFound",u[u.InvalidParams=-32602]="InvalidParams",u[u.InternalError=-32603]="InternalError"}(e.JSONRPCErrorCode||(e.JSONRPCErrorCode={}));var s=function(u,f,a,c){var h={code:f,message:a};return c&&(h.data=c),{jsonrpc:e.JSONRPC,id:u,error:h}};e.createJSONRPCErrorResponse=s})(ce);var he={};Object.defineProperty(he,"__esModule",{value:!0}),he.DefaultErrorCode=void 0,he.DefaultErrorCode=0;var Yo=v&&v.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function f(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?o(c.value):i(c.value).then(u,f)}a((n=n.apply(e,t||[])).next())})},Go=v&&v.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return f([a,c])}}function f(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=a[0]&2?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[a[0]&2,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(a[0]===6&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],i=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(k,"__esModule",{value:!0}),k.JSONRPCClient=void 0;var le=ce,Er=he,Vo=function(){function e(t,r){this._send=t,this.createID=r,this.idToResolveMap=new Map,this.id=0}return e.prototype._createID=function(){return this.createID?this.createID():++this.id},e.prototype.timeout=function(t,r){var n=this;r===void 0&&(r=function(s){return(0,le.createJSONRPCErrorResponse)(s,Er.DefaultErrorCode,"Request timeout")});var i=function(s,u){var f=setTimeout(function(){s.forEach(function(a){var c=n.idToResolveMap.get(a);c&&(n.idToResolveMap.delete(a),c(r(a)))})},t);return u().then(function(a){return clearTimeout(f),a},function(a){return clearTimeout(f),Promise.reject(a)})},o=function(s,u){var f=(Array.isArray(s)?s:[s]).map(function(a){return a.id}).filter(Ln);return i(f,function(){return n.requestAdvanced(s,u)})};return{request:function(s,u,f){var a=n._createID();return i([a],function(){return n.requestWithID(s,u,f,a)})},requestAdvanced:function(s,u){return o(s,u)}}},e.prototype.request=function(t,r,n){return this.requestWithID(t,r,n,this._createID())},e.prototype.requestWithID=function(t,r,n,i){return Yo(this,void 0,void 0,function(){var o,s;return Go(this,function(u){switch(u.label){case 0:return o={jsonrpc:le.JSONRPC,method:t,params:r,id:i},[4,this.requestAdvanced(o,n)];case 1:return s=u.sent(),s.result!==void 0&&!s.error?[2,s.result]:s.result===void 0&&s.error?[2,Promise.reject(new Error(s.error.message))]:[2,Promise.reject(new Error("An unexpected error occurred"))]}})})},e.prototype.requestAdvanced=function(t,r){var n=this,i=Array.isArray(t);Array.isArray(t)||(t=[t]);var o=t.filter(function(f){return Ln(f.id)}),s=o.map(function(f){return new Promise(function(a){return n.idToResolveMap.set(f.id,a)})}),u=Promise.all(s).then(function(f){return i||!f.length?f:f[0]});return this.send(i?t:t[0],r).then(function(){return u},function(f){return o.forEach(function(a){n.receive((0,le.createJSONRPCErrorResponse)(a.id,Er.DefaultErrorCode,f&&f.message||"Failed to send a request"))}),u})},e.prototype.notify=function(t,r,n){this.send({jsonrpc:le.JSONRPC,method:t,params:r},n).then(void 0,function(){})},e.prototype.send=function(t,r){return this._send(t,r)},e.prototype.rejectAllPendingRequests=function(t){this.idToResolveMap.forEach(function(r,n){return r((0,le.createJSONRPCErrorResponse)(n,Er.DefaultErrorCode,t))}),this.idToResolveMap.clear()},e.prototype.receive=function(t){var r=this;Array.isArray(t)||(t=[t]),t.forEach(function(n){var i=r.idToResolveMap.get(n.id);i&&(r.idToResolveMap.delete(n.id),i(n))})},e}();k.JSONRPCClient=Vo;var Ln=function(e){return e!=null},We={},Ke=v&&v.__assign||function(){return Ke=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Ke.apply(this,arguments)},jn=v&&v.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function f(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?o(c.value):i(c.value).then(u,f)}a((n=n.apply(e,t||[])).next())})},Dn=v&&v.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return f([a,c])}}function f(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=a[0]&2?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[a[0]&2,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(a[0]===6&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],i=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Xo=v&&v.__spreadArray||function(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,o;n<i;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))};Object.defineProperty(We,"__esModule",{value:!0}),We.JSONRPCServer=void 0;var rt=ce,Qo=he,Zo=function(){return(0,rt.createJSONRPCErrorResponse)(null,rt.JSONRPCErrorCode.ParseError,"Parse error")},ts=function(e){return(0,rt.createJSONRPCErrorResponse)((0,rt.isJSONRPCID)(e.id)?e.id:null,rt.JSONRPCErrorCode.InvalidRequest,"Invalid Request")},es=function(e){return(0,rt.createJSONRPCErrorResponse)(e,rt.JSONRPCErrorCode.MethodNotFound,"Method not found")},rs=function(){function e(t){t===void 0&&(t={});var r;this.mapErrorToJSONRPCErrorResponse=ss,this.nameToMethodDictionary={},this.middleware=null,this.errorListener=(r=t.errorListener)!==null&&r!==void 0?r:console.warn}return e.prototype.addMethod=function(t,r){this.addMethodAdvanced(t,this.toJSONRPCMethod(r))},e.prototype.toJSONRPCMethod=function(t){return function(r,n){var i=t(r.params,n);return Promise.resolve(i).then(function(o){return os(r.id,o)})}},e.prototype.addMethodAdvanced=function(t,r){var n;this.nameToMethodDictionary=Ke(Ke({},this.nameToMethodDictionary),(n={},n[t]=r,n))},e.prototype.receiveJSON=function(t,r){var n=this.tryParseRequestJSON(t);return n?this.receive(n,r):Promise.resolve(Zo())},e.prototype.tryParseRequestJSON=function(t){try{return JSON.parse(t)}catch{return null}},e.prototype.receive=function(t,r){return Array.isArray(t)?this.receiveMultiple(t,r):this.receiveSingle(t,r)},e.prototype.receiveMultiple=function(t,r){return jn(this,void 0,void 0,function(){var n,i=this;return Dn(this,function(o){switch(o.label){case 0:return[4,Promise.all(t.map(function(s){return i.receiveSingle(s,r)}))];case 1:return n=o.sent().filter(ns),n.length===1?[2,n[0]]:n.length?[2,n]:[2,null]}})})},e.prototype.receiveSingle=function(t,r){return jn(this,void 0,void 0,function(){var n,i;return Dn(this,function(o){switch(o.label){case 0:return n=this.nameToMethodDictionary[t.method],(0,rt.isJSONRPCRequest)(t)?[3,1]:[2,ts(t)];case 1:return n?[4,this.callMethod(n,t,r)]:[3,3];case 2:return i=o.sent(),[2,us(t,i)];case 3:return t.id!==void 0?[2,es(t.id)]:[2,null];case 4:return[2]}})})},e.prototype.applyMiddleware=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.middleware?this.middleware=this.combineMiddlewares(Xo([this.middleware],t,!0)):this.middleware=this.combineMiddlewares(t)},e.prototype.combineMiddlewares=function(t){return t.length?t.reduce(this.middlewareReducer):null},e.prototype.middlewareReducer=function(t,r){return function(n,i,o){return t(function(s,u){return r(n,s,u)},i,o)}},e.prototype.callMethod=function(t,r,n){var i=this,o=function(u,f){return t(u,f)},s=function(u){return i.errorListener('An unexpected error occurred while executing "'.concat(r.method,'" JSON-RPC method:'),u),Promise.resolve(i.mapErrorToJSONRPCErrorResponseIfNecessary(r.id,u))};try{return(this.middleware||is)(o,r,n).then(void 0,s)}catch(u){return s(u)}},e.prototype.mapErrorToJSONRPCErrorResponseIfNecessary=function(t,r){return t!==void 0?this.mapErrorToJSONRPCErrorResponse(t,r):null},e}();We.JSONRPCServer=rs;var ns=function(e){return e!==null},is=function(e,t,r){return e(t,r)},os=function(e,t){return e!==void 0?{jsonrpc:rt.JSONRPC,id:e,result:t===void 0?null:t}:null},ss=function(e,t){return(0,rt.createJSONRPCErrorResponse)(e,Qo.DefaultErrorCode,t&&t.message||"An unexpected error occurred")},us=function(e,t){return t||(e.id!==void 0?(0,rt.createJSONRPCErrorResponse)(e.id,rt.JSONRPCErrorCode.InternalError,"Internal error"):null)},Fe={},as=v&&v.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function f(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?o(c.value):i(c.value).then(u,f)}a((n=n.apply(e,t||[])).next())})},fs=v&&v.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return f([a,c])}}function f(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=a[0]&2?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[a[0]&2,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(a[0]===6&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],i=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.JSONRPCServerAndClient=void 0;var He=ce,cs=function(){function e(t,r,n){n===void 0&&(n={});var i;this.server=t,this.client=r,this.errorListener=(i=n.errorListener)!==null&&i!==void 0?i:console.warn}return e.prototype.applyServerMiddleware=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];(t=this.server).applyMiddleware.apply(t,r)},e.prototype.addMethod=function(t,r){this.server.addMethod(t,r)},e.prototype.addMethodAdvanced=function(t,r){this.server.addMethodAdvanced(t,r)},e.prototype.timeout=function(t){return this.client.timeout(t)},e.prototype.request=function(t,r,n){return this.client.request(t,r,n)},e.prototype.requestAdvanced=function(t,r){return this.client.requestAdvanced(t,r)},e.prototype.notify=function(t,r,n){this.client.notify(t,r,n)},e.prototype.rejectAllPendingRequests=function(t){this.client.rejectAllPendingRequests(t)},e.prototype.receiveAndSend=function(t,r,n){return as(this,void 0,void 0,function(){var i,o;return fs(this,function(s){switch(s.label){case 0:return(0,He.isJSONRPCResponse)(t)||(0,He.isJSONRPCResponses)(t)?(this.client.receive(t),[3,4]):[3,1];case 1:return(0,He.isJSONRPCRequest)(t)||(0,He.isJSONRPCRequests)(t)?[4,this.server.receive(t,r)]:[3,3];case 2:return i=s.sent(),i?[2,this.client.send(i,n)]:[3,4];case 3:return o="Received an invalid JSON-RPC message",this.errorListener(o,t),[2,Promise.reject(new Error(o))];case 4:return[2]}})})},e}();Fe.JSONRPCServerAndClient=cs,function(e){var t=v&&v.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o),Object.defineProperty(n,s,{enumerable:!0,get:function(){return i[o]}})}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),r=v&&v.__exportStar||function(n,i){for(var o in n)o!=="default"&&!Object.prototype.hasOwnProperty.call(i,o)&&t(i,n,o)};Object.defineProperty(e,"__esModule",{value:!0}),r(k,e),r(ce,e),r(We,e),r(Fe,e)}(C);const gt={};function hs(e){gt.context=e}const ls=(e,t)=>e===t,_s=Symbol("solid-track"),Ye={equals:ls};let xn=Kn;const Ht={},jt=1,Ge=2,Jn={owned:null,cleanups:null,context:null,owner:null};var B=null;let _e=null,q=null,de=null,U=null,at=null,Or=0;function pe(e,t){const r=q,n=B,i=e.length===0?Jn:{owned:null,cleanups:null,context:null,owner:t||n};B=i,q=null;try{return Rr(()=>e(()=>Nr(i)),!0)}finally{q=r,B=n}}function Bn(e,t){t=t?Object.assign({},Ye,t):Ye;const r={value:e,observers:null,observerSlots:null,pending:Ht,comparator:t.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.pending!==Ht?r.pending:r.value)),zr(r,i));return[Wn.bind(r),n]}function D(e,t,r){const n=Ir(e,t,!1,jt);ve(n)}function Un(e,t,r){xn=gs;const n=Ir(e,t,!1,jt);n.user=!0,at?at.push(n):ve(n)}function Mr(e,t,r){r=r?Object.assign({},Ye,r):Ye;const n=Ir(e,t,!0,0);return n.pending=Ht,n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,ve(n),Wn.bind(n)}function ds(e){if(de)return e();let t;const r=de=[];try{t=e()}finally{de=null}return Rr(()=>{for(let n=0;n<r.length;n+=1){const i=r[n];if(i.pending!==Ht){const o=i.pending;i.pending=Ht,zr(i,o)}}},!1),t}function Ar(e){let t,r=q;return q=null,t=e(),q=r,t}function ps(e){return B===null||(B.cleanups===null?B.cleanups=[e]:B.cleanups.push(e)),e}function Wn(){const e=_e;if(this.sources&&(this.state||e)){const t=U;U=null,this.state===jt||e?ve(this):Ve(this),U=t}if(q){const t=this.observers?this.observers.length:0;q.sources?(q.sources.push(this),q.sourceSlots.push(t)):(q.sources=[this],q.sourceSlots=[t]),this.observers?(this.observers.push(q),this.observerSlots.push(q.sources.length-1)):(this.observers=[q],this.observerSlots=[q.sources.length-1])}return this.value}function zr(e,t,r){if(de)return e.pending===Ht&&de.push(e),e.pending=t,t;if(e.comparator&&e.comparator(e.value,t))return t;let n=!1;return e.value=t,e.observers&&e.observers.length&&Rr(()=>{for(let i=0;i<e.observers.length;i+=1){const o=e.observers[i];n&&_e.disposed.has(o),(n&&!o.tState||!n&&!o.state)&&(o.pure?U.push(o):at.push(o),o.observers&&Fn(o)),n||(o.state=jt)}if(U.length>1e6)throw U=[],new Error},!1),t}function ve(e){if(!e.fn)return;Nr(e);const t=B,r=q,n=Or;q=B=e,vs(e,e.value,n),q=r,B=t}function vs(e,t,r){let n;try{n=e.fn(t)}catch(i){Hn(i)}(!e.updatedAt||e.updatedAt<=r)&&(e.observers&&e.observers.length?zr(e,n):e.value=n,e.updatedAt=r)}function Ir(e,t,r,n=jt,i){const o={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:B,context:null,pure:r};return B===null||B!==Jn&&(B.owned?B.owned.push(o):B.owned=[o]),o}function ye(e){const t=_e;if(e.state===0||t)return;if(e.state===Ge||t)return Ve(e);if(e.suspense&&Ar(e.suspense.inFallback))return e.suspense.effects.push(e);const r=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Or);)(e.state||t)&&r.push(e);for(let n=r.length-1;n>=0;n--)if(e=r[n],e.state===jt||t)ve(e);else if(e.state===Ge||t){const i=U;U=null,Ve(e,r[0]),U=i}}function Rr(e,t){if(U)return e();let r=!1;t||(U=[]),at?r=!0:at=[],Or++;try{const n=e();return ys(r),n}catch(n){Hn(n)}finally{U=null,r||(at=null)}}function ys(e){U&&(Kn(U),U=null),!e&&(at.length?ds(()=>{xn(at),at=null}):at=null)}function Kn(e){for(let t=0;t<e.length;t++)ye(e[t])}function gs(e){let t,r=0;for(t=0;t<e.length;t++){const i=e[t];i.user?e[r++]=i:ye(i)}gt.context&&hs();const n=e.length;for(t=0;t<r;t++)ye(e[t]);for(t=n;t<e.length;t++)ye(e[t])}function Ve(e,t){const r=_e;e.state=0;for(let n=0;n<e.sources.length;n+=1){const i=e.sources[n];i.sources&&(i.state===jt||r?i!==t&&ye(i):(i.state===Ge||r)&&Ve(i,t))}}function Fn(e){const t=_e;for(let r=0;r<e.observers.length;r+=1){const n=e.observers[r];(!n.state||t)&&(n.state=Ge,n.pure?U.push(n):at.push(n),n.observers&&Fn(n))}}function Nr(e){let t;if(e.sources)for(;e.sources.length;){const r=e.sources.pop(),n=e.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),s=r.observerSlots.pop();n<i.length&&(o.sourceSlots[s]=n,i[n]=o,r.observerSlots[n]=s)}}if(e.owned){for(t=0;t<e.owned.length;t++)Nr(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function Hn(e){throw e}const ms=Symbol("fallback");function Yn(e){for(let t=0;t<e.length;t++)e[t]()}function ws(e,t,r={}){let n=[],i=[],o=[],s=0,u=t.length>1?[]:null;return ps(()=>Yn(o)),()=>{let f=e()||[],a,c;return f[_s],Ar(()=>{let l=f.length,_,d,p,m,R,A,j,yt,kt;if(l===0)s!==0&&(Yn(o),o=[],n=[],i=[],s=0,u&&(u=[])),r.fallback&&(n=[ms],i[0]=pe(wr=>(o[0]=wr,r.fallback())),s=1);else if(s===0){for(i=new Array(l),c=0;c<l;c++)n[c]=f[c],i[c]=pe(h);s=l}else{for(p=new Array(l),m=new Array(l),u&&(R=new Array(l)),A=0,j=Math.min(s,l);A<j&&n[A]===f[A];A++);for(j=s-1,yt=l-1;j>=A&&yt>=A&&n[j]===f[yt];j--,yt--)p[yt]=i[j],m[yt]=o[j],u&&(R[yt]=u[j]);for(_=new Map,d=new Array(yt+1),c=yt;c>=A;c--)kt=f[c],a=_.get(kt),d[c]=a===void 0?-1:a,_.set(kt,c);for(a=A;a<=j;a++)kt=n[a],c=_.get(kt),c!==void 0&&c!==-1?(p[c]=i[a],m[c]=o[a],u&&(R[c]=u[a]),c=d[c],_.set(kt,c)):o[a]();for(c=A;c<l;c++)c in p?(i[c]=p[c],o[c]=m[c],u&&(u[c]=R[c],u[c](c))):i[c]=pe(h);i=i.slice(0,s=l),n=f.slice(0)}return i});function h(l){if(o[c]=l,u){const[_,d]=Bn(c);return u[c]=d,t(f[c],_)}return t(f[c])}}}function K(e,t){return Ar(()=>e(t||{}))}function Rt(e){const t="fallback"in e&&{fallback:()=>e.fallback};return Mr(ws(()=>e.each,e.children,t||void 0))}const Ss=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],bs=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...Ss]),Es=new Set(["innerHTML","textContent","innerText","children"]),Os={className:"class",htmlFor:"for"},Gn={class:"className",formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly"},Vn=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Ms={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function As(e,t,r){let n=r.length,i=t.length,o=n,s=0,u=0,f=t[i-1].nextSibling,a=null;for(;s<i||u<o;){if(t[s]===r[u]){s++,u++;continue}for(;t[i-1]===r[o-1];)i--,o--;if(i===s){const c=o<n?u?r[u-1].nextSibling:r[o-u]:f;for(;u<o;)e.insertBefore(r[u++],c)}else if(o===u)for(;s<i;)(!a||!a.has(t[s]))&&t[s].remove(),s++;else if(t[s]===r[o-1]&&r[u]===t[i-1]){const c=t[--i].nextSibling;e.insertBefore(r[u++],t[s++].nextSibling),e.insertBefore(r[--o],c),t[i]=r[o]}else{if(!a){a=new Map;let h=u;for(;h<o;)a.set(r[h],h++)}const c=a.get(t[s]);if(c!=null)if(u<c&&c<o){let h=s,l=1,_;for(;++h<i&&h<o&&!((_=a.get(t[h]))==null||_!==c+l);)l++;if(l>c-u){const d=t[s];for(;u<c;)e.insertBefore(r[u++],d)}else e.replaceChild(r[u++],t[s++])}else s++;else t[s++].remove()}}}const Xn="_$DX_DELEGATE";function ge(e,t,r){let n;return pe(i=>{n=i,t===document?e():w(t,e(),t.firstChild?null:void 0,r)}),()=>{n(),t.textContent=""}}function x(e,t,r){const n=document.createElement("template");n.innerHTML=e;let i=n.content.firstChild;return r&&(i=i.firstChild),i}function zs(e,t=window.document){const r=t[Xn]||(t[Xn]=new Set);for(let n=0,i=e.length;n<i;n++){const o=e[n];r.has(o)||(r.add(o),t.addEventListener(o,Ps))}}function Xe(e,t,r){r==null?e.removeAttribute(t):e.setAttribute(t,r)}function Is(e,t,r,n){n==null?e.removeAttributeNS(t,r):e.setAttributeNS(t,r,n)}function P(e,t){t==null?e.removeAttribute("class"):e.className=t}function Rs(e,t,r,n){n?Array.isArray(r)?(e[`$$${t}`]=r[0],e[`$$${t}Data`]=r[1]):e[`$$${t}`]=r:Array.isArray(r)?e.addEventListener(t,i=>r[0](r[1],i)):e.addEventListener(t,r)}function Qe(e,t,r={}){const n=Object.keys(t||{}),i=Object.keys(r);let o,s;for(o=0,s=i.length;o<s;o++){const u=i[o];!u||u==="undefined"||t[u]||(Qn(e,u,!1),delete r[u])}for(o=0,s=n.length;o<s;o++){const u=n[o],f=!!t[u];!u||u==="undefined"||r[u]===f||!f||(Qn(e,u,!0),r[u]=f)}return r}function Ns(e,t,r={}){const n=e.style,i=typeof r=="string";if(t==null&&i||typeof t=="string")return n.cssText=t;i&&(n.cssText=void 0,r={}),t||(t={});let o,s;for(s in r)t[s]==null&&n.removeProperty(s),delete r[s];for(s in t)o=t[s],o!==r[s]&&(n.setProperty(s,o),r[s]=o);return r}function $s(e,t,r,n){typeof t=="function"?D(i=>ti(e,t(),i,r,n)):ti(e,t,void 0,r,n)}function w(e,t,r,n){if(r!==void 0&&!n&&(n=[]),typeof t!="function")return Yt(e,t,n,r);D(i=>Yt(e,t(),i,r),n)}function Cs(e,t,r,n,i={},o=!1){t||(t={});for(const s in i)if(!(s in t)){if(s==="children")continue;Zn(e,s,null,i[s],r,o)}for(const s in t){if(s==="children"){n||Yt(e,t.children);continue}const u=t[s];i[s]=Zn(e,s,u,i[s],r,o)}}function qs(e){return e.toLowerCase().replace(/-([a-z])/g,(t,r)=>r.toUpperCase())}function Qn(e,t,r){const n=t.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)e.classList.toggle(n[i],r)}function Zn(e,t,r,n,i,o){let s,u,f;if(t==="style")return Ns(e,r,n);if(t==="classList")return Qe(e,r,n);if(r===n)return n;if(t==="ref")o||r(e);else if(t.slice(0,3)==="on:")e.addEventListener(t.slice(3),r);else if(t.slice(0,10)==="oncapture:")e.addEventListener(t.slice(10),r,!0);else if(t.slice(0,2)==="on"){const a=t.slice(2).toLowerCase(),c=Vn.has(a);Rs(e,a,r,c),c&&zs([a])}else if((f=Es.has(t))||!i&&(Gn[t]||(u=bs.has(t)))||(s=e.nodeName.includes("-")))t==="class"||t==="className"?P(e,r):s&&!u&&!f?e[qs(t)]=r:e[Gn[t]||t]=r;else{const a=i&&t.indexOf(":")>-1&&Ms[t.split(":")[0]];a?Is(e,a,t,r):Xe(e,Os[t]||t,r)}return r}function Ps(e){const t=`$$${e.type}`;let r=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==r&&Object.defineProperty(e,"target",{configurable:!0,value:r}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return r||document}}),gt.registry&&!gt.done&&(gt.done=!0,document.querySelectorAll("[id^=pl-]").forEach(n=>n.remove()));r!==null;){const n=r[t];if(n&&!r.disabled){const i=r[`${t}Data`];if(i!==void 0?n(i,e):n(e),e.cancelBubble)return}r=r.host&&r.host!==r&&r.host instanceof Node?r.host:r.parentNode}}function ti(e,t,r={},n,i){return t||(t={}),!i&&"children"in t&&D(()=>r.children=Yt(e,t.children,r.children)),t.ref&&t.ref(e),D(()=>Cs(e,t,n,!0,r,!0)),r}function Yt(e,t,r,n,i){for(gt.context&&!r&&(r=[...e.childNodes]);typeof r=="function";)r=r();if(t===r)return r;const o=typeof t,s=n!==void 0;if(e=s&&r[0]&&r[0].parentNode||e,o==="string"||o==="number"){if(gt.context)return r;if(o==="number"&&(t=t.toString()),s){let u=r[0];u&&u.nodeType===3?u.data=t:u=document.createTextNode(t),r=Gt(e,r,n,u)}else r!==""&&typeof r=="string"?r=e.firstChild.data=t:r=e.textContent=t}else if(t==null||o==="boolean"){if(gt.context)return r;r=Gt(e,r,n)}else{if(o==="function")return D(()=>{let u=t();for(;typeof u=="function";)u=u();r=Yt(e,u,r,n)}),()=>r;if(Array.isArray(t)){const u=[];if($r(u,t,i))return D(()=>r=Yt(e,u,r,n,!0)),()=>r;if(gt.context){for(let f=0;f<u.length;f++)if(u[f].parentNode)return r=u}if(u.length===0){if(r=Gt(e,r,n),s)return r}else Array.isArray(r)?r.length===0?ei(e,u,n):As(e,r,u):(r&&Gt(e),ei(e,u));r=u}else if(t instanceof Node){if(gt.context&&t.parentNode)return r=s?[t]:t;if(Array.isArray(r)){if(s)return r=Gt(e,r,n,t);Gt(e,r,null,t)}else r==null||r===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);r=t}}return r}function $r(e,t,r){let n=!1;for(let i=0,o=t.length;i<o;i++){let s=t[i],u;if(s instanceof Node)e.push(s);else if(!(s==null||s===!0||s===!1))if(Array.isArray(s))n=$r(e,s)||n;else if((u=typeof s)=="string")e.push(document.createTextNode(s));else if(u==="function")if(r){for(;typeof s=="function";)s=s();n=$r(e,Array.isArray(s)?s:[s])||n}else e.push(s),n=!0;else e.push(document.createTextNode(s.toString()))}return n}function ei(e,t,r){for(let n=0,i=t.length;n<i;n++)e.insertBefore(t[n],r)}function Gt(e,t,r,n){if(r===void 0)return e.textContent="";const i=n||document.createTextNode("");if(t.length){let o=!1;for(let s=t.length-1;s>=0;s--){const u=t[s];if(i!==u){const f=u.parentNode===e;!o&&!s?f?e.replaceChild(i,u):e.insertBefore(i,r):f&&u.remove()}else o=!0}}else e.insertBefore(i,r);return[i]}var ri=`._mainBody_8f6zw_1{opacity:.5}._mainBody_8f6zw_1 *{font-size:.75rem;margin:0}._mainBody_8f6zw_1 button,._clickable_8f6zw_11{cursor:pointer}._stateWorkingOn_8f6zw_14{color:#00f}._stateSure_8f6zw_17{color:green}._stateNotSure_8f6zw_20{color:red}._answerMsg_8f6zw_23{border-style:groove;border-width:thin;opacity:.75;margin-bottom:.5rem}._answerMsg_8f6zw_23 ul{padding-left:1rem}._answerMsgName_8f6zw_32{font-weight:700}._answerMark_8f6zw_35{display:flex;justify-content:end;align-items:center;border-style:groove;border-width:thin;margin-bottom:.5rem;opacity:.75}._answerMark_8f6zw_35 button{padding:0;margin-left:.5rem;white-space:nowrap}._answerMark_8f6zw_35 input{height:max-content;width:100%}._answerDetail_8f6zw_53 ._stateWorkingOn_8f6zw_14,._answerDetail_8f6zw_53 ._stateSure_8f6zw_17,._answerDetail_8f6zw_53 ._stateNotSure_8f6zw_20{font-weight:700}._answerDetail_8f6zw_53 ul{padding-left:1.5rem}._answerDetail_8f6zw_53 img{height:auto;width:80%}._answerDetailShortAnswer_8f6zw_65{border-style:groove;border-width:thin;margin:.2rem;padding:.2rem}._settings_8f6zw_71{border-style:groove;border-width:thin;display:flex;flex-direction:column;padding:.5rem;margin-bottom:.5rem}._settingsEntry_8f6zw_79{display:flex;flex-direction:row;margin-bottom:.5rem;justify-content:space-between;align-items:center}._settingsEntry_8f6zw_79 label{font-weight:700}._settingsEntry_8f6zw_79 input{height:max-content;text-align:right}._settingsSubmit_8f6zw_93{display:flex;flex-direction:row;align-items:center;justify-content:end}._settingsSubmitTip_8f6zw_99{margin-right:.5rem}._about_8f6zw_102 p{margin-bottom:.25rem}._about_8f6zw_102 ul{padding-left:1.5rem;margin-bottom:.25rem}._about_8f6zw_102 ul li{margin-bottom:.25rem}._uploadImg_8f6zw_112{display:flex;flex-direction:column}._uploadImg_8f6zw_112 img{width:100%;height:auto}._uploadImgImage_8f6zw_120{border-style:groove;border-width:thin;padding:.5rem}._uploadImgConfirm_8f6zw_125{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-bottom:.5rem}
`;const Ts=x("<title> </title>"),ks=x("<style></style>");function ni(e,t){Cr(e!=null,t!=null?t:"null value")}function ii(e,t,r){Cr(t instanceof e,r!=null?r:"not HTMLElement")}function Cr(e,t){if(e!==!0)throw Error(t!=null?t:"assertion failed")}function ft(...e){return e}function qr(e){const t=window.open("","",Object.entries(e).map(([n,i])=>`${n}=${i}`).join(","));ni(t);const r=()=>t.close();return window.addEventListener("unload",r),t.addEventListener("close",()=>window.removeEventListener("unload",r)),ge(()=>[(()=>{const n=Ts.cloneNode(!0),i=n.firstChild;return D(()=>i.data=e.title),n})(),(()=>{const n=ks.cloneNode(!0);return n.textContent=ri,n})()],t.document.head),t}function Pr(e,...t){}function oi(e,t){const r=new URL(e,self.location.origin);for(const[n,i]of Object.entries(t!=null?t:{}))r.searchParams.set(n,i);return r}function si(e){const t=GM_getValue(e);if(t!==void 0)return t.contents}function me(e,t){GM_setValue(e,{contents:t})}function Ls(){var r;const e=[{name:"202205231915_gm_value",up(){me("no_leave_check",GM_getValue("nol_eavecheck")),GM_setValue("nol_eavecheck",void 0);for(const n of["username","server","sync_answers","sort_problems"])me(n,GM_getValue(n))}}],t=(r=si("migrations"))!=null?r:[];for(const{name:n,idx:i}of t)if(n!==e[i].name)throw new Error("bad migrations");for(const{name:n,up:i}of e.slice(t.length))i();me("migrations",e.map((n,i)=>({name:n.name,idx:i})))}class we{constructor(t,r){et(this,"_name");et(this,"_init");et(this,"inited",!1);et(this,"_cached");this._name=t,this._init=r}get(){if(!this.inited){const t=si(this._name);t===void 0&&this._init!==void 0&&me(this._name,this._init),this._cached=t!=null?t:this._init,this.inited=!0}return this._cached}set(t){t!==void 0&&(me(this._name,t),this._cached=t)}}const Tr=new we("username"),kr=new we("server"),Lr=new we("sync_answers",!0),jr=new we("sort_problems",!1),Dr=new we("no_leave_check",!0);class js{constructor(){et(this,"token");et(this,"client");et(this,"examId");et(this,"paper");et(this,"queue",new Map);et(this,"onmsg",[])}onmessage(t){this.onmsg.push(t)}updateQueue(t,r){let n=this.queue.get(t);n!==void 0?r(n):(n={},r(n),this.queue.set(t,n))}updateAnswer(t,r){this.updateQueue(t,n=>n.result=r)}updateState(t,r){this.updateQueue(t,n=>{var i;n.context=(i=n.context)!=null?i:{},n.context.state=r})}updateMsg(t,r){this.updateQueue(t,n=>{var i;n.context=(i=n.context)!=null?i:{},n.context.msg=r})}async watch(t){return new Promise((r,n)=>{const i=setInterval(()=>{this.sendQueue().catch(o=>{clearInterval(i),alert("\u4E0E\u670D\u52A1\u5668\u901A\u4FE1\u5F02\u5E38"),n(o)})},t)})}async login(t,r){this.examId=t,this.paper=r}async sendQueue(){const t=Lr.get(),r=kr.get(),n=Tr.get();if(t!==!0||this.queue.size<1||r===void 0||n===void 0||this.examId===void 0||this.paper===void 0)return;let i=[...this.queue.entries()];if(this.queue.clear(),this.client===void 0){const s=new C.JSONRPCClient(u=>new Promise((f,a)=>{GM.xmlHttpRequest({url:r,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(u),onload:c=>{c.status===200?(s.receive(JSON.parse(c.responseText)),f()):a(new Error(c.statusText))},onerror:c=>a(c.statusText)})}));this.client=s}if(this.token===void 0){Pr(`login to server: ${n}, ${this.examId}`);const s=await this.client.request("login",[n,this.examId,this.paper]);this.token=s}const o=await this.client.request("answer_problem",[this.token,i.map(([s,{result:u,context:f}])=>({problem_id:s,result:u,context:f}))]);this.onmsg.forEach(s=>s(o))}}const Ot=new js;function Ds(e){const t=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(r,n){const i=e.call(this,oi(n)),o=this.send;this.send=function(s){i!==void 0?i(s).then(u=>{o.call(this,u),this.send=o}).catch(Pr):(o.call(this,s),this.send=o)},t.apply(this,arguments)}}var mt=(e=>(e[e.SingleChoice=1]="SingleChoice",e[e.MultipleChoice=2]="MultipleChoice",e[e.Polling=3]="Polling",e[e.FillBlank=4]="FillBlank",e[e.ShortAnswer=5]="ShortAnswer",e[e.Judgement=6]="Judgement",e))(mt||{}),ct=(e=>(e[e.WorkingOn=0]="WorkingOn",e[e.Sure=1]="Sure",e[e.NotSure=2]="NotSure",e))(ct||{}),z={mainBody:"_mainBody_8f6zw_1",clickable:"_clickable_8f6zw_11",stateWorkingOn:"_stateWorkingOn_8f6zw_14",stateSure:"_stateSure_8f6zw_17",stateNotSure:"_stateNotSure_8f6zw_20",answerMsg:"_answerMsg_8f6zw_23",answerMsgName:"_answerMsgName_8f6zw_32",answerMark:"_answerMark_8f6zw_35",answerDetail:"_answerDetail_8f6zw_53",answerDetailShortAnswer:"_answerDetailShortAnswer_8f6zw_65",settings:"_settings_8f6zw_71",settingsEntry:"_settingsEntry_8f6zw_79",settingsSubmit:"_settingsSubmit_8f6zw_93",settingsSubmitTip:"_settingsSubmitTip_8f6zw_99",about:"_about_8f6zw_102",uploadImg:"_uploadImg_8f6zw_112",uploadImgImage:"_uploadImgImage_8f6zw_120",uploadImgConfirm:"_uploadImgConfirm_8f6zw_125"};const ht=Symbol("@ts-pattern/matcher"),Ze="@ts-pattern/anonymous-select-key",xr=e=>Boolean(e&&typeof e=="object"),tr=e=>e&&!!e[ht],lt=(e,t,r)=>{if(xr(e)){if(tr(e)){const n=e[ht](),{matched:i,selections:o}=n.match(t);return i&&o&&Object.keys(o).forEach(s=>r(s,o[s])),i}if(!xr(t))return!1;if(Array.isArray(e))return!!Array.isArray(t)&&e.length===t.length&&e.every((n,i)=>lt(n,t[i],r));if(e instanceof Map)return t instanceof Map&&Array.from(e.keys()).every(n=>lt(e.get(n),t.get(n),r));if(e instanceof Set){if(!(t instanceof Set))return!1;if(e.size===0)return t.size===0;if(e.size===1){const[n]=Array.from(e.values());return tr(n)?Array.from(t.values()).every(i=>lt(n,i,r)):t.has(n)}return Array.from(e.values()).every(n=>t.has(n))}return Object.keys(e).every(n=>{const i=e[n];return(n in t||tr(o=i)&&o[ht]().matcherType==="optional")&&lt(i,t[n],r);var o})}return Object.is(t,e)},Mt=e=>{var t,r,n;return xr(e)?tr(e)?(t=(r=(n=e[ht]()).getSelectionKeys)==null?void 0:r.call(n))!=null?t:[]:Array.isArray(e)?Se(e,Mt):Se(Object.values(e),Mt):[]},Se=(e,t)=>e.reduce((r,n)=>r.concat(t(n)),[]);function ui(e){return{[ht]:()=>({match:t=>{let r={};const n=(i,o)=>{r[i]=o};return t===void 0?(Mt(e).forEach(i=>n(i,void 0)),{matched:!0,selections:r}):{matched:lt(e,t,n),selections:r}},getSelectionKeys:()=>Mt(e),matcherType:"optional"})}}function ai(e){return{[ht]:()=>({match:t=>{if(!Array.isArray(t))return{matched:!1};let r={};const n=(i,o)=>{r[i]=(r[i]||[]).concat([o])};return{matched:t.every(i=>lt(e,i,n)),selections:r}},getSelectionKeys:()=>Mt(e)})}}function fi(...e){return{[ht]:()=>({match:t=>{let r={};const n=(i,o)=>{r[i]=o};return{matched:e.every(i=>lt(i,t,n)),selections:r}},getSelectionKeys:()=>Se(e,Mt),matcherType:"and"})}}function ci(...e){return{[ht]:()=>({match:t=>{let r={};const n=(i,o)=>{r[i]=o};return Se(e,Mt).forEach(i=>n(i,void 0)),{matched:e.some(i=>lt(i,t,n)),selections:r}},getSelectionKeys:()=>Se(e,Mt),matcherType:"or"})}}function hi(e){return{[ht]:()=>({match:t=>({matched:!lt(e,t,()=>{})}),getSelectionKeys:()=>[],matcherType:"not"})}}function wt(e){return{[ht]:()=>({match:t=>({matched:Boolean(e(t))})})}}function li(...e){const t=typeof e[0]=="string"?e[0]:void 0,r=e.length===2?e[1]:typeof e[0]=="string"?void 0:e[0];return{[ht]:()=>({match:n=>{let i={[t!=null?t:Ze]:n};return{matched:r===void 0||lt(r,n,(o,s)=>{i[o]=s}),selections:i}},getSelectionKeys:()=>[t!=null?t:Ze].concat(r===void 0?[]:Mt(r))})}}const _i=wt(function(e){return!0}),xs=_i,Js=wt(function(e){return typeof e=="string"}),Bs=wt(function(e){return typeof e=="number"}),Us=wt(function(e){return typeof e=="boolean"}),Ws=wt(function(e){return typeof e=="bigint"}),Ks=wt(function(e){return typeof e=="symbol"}),Fs=wt(function(e){return e==null});var er={__proto__:null,optional:ui,array:ai,intersection:fi,union:ci,not:hi,when:wt,select:li,any:_i,_:xs,string:Js,number:Bs,boolean:Us,bigint:Ws,symbol:Ks,nullish:Fs,instanceOf:function(e){return wt(function(t){return r=>r instanceof t}(e))},typed:function(){return{array:ai,optional:ui,intersection:fi,union:ci,not:hi,select:li,when:wt}}};const Hs=e=>new be(e,[]);class be{constructor(t,r){this.value=void 0,this.cases=void 0,this.value=t,this.cases=r}with(...t){const r=t[t.length-1],n=[t[0]],i=[];return t.length===3&&typeof t[1]=="function"?(n.push(t[0]),i.push(t[1])):t.length>2&&n.push(...t.slice(1,t.length-1)),new be(this.value,this.cases.concat([{match:o=>{let s={};const u=Boolean(n.some(f=>lt(f,o,(a,c)=>{s[a]=c}))&&i.every(f=>f(o)));return{matched:u,value:u&&Object.keys(s).length?Ze in s?s[Ze]:s:o}},handler:r}]))}when(t,r){return new be(this.value,this.cases.concat([{match:n=>({matched:Boolean(t(n)),value:n}),handler:r}]))}otherwise(t){return new be(this.value,this.cases.concat([{match:r=>({matched:!0,value:r}),handler:t}])).run()}exhaustive(){return this.run()}run(){let t,r=this.value;for(const n of this.cases){const i=n.match(this.value);if(i.matched){r=i.value,t=n.handler;break}}if(!t){let n;try{n=JSON.stringify(this.value)}catch{n=this.value}throw new Error(`Pattern matching error: no pattern matches value ${n}`)}return t(r,this.value)}}class Jr{constructor(t){et(this,"t");this.t=t}then(t){return new Jr(t(this.t))}}function Y(e){return new Jr(e)}function di(e){return function*(t){for(const r of t)yield e(r)}}function*Br(e){let t=0;for(const r of e)yield[t++,r]}function Ys(e){return function*(t){for(const r of t)e(r)&&(yield r)}}function Gs(e){return function*(t){const r=t[Symbol.iterator](),n=e[Symbol.iterator]();for(;;){const i=r.next(),o=n.next();if(i.done!==!0&&o.done!==!0)yield[i.value,o.value];else return}}}function pi(e){return function(t){return Array.from(t).sort(e)}}function Vs(e){for(const t of e)return t}function Dt(e,t){return function(r){let n=e;for(const i of r)n=t(n,i);return n}}function Ee(e){return Array.from(e)}function Ur(e){return function(t){for(const r of t)e(r)}}var Oe="delete",E=5,nt=1<<E,F=nt-1,y={};function Wr(){return{value:!1}}function it(e){e&&(e.value=!0)}function Kr(){}function Vt(e){return e.size===void 0&&(e.size=e.__iterate(vi)),e.size}function Nt(e,t){if(typeof t!="number"){var r=t>>>0;if(""+r!==t||r===4294967295)return NaN;t=r}return t<0?Vt(e)+t:t}function vi(){return!0}function rr(e,t,r){return(e===0&&!gi(e)||r!==void 0&&e<=-r)&&(t===void 0||r!==void 0&&t>=r)}function Me(e,t){return yi(e,t,0)}function nr(e,t){return yi(e,t,t)}function yi(e,t,r){return e===void 0?r:gi(e)?t===1/0?t:Math.max(0,t+e)|0:t===void 0||t===e?e:Math.min(t,e)|0}function gi(e){return e<0||e===0&&1/e===-1/0}var mi="@@__IMMUTABLE_ITERABLE__@@";function G(e){return Boolean(e&&e[mi])}var wi="@@__IMMUTABLE_KEYED__@@";function I(e){return Boolean(e&&e[wi])}var Si="@@__IMMUTABLE_INDEXED__@@";function V(e){return Boolean(e&&e[Si])}function ir(e){return I(e)||V(e)}var N=function(t){return G(t)?t:Q(t)},ot=function(e){function t(r){return I(r)?r:$t(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(N),xt=function(e){function t(r){return V(r)?r:pt(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(N),Xt=function(e){function t(r){return G(r)&&!ir(r)?r:ee(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(N);N.Keyed=ot,N.Indexed=xt,N.Set=Xt;var bi="@@__IMMUTABLE_SEQ__@@";function Fr(e){return Boolean(e&&e[bi])}var Ei="@@__IMMUTABLE_RECORD__@@";function Qt(e){return Boolean(e&&e[Ei])}function St(e){return G(e)||Qt(e)}var Zt="@@__IMMUTABLE_ORDERED__@@";function _t(e){return Boolean(e&&e[Zt])}var Ae=0,dt=1,st=2,Hr=typeof Symbol=="function"&&Symbol.iterator,Oi="@@iterator",or=Hr||Oi,g=function(t){this.next=t};g.prototype.toString=function(){return"[Iterator]"},g.KEYS=Ae,g.VALUES=dt,g.ENTRIES=st,g.prototype.inspect=g.prototype.toSource=function(){return this.toString()},g.prototype[or]=function(){return this};function M(e,t,r,n){var i=e===0?t:e===1?r:[t,r];return n?n.value=i:n={value:i,done:!1},n}function X(){return{value:void 0,done:!0}}function Mi(e){return Array.isArray(e)?!0:!!sr(e)}function Ai(e){return e&&typeof e.next=="function"}function Yr(e){var t=sr(e);return t&&t.call(e)}function sr(e){var t=e&&(Hr&&e[Hr]||e[Oi]);if(typeof t=="function")return t}function Xs(e){var t=sr(e);return t&&t===e.entries}function Qs(e){var t=sr(e);return t&&t===e.keys}var te=Object.prototype.hasOwnProperty;function zi(e){return Array.isArray(e)||typeof e=="string"?!0:e&&typeof e=="object"&&Number.isInteger(e.length)&&e.length>=0&&(e.length===0?Object.keys(e).length===1:e.hasOwnProperty(e.length-1))}var Q=function(e){function t(r){return r==null?Vr():St(r)?r.toSeq():tu(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq {","}")},t.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},t.prototype.__iterate=function(n,i){var o=this._cache;if(o){for(var s=o.length,u=0;u!==s;){var f=o[i?s-++u:u++];if(n(f[1],f[0],this)===!1)break}return u}return this.__iterateUncached(n,i)},t.prototype.__iterator=function(n,i){var o=this._cache;if(o){var s=o.length,u=0;return new g(function(){if(u===s)return X();var f=o[i?s-++u:u++];return M(n,f[0],f[1])})}return this.__iteratorUncached(n,i)},t}(N),$t=function(e){function t(r){return r==null?Vr().toKeyedSeq():G(r)?I(r)?r.toSeq():r.fromEntrySeq():Qt(r)?r.toSeq():Xr(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toKeyedSeq=function(){return this},t}(Q),pt=function(e){function t(r){return r==null?Vr():G(r)?I(r)?r.entrySeq():r.toIndexedSeq():Qt(r)?r.toSeq().entrySeq():Ri(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toIndexedSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq [","]")},t}(Q),ee=function(e){function t(r){return(G(r)&&!ir(r)?r:pt(r)).toSetSeq()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toSetSeq=function(){return this},t}(Q);Q.isSeq=Fr,Q.Keyed=$t,Q.Set=ee,Q.Indexed=pt,Q.prototype[bi]=!0;var Jt=function(e){function t(r){this._array=r,this.size=r.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(n,i){return this.has(n)?this._array[Nt(this,n)]:i},t.prototype.__iterate=function(n,i){for(var o=this._array,s=o.length,u=0;u!==s;){var f=i?s-++u:u++;if(n(o[f],f,this)===!1)break}return u},t.prototype.__iterator=function(n,i){var o=this._array,s=o.length,u=0;return new g(function(){if(u===s)return X();var f=i?s-++u:u++;return M(n,f,o[f])})},t}(pt),Gr=function(e){function t(r){var n=Object.keys(r).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(r):[]);this._object=r,this._keys=n,this.size=n.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(n,i){return i!==void 0&&!this.has(n)?i:this._object[n]},t.prototype.has=function(n){return te.call(this._object,n)},t.prototype.__iterate=function(n,i){for(var o=this._object,s=this._keys,u=s.length,f=0;f!==u;){var a=s[i?u-++f:f++];if(n(o[a],a,this)===!1)break}return f},t.prototype.__iterator=function(n,i){var o=this._object,s=this._keys,u=s.length,f=0;return new g(function(){if(f===u)return X();var a=s[i?u-++f:f++];return M(n,a,o[a])})},t}($t);Gr.prototype[Zt]=!0;var Zs=function(e){function t(r){this._collection=r,this.size=r.length||r.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.__iterateUncached=function(n,i){if(i)return this.cacheResult().__iterate(n,i);var o=this._collection,s=Yr(o),u=0;if(Ai(s))for(var f;!(f=s.next()).done&&n(f.value,u++,this)!==!1;);return u},t.prototype.__iteratorUncached=function(n,i){if(i)return this.cacheResult().__iterator(n,i);var o=this._collection,s=Yr(o);if(!Ai(s))return new g(X);var u=0;return new g(function(){var f=s.next();return f.done?f:M(n,u++,f.value)})},t}(pt),Ii;function Vr(){return Ii||(Ii=new Jt([]))}function Xr(e){var t=Qr(e);if(t)return t.fromEntrySeq();if(typeof e=="object")return new Gr(e);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+e)}function Ri(e){var t=Qr(e);if(t)return t;throw new TypeError("Expected Array or collection object of values: "+e)}function tu(e){var t=Qr(e);if(t)return Xs(e)?t.fromEntrySeq():Qs(e)?t.toSetSeq():t;if(typeof e=="object")return new Gr(e);throw new TypeError("Expected Array or collection object of values, or keyed object: "+e)}function Qr(e){return zi(e)?new Jt(e):Mi(e)?new Zs(e):void 0}var Ni="@@__IMMUTABLE_MAP__@@";function Zr(e){return Boolean(e&&e[Ni])}function $i(e){return Zr(e)&&_t(e)}function Ci(e){return Boolean(e&&typeof e.equals=="function"&&typeof e.hashCode=="function")}function Z(e,t){if(e===t||e!==e&&t!==t)return!0;if(!e||!t)return!1;if(typeof e.valueOf=="function"&&typeof t.valueOf=="function"){if(e=e.valueOf(),t=t.valueOf(),e===t||e!==e&&t!==t)return!0;if(!e||!t)return!1}return!!(Ci(e)&&Ci(t)&&e.equals(t))}var ze=typeof Math.imul=="function"&&Math.imul(4294967295,2)===-2?Math.imul:function(t,r){t|=0,r|=0;var n=t&65535,i=r&65535;return n*i+((t>>>16)*i+n*(r>>>16)<<16>>>0)|0};function ur(e){return e>>>1&1073741824|e&3221225471}var eu=Object.prototype.valueOf;function tt(e){if(e==null)return qi(e);if(typeof e.hashCode=="function")return ur(e.hashCode(e));var t=uu(e);if(t==null)return qi(t);switch(typeof t){case"boolean":return t?1108378657:1108378656;case"number":return ru(t);case"string":return t.length>au?nu(t):tn(t);case"object":case"function":return ou(t);case"symbol":return iu(t);default:if(typeof t.toString=="function")return tn(t.toString());throw new Error("Value type "+typeof t+" cannot be hashed.")}}function qi(e){return e===null?1108378658:1108378659}function ru(e){if(e!==e||e===1/0)return 0;var t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)e/=4294967295,t^=e;return ur(t)}function nu(e){var t=sn[e];return t===void 0&&(t=tn(e),on===fu&&(on=0,sn={}),on++,sn[e]=t),t}function tn(e){for(var t=0,r=0;r<e.length;r++)t=31*t+e.charCodeAt(r)|0;return ur(t)}function iu(e){var t=Li[e];return t!==void 0||(t=ki(),Li[e]=t),t}function ou(e){var t;if(en&&(t=rn.get(e),t!==void 0)||(t=e[Bt],t!==void 0)||!Ti&&(t=e.propertyIsEnumerable&&e.propertyIsEnumerable[Bt],t!==void 0||(t=su(e),t!==void 0)))return t;if(t=ki(),en)rn.set(e,t);else{if(Pi!==void 0&&Pi(e)===!1)throw new Error("Non-extensible objects are not allowed as keys.");if(Ti)Object.defineProperty(e,Bt,{enumerable:!1,configurable:!1,writable:!1,value:t});else if(e.propertyIsEnumerable!==void 0&&e.propertyIsEnumerable===e.constructor.prototype.propertyIsEnumerable)e.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},e.propertyIsEnumerable[Bt]=t;else if(e.nodeType!==void 0)e[Bt]=t;else throw new Error("Unable to set a non-enumerable property on object.")}return t}var Pi=Object.isExtensible,Ti=function(){try{return Object.defineProperty({},"@",{}),!0}catch{return!1}}();function su(e){if(e&&e.nodeType>0)switch(e.nodeType){case 1:return e.uniqueID;case 9:return e.documentElement&&e.documentElement.uniqueID}}function uu(e){return e.valueOf!==eu&&typeof e.valueOf=="function"?e.valueOf(e):e}function ki(){var e=++nn;return nn&1073741824&&(nn=0),e}var en=typeof WeakMap=="function",rn;en&&(rn=new WeakMap);var Li=Object.create(null),nn=0,Bt="__immutablehash__";typeof Symbol=="function"&&(Bt=Symbol(Bt));var au=16,fu=255,on=0,sn={},ar=function(e){function t(r,n){this._iter=r,this._useKeys=n,this.size=r.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(n,i){return this._iter.get(n,i)},t.prototype.has=function(n){return this._iter.has(n)},t.prototype.valueSeq=function(){return this._iter.valueSeq()},t.prototype.reverse=function(){var n=this,i=un(this,!0);return this._useKeys||(i.valueSeq=function(){return n._iter.toSeq().reverse()}),i},t.prototype.map=function(n,i){var o=this,s=Bi(this,n,i);return this._useKeys||(s.valueSeq=function(){return o._iter.toSeq().map(n,i)}),s},t.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s,u){return n(s,u,o)},i)},t.prototype.__iterator=function(n,i){return this._iter.__iterator(n,i)},t}($t);ar.prototype[Zt]=!0;var ji=function(e){function t(r){this._iter=r,this.size=r.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.includes=function(n){return this._iter.includes(n)},t.prototype.__iterate=function(n,i){var o=this,s=0;return i&&Vt(this),this._iter.__iterate(function(u){return n(u,i?o.size-++s:s++,o)},i)},t.prototype.__iterator=function(n,i){var o=this,s=this._iter.__iterator(dt,i),u=0;return i&&Vt(this),new g(function(){var f=s.next();return f.done?f:M(n,i?o.size-++u:u++,f.value,f)})},t}(pt),Di=function(e){function t(r){this._iter=r,this.size=r.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.has=function(n){return this._iter.includes(n)},t.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s){return n(s,s,o)},i)},t.prototype.__iterator=function(n,i){var o=this._iter.__iterator(dt,i);return new g(function(){var s=o.next();return s.done?s:M(n,s.value,s.value,s)})},t}(ee),xi=function(e){function t(r){this._iter=r,this.size=r.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.entrySeq=function(){return this._iter.toSeq()},t.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s){if(s){Hi(s);var u=G(s);return n(u?s.get(1):s[1],u?s.get(0):s[0],o)}},i)},t.prototype.__iterator=function(n,i){var o=this._iter.__iterator(dt,i);return new g(function(){for(;;){var s=o.next();if(s.done)return s;var u=s.value;if(u){Hi(u);var f=G(u);return M(n,f?u.get(0):u[0],f?u.get(1):u[1],s)}}})},t}($t);ji.prototype.cacheResult=ar.prototype.cacheResult=Di.prototype.cacheResult=xi.prototype.cacheResult=fn;function Ji(e){var t=bt(e);return t._iter=e,t.size=e.size,t.flip=function(){return e},t.reverse=function(){var r=e.reverse.apply(this);return r.flip=function(){return e.reverse()},r},t.has=function(r){return e.includes(r)},t.includes=function(r){return e.has(r)},t.cacheResult=fn,t.__iterateUncached=function(r,n){var i=this;return e.__iterate(function(o,s){return r(s,o,i)!==!1},n)},t.__iteratorUncached=function(r,n){if(r===st){var i=e.__iterator(r,n);return new g(function(){var o=i.next();if(!o.done){var s=o.value[0];o.value[0]=o.value[1],o.value[1]=s}return o})}return e.__iterator(r===dt?Ae:dt,n)},t}function Bi(e,t,r){var n=bt(e);return n.size=e.size,n.has=function(i){return e.has(i)},n.get=function(i,o){var s=e.get(i,y);return s===y?o:t.call(r,s,i,e)},n.__iterateUncached=function(i,o){var s=this;return e.__iterate(function(u,f,a){return i(t.call(r,u,f,a),f,s)!==!1},o)},n.__iteratorUncached=function(i,o){var s=e.__iterator(st,o);return new g(function(){var u=s.next();if(u.done)return u;var f=u.value,a=f[0];return M(i,a,t.call(r,f[1],a,e),u)})},n}function un(e,t){var r=this,n=bt(e);return n._iter=e,n.size=e.size,n.reverse=function(){return e},e.flip&&(n.flip=function(){var i=Ji(e);return i.reverse=function(){return e.flip()},i}),n.get=function(i,o){return e.get(t?i:-1-i,o)},n.has=function(i){return e.has(t?i:-1-i)},n.includes=function(i){return e.includes(i)},n.cacheResult=fn,n.__iterate=function(i,o){var s=this,u=0;return o&&Vt(e),e.__iterate(function(f,a){return i(f,t?a:o?s.size-++u:u++,s)},!o)},n.__iterator=function(i,o){var s=0;o&&Vt(e);var u=e.__iterator(st,!o);return new g(function(){var f=u.next();if(f.done)return f;var a=f.value;return M(i,t?a[0]:o?r.size-++s:s++,a[1],f)})},n}function Ui(e,t,r,n){var i=bt(e);return n&&(i.has=function(o){var s=e.get(o,y);return s!==y&&!!t.call(r,s,o,e)},i.get=function(o,s){var u=e.get(o,y);return u!==y&&t.call(r,u,o,e)?u:s}),i.__iterateUncached=function(o,s){var u=this,f=0;return e.__iterate(function(a,c,h){if(t.call(r,a,c,h))return f++,o(a,n?c:f-1,u)},s),f},i.__iteratorUncached=function(o,s){var u=e.__iterator(st,s),f=0;return new g(function(){for(;;){var a=u.next();if(a.done)return a;var c=a.value,h=c[0],l=c[1];if(t.call(r,l,h,e))return M(o,n?h:f++,l,a)}})},i}function cu(e,t,r){var n=qt().asMutable();return e.__iterate(function(i,o){n.update(t.call(r,i,o,e),0,function(s){return s+1})}),n.asImmutable()}function hu(e,t,r){var n=I(e),i=(_t(e)?zt():qt()).asMutable();e.__iterate(function(s,u){i.update(t.call(r,s,u,e),function(f){return f=f||[],f.push(n?[u,s]:s),f})});var o=Yi(e);return i.map(function(s){return S(e,o(s))}).asImmutable()}function an(e,t,r,n){var i=e.size;if(rr(t,r,i))return e;var o=Me(t,i),s=nr(r,i);if(o!==o||s!==s)return an(e.toSeq().cacheResult(),t,r,n);var u=s-o,f;u===u&&(f=u<0?0:u);var a=bt(e);return a.size=f===0?f:e.size&&f||void 0,!n&&Fr(e)&&f>=0&&(a.get=function(c,h){return c=Nt(this,c),c>=0&&c<f?e.get(c+o,h):h}),a.__iterateUncached=function(c,h){var l=this;if(f===0)return 0;if(h)return this.cacheResult().__iterate(c,h);var _=0,d=!0,p=0;return e.__iterate(function(m,R){if(!(d&&(d=_++<o)))return p++,c(m,n?R:p-1,l)!==!1&&p!==f}),p},a.__iteratorUncached=function(c,h){if(f!==0&&h)return this.cacheResult().__iterator(c,h);if(f===0)return new g(X);var l=e.__iterator(c,h),_=0,d=0;return new g(function(){for(;_++<o;)l.next();if(++d>f)return X();var p=l.next();return n||c===dt||p.done?p:c===Ae?M(c,d-1,void 0,p):M(c,d-1,p.value[1],p)})},a}function lu(e,t,r){var n=bt(e);return n.__iterateUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterate(i,o);var u=0;return e.__iterate(function(f,a,c){return t.call(r,f,a,c)&&++u&&i(f,a,s)}),u},n.__iteratorUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterator(i,o);var u=e.__iterator(st,o),f=!0;return new g(function(){if(!f)return X();var a=u.next();if(a.done)return a;var c=a.value,h=c[0],l=c[1];return t.call(r,l,h,s)?i===st?a:M(i,h,l,a):(f=!1,X())})},n}function Wi(e,t,r,n){var i=bt(e);return i.__iterateUncached=function(o,s){var u=this;if(s)return this.cacheResult().__iterate(o,s);var f=!0,a=0;return e.__iterate(function(c,h,l){if(!(f&&(f=t.call(r,c,h,l))))return a++,o(c,n?h:a-1,u)}),a},i.__iteratorUncached=function(o,s){var u=this;if(s)return this.cacheResult().__iterator(o,s);var f=e.__iterator(st,s),a=!0,c=0;return new g(function(){var h,l,_;do{if(h=f.next(),h.done)return n||o===dt?h:o===Ae?M(o,c++,void 0,h):M(o,c++,h.value[1],h);var d=h.value;l=d[0],_=d[1],a&&(a=t.call(r,_,l,u))}while(a);return o===st?h:M(o,l,_,h)})},i}function _u(e,t){var r=I(e),n=[e].concat(t).map(function(s){return G(s)?r&&(s=ot(s)):s=r?Xr(s):Ri(Array.isArray(s)?s:[s]),s}).filter(function(s){return s.size!==0});if(n.length===0)return e;if(n.length===1){var i=n[0];if(i===e||r&&I(i)||V(e)&&V(i))return i}var o=new Jt(n);return r?o=o.toKeyedSeq():V(e)||(o=o.toSetSeq()),o=o.flatten(!0),o.size=n.reduce(function(s,u){if(s!==void 0){var f=u.size;if(f!==void 0)return s+f}},0),o}function Ki(e,t,r){var n=bt(e);return n.__iterateUncached=function(i,o){if(o)return this.cacheResult().__iterate(i,o);var s=0,u=!1;function f(a,c){a.__iterate(function(h,l){return(!t||c<t)&&G(h)?f(h,c+1):(s++,i(h,r?l:s-1,n)===!1&&(u=!0)),!u},o)}return f(e,0),s},n.__iteratorUncached=function(i,o){if(o)return this.cacheResult().__iterator(i,o);var s=e.__iterator(i,o),u=[],f=0;return new g(function(){for(;s;){var a=s.next();if(a.done!==!1){s=u.pop();continue}var c=a.value;if(i===st&&(c=c[1]),(!t||u.length<t)&&G(c))u.push(s),s=c.__iterator(i,o);else return r?a:M(i,f++,c,a)}return X()})},n}function du(e,t,r){var n=Yi(e);return e.toSeq().map(function(i,o){return n(t.call(r,i,o,e))}).flatten(!0)}function pu(e,t){var r=bt(e);return r.size=e.size&&e.size*2-1,r.__iterateUncached=function(n,i){var o=this,s=0;return e.__iterate(function(u){return(!s||n(t,s++,o)!==!1)&&n(u,s++,o)!==!1},i),s},r.__iteratorUncached=function(n,i){var o=e.__iterator(dt,i),s=0,u;return new g(function(){return(!u||s%2)&&(u=o.next(),u.done)?u:s%2?M(n,s++,t):M(n,s++,u.value,u)})},r}function re(e,t,r){t||(t=Gi);var n=I(e),i=0,o=e.toSeq().map(function(s,u){return[u,s,i++,r?r(s,u,e):s]}).valueSeq().toArray();return o.sort(function(s,u){return t(s[3],u[3])||s[2]-u[2]}).forEach(n?function(s,u){o[u].length=2}:function(s,u){o[u]=s[1]}),n?$t(o):V(e)?pt(o):ee(o)}function fr(e,t,r){if(t||(t=Gi),r){var n=e.toSeq().map(function(i,o){return[i,r(i,o,e)]}).reduce(function(i,o){return Fi(t,i[1],o[1])?o:i});return n&&n[0]}return e.reduce(function(i,o){return Fi(t,i,o)?o:i})}function Fi(e,t,r){var n=e(r,t);return n===0&&r!==t&&(r==null||r!==r)||n>0}function cr(e,t,r,n){var i=bt(e),o=new Jt(r).map(function(s){return s.size});return i.size=n?o.max():o.min(),i.__iterate=function(s,u){for(var f=this.__iterator(dt,u),a,c=0;!(a=f.next()).done&&s(a.value,c++,this)!==!1;);return c},i.__iteratorUncached=function(s,u){var f=r.map(function(h){return h=N(h),Yr(u?h.reverse():h)}),a=0,c=!1;return new g(function(){var h;return c||(h=f.map(function(l){return l.next()}),c=n?h.every(function(l){return l.done}):h.some(function(l){return l.done})),c?X():M(s,a++,t.apply(null,h.map(function(l){return l.value})))})},i}function S(e,t){return e===t?e:Fr(e)?t:e.constructor(t)}function Hi(e){if(e!==Object(e))throw new TypeError("Expected [K, V] tuple: "+e)}function Yi(e){return I(e)?ot:V(e)?xt:Xt}function bt(e){return Object.create((I(e)?$t:V(e)?pt:ee).prototype)}function fn(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):Q.prototype.cacheResult.call(this)}function Gi(e,t){return e===void 0&&t===void 0?0:e===void 0?1:t===void 0?-1:e>t?1:e<t?-1:0}function Et(e,t){t=t||0;for(var r=Math.max(0,e.length-t),n=new Array(r),i=0;i<r;i++)n[i]=e[i+t];return n}function cn(e,t){if(!e)throw new Error(t)}function ut(e){cn(e!==1/0,"Cannot perform this action with an infinite size.")}function Vi(e){if(zi(e)&&typeof e!="string")return e;if(_t(e))return e.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+e)}var vu=Object.prototype.toString;function yu(e){if(!e||typeof e!="object"||vu.call(e)!=="[object Object]")return!1;var t=Object.getPrototypeOf(e);if(t===null)return!0;for(var r=t,n=Object.getPrototypeOf(t);n!==null;)r=n,n=Object.getPrototypeOf(r);return r===t}function Ct(e){return typeof e=="object"&&(St(e)||Array.isArray(e)||yu(e))}function Ie(e){try{return typeof e=="string"?JSON.stringify(e):String(e)}catch{return JSON.stringify(e)}}function gu(e,t){return St(e)?e.has(t):Ct(e)&&te.call(e,t)}function Xi(e,t,r){return St(e)?e.get(t,r):gu(e,t)?typeof e.get=="function"?e.get(t):e[t]:r}function hr(e){if(Array.isArray(e))return Et(e);var t={};for(var r in e)te.call(e,r)&&(t[r]=e[r]);return t}function mu(e,t){if(!Ct(e))throw new TypeError("Cannot update non-data-structure value: "+e);if(St(e)){if(!e.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+e);return e.remove(t)}if(!te.call(e,t))return e;var r=hr(e);return Array.isArray(r)?r.splice(t,1):delete r[t],r}function wu(e,t,r){if(!Ct(e))throw new TypeError("Cannot update non-data-structure value: "+e);if(St(e)){if(!e.set)throw new TypeError("Cannot update immutable value without .set() method: "+e);return e.set(t,r)}if(te.call(e,t)&&r===e[t])return e;var n=hr(e);return n[t]=r,n}function ne(e,t,r,n){n||(n=r,r=void 0);var i=Qi(St(e),e,Vi(t),0,r,n);return i===y?r:i}function Qi(e,t,r,n,i,o){var s=t===y;if(n===r.length){var u=s?i:t,f=o(u);return f===u?t:f}if(!s&&!Ct(t))throw new TypeError("Cannot update within non-data-structure value in path ["+r.slice(0,n).map(Ie)+"]: "+t);var a=r[n],c=s?y:Xi(t,a,y),h=Qi(c===y?e:St(c),c,r,n+1,i,o);return h===c?t:h===y?mu(t,a):wu(s?e?vt():{}:t,a,h)}function Su(e,t,r){return ne(e,t,y,function(){return r})}function hn(e,t){return Su(this,e,t)}function bu(e,t){return ne(e,t,function(){return y})}function ln(e){return bu(this,e)}function Zi(e,t,r,n){return ne(e,[t],r,n)}function _n(e,t,r){return arguments.length===1?e(this):Zi(this,e,t,r)}function dn(e,t,r){return ne(this,e,t,r)}function to(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return ro(this,e)}function eo(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if(typeof e!="function")throw new TypeError("Invalid merger function: "+e);return ro(this,t,e)}function ro(e,t,r){for(var n=[],i=0;i<t.length;i++){var o=ot(t[i]);o.size!==0&&n.push(o)}return n.length===0?e:e.toSeq().size===0&&!e.__ownerID&&n.length===1?e.constructor(n[0]):e.withMutations(function(s){for(var u=r?function(a,c){Zi(s,c,y,function(h){return h===y?a:r(h,a,c)})}:function(a,c){s.set(c,a)},f=0;f<n.length;f++)n[f].forEach(u)})}function pn(e,t,r){return vn(e,t,Eu(r))}function vn(e,t,r){if(!Ct(e))throw new TypeError("Cannot merge into non-data-structure value: "+e);if(St(e))return typeof r=="function"&&e.mergeWith?e.mergeWith.apply(e,[r].concat(t)):e.merge?e.merge.apply(e,t):e.concat.apply(e,t);for(var n=Array.isArray(e),i=e,o=n?xt:ot,s=n?function(f){i===e&&(i=hr(i)),i.push(f)}:function(f,a){var c=te.call(i,a),h=c&&r?r(i[a],f,a):f;(!c||h!==i[a])&&(i===e&&(i=hr(i)),i[a]=h)},u=0;u<t.length;u++)o(t[u]).forEach(s);return i}function Eu(e){function t(r,n,i){return Ct(r)&&Ct(n)&&Ou(r,n)?vn(r,[n],t):e?e(r,n,i):n}return t}function Ou(e,t){var r=Q(e),n=Q(t);return V(r)===V(n)&&I(r)===I(n)}function no(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return pn(this,e)}function io(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return pn(this,t,e)}function yn(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return ne(this,e,vt(),function(n){return vn(n,t)})}function gn(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return ne(this,e,vt(),function(n){return pn(n,t)})}function Re(e){var t=this.asMutable();return e(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this}function Ne(){return this.__ownerID?this:this.__ensureOwner(new Kr)}function $e(){return this.__ensureOwner()}function mn(){return this.__altered}var qt=function(e){function t(r){return r==null?vt():Zr(r)&&!_t(r)?r:vt().withMutations(function(n){var i=e(r);ut(i.size),i.forEach(function(o,s){return n.set(s,o)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return vt().withMutations(function(o){for(var s=0;s<n.length;s+=2){if(s+1>=n.length)throw new Error("Missing value for key: "+n[s]);o.set(n[s],n[s+1])}})},t.prototype.toString=function(){return this.__toString("Map {","}")},t.prototype.get=function(n,i){return this._root?this._root.get(0,void 0,n,i):i},t.prototype.set=function(n,i){return uo(this,n,i)},t.prototype.remove=function(n){return uo(this,n,y)},t.prototype.deleteAll=function(n){var i=N(n);return i.size===0?this:this.withMutations(function(o){i.forEach(function(s){return o.remove(s)})})},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):vt()},t.prototype.sort=function(n){return zt(re(this,n))},t.prototype.sortBy=function(n,i){return zt(re(this,i,n))},t.prototype.map=function(n,i){var o=this;return this.withMutations(function(s){s.forEach(function(u,f){s.set(f,n.call(i,u,f,o))})})},t.prototype.__iterator=function(n,i){return new Mu(this,n,i)},t.prototype.__iterate=function(n,i){var o=this,s=0;return this._root&&this._root.iterate(function(u){return s++,n(u[1],u[0],o)},i),s},t.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?Sn(this.size,this._root,n,this.__hash):this.size===0?vt():(this.__ownerID=n,this.__altered=!1,this)},t}(ot);qt.isMap=Zr;var O=qt.prototype;O[Ni]=!0,O[Oe]=O.remove,O.removeAll=O.deleteAll,O.setIn=hn,O.removeIn=O.deleteIn=ln,O.update=_n,O.updateIn=dn,O.merge=O.concat=to,O.mergeWith=eo,O.mergeDeep=no,O.mergeDeepWith=io,O.mergeIn=yn,O.mergeDeepIn=gn,O.withMutations=Re,O.wasAltered=mn,O.asImmutable=$e,O["@@transducer/init"]=O.asMutable=Ne,O["@@transducer/step"]=function(e,t){return e.set(t[0],t[1])},O["@@transducer/result"]=function(e){return e.asImmutable()};var Ce=function(t,r){this.ownerID=t,this.entries=r};Ce.prototype.get=function(t,r,n,i){for(var o=this.entries,s=0,u=o.length;s<u;s++)if(Z(n,o[s][0]))return o[s][1];return i},Ce.prototype.update=function(t,r,n,i,o,s,u){for(var f=o===y,a=this.entries,c=0,h=a.length;c<h&&!Z(i,a[c][0]);c++);var l=c<h;if(l?a[c][1]===o:f)return this;if(it(u),(f||!l)&&it(s),!(f&&a.length===1)){if(!l&&!f&&a.length>=$u)return Au(t,a,i,o);var _=t&&t===this.ownerID,d=_?a:Et(a);return l?f?c===h-1?d.pop():d[c]=d.pop():d[c]=[i,o]:d.push([i,o]),_?(this.entries=d,this):new Ce(t,d)}};var ie=function(t,r,n){this.ownerID=t,this.bitmap=r,this.nodes=n};ie.prototype.get=function(t,r,n,i){r===void 0&&(r=tt(n));var o=1<<((t===0?r:r>>>t)&F),s=this.bitmap;return(s&o)===0?i:this.nodes[fo(s&o-1)].get(t+E,r,n,i)},ie.prototype.update=function(t,r,n,i,o,s,u){n===void 0&&(n=tt(i));var f=(r===0?n:n>>>r)&F,a=1<<f,c=this.bitmap,h=(c&a)!==0;if(!h&&o===y)return this;var l=fo(c&a-1),_=this.nodes,d=h?_[l]:void 0,p=bn(d,t,r+E,n,i,o,s,u);if(p===d)return this;if(!h&&p&&_.length>=Cu)return Iu(t,_,c,f,p);if(h&&!p&&_.length===2&&ao(_[l^1]))return _[l^1];if(h&&p&&_.length===1&&ao(p))return p;var m=t&&t===this.ownerID,R=h?p?c:c^a:c|a,A=h?p?co(_,l,p,m):Nu(_,l,m):Ru(_,l,p,m);return m?(this.bitmap=R,this.nodes=A,this):new ie(t,R,A)};var qe=function(t,r,n){this.ownerID=t,this.count=r,this.nodes=n};qe.prototype.get=function(t,r,n,i){r===void 0&&(r=tt(n));var o=(t===0?r:r>>>t)&F,s=this.nodes[o];return s?s.get(t+E,r,n,i):i},qe.prototype.update=function(t,r,n,i,o,s,u){n===void 0&&(n=tt(i));var f=(r===0?n:n>>>r)&F,a=o===y,c=this.nodes,h=c[f];if(a&&!h)return this;var l=bn(h,t,r+E,n,i,o,s,u);if(l===h)return this;var _=this.count;if(!h)_++;else if(!l&&(_--,_<qu))return zu(t,c,_,f);var d=t&&t===this.ownerID,p=co(c,f,l,d);return d?(this.count=_,this.nodes=p,this):new qe(t,_,p)};var oe=function(t,r,n){this.ownerID=t,this.keyHash=r,this.entries=n};oe.prototype.get=function(t,r,n,i){for(var o=this.entries,s=0,u=o.length;s<u;s++)if(Z(n,o[s][0]))return o[s][1];return i},oe.prototype.update=function(t,r,n,i,o,s,u){n===void 0&&(n=tt(i));var f=o===y;if(n!==this.keyHash)return f?this:(it(u),it(s),En(this,t,r,n,[i,o]));for(var a=this.entries,c=0,h=a.length;c<h&&!Z(i,a[c][0]);c++);var l=c<h;if(l?a[c][1]===o:f)return this;if(it(u),(f||!l)&&it(s),f&&h===2)return new At(t,this.keyHash,a[c^1]);var _=t&&t===this.ownerID,d=_?a:Et(a);return l?f?c===h-1?d.pop():d[c]=d.pop():d[c]=[i,o]:d.push([i,o]),_?(this.entries=d,this):new oe(t,this.keyHash,d)};var At=function(t,r,n){this.ownerID=t,this.keyHash=r,this.entry=n};At.prototype.get=function(t,r,n,i){return Z(n,this.entry[0])?this.entry[1]:i},At.prototype.update=function(t,r,n,i,o,s,u){var f=o===y,a=Z(i,this.entry[0]);if(a?o===this.entry[1]:f)return this;if(it(u),f){it(s);return}return a?t&&t===this.ownerID?(this.entry[1]=o,this):new At(t,this.keyHash,[i,o]):(it(s),En(this,t,r,tt(i),[i,o]))},Ce.prototype.iterate=oe.prototype.iterate=function(e,t){for(var r=this.entries,n=0,i=r.length-1;n<=i;n++)if(e(r[t?i-n:n])===!1)return!1},ie.prototype.iterate=qe.prototype.iterate=function(e,t){for(var r=this.nodes,n=0,i=r.length-1;n<=i;n++){var o=r[t?i-n:n];if(o&&o.iterate(e,t)===!1)return!1}},At.prototype.iterate=function(e,t){return e(this.entry)};var Mu=function(e){function t(r,n,i){this._type=n,this._reverse=i,this._stack=r._root&&oo(r._root)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){for(var n=this._type,i=this._stack;i;){var o=i.node,s=i.index++,u=void 0;if(o.entry){if(s===0)return wn(n,o.entry)}else if(o.entries){if(u=o.entries.length-1,s<=u)return wn(n,o.entries[this._reverse?u-s:s])}else if(u=o.nodes.length-1,s<=u){var f=o.nodes[this._reverse?u-s:s];if(f){if(f.entry)return wn(n,f.entry);i=this._stack=oo(f,i)}continue}i=this._stack=this._stack.__prev}return X()},t}(g);function wn(e,t){return M(e,t[0],t[1])}function oo(e,t){return{node:e,index:0,__prev:t}}function Sn(e,t,r,n){var i=Object.create(O);return i.size=e,i._root=t,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var so;function vt(){return so||(so=Sn(0))}function uo(e,t,r){var n,i;if(e._root){var o=Wr(),s=Wr();if(n=bn(e._root,e.__ownerID,0,void 0,t,r,o,s),!s.value)return e;i=e.size+(o.value?r===y?-1:1:0)}else{if(r===y)return e;i=1,n=new Ce(e.__ownerID,[[t,r]])}return e.__ownerID?(e.size=i,e._root=n,e.__hash=void 0,e.__altered=!0,e):n?Sn(i,n):vt()}function bn(e,t,r,n,i,o,s,u){return e?e.update(t,r,n,i,o,s,u):o===y?e:(it(u),it(s),new At(t,n,[i,o]))}function ao(e){return e.constructor===At||e.constructor===oe}function En(e,t,r,n,i){if(e.keyHash===n)return new oe(t,n,[e.entry,i]);var o=(r===0?e.keyHash:e.keyHash>>>r)&F,s=(r===0?n:n>>>r)&F,u,f=o===s?[En(e,t,r+E,n,i)]:(u=new At(t,n,i),o<s?[e,u]:[u,e]);return new ie(t,1<<o|1<<s,f)}function Au(e,t,r,n){e||(e=new Kr);for(var i=new At(e,tt(r),[r,n]),o=0;o<t.length;o++){var s=t[o];i=i.update(e,0,void 0,s[0],s[1])}return i}function zu(e,t,r,n){for(var i=0,o=0,s=new Array(r),u=0,f=1,a=t.length;u<a;u++,f<<=1){var c=t[u];c!==void 0&&u!==n&&(i|=f,s[o++]=c)}return new ie(e,i,s)}function Iu(e,t,r,n,i){for(var o=0,s=new Array(nt),u=0;r!==0;u++,r>>>=1)s[u]=r&1?t[o++]:void 0;return s[n]=i,new qe(e,o+1,s)}function fo(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function co(e,t,r,n){var i=n?e:Et(e);return i[t]=r,i}function Ru(e,t,r,n){var i=e.length+1;if(n&&t+1===i)return e[t]=r,e;for(var o=new Array(i),s=0,u=0;u<i;u++)u===t?(o[u]=r,s=-1):o[u]=e[u+s];return o}function Nu(e,t,r){var n=e.length-1;if(r&&t===n)return e.pop(),e;for(var i=new Array(n),o=0,s=0;s<n;s++)s===t&&(o=1),i[s]=e[s+o];return i}var $u=nt/4,Cu=nt/2,qu=nt/4,ho="@@__IMMUTABLE_LIST__@@";function lo(e){return Boolean(e&&e[ho])}var lr=function(e){function t(r){var n=_r();if(r==null)return n;if(lo(r))return r;var i=e(r),o=i.size;return o===0?n:(ut(o),o>0&&o<nt?Te(0,o,E,null,new Pt(i.toArray())):n.withMutations(function(s){s.setSize(o),i.forEach(function(u,f){return s.set(f,u)})}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("List [","]")},t.prototype.get=function(n,i){if(n=Nt(this,n),n>=0&&n<this.size){n+=this._origin;var o=vo(this,n);return o&&o.array[n&F]}return i},t.prototype.set=function(n,i){return Pu(this,n,i)},t.prototype.remove=function(n){return this.has(n)?n===0?this.shift():n===this.size-1?this.pop():this.splice(n,1):this},t.prototype.insert=function(n,i){return this.splice(n,0,i)},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=E,this._root=this._tail=this.__hash=void 0,this.__altered=!0,this):_r()},t.prototype.push=function(){var n=arguments,i=this.size;return this.withMutations(function(o){Tt(o,0,i+n.length);for(var s=0;s<n.length;s++)o.set(i+s,n[s])})},t.prototype.pop=function(){return Tt(this,0,-1)},t.prototype.unshift=function(){var n=arguments;return this.withMutations(function(i){Tt(i,-n.length);for(var o=0;o<n.length;o++)i.set(o,n[o])})},t.prototype.shift=function(){return Tt(this,1)},t.prototype.concat=function(){for(var n=arguments,i=[],o=0;o<arguments.length;o++){var s=n[o],u=e(typeof s!="string"&&Mi(s)?s:[s]);u.size!==0&&i.push(u)}return i.length===0?this:this.size===0&&!this.__ownerID&&i.length===1?this.constructor(i[0]):this.withMutations(function(f){i.forEach(function(a){return a.forEach(function(c){return f.push(c)})})})},t.prototype.setSize=function(n){return Tt(this,0,n)},t.prototype.map=function(n,i){var o=this;return this.withMutations(function(s){for(var u=0;u<o.size;u++)s.set(u,n.call(i,s.get(u),u,o))})},t.prototype.slice=function(n,i){var o=this.size;return rr(n,i,o)?this:Tt(this,Me(n,o),nr(i,o))},t.prototype.__iterator=function(n,i){var o=i?this.size:0,s=_o(this,i);return new g(function(){var u=s();return u===Pe?X():M(n,i?--o:o++,u)})},t.prototype.__iterate=function(n,i){for(var o=i?this.size:0,s=_o(this,i),u;(u=s())!==Pe&&n(u,i?--o:o++,this)!==!1;);return o},t.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?Te(this._origin,this._capacity,this._level,this._root,this._tail,n,this.__hash):this.size===0?_r():(this.__ownerID=n,this.__altered=!1,this)},t}(xt);lr.isList=lo;var $=lr.prototype;$[ho]=!0,$[Oe]=$.remove,$.merge=$.concat,$.setIn=hn,$.deleteIn=$.removeIn=ln,$.update=_n,$.updateIn=dn,$.mergeIn=yn,$.mergeDeepIn=gn,$.withMutations=Re,$.wasAltered=mn,$.asImmutable=$e,$["@@transducer/init"]=$.asMutable=Ne,$["@@transducer/step"]=function(e,t){return e.push(t)},$["@@transducer/result"]=function(e){return e.asImmutable()};var Pt=function(t,r){this.array=t,this.ownerID=r};Pt.prototype.removeBefore=function(t,r,n){if(n===r?1<<r:this.array.length===0)return this;var i=n>>>r&F;if(i>=this.array.length)return new Pt([],t);var o=i===0,s;if(r>0){var u=this.array[i];if(s=u&&u.removeBefore(t,r-E,n),s===u&&o)return this}if(o&&!s)return this;var f=se(this,t);if(!o)for(var a=0;a<i;a++)f.array[a]=void 0;return s&&(f.array[i]=s),f},Pt.prototype.removeAfter=function(t,r,n){if(n===(r?1<<r:0)||this.array.length===0)return this;var i=n-1>>>r&F;if(i>=this.array.length)return this;var o;if(r>0){var s=this.array[i];if(o=s&&s.removeAfter(t,r-E,n),o===s&&i===this.array.length-1)return this}var u=se(this,t);return u.array.splice(i+1),o&&(u.array[i]=o),u};var Pe={};function _o(e,t){var r=e._origin,n=e._capacity,i=ke(n),o=e._tail;return s(e._root,e._level,0);function s(a,c,h){return c===0?u(a,h):f(a,c,h)}function u(a,c){var h=c===i?o&&o.array:a&&a.array,l=c>r?0:r-c,_=n-c;return _>nt&&(_=nt),function(){if(l===_)return Pe;var d=t?--_:l++;return h&&h[d]}}function f(a,c,h){var l,_=a&&a.array,d=h>r?0:r-h>>c,p=(n-h>>c)+1;return p>nt&&(p=nt),function(){for(;;){if(l){var m=l();if(m!==Pe)return m;l=null}if(d===p)return Pe;var R=t?--p:d++;l=s(_&&_[R],c-E,h+(R<<c))}}}}function Te(e,t,r,n,i,o,s){var u=Object.create($);return u.size=t-e,u._origin=e,u._capacity=t,u._level=r,u._root=n,u._tail=i,u.__ownerID=o,u.__hash=s,u.__altered=!1,u}var po;function _r(){return po||(po=Te(0,0,E))}function Pu(e,t,r){if(t=Nt(e,t),t!==t)return e;if(t>=e.size||t<0)return e.withMutations(function(s){t<0?Tt(s,t).set(0,r):Tt(s,0,t+1).set(t,r)});t+=e._origin;var n=e._tail,i=e._root,o=Wr();return t>=ke(e._capacity)?n=On(n,e.__ownerID,0,t,r,o):i=On(i,e.__ownerID,e._level,t,r,o),o.value?e.__ownerID?(e._root=i,e._tail=n,e.__hash=void 0,e.__altered=!0,e):Te(e._origin,e._capacity,e._level,i,n):e}function On(e,t,r,n,i,o){var s=n>>>r&F,u=e&&s<e.array.length;if(!u&&i===void 0)return e;var f;if(r>0){var a=e&&e.array[s],c=On(a,t,r-E,n,i,o);return c===a?e:(f=se(e,t),f.array[s]=c,f)}return u&&e.array[s]===i?e:(o&&it(o),f=se(e,t),i===void 0&&s===f.array.length-1?f.array.pop():f.array[s]=i,f)}function se(e,t){return t&&e&&t===e.ownerID?e:new Pt(e?e.array.slice():[],t)}function vo(e,t){if(t>=ke(e._capacity))return e._tail;if(t<1<<e._level+E){for(var r=e._root,n=e._level;r&&n>0;)r=r.array[t>>>n&F],n-=E;return r}}function Tt(e,t,r){t!==void 0&&(t|=0),r!==void 0&&(r|=0);var n=e.__ownerID||new Kr,i=e._origin,o=e._capacity,s=i+t,u=r===void 0?o:r<0?o+r:i+r;if(s===i&&u===o)return e;if(s>=u)return e.clear();for(var f=e._level,a=e._root,c=0;s+c<0;)a=new Pt(a&&a.array.length?[void 0,a]:[],n),f+=E,c+=1<<f;c&&(s+=c,i+=c,u+=c,o+=c);for(var h=ke(o),l=ke(u);l>=1<<f+E;)a=new Pt(a&&a.array.length?[a]:[],n),f+=E;var _=e._tail,d=l<h?vo(e,u-1):l>h?new Pt([],n):_;if(_&&l>h&&s<o&&_.array.length){a=se(a,n);for(var p=a,m=f;m>E;m-=E){var R=h>>>m&F;p=p.array[R]=se(p.array[R],n)}p.array[h>>>E&F]=_}if(u<o&&(d=d&&d.removeAfter(n,0,u)),s>=l)s-=l,u-=l,f=E,a=null,d=d&&d.removeBefore(n,0,s);else if(s>i||l<h){for(c=0;a;){var A=s>>>f&F;if(A!==l>>>f&F)break;A&&(c+=(1<<f)*A),f-=E,a=a.array[A]}a&&s>i&&(a=a.removeBefore(n,f,s-c)),a&&l<h&&(a=a.removeAfter(n,f,l-c)),c&&(s-=c,u-=c)}return e.__ownerID?(e.size=u-s,e._origin=s,e._capacity=u,e._level=f,e._root=a,e._tail=d,e.__hash=void 0,e.__altered=!0,e):Te(s,u,f,a,d)}function ke(e){return e<nt?0:e-1>>>E<<E}var zt=function(e){function t(r){return r==null?Le():$i(r)?r:Le().withMutations(function(n){var i=ot(r);ut(i.size),i.forEach(function(o,s){return n.set(s,o)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("OrderedMap {","}")},t.prototype.get=function(n,i){var o=this._map.get(n);return o!==void 0?this._list.get(o)[1]:i},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this.__altered=!0,this):Le()},t.prototype.set=function(n,i){return go(this,n,i)},t.prototype.remove=function(n){return go(this,n,y)},t.prototype.__iterate=function(n,i){var o=this;return this._list.__iterate(function(s){return s&&n(s[1],s[0],o)},i)},t.prototype.__iterator=function(n,i){return this._list.fromEntrySeq().__iterator(n,i)},t.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n),o=this._list.__ensureOwner(n);return n?Mn(i,o,n,this.__hash):this.size===0?Le():(this.__ownerID=n,this.__altered=!1,this._map=i,this._list=o,this)},t}(qt);zt.isOrderedMap=$i,zt.prototype[Zt]=!0,zt.prototype[Oe]=zt.prototype.remove;function Mn(e,t,r,n){var i=Object.create(zt.prototype);return i.size=e?e.size:0,i._map=e,i._list=t,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var yo;function Le(){return yo||(yo=Mn(vt(),_r()))}function go(e,t,r){var n=e._map,i=e._list,o=n.get(t),s=o!==void 0,u,f;if(r===y){if(!s)return e;i.size>=nt&&i.size>=n.size*2?(f=i.filter(function(a,c){return a!==void 0&&o!==c}),u=f.toKeyedSeq().map(function(a){return a[0]}).flip().toMap(),e.__ownerID&&(u.__ownerID=f.__ownerID=e.__ownerID)):(u=n.remove(t),f=o===i.size-1?i.pop():i.set(o,void 0))}else if(s){if(r===i.get(o)[1])return e;u=n,f=i.set(o,[t,r])}else u=n.set(t,i.size),f=i.set(i.size,[t,r]);return e.__ownerID?(e.size=u.size,e._map=u,e._list=f,e.__hash=void 0,e.__altered=!0,e):Mn(u,f)}var mo="@@__IMMUTABLE_STACK__@@";function An(e){return Boolean(e&&e[mo])}var zn=function(e){function t(r){return r==null?dr():An(r)?r:dr().pushAll(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("Stack [","]")},t.prototype.get=function(n,i){var o=this._head;for(n=Nt(this,n);o&&n--;)o=o.next;return o?o.value:i},t.prototype.peek=function(){return this._head&&this._head.value},t.prototype.push=function(){var n=arguments;if(arguments.length===0)return this;for(var i=this.size+arguments.length,o=this._head,s=arguments.length-1;s>=0;s--)o={value:n[s],next:o};return this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):je(i,o)},t.prototype.pushAll=function(n){if(n=e(n),n.size===0)return this;if(this.size===0&&An(n))return n;ut(n.size);var i=this.size,o=this._head;return n.__iterate(function(s){i++,o={value:s,next:o}},!0),this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):je(i,o)},t.prototype.pop=function(){return this.slice(1)},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):dr()},t.prototype.slice=function(n,i){if(rr(n,i,this.size))return this;var o=Me(n,this.size),s=nr(i,this.size);if(s!==this.size)return e.prototype.slice.call(this,n,i);for(var u=this.size-o,f=this._head;o--;)f=f.next;return this.__ownerID?(this.size=u,this._head=f,this.__hash=void 0,this.__altered=!0,this):je(u,f)},t.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?je(this.size,this._head,n,this.__hash):this.size===0?dr():(this.__ownerID=n,this.__altered=!1,this)},t.prototype.__iterate=function(n,i){var o=this;if(i)return new Jt(this.toArray()).__iterate(function(f,a){return n(f,a,o)},i);for(var s=0,u=this._head;u&&n(u.value,s++,this)!==!1;)u=u.next;return s},t.prototype.__iterator=function(n,i){if(i)return new Jt(this.toArray()).__iterator(n,i);var o=0,s=this._head;return new g(function(){if(s){var u=s.value;return s=s.next,M(n,o++,u)}return X()})},t}(xt);zn.isStack=An;var H=zn.prototype;H[mo]=!0,H.shift=H.pop,H.unshift=H.push,H.unshiftAll=H.pushAll,H.withMutations=Re,H.wasAltered=mn,H.asImmutable=$e,H["@@transducer/init"]=H.asMutable=Ne,H["@@transducer/step"]=function(e,t){return e.unshift(t)},H["@@transducer/result"]=function(e){return e.asImmutable()};function je(e,t,r,n){var i=Object.create(H);return i.size=e,i._head=t,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var wo;function dr(){return wo||(wo=je(0))}var So="@@__IMMUTABLE_SET__@@";function In(e){return Boolean(e&&e[So])}function bo(e){return In(e)&&_t(e)}function Eo(e,t){if(e===t)return!0;if(!G(t)||e.size!==void 0&&t.size!==void 0&&e.size!==t.size||e.__hash!==void 0&&t.__hash!==void 0&&e.__hash!==t.__hash||I(e)!==I(t)||V(e)!==V(t)||_t(e)!==_t(t))return!1;if(e.size===0&&t.size===0)return!0;var r=!ir(e);if(_t(e)){var n=e.entries();return t.every(function(f,a){var c=n.next().value;return c&&Z(c[1],f)&&(r||Z(c[0],a))})&&n.next().done}var i=!1;if(e.size===void 0)if(t.size===void 0)typeof e.cacheResult=="function"&&e.cacheResult();else{i=!0;var o=e;e=t,t=o}var s=!0,u=t.__iterate(function(f,a){if(r?!e.has(f):i?!Z(f,e.get(a,y)):!Z(e.get(a,y),f))return s=!1,!1});return s&&e.size===u}function Ut(e,t){var r=function(n){e.prototype[n]=t[n]};return Object.keys(t).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(r),e}function pr(e){if(!e||typeof e!="object")return e;if(!G(e)){if(!Ct(e))return e;e=Q(e)}if(I(e)){var t={};return e.__iterate(function(n,i){t[i]=pr(n)}),t}var r=[];return e.__iterate(function(n){r.push(pr(n))}),r}var vr=function(e){function t(r){return r==null?De():In(r)&&!_t(r)?r:De().withMutations(function(n){var i=e(r);ut(i.size),i.forEach(function(o){return n.add(o)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(n){return this(ot(n).keySeq())},t.intersect=function(n){return n=N(n).toArray(),n.length?J.intersect.apply(t(n.pop()),n):De()},t.union=function(n){return n=N(n).toArray(),n.length?J.union.apply(t(n.pop()),n):De()},t.prototype.toString=function(){return this.__toString("Set {","}")},t.prototype.has=function(n){return this._map.has(n)},t.prototype.add=function(n){return yr(this,this._map.set(n,n))},t.prototype.remove=function(n){return yr(this,this._map.remove(n))},t.prototype.clear=function(){return yr(this,this._map.clear())},t.prototype.map=function(n,i){var o=this,s=!1,u=yr(this,this._map.mapEntries(function(f){var a=f[1],c=n.call(i,a,a,o);return c!==a&&(s=!0),[c,c]},i));return s?u:this},t.prototype.union=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return n=n.filter(function(o){return o.size!==0}),n.length===0?this:this.size===0&&!this.__ownerID&&n.length===1?this.constructor(n[0]):this.withMutations(function(o){for(var s=0;s<n.length;s++)e(n[s]).forEach(function(u){return o.add(u)})})},t.prototype.intersect=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(s){return e(s)});var o=[];return this.forEach(function(s){n.every(function(u){return u.includes(s)})||o.push(s)}),this.withMutations(function(s){o.forEach(function(u){s.remove(u)})})},t.prototype.subtract=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(s){return e(s)});var o=[];return this.forEach(function(s){n.some(function(u){return u.includes(s)})&&o.push(s)}),this.withMutations(function(s){o.forEach(function(u){s.remove(u)})})},t.prototype.sort=function(n){return Je(re(this,n))},t.prototype.sortBy=function(n,i){return Je(re(this,i,n))},t.prototype.wasAltered=function(){return this._map.wasAltered()},t.prototype.__iterate=function(n,i){var o=this;return this._map.__iterate(function(s){return n(s,s,o)},i)},t.prototype.__iterator=function(n,i){return this._map.__iterator(n,i)},t.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n);return n?this.__make(i,n):this.size===0?this.__empty():(this.__ownerID=n,this._map=i,this)},t}(Xt);vr.isSet=In;var J=vr.prototype;J[So]=!0,J[Oe]=J.remove,J.merge=J.concat=J.union,J.withMutations=Re,J.asImmutable=$e,J["@@transducer/init"]=J.asMutable=Ne,J["@@transducer/step"]=function(e,t){return e.add(t)},J["@@transducer/result"]=function(e){return e.asImmutable()},J.__empty=De,J.__make=Oo;function yr(e,t){return e.__ownerID?(e.size=t.size,e._map=t,e):t===e._map?e:t.size===0?e.__empty():e.__make(t)}function Oo(e,t){var r=Object.create(J);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}var Mo;function De(){return Mo||(Mo=Oo(vt()))}var Tu=function(e){function t(r,n,i){if(!(this instanceof t))return new t(r,n,i);if(cn(i!==0,"Cannot step a Range by 0"),r=r||0,n===void 0&&(n=1/0),i=i===void 0?1:Math.abs(i),n<r&&(i=-i),this._start=r,this._end=n,this._step=i,this.size=Math.max(0,Math.ceil((n-r)/i-1)+1),this.size===0){if(Rn)return Rn;Rn=this}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return this.size===0?"Range []":"Range [ "+this._start+"..."+this._end+(this._step!==1?" by "+this._step:"")+" ]"},t.prototype.get=function(n,i){return this.has(n)?this._start+Nt(this,n)*this._step:i},t.prototype.includes=function(n){var i=(n-this._start)/this._step;return i>=0&&i<this.size&&i===Math.floor(i)},t.prototype.slice=function(n,i){return rr(n,i,this.size)?this:(n=Me(n,this.size),i=nr(i,this.size),i<=n?new t(0,0):new t(this.get(n,this._end),this.get(i,this._end),this._step))},t.prototype.indexOf=function(n){var i=n-this._start;if(i%this._step===0){var o=i/this._step;if(o>=0&&o<this.size)return o}return-1},t.prototype.lastIndexOf=function(n){return this.indexOf(n)},t.prototype.__iterate=function(n,i){for(var o=this.size,s=this._step,u=i?this._start+(o-1)*s:this._start,f=0;f!==o&&n(u,i?o-++f:f++,this)!==!1;)u+=i?-s:s;return f},t.prototype.__iterator=function(n,i){var o=this.size,s=this._step,u=i?this._start+(o-1)*s:this._start,f=0;return new g(function(){if(f===o)return X();var a=u;return u+=i?-s:s,M(n,i?o-++f:f++,a)})},t.prototype.equals=function(n){return n instanceof t?this._start===n._start&&this._end===n._end&&this._step===n._step:Eo(this,n)},t}(pt),Rn;function Ao(e,t,r){for(var n=Vi(t),i=0;i!==n.length;)if(e=Xi(e,n[i++],y),e===y)return r;return e}function zo(e,t){return Ao(this,e,t)}function ku(e,t){return Ao(e,t,y)!==y}function Lu(e){return ku(this,e)}function Io(){ut(this.size);var e={};return this.__iterate(function(t,r){e[r]=t}),e}N.isIterable=G,N.isKeyed=I,N.isIndexed=V,N.isAssociative=ir,N.isOrdered=_t,N.Iterator=g,Ut(N,{toArray:function(){ut(this.size);var t=new Array(this.size||0),r=I(this),n=0;return this.__iterate(function(i,o){t[n++]=r?[o,i]:i}),t},toIndexedSeq:function(){return new ji(this)},toJS:function(){return pr(this)},toKeyedSeq:function(){return new ar(this,!0)},toMap:function(){return qt(this.toKeyedSeq())},toObject:Io,toOrderedMap:function(){return zt(this.toKeyedSeq())},toOrderedSet:function(){return Je(I(this)?this.valueSeq():this)},toSet:function(){return vr(I(this)?this.valueSeq():this)},toSetSeq:function(){return new Di(this)},toSeq:function(){return V(this)?this.toIndexedSeq():I(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return zn(I(this)?this.valueSeq():this)},toList:function(){return lr(I(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(t,r){return this.size===0?t+r:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+r},concat:function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return S(this,_u(this,t))},includes:function(t){return this.some(function(r){return Z(r,t)})},entries:function(){return this.__iterator(st)},every:function(t,r){ut(this.size);var n=!0;return this.__iterate(function(i,o,s){if(!t.call(r,i,o,s))return n=!1,!1}),n},filter:function(t,r){return S(this,Ui(this,t,r,!0))},find:function(t,r,n){var i=this.findEntry(t,r);return i?i[1]:n},forEach:function(t,r){return ut(this.size),this.__iterate(r?t.bind(r):t)},join:function(t){ut(this.size),t=t!==void 0?""+t:",";var r="",n=!0;return this.__iterate(function(i){n?n=!1:r+=t,r+=i!=null?i.toString():""}),r},keys:function(){return this.__iterator(Ae)},map:function(t,r){return S(this,Bi(this,t,r))},reduce:function(t,r,n){return Ro(this,t,r,n,arguments.length<2,!1)},reduceRight:function(t,r,n){return Ro(this,t,r,n,arguments.length<2,!0)},reverse:function(){return S(this,un(this,!0))},slice:function(t,r){return S(this,an(this,t,r,!0))},some:function(t,r){return!this.every(gr(t),r)},sort:function(t){return S(this,re(this,t))},values:function(){return this.__iterator(dt)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return this.size!==void 0?this.size===0:!this.some(function(){return!0})},count:function(t,r){return Vt(t?this.toSeq().filter(t,r):this)},countBy:function(t,r){return cu(this,t,r)},equals:function(t){return Eo(this,t)},entrySeq:function(){var t=this;if(t._cache)return new Jt(t._cache);var r=t.toSeq().map(Du).toIndexedSeq();return r.fromEntrySeq=function(){return t.toSeq()},r},filterNot:function(t,r){return this.filter(gr(t),r)},findEntry:function(t,r,n){var i=n;return this.__iterate(function(o,s,u){if(t.call(r,o,s,u))return i=[s,o],!1}),i},findKey:function(t,r){var n=this.findEntry(t,r);return n&&n[0]},findLast:function(t,r,n){return this.toKeyedSeq().reverse().find(t,r,n)},findLastEntry:function(t,r,n){return this.toKeyedSeq().reverse().findEntry(t,r,n)},findLastKey:function(t,r){return this.toKeyedSeq().reverse().findKey(t,r)},first:function(t){return this.find(vi,null,t)},flatMap:function(t,r){return S(this,du(this,t,r))},flatten:function(t){return S(this,Ki(this,t,!0))},fromEntrySeq:function(){return new xi(this)},get:function(t,r){return this.find(function(n,i){return Z(i,t)},void 0,r)},getIn:zo,groupBy:function(t,r){return hu(this,t,r)},has:function(t){return this.get(t,y)!==y},hasIn:Lu,isSubset:function(t){return t=typeof t.includes=="function"?t:N(t),this.every(function(r){return t.includes(r)})},isSuperset:function(t){return t=typeof t.isSubset=="function"?t:N(t),t.isSubset(this)},keyOf:function(t){return this.findKey(function(r){return Z(r,t)})},keySeq:function(){return this.toSeq().map(ju).toIndexedSeq()},last:function(t){return this.toSeq().reverse().first(t)},lastKeyOf:function(t){return this.toKeyedSeq().reverse().keyOf(t)},max:function(t){return fr(this,t)},maxBy:function(t,r){return fr(this,r,t)},min:function(t){return fr(this,t?No(t):Co)},minBy:function(t,r){return fr(this,r?No(r):Co,t)},rest:function(){return this.slice(1)},skip:function(t){return t===0?this:this.slice(Math.max(0,t))},skipLast:function(t){return t===0?this:this.slice(0,-Math.max(0,t))},skipWhile:function(t,r){return S(this,Wi(this,t,r,!0))},skipUntil:function(t,r){return this.skipWhile(gr(t),r)},sortBy:function(t,r){return S(this,re(this,r,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return this.slice(-Math.max(0,t))},takeWhile:function(t,r){return S(this,lu(this,t,r))},takeUntil:function(t,r){return this.takeWhile(gr(t),r)},update:function(t){return t(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=xu(this))}});var W=N.prototype;W[mi]=!0,W[or]=W.values,W.toJSON=W.toArray,W.__toStringMapper=Ie,W.inspect=W.toSource=function(){return this.toString()},W.chain=W.flatMap,W.contains=W.includes,Ut(ot,{flip:function(){return S(this,Ji(this))},mapEntries:function(t,r){var n=this,i=0;return S(this,this.toSeq().map(function(o,s){return t.call(r,[s,o],i++,n)}).fromEntrySeq())},mapKeys:function(t,r){var n=this;return S(this,this.toSeq().flip().map(function(i,o){return t.call(r,i,o,n)}).flip())}});var xe=ot.prototype;xe[wi]=!0,xe[or]=W.entries,xe.toJSON=Io,xe.__toStringMapper=function(e,t){return Ie(t)+": "+Ie(e)},Ut(xt,{toKeyedSeq:function(){return new ar(this,!1)},filter:function(t,r){return S(this,Ui(this,t,r,!1))},findIndex:function(t,r){var n=this.findEntry(t,r);return n?n[0]:-1},indexOf:function(t){var r=this.keyOf(t);return r===void 0?-1:r},lastIndexOf:function(t){var r=this.lastKeyOf(t);return r===void 0?-1:r},reverse:function(){return S(this,un(this,!1))},slice:function(t,r){return S(this,an(this,t,r,!1))},splice:function(t,r){var n=arguments.length;if(r=Math.max(r||0,0),n===0||n===2&&!r)return this;t=Me(t,t<0?this.count():this.size);var i=this.slice(0,t);return S(this,n===1?i:i.concat(Et(arguments,2),this.slice(t+r)))},findLastIndex:function(t,r){var n=this.findLastEntry(t,r);return n?n[0]:-1},first:function(t){return this.get(0,t)},flatten:function(t){return S(this,Ki(this,t,!1))},get:function(t,r){return t=Nt(this,t),t<0||this.size===1/0||this.size!==void 0&&t>this.size?r:this.find(function(n,i){return i===t},void 0,r)},has:function(t){return t=Nt(this,t),t>=0&&(this.size!==void 0?this.size===1/0||t<this.size:this.indexOf(t)!==-1)},interpose:function(t){return S(this,pu(this,t))},interleave:function(){var t=[this].concat(Et(arguments)),r=cr(this.toSeq(),pt.of,t),n=r.flatten(!0);return r.size&&(n.size=r.size*t.length),S(this,n)},keySeq:function(){return Tu(0,this.size)},last:function(t){return this.get(-1,t)},skipWhile:function(t,r){return S(this,Wi(this,t,r,!1))},zip:function(){var t=[this].concat(Et(arguments));return S(this,cr(this,$o,t))},zipAll:function(){var t=[this].concat(Et(arguments));return S(this,cr(this,$o,t,!0))},zipWith:function(t){var r=Et(arguments);return r[0]=this,S(this,cr(this,t,r))}});var ue=xt.prototype;ue[Si]=!0,ue[Zt]=!0,Ut(Xt,{get:function(t,r){return this.has(t)?t:r},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}});var ae=Xt.prototype;ae.has=W.includes,ae.contains=ae.includes,ae.keys=ae.values,Ut($t,xe),Ut(pt,ue),Ut(ee,ae);function Ro(e,t,r,n,i,o){return ut(e.size),e.__iterate(function(s,u,f){i?(i=!1,r=s):r=t.call(n,r,s,u,f)},o),r}function ju(e,t){return t}function Du(e,t){return[t,e]}function gr(e){return function(){return!e.apply(this,arguments)}}function No(e){return function(){return-e.apply(this,arguments)}}function $o(){return Et(arguments)}function Co(e,t){return e<t?1:e>t?-1:0}function xu(e){if(e.size===1/0)return 0;var t=_t(e),r=I(e),n=t?1:0,i=e.__iterate(r?t?function(o,s){n=31*n+qo(tt(o),tt(s))|0}:function(o,s){n=n+qo(tt(o),tt(s))|0}:t?function(o){n=31*n+tt(o)|0}:function(o){n=n+tt(o)|0});return Ju(i,n)}function Ju(e,t){return t=ze(t,3432918353),t=ze(t<<15|t>>>-15,461845907),t=ze(t<<13|t>>>-13,5),t=(t+3864292196|0)^e,t=ze(t^t>>>16,2246822507),t=ze(t^t>>>13,3266489909),t=ur(t^t>>>16),t}function qo(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}var Je=function(e){function t(r){return r==null?Nn():bo(r)?r:Nn().withMutations(function(n){var i=Xt(r);ut(i.size),i.forEach(function(o){return n.add(o)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(n){return this(ot(n).keySeq())},t.prototype.toString=function(){return this.__toString("OrderedSet {","}")},t}(vr);Je.isOrderedSet=bo;var Wt=Je.prototype;Wt[Zt]=!0,Wt.zip=ue.zip,Wt.zipWith=ue.zipWith,Wt.zipAll=ue.zipAll,Wt.__empty=Nn,Wt.__make=Po;function Po(e,t){var r=Object.create(Wt);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}var To;function Nn(){return To||(To=Po(Le()))}function Bu(e){if(Qt(e))throw new Error("Can not call `Record` with an immutable Record as default values. Use a plain javascript object instead.");if(St(e))throw new Error("Can not call `Record` with an immutable Collection as default values. Use a plain javascript object instead.");if(e===null||typeof e!="object")throw new Error("Can not call `Record` with a non-object as default values. Use a plain javascript object instead.")}var L=function(t,r){var n;Bu(t);var i=function(u){var f=this;if(u instanceof i)return u;if(!(this instanceof i))return new i(u);if(!n){n=!0;var a=Object.keys(t),c=o._indices={};o._name=r,o._keys=a,o._defaultValues=t;for(var h=0;h<a.length;h++){var l=a[h];c[l]=h,o[l]?typeof console=="object"&&console.warn&&console.warn("Cannot define "+Cn(this)+' with property "'+l+'" since that property name is part of the Record API.'):Uu(o,l)}}return this.__ownerID=void 0,this._values=lr().withMutations(function(_){_.setSize(f._keys.length),ot(u).forEach(function(d,p){_.set(f._indices[p],d===f._defaultValues[p]?void 0:d)})}),this},o=i.prototype=Object.create(b);return o.constructor=i,r&&(i.displayName=r),i};L.prototype.toString=function(){for(var t=Cn(this)+" { ",r=this._keys,n,i=0,o=r.length;i!==o;i++)n=r[i],t+=(i?", ":"")+n+": "+Ie(this.get(n));return t+" }"},L.prototype.equals=function(t){return this===t||Qt(t)&&fe(this).equals(fe(t))},L.prototype.hashCode=function(){return fe(this).hashCode()},L.prototype.has=function(t){return this._indices.hasOwnProperty(t)},L.prototype.get=function(t,r){if(!this.has(t))return r;var n=this._indices[t],i=this._values.get(n);return i===void 0?this._defaultValues[t]:i},L.prototype.set=function(t,r){if(this.has(t)){var n=this._values.set(this._indices[t],r===this._defaultValues[t]?void 0:r);if(n!==this._values&&!this.__ownerID)return $n(this,n)}return this},L.prototype.remove=function(t){return this.set(t)},L.prototype.clear=function(){var t=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:$n(this,t)},L.prototype.wasAltered=function(){return this._values.wasAltered()},L.prototype.toSeq=function(){return fe(this)},L.prototype.toJS=function(){return pr(this)},L.prototype.entries=function(){return this.__iterator(st)},L.prototype.__iterator=function(t,r){return fe(this).__iterator(t,r)},L.prototype.__iterate=function(t,r){return fe(this).__iterate(t,r)},L.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var r=this._values.__ensureOwner(t);return t?$n(this,r,t):(this.__ownerID=t,this._values=r,this)},L.isRecord=Qt,L.getDescriptiveName=Cn;var b=L.prototype;b[Ei]=!0,b[Oe]=b.remove,b.deleteIn=b.removeIn=ln,b.getIn=zo,b.hasIn=W.hasIn,b.merge=to,b.mergeWith=eo,b.mergeIn=yn,b.mergeDeep=no,b.mergeDeepWith=io,b.mergeDeepIn=gn,b.setIn=hn,b.update=_n,b.updateIn=dn,b.withMutations=Re,b.asMutable=Ne,b.asImmutable=$e,b[or]=b.entries,b.toJSON=b.toObject=W.toObject,b.inspect=b.toSource=function(){return this.toString()};function $n(e,t,r){var n=Object.create(Object.getPrototypeOf(e));return n._values=t,n.__ownerID=r,n}function Cn(e){return e.constructor.displayName||e.constructor.name||"Record"}function fe(e){return Xr(e._keys.map(function(t){return[t,e.get(t)]}))}function Uu(e,t){try{Object.defineProperty(e,t,{get:function(){return this.get(t)},set:function(r){cn(this.__ownerID,"Cannot set on an immutable record."),this.set(t,r)}})}catch{}}const Wu=x('<div><fieldset><legend>\u6807\u8BB0</legend><input type="text" placeholder="\u7559\u8A00"><button type="button">\u6211\u6B63\u5728\u505A</button><button type="button">\u6211\u5F88\u786E\u5B9A</button><button type="button">\u6211\u4E0D\u786E\u5B9A</button></fieldset><div><fieldset><legend> \u7559\u8A00 </legend><ul></ul></fieldset><div></div></div></div>'),Ku=x("<li><span></span></li>"),ko=x("<div><p><strong></strong></p><ul></ul></div>"),Lo=x("<li></li>"),Fu=x("<li><pre></pre><ul></ul></li>"),Hu=x("<div></div>"),Yu=x("<ul></ul>"),Gu=x("<li><a></a></li>"),Vu=x("<p><strong></strong></p>");function qn(e,t){return e===t?0:e<t?-1:1}function jo(e){switch(e){case ct.Sure:return 0;case ct.WorkingOn:return 1;case ct.NotSure:return 2}}function Do([e,t],[r,n]){return Hs(ft(t,n)).with(ft(void 0,void 0),()=>qn(e,r)).with(ft(void 0,er.not(void 0)),()=>1).with(ft(er.not(void 0),void 0),()=>-1).with(ft(er.not(void 0),er.not(void 0)),([i,o])=>{const s=jo(o)-jo(i);return s===0?qn(e,r):s}).exhaustive()}function xo([e,t],[r,n]){var i,o;return Do(ft(e,(i=t.context)==null?void 0:i.state),ft(r,(o=n.context)==null?void 0:o.state))}function Jo([e,t],[r,n]){return Do(ft(e,t==null?void 0:t.state),ft(r,n==null?void 0:n.state))}function mr(e){if(e!==void 0)switch(e){case ct.WorkingOn:return z.stateWorkingOn;case ct.NotSure:return z.stateNotSure;case ct.Sure:return z.stateSure}}function Bo(e,t){return`${Math.floor(e*100/t)}%`}function Pn([e],[t]){return qn(e,t)}class Tn{constructor(t,r,n){et(this,"_details",qt());this.updateUI=pe(()=>{const[i,o]=Bn(qt(),{}),s=()=>o(this._details),u=n(i);let f=r.querySelector(".item-type");return ii(HTMLElement,f),f.classList.add(z.clickable),f.addEventListener("click",()=>{let a=f==null?void 0:f.getBoundingClientRect();const c=qr({title:"\u8BE6\u7EC6\u7B54\u6848",height:200,width:300,top:a==null?void 0:a.top,left:a==null?void 0:a.left});ge(()=>(()=>{const h=Wu.cloneNode(!0),l=h.firstChild,_=l.firstChild,d=_.nextSibling,p=d.nextSibling,m=p.nextSibling,R=m.nextSibling,A=l.nextSibling,j=A.firstChild,yt=j.firstChild,kt=yt.nextSibling,wr=j.nextSibling;return d.addEventListener("change",T=>Ot.updateMsg(t,T.currentTarget.value)),p.addEventListener("click",()=>Ot.updateState(t,ct.WorkingOn)),m.addEventListener("click",()=>Ot.updateState(t,ct.Sure)),R.addEventListener("click",()=>Ot.updateState(t,ct.NotSure)),w(kt,K(Rt,{get each(){return Y(i()).then(pi(xo)).then(Ee).t},children:([T,{context:Kt}])=>{if(Kt===void 0)return;let It=Kt.msg;if(Kt.state===ct.WorkingOn&&(It=It!=null?It:"\u6211\u6B63\u5728\u505A"),It!==void 0)return(()=>{const Ft=Ku.cloneNode(!0),Ue=Ft.firstChild;return w(Ue,`${T}: `),w(Ft,It,null),D(Lt=>{const Sr=mr(Kt.state),br=z.answerMsgName;return Sr!==Lt._v$8&&P(Ft,Lt._v$8=Sr),br!==Lt._v$9&&P(Ue,Lt._v$9=br),Lt},{_v$8:void 0,_v$9:void 0}),Ft})()}})),w(wr,K(u,{})),D(T=>{const Kt=z.mainBody,It=z.answerMark,Ft=z.stateWorkingOn,Ue=z.stateSure,Lt=z.stateNotSure,Sr={[z.answerMsg]:!0},br={[z.answerDetail]:!0};return Kt!==T._v$&&P(h,T._v$=Kt),It!==T._v$2&&P(l,T._v$2=It),Ft!==T._v$3&&P(p,T._v$3=Ft),Ue!==T._v$4&&P(m,T._v$4=Ue),Lt!==T._v$5&&P(R,T._v$5=Lt),T._v$6=Qe(j,Sr,T._v$6),T._v$7=Qe(wr,br,T._v$7),T},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0}),h})(),c.document.body)}),s})}updateAnswer(t,r){this._details=this._details.set(t,r)}}class Uo{constructor(t){this._ele=t}setContent(t){this._ele.setAttribute("title",t)}}class Xu extends Tn{constructor(t,r,n){const i=Y(r.querySelectorAll(".item-body .checkboxInput, .item-body .radioInput")).then(o=>Array.from(o)).then(Br).then(Dt(new Map,(o,[s,u])=>o.set(String.fromCharCode(s+65),new Uo(u)))).t;super(t,r,o=>{const s=Mr(()=>Y(o()).then(Dt(new Map,(u,[f,{answer:a,context:c}])=>{var h;if(a!==void 0)for(let l of a){l=n(l);const _=(h=u.get(l))!=null?h:[];return _.push([f,c]),u.set(l,_)}return u})).then(Ee).t.sort(Pn));return Un(()=>{Y(s()).then(Ur(([u,f])=>{var a;(a=i.get(u))==null||a.setContent(Bo(f.length,o().size))}))}),()=>K(Rt,{get each(){return s()},children:([u,f])=>(()=>{const a=ko.cloneNode(!0),c=a.firstChild,h=c.firstChild,l=c.nextSibling;return w(h,u),w(l,K(Rt,{get each(){return f.sort(Jo)},children:([_,d])=>(()=>{const p=Lo.cloneNode(!0);return w(p,_),D(()=>P(p,mr(d==null?void 0:d.state))),p})()})),a})()})})}}class Qu extends Tn{constructor(t,r){const n=Y(r.querySelectorAll(".item-body .blank-item-dynamic")).then(Array.from).then(Br).then(Dt(new Map,(i,[o,s])=>i.set(String.fromCharCode(o+49),new Uo(s)))).t;super(t,r,i=>{const o=()=>Y(i()).then(Dt(new Map,(s,[u,{answer:f,context:a}])=>f===void 0?s:Y(f).then(Object.entries).then(Dt(s,(c,[h,l])=>{var p,m;l=l.trim();const _=(p=c.get(h))!=null?p:new Map,d=(m=_.get(l))!=null?m:[];return d.push([u,a]),c.set(h,_.set(l,d))})).t)).then(di(([s,u])=>ft(s,Y(u).then(Ee).t.sort(Pn)))).then(Ee).t.sort(Pn);return Un(()=>{Y(o()).then(Ur(([s,u])=>{var a;const f=Y(u).then(di(([c,h])=>ft(c,h.length))).then(pi(([c,h],[l,_])=>_-h)).then(Vs).t;(a=n.get(s))==null||a.setContent(f===void 0?"":`(${Bo(f[1],i().size)}) ${f[0]}`)}))}),()=>K(Rt,{get each(){return o()},children:([s,u])=>(()=>{const f=ko.cloneNode(!0),a=f.firstChild,c=a.firstChild,h=a.nextSibling;return w(c,`#${s}`),w(h,K(Rt,{each:u,children:([l,_])=>(()=>{const d=Fu.cloneNode(!0),p=d.firstChild,m=p.nextSibling;return w(p,l),w(m,K(Rt,{get each(){return _.sort(Jo)},children:([R,A])=>(()=>{const j=Lo.cloneNode(!0);return w(j,R),D(()=>P(j,mr(A==null?void 0:A.state))),j})()})),d})()})),f})()})})}}class Zu extends Tn{constructor(t,r){super(t,r,n=>{const i=Mr(()=>Y(n()).then(Ee).t.sort(xo));return()=>K(Rt,{get each(){return i()},children:([o,{answer:s,context:u}])=>{var l;const f=s==null?void 0:s.content,a=(l=s==null?void 0:s.attachments)==null?void 0:l.filelist;let c,h;if(f!==void 0&&(c=(()=>{const _=Hu.cloneNode(!0);return _.innerHTML=f,D(()=>P(_,z.answerDetailShortAnswer)),_})()),a!==void 0&&(h=(()=>{const _=Yu.cloneNode(!0);return w(_,K(Rt,{each:a,children:({fileUrl:d,fileName:p})=>(()=>{const m=Gu.cloneNode(!0),R=m.firstChild;return Xe(R,"href",d),w(R,p),m})()})),_})()),!(c===void 0&&h===void 0))return[(()=>{const _=Vu.cloneNode(!0),d=_.firstChild;return w(d,o),D(()=>P(_,mr(u==null?void 0:u.state))),_})(),c,h]}})})}}const ta=x("<div><label></label><input></div>"),ea=x('<div><form><div><p><i> *\u66F4\u6539\u8BBE\u7F6E\u540E\u8BF7\u5237\u65B0\u9875\u9762 </i></p><button type="submit"> \u63D0\u4EA4 </button></div></form><div><p><strong> \u529F\u80FD\u7279\u6027\uFF1A </strong></p><ul></ul></div></div>'),ra=x("<li><strong></strong></li>"),na=x("<div></div>");function Be(e){const t=Ho(Fo({},e.extra),{name:e.name});return(()=>{const r=ta.cloneNode(!0),n=r.firstChild,i=n.nextSibling;return w(n,()=>e.title),$s(i,t,!1,!1),D(o=>{const s=z.settingsEntry,u=e.name;return s!==o._v$&&P(r,o._v$=s),u!==o._v$2&&Xe(n,"for",o._v$2=u),o},{_v$:void 0,_v$2:void 0}),r})()}function ia(e){const t={};function r(i){return o=>t[i]=o.currentTarget.value}function n(i){return o=>t[i]=o.currentTarget.checked}return(()=>{const i=ea.cloneNode(!0),o=i.firstChild,s=o.firstChild,u=s.firstChild,f=o.nextSibling,a=f.firstChild,c=a.nextSibling;return o.addEventListener("submit",h=>{h.preventDefault(),Tr.set(t.username),kr.set(t.server),Lr.set(t.syncAnswers),jr.set(t.sortProblems),Dr.set(t.noLeaveCheck),e.onSubmit()}),w(o,K(Be,{name:"username",title:"\u7528\u6237\u540D",get extra(){return{type:"text",pattern:"^[a-z][a-z0-9_]*$",title:"\u5C0F\u5199\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF",required:!0,value:Tr.get(),onChange:r("username")}}}),s),w(o,K(Be,{name:"server",title:"\u670D\u52A1\u5668",get extra(){return{type:"url",required:!0,value:kr.get(),onChange:r("server")}}}),s),w(o,K(Be,{name:"sync_answers",title:"\u540C\u6B65\u7B54\u6848",get extra(){return{type:"checkbox",checked:Lr.get(),onChange:n("syncAnswers")}}}),s),w(o,K(Be,{name:"sort_problems",title:"\u6392\u5E8F\u9898\u76EE",get extra(){return{type:"checkbox",checked:jr.get(),onChange:n("sortProblems")}}}),s),w(o,K(Be,{name:"no_leave_check",title:"\u62E6\u622A\u5207\u5C4F\u68C0\u6D4B",get extra(){return{type:"checkbox",checked:Dr.get(),onChange:n("noLeaveCheck")}}}),s),w(c,()=>[["\u540C\u6B65\u7B54\u6848\uFF1A","\u70B9\u51FB\u9898\u76EE\u663E\u793A\u8BE6\u7EC6\u7B54\u6848\uFF0C\u5728\u9009\u9879/\u586B\u7A7A\u5904\u60AC\u505C\u663E\u793A\u7B80\u7565\u7B54\u6848"],["\u6392\u5E8F\u9898\u76EE\uFF1A","\u6839\u636E ID \u5BF9\u9898\u76EE\u548C\u9009\u9879\u8FDB\u884C\u91CD\u65B0\u6392\u5E8F"],["\u62E6\u622A\u5207\u5C4F\u68C0\u6D4B\uFF1A","\u968F\u610F\u5207\u6362\u9875\u9762\u3001\u7A97\u53E3\u4E0D\u4F1A\u88AB\u53D1\u73B0"],["\u62E6\u622A\u4E0A\u4F20\u622A\u56FE\uFF1A","\u4EC5\u5F53\u7528\u6237\u786E\u8BA4\u540E\uFF0C\u624D\u4F1A\u4E0A\u4F20\u622A\u56FE"],["\u62E6\u622A\u5F02\u5E38\u72B6\u6001\uFF1A","\u5373\u4F7F\u672C\u5730\u663E\u793A\u5F02\u5E38\u4E5F\u4E0D\u4F1A\u63A8\u9001\u5230\u670D\u52A1\u5668"]].map(([h,l])=>(()=>{const _=ra.cloneNode(!0),d=_.firstChild;return w(d,h),w(_,l,null),_})())),D(h=>{const l=z.settingsSubmit,_=z.settingsSubmitTip,d=z.about;return l!==h._v$3&&P(s,h._v$3=l),_!==h._v$4&&P(u,h._v$4=_),d!==h._v$5&&P(f,h._v$5=d),h},{_v$3:void 0,_v$4:void 0,_v$5:void 0}),i})()}function oa(){const e=qr({title:"\u8BBE\u7F6E",width:400,height:300});ge(()=>(()=>{const t=na.cloneNode(!0);return w(t,K(ia,{onSubmit:()=>e.close()})),D(()=>P(t,z.mainBody)),t})(),e.document.body)}const sa=x("<style></style>"),ua=x('<div><div><button type="button">\u786E\u8BA4\u4E0A\u4F20</button><span><i>*\u5173\u95ED\u7A97\u53E3\u4EE5\u53D6\u6D88\u4E0A\u4F20</i></span></div><div><img></div></div>');class aa{constructor(t){ge(()=>(()=>{const i=sa.cloneNode(!0);return i.textContent=ri,i})(),document.head);const r=document.body.querySelector(".header-title");ii(HTMLElement,r),r.classList.add(z.clickable),r.addEventListener("click",()=>oa());let n=Array.from(document.body.querySelectorAll(".exam-main--body .subject-item"));Cr(n.length===t.length,"number subject items mismatches problems"),this._details=Y(n).then(Gs(t)).then(Dt(new Map,(i,[o,s])=>{let u;switch(s.ProblemType){case mt.SingleChoice:case mt.MultipleChoice:case mt.Judgement:case mt.Polling:ni(s.Options,"null choices");const f=Y(s.Options).then(Br).then(Dt(new Map,(a,[c,{key:h}])=>a.set(h,String.fromCharCode(65+c)))).t;u=new Xu(s.ProblemID,o,a=>{var c;return(c=f.get(a))!=null?c:a});break;case mt.FillBlank:u=new Qu(s.ProblemID,o);break;case mt.ShortAnswer:u=new Zu(s.ProblemID,o);break}return i.set(s.ProblemID,u)})).t}updateAnswer({username:t,problem_id:r,result:n,context:i}){var o;(o=this._details.get(r))==null||o.updateAnswer(t,{answer:n,context:i})}updateUI(){this._details.forEach(t=>t.updateUI())}}function fa(e,t){const r=qr({title:"\u4E0A\u4F20\u56FE\u7247",width:400,height:300});ge(()=>(()=>{const n=ua.cloneNode(!0),i=n.firstChild,o=i.firstChild,s=i.nextSibling,u=s.firstChild;return o.addEventListener("click",()=>{r.close(),t()}),Xe(u,"src",e),D(f=>{const a={[z.mainBody]:!0,[z.uploadImg]:!0},c=z.uploadImgConfirm,h=z.uploadImgImage;return f._v$=Qe(n,a,f._v$),c!==f._v$2&&P(i,f._v$2=c),h!==f._v$3&&P(s,f._v$3=h),f},{_v$:void 0,_v$2:void 0,_v$3:void 0}),n})(),r.document.body)}function Wo(e){return e.forEach(t=>{switch(t.ProblemType){case mt.SingleChoice:case mt.MultipleChoice:case mt.Polling:{t.Options.sort((n,i)=>n.key<i.key?-1:1);break}}}),e.sort((t,r)=>t.ProblemID-r.ProblemID),e}function ca(e){return jr.get()===!0&&(e.data.has_problem_dict===!0?e.data.problems=e.data.problems.sort((t,r)=>t.id-r.id).map(t=>(t.problems=Wo(t.problems),t)):e.data.problems=Wo(e.data.problems)),e}function ha(){document.addEventListener("visibilitychange",e=>{e.preventDefault(),e.stopImmediatePropagation()},!0),window.addEventListener("visibilitychange",e=>{e.preventDefault(),e.stopImmediatePropagation()},!0)}async function la(){Y([1,2,3,4,5,6]).then(Ys(e=>e>2)).then(Ur(console.log)),Vn.clear(),Ls(),Dr.get()===!0&&ha(),Ds(function(e){switch(e.pathname){case"/exam_room/show_paper":this.addEventListener("readystatechange",()=>{if(this.readyState==XMLHttpRequest.DONE){const t=JSON.stringify(ca(JSON.parse(this.responseText)));Object.defineProperties(this,{responseText:{get(){return t}}})}}),this.addEventListener("load",()=>{const t=JSON.parse(this.responseText);let r=[];t.data.has_problem_dict===!0?t.data.problems.forEach(o=>{r=r.concat(o.problems)}):r=t.data.problems;const n=new aa(r);Ot.onmessage(o=>{o.forEach(s=>n.updateAnswer(s)),n.updateUI()});const i=parseInt(e.searchParams.get("exam_id"));Ot.login(i,{title:t.data.title,problems:r}),fetch(oi("/exam_room/cache_results",{exam_id:i.toString()}).toString()).then(o=>o.json()).then(o=>o.data.results.forEach(({problem_id:s,result:u})=>Ot.updateAnswer(s,u))).catch(Pr)});return;case"/exam_room/answer_problem":return async t=>{var r;if(typeof t=="string"){const n=JSON.parse(t);if("action"in n)switch(n.action){case 1:case 17:break;default:return console.log("intercept action",n),new Promise(()=>{})}else"results"in n&&((r=n.results)==null||r.forEach(({problem_id:i,result:o})=>Ot.updateAnswer(i,o)))}return t};default:return e.hostname==="upload-z1.qiniup.com"?async t=>t instanceof FormData&&t.get("file")instanceof File?new Promise(r=>{const n=new FileReader;n.onload=()=>fa(n.result,()=>r(t)),n.readAsDataURL(t.get("file"))}):t:void 0}}),await Ot.watch(1e4)}la().catch(console.error)});
