// ==UserScript==
// @name         yuk-client
// @version      0.6.1
// @author       doge2x
// @icon         https://www.yuketang.cn/static/images/favicon.ico
// @match        https://examination.xuetangx.com/*
// @grant        GM.xmlHttpRequest
// @grant        GM_getValue
// @grant        GM_setValue
// @run-at       document-start
// ==/UserScript==
(function(v){typeof define=="function"&&define.amd?define(v):v()})(function(){"use strict";var Sa=Object.defineProperty,ba=Object.defineProperties;var Oa=Object.getOwnPropertyDescriptors;var Fn=Object.getOwnPropertySymbols;var Na=Object.prototype.hasOwnProperty,Ma=Object.prototype.propertyIsEnumerable;var Rt=(v,E,b)=>E in v?Sa(v,E,{enumerable:!0,configurable:!0,writable:!0,value:b}):v[E]=b,Gn=(v,E)=>{for(var b in E||(E={}))Na.call(E,b)&&Rt(v,b,E[b]);if(Fn)for(var b of Fn(E))Ma.call(E,b)&&Rt(v,b,E[b]);return v},Xn=(v,E)=>ba(v,Oa(E));var W=(v,E,b)=>(Rt(v,typeof E!="symbol"?E+"":E,b),b);var v=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},E={},b={},ee={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createJSONRPCErrorResponse=e.JSONRPCErrorCode=e.isJSONRPCResponses=e.isJSONRPCResponse=e.isJSONRPCRequests=e.isJSONRPCRequest=e.isJSONRPCID=e.JSONRPC=void 0,e.JSONRPC="2.0";var t=function(o){return typeof o=="string"||typeof o=="number"||o===null};e.isJSONRPCID=t;var n=function(o){return o.jsonrpc===e.JSONRPC&&o.method!==void 0&&o.result===void 0&&o.error===void 0};e.isJSONRPCRequest=n;var r=function(o){return Array.isArray(o)&&o.every(e.isJSONRPCRequest)};e.isJSONRPCRequests=r;var i=function(o){return o.jsonrpc===e.JSONRPC&&o.id!==void 0&&(o.result!==void 0||o.error!==void 0)};e.isJSONRPCResponse=i;var a=function(o){return Array.isArray(o)&&o.every(e.isJSONRPCResponse)};e.isJSONRPCResponses=a,function(o){o[o.ParseError=-32700]="ParseError",o[o.InvalidRequest=-32600]="InvalidRequest",o[o.MethodNotFound=-32601]="MethodNotFound",o[o.InvalidParams=-32602]="InvalidParams",o[o.InternalError=-32603]="InternalError"}(e.JSONRPCErrorCode||(e.JSONRPCErrorCode={}));var u=function(o,c,s,f){var d={code:c,message:s};return f&&(d.data=f),{jsonrpc:e.JSONRPC,id:o,error:d}};e.createJSONRPCErrorResponse=u})(ee);var te={};Object.defineProperty(te,"__esModule",{value:!0}),te.DefaultErrorCode=void 0,te.DefaultErrorCode=0;var Yn=v&&v.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(u){u(a)})}return new(n||(n=Promise))(function(a,u){function o(f){try{s(r.next(f))}catch(d){u(d)}}function c(f){try{s(r.throw(f))}catch(d){u(d)}}function s(f){f.done?a(f.value):i(f.value).then(o,c)}s((r=r.apply(e,t||[])).next())})},Zn=v&&v.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,u;return u={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function o(s){return function(f){return c([s,f])}}function c(s){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(a=s[0]&2?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,i=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){n.label=s[1];break}if(s[0]===6&&n.label<a[1]){n.label=a[1],a=s;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(s);break}a[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(f){s=[6,f],i=0}finally{r=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(b,"__esModule",{value:!0}),b.JSONRPCClient=void 0;var ne=ee,Le=te,Qn=function(){function e(t,n){this._send=t,this.createID=n,this.idToResolveMap=new Map,this.id=0}return e.prototype._createID=function(){return this.createID?this.createID():++this.id},e.prototype.timeout=function(t,n){var r=this;n===void 0&&(n=function(u){return(0,ne.createJSONRPCErrorResponse)(u,Le.DefaultErrorCode,"Request timeout")});var i=function(u,o){var c=setTimeout(function(){u.forEach(function(s){var f=r.idToResolveMap.get(s);f&&(r.idToResolveMap.delete(s),f(n(s)))})},t);return o().then(function(s){return clearTimeout(c),s},function(s){return clearTimeout(c),Promise.reject(s)})},a=function(u,o){var c=(Array.isArray(u)?u:[u]).map(function(s){return s.id}).filter(kt);return i(c,function(){return r.requestAdvanced(u,o)})};return{request:function(u,o,c){var s=r._createID();return i([s],function(){return r.requestWithID(u,o,c,s)})},requestAdvanced:function(u,o){return a(u,o)}}},e.prototype.request=function(t,n,r){return this.requestWithID(t,n,r,this._createID())},e.prototype.requestWithID=function(t,n,r,i){return Yn(this,void 0,void 0,function(){var a,u;return Zn(this,function(o){switch(o.label){case 0:return a={jsonrpc:ne.JSONRPC,method:t,params:n,id:i},[4,this.requestAdvanced(a,r)];case 1:return u=o.sent(),u.result!==void 0&&!u.error?[2,u.result]:u.result===void 0&&u.error?[2,Promise.reject(new Error(u.error.message))]:[2,Promise.reject(new Error("An unexpected error occurred"))]}})})},e.prototype.requestAdvanced=function(t,n){var r=this,i=Array.isArray(t);Array.isArray(t)||(t=[t]);var a=t.filter(function(c){return kt(c.id)}),u=a.map(function(c){return new Promise(function(s){return r.idToResolveMap.set(c.id,s)})}),o=Promise.all(u).then(function(c){return i||!c.length?c:c[0]});return this.send(i?t:t[0],n).then(function(){return o},function(c){return a.forEach(function(s){r.receive((0,ne.createJSONRPCErrorResponse)(s.id,Le.DefaultErrorCode,c&&c.message||"Failed to send a request"))}),o})},e.prototype.notify=function(t,n,r){this.send({jsonrpc:ne.JSONRPC,method:t,params:n},r).then(void 0,function(){})},e.prototype.send=function(t,n){return this._send(t,n)},e.prototype.rejectAllPendingRequests=function(t){this.idToResolveMap.forEach(function(n,r){return n((0,ne.createJSONRPCErrorResponse)(r,Le.DefaultErrorCode,t))}),this.idToResolveMap.clear()},e.prototype.receive=function(t){var n=this;Array.isArray(t)||(t=[t]),t.forEach(function(r){var i=n.idToResolveMap.get(r.id);i&&(n.idToResolveMap.delete(r.id),i(r))})},e}();b.JSONRPCClient=Qn;var kt=function(e){return e!=null},ve={},he=v&&v.__assign||function(){return he=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},he.apply(this,arguments)},It=v&&v.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(u){u(a)})}return new(n||(n=Promise))(function(a,u){function o(f){try{s(r.next(f))}catch(d){u(d)}}function c(f){try{s(r.throw(f))}catch(d){u(d)}}function s(f){f.done?a(f.value):i(f.value).then(o,c)}s((r=r.apply(e,t||[])).next())})},Pt=v&&v.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,u;return u={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function o(s){return function(f){return c([s,f])}}function c(s){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(a=s[0]&2?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,i=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){n.label=s[1];break}if(s[0]===6&&n.label<a[1]){n.label=a[1],a=s;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(s);break}a[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(f){s=[6,f],i=0}finally{r=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},Kn=v&&v.__spreadArray||function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))};Object.defineProperty(ve,"__esModule",{value:!0}),ve.JSONRPCServer=void 0;var I=ee,er=te,tr=function(){return(0,I.createJSONRPCErrorResponse)(null,I.JSONRPCErrorCode.ParseError,"Parse error")},nr=function(e){return(0,I.createJSONRPCErrorResponse)((0,I.isJSONRPCID)(e.id)?e.id:null,I.JSONRPCErrorCode.InvalidRequest,"Invalid Request")},rr=function(e){return(0,I.createJSONRPCErrorResponse)(e,I.JSONRPCErrorCode.MethodNotFound,"Method not found")},ir=function(){function e(t){t===void 0&&(t={});var n;this.mapErrorToJSONRPCErrorResponse=sr,this.nameToMethodDictionary={},this.middleware=null,this.errorListener=(n=t.errorListener)!==null&&n!==void 0?n:console.warn}return e.prototype.addMethod=function(t,n){this.addMethodAdvanced(t,this.toJSONRPCMethod(n))},e.prototype.toJSONRPCMethod=function(t){return function(n,r){var i=t(n.params,r);return Promise.resolve(i).then(function(a){return or(n.id,a)})}},e.prototype.addMethodAdvanced=function(t,n){var r;this.nameToMethodDictionary=he(he({},this.nameToMethodDictionary),(r={},r[t]=n,r))},e.prototype.receiveJSON=function(t,n){var r=this.tryParseRequestJSON(t);return r?this.receive(r,n):Promise.resolve(tr())},e.prototype.tryParseRequestJSON=function(t){try{return JSON.parse(t)}catch{return null}},e.prototype.receive=function(t,n){return Array.isArray(t)?this.receiveMultiple(t,n):this.receiveSingle(t,n)},e.prototype.receiveMultiple=function(t,n){return It(this,void 0,void 0,function(){var r,i=this;return Pt(this,function(a){switch(a.label){case 0:return[4,Promise.all(t.map(function(u){return i.receiveSingle(u,n)}))];case 1:return r=a.sent().filter(ar),r.length===1?[2,r[0]]:r.length?[2,r]:[2,null]}})})},e.prototype.receiveSingle=function(t,n){return It(this,void 0,void 0,function(){var r,i;return Pt(this,function(a){switch(a.label){case 0:return r=this.nameToMethodDictionary[t.method],(0,I.isJSONRPCRequest)(t)?[3,1]:[2,nr(t)];case 1:return r?[4,this.callMethod(r,t,n)]:[3,3];case 2:return i=a.sent(),[2,cr(t,i)];case 3:return t.id!==void 0?[2,rr(t.id)]:[2,null];case 4:return[2]}})})},e.prototype.applyMiddleware=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.middleware?this.middleware=this.combineMiddlewares(Kn([this.middleware],t,!0)):this.middleware=this.combineMiddlewares(t)},e.prototype.combineMiddlewares=function(t){return t.length?t.reduce(this.middlewareReducer):null},e.prototype.middlewareReducer=function(t,n){return function(r,i,a){return t(function(u,o){return n(r,u,o)},i,a)}},e.prototype.callMethod=function(t,n,r){var i=this,a=function(o,c){return t(o,c)},u=function(o){return i.errorListener('An unexpected error occurred while executing "'.concat(n.method,'" JSON-RPC method:'),o),Promise.resolve(i.mapErrorToJSONRPCErrorResponseIfNecessary(n.id,o))};try{return(this.middleware||ur)(a,n,r).then(void 0,u)}catch(o){return u(o)}},e.prototype.mapErrorToJSONRPCErrorResponseIfNecessary=function(t,n){return t!==void 0?this.mapErrorToJSONRPCErrorResponse(t,n):null},e}();ve.JSONRPCServer=ir;var ar=function(e){return e!==null},ur=function(e,t,n){return e(t,n)},or=function(e,t){return e!==void 0?{jsonrpc:I.JSONRPC,id:e,result:t===void 0?null:t}:null},sr=function(e,t){return(0,I.createJSONRPCErrorResponse)(e,er.DefaultErrorCode,t&&t.message||"An unexpected error occurred")},cr=function(e,t){return t||(e.id!==void 0?(0,I.createJSONRPCErrorResponse)(e.id,I.JSONRPCErrorCode.InternalError,"Internal error"):null)},me={},lr=v&&v.__awaiter||function(e,t,n,r){function i(a){return a instanceof n?a:new n(function(u){u(a)})}return new(n||(n=Promise))(function(a,u){function o(f){try{s(r.next(f))}catch(d){u(d)}}function c(f){try{s(r.throw(f))}catch(d){u(d)}}function s(f){f.done?a(f.value):i(f.value).then(o,c)}s((r=r.apply(e,t||[])).next())})},fr=v&&v.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,u;return u={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function o(s){return function(f){return c([s,f])}}function c(s){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(a=s[0]&2?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,i=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){n.label=s[1];break}if(s[0]===6&&n.label<a[1]){n.label=a[1],a=s;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(s);break}a[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(f){s=[6,f],i=0}finally{r=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(me,"__esModule",{value:!0}),me.JSONRPCServerAndClient=void 0;var pe=ee,dr=function(){function e(t,n,r){r===void 0&&(r={});var i;this.server=t,this.client=n,this.errorListener=(i=r.errorListener)!==null&&i!==void 0?i:console.warn}return e.prototype.applyServerMiddleware=function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];(t=this.server).applyMiddleware.apply(t,n)},e.prototype.addMethod=function(t,n){this.server.addMethod(t,n)},e.prototype.addMethodAdvanced=function(t,n){this.server.addMethodAdvanced(t,n)},e.prototype.timeout=function(t){return this.client.timeout(t)},e.prototype.request=function(t,n,r){return this.client.request(t,n,r)},e.prototype.requestAdvanced=function(t,n){return this.client.requestAdvanced(t,n)},e.prototype.notify=function(t,n,r){this.client.notify(t,n,r)},e.prototype.rejectAllPendingRequests=function(t){this.client.rejectAllPendingRequests(t)},e.prototype.receiveAndSend=function(t,n,r){return lr(this,void 0,void 0,function(){var i,a;return fr(this,function(u){switch(u.label){case 0:return(0,pe.isJSONRPCResponse)(t)||(0,pe.isJSONRPCResponses)(t)?(this.client.receive(t),[3,4]):[3,1];case 1:return(0,pe.isJSONRPCRequest)(t)||(0,pe.isJSONRPCRequests)(t)?[4,this.server.receive(t,n)]:[3,3];case 2:return i=u.sent(),i?[2,this.client.send(i,r)]:[3,4];case 3:return a="Received an invalid JSON-RPC message",this.errorListener(a,t),[2,Promise.reject(new Error(a))];case 4:return[2]}})})},e}();me.JSONRPCServerAndClient=dr,function(e){var t=v&&v.__createBinding||(Object.create?function(r,i,a,u){u===void 0&&(u=a),Object.defineProperty(r,u,{enumerable:!0,get:function(){return i[a]}})}:function(r,i,a,u){u===void 0&&(u=a),r[u]=i[a]}),n=v&&v.__exportStar||function(r,i){for(var a in r)a!=="default"&&!Object.prototype.hasOwnProperty.call(i,a)&&t(i,r,a)};Object.defineProperty(e,"__esModule",{value:!0}),n(b,e),n(ee,e),n(ve,e),n(me,e)}(E);const J={};let vr=Jt;const Te={},re=1,ge=2,Vt={owned:null,cleanups:null,context:null,owner:null};var P=null;let we=null,ie=null,C=null,$=null,$e=0;function hr(e,t){const n=P,r=e.length===0?Vt:{owned:null,cleanups:null,context:null,owner:t||n};P=r;try{return Je(()=>e(()=>Ue(r)),!0)}finally{P=n}}function _e(e,t,n){const r=wr(e,t,!1,re);Tt(r)}function mr(e){if(ie)return e();let t;const n=ie=[];try{t=e()}finally{ie=null}return Je(()=>{for(let r=0;r<n.length;r+=1){const i=n[r];if(i.pending!==Te){const a=i.pending;i.pending=Te,Lt(i,a)}}},!1),t}function pr(e){let t;return t=e(),t}function Lt(e,t,n){if(ie)return e.pending===Te&&ie.push(e),e.pending=t,t;if(e.comparator&&e.comparator(e.value,t))return t;let r=!1;return e.value=t,e.observers&&e.observers.length&&Je(()=>{for(let i=0;i<e.observers.length;i+=1){const a=e.observers[i];r&&we.disposed.has(a),(r&&!a.tState||!r&&!a.state)&&(a.pure?C.push(a):$.push(a),a.observers&&xt(a)),r||(a.state=re)}if(C.length>1e6)throw C=[],new Error},!1),t}function Tt(e){if(!e.fn)return;Ue(e);const t=P,n=$e;P=e,gr(e,e.value,n),P=t}function gr(e,t,n){let r;try{r=e.fn(t)}catch(i){Ut(i)}(!e.updatedAt||e.updatedAt<=n)&&(e.observers&&e.observers.length?Lt(e,r):e.value=r,e.updatedAt=n)}function wr(e,t,n,r=re,i){const a={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:P,context:null,pure:n};return P===null||P!==Vt&&(P.owned?P.owned.push(a):P.owned=[a]),a}function $t(e){const t=we;if(e.state===0||t)return;if(e.state===ge||t)return xe(e);if(e.suspense&&pr(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<$e);)(e.state||t)&&n.push(e);for(let r=n.length-1;r>=0;r--)if(e=n[r],e.state===re||t)Tt(e);else if(e.state===ge||t){const i=C;C=null,xe(e,n[0]),C=i}}function Je(e,t){if(C)return e();let n=!1;t||(C=[]),$?n=!0:$=[],$e++;try{const r=e();return _r(n),r}catch(r){Ut(r)}finally{C=null,n||($=null)}}function _r(e){C&&(Jt(C),C=null),!e&&($.length?mr(()=>{vr($),$=null}):$=null)}function Jt(e){for(let t=0;t<e.length;t++)$t(e[t])}function xe(e,t){const n=we;e.state=0;for(let r=0;r<e.sources.length;r+=1){const i=e.sources[r];i.sources&&(i.state===re||n?i!==t&&$t(i):(i.state===ge||n)&&xe(i,t))}}function xt(e){const t=we;for(let n=0;n<e.observers.length;n+=1){const r=e.observers[n];(!r.state||t)&&(r.state=ge,r.pure?C.push(r):$.push(r),r.observers&&xt(r))}}function Ue(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),i=n.observers;if(i&&i.length){const a=i.pop(),u=n.observerSlots.pop();r<i.length&&(a.sourceSlots[u]=r,i[r]=a,n.observerSlots[r]=u)}}if(e.owned){for(t=0;t<e.owned.length;t++)Ue(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function Ut(e){throw e}function yr(e,t,n){let r=n.length,i=t.length,a=r,u=0,o=0,c=t[i-1].nextSibling,s=null;for(;u<i||o<a;){if(t[u]===n[o]){u++,o++;continue}for(;t[i-1]===n[a-1];)i--,a--;if(i===u){const f=a<r?o?n[o-1].nextSibling:n[a-o]:c;for(;o<a;)e.insertBefore(n[o++],f)}else if(a===o)for(;u<i;)(!s||!s.has(t[u]))&&t[u].remove(),u++;else if(t[u]===n[a-1]&&n[o]===t[i-1]){const f=t[--i].nextSibling;e.insertBefore(n[o++],t[u++].nextSibling),e.insertBefore(n[--a],f),t[i]=n[a]}else{if(!s){s=new Map;let d=o;for(;d<a;)s.set(n[d],d++)}const f=s.get(t[u]);if(f!=null)if(o<f&&f<a){let d=u,_=1,S;for(;++d<i&&d<a&&!((S=s.get(t[d]))==null||S!==f+_);)_++;if(_>f-o){const w=t[u];for(;o<f;)e.insertBefore(n[o++],w)}else e.replaceChild(n[o++],t[u++])}else u++;else t[u++].remove()}}}const zt="_$DX_DELEGATE";function qt(e,t,n){let r;return hr(i=>{r=i,t===document?e():qe(t,e(),t.firstChild?null:void 0,n)}),()=>{r(),t.textContent=""}}function ze(e,t,n){const r=document.createElement("template");r.innerHTML=e;let i=r.content.firstChild;return n&&(i=i.firstChild),i}function Er(e,t=window.document){const n=t[zt]||(t[zt]=new Set);for(let r=0,i=e.length;r<i;r++){const a=e[r];n.has(a)||(n.add(a),t.addEventListener(a,Or))}}function Sr(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function Bt(e,t){t==null?e.removeAttribute("class"):e.className=t}function br(e,t,n={}){const r=Object.keys(t||{}),i=Object.keys(n);let a,u;for(a=0,u=i.length;a<u;a++){const o=i[a];!o||o==="undefined"||t[o]||(jt(e,o,!1),delete n[o])}for(a=0,u=r.length;a<u;a++){const o=r[a],c=!!t[o];!o||o==="undefined"||n[o]===c||!c||(jt(e,o,!0),n[o]=c)}return n}function qe(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return ye(e,t,r,n);_e(i=>ye(e,t(),i,n),r)}function jt(e,t,n){const r=t.trim().split(/\s+/);for(let i=0,a=r.length;i<a;i++)e.classList.toggle(r[i],n)}function Or(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}}),J.registry&&!J.done&&(J.done=!0,document.querySelectorAll("[id^=pl-]").forEach(r=>r.remove()));n!==null;){const r=n[t];if(r&&!n.disabled){const i=n[`${t}Data`];if(i!==void 0?r(i,e):r(e),e.cancelBubble)return}n=n.host&&n.host!==n&&n.host instanceof Node?n.host:n.parentNode}}function ye(e,t,n,r,i){for(J.context&&!n&&(n=[...e.childNodes]);typeof n=="function";)n=n();if(t===n)return n;const a=typeof t,u=r!==void 0;if(e=u&&n[0]&&n[0].parentNode||e,a==="string"||a==="number"){if(J.context)return n;if(a==="number"&&(t=t.toString()),u){let o=n[0];o&&o.nodeType===3?o.data=t:o=document.createTextNode(t),n=Y(e,n,r,o)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||a==="boolean"){if(J.context)return n;n=Y(e,n,r)}else{if(a==="function")return _e(()=>{let o=t();for(;typeof o=="function";)o=o();n=ye(e,o,n,r)}),()=>n;if(Array.isArray(t)){const o=[];if(Be(o,t,i))return _e(()=>n=ye(e,o,n,r,!0)),()=>n;if(J.context){for(let c=0;c<o.length;c++)if(o[c].parentNode)return n=o}if(o.length===0){if(n=Y(e,n,r),u)return n}else Array.isArray(n)?n.length===0?Wt(e,o,r):yr(e,n,o):(n&&Y(e),Wt(e,o));n=o}else if(t instanceof Node){if(J.context&&t.parentNode)return n=u?[t]:t;if(Array.isArray(n)){if(u)return n=Y(e,n,r,t);Y(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Be(e,t,n){let r=!1;for(let i=0,a=t.length;i<a;i++){let u=t[i],o;if(u instanceof Node)e.push(u);else if(!(u==null||u===!0||u===!1))if(Array.isArray(u))r=Be(e,u)||r;else if((o=typeof u)=="string")e.push(document.createTextNode(u));else if(o==="function")if(n){for(;typeof u=="function";)u=u();r=Be(e,Array.isArray(u)?u:[u])||r}else e.push(u),r=!0;else e.push(document.createTextNode(u.toString()))}return r}function Wt(e,t,n){for(let r=0,i=t.length;r<i;r++)e.insertBefore(t[r],n)}function Y(e,t,n,r){if(n===void 0)return e.textContent="";const i=r||document.createTextNode("");if(t.length){let a=!1;for(let u=t.length-1;u>=0;u--){const o=t[u];if(i!==o){const c=o.parentNode===e;!a&&!u?c?e.replaceChild(i,o):e.insertBefore(i,n):c&&o.remove()}else a=!0}}else e.insertBefore(i,n);return[i]}var je=`._mainBody_8f6zw_1{opacity:.5}._mainBody_8f6zw_1 *{font-size:.75rem;margin:0}._mainBody_8f6zw_1 button,._clickable_8f6zw_11{cursor:pointer}._stateWorkingOn_8f6zw_14{color:#00f}._stateSure_8f6zw_17{color:green}._stateNotSure_8f6zw_20{color:red}._answerMsg_8f6zw_23{border-style:groove;border-width:thin;opacity:.75;margin-bottom:.5rem}._answerMsg_8f6zw_23 ul{padding-left:1rem}._answerMsgName_8f6zw_32{font-weight:700}._answerMark_8f6zw_35{display:flex;justify-content:end;align-items:center;border-style:groove;border-width:thin;margin-bottom:.5rem;opacity:.75}._answerMark_8f6zw_35 button{padding:0;margin-left:.5rem;white-space:nowrap}._answerMark_8f6zw_35 input{height:max-content;width:100%}._answerDetail_8f6zw_53 ._stateWorkingOn_8f6zw_14,._answerDetail_8f6zw_53 ._stateSure_8f6zw_17,._answerDetail_8f6zw_53 ._stateNotSure_8f6zw_20{font-weight:700}._answerDetail_8f6zw_53 ul{padding-left:1.5rem}._answerDetail_8f6zw_53 img{height:auto;width:80%}._answerDetailShortAnswer_8f6zw_65{border-style:groove;border-width:thin;margin:.2rem;padding:.2rem}._settings_8f6zw_71{border-style:groove;border-width:thin;display:flex;flex-direction:column;padding:.5rem;margin-bottom:.5rem}._settingsEntry_8f6zw_79{display:flex;flex-direction:row;margin-bottom:.5rem;justify-content:space-between;align-items:center}._settingsEntry_8f6zw_79 label{font-weight:700}._settingsEntry_8f6zw_79 input{height:max-content;text-align:right}._settingsSubmit_8f6zw_93{display:flex;flex-direction:row;align-items:center;justify-content:end}._settingsSubmitTip_8f6zw_99{margin-right:.5rem}._about_8f6zw_102 p{margin-bottom:.25rem}._about_8f6zw_102 ul{padding-left:1.5rem;margin-bottom:.25rem}._about_8f6zw_102 ul li{margin-bottom:.25rem}._uploadImg_8f6zw_112{display:flex;flex-direction:column}._uploadImg_8f6zw_112 img{width:100%;height:auto}._uploadImgImage_8f6zw_120{border-style:groove;border-width:thin;padding:.5rem}._uploadImgConfirm_8f6zw_125{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-bottom:.5rem}
`;const Nr=ze("<title></title>"),Mr=ze("<style></style>");function Ar(e,t){if(e==null)throw Error(t!=null?t:"value cannot be null")}const Ht=[];window.addEventListener("unload",()=>Ht.forEach(e=>{var t;(t=e.value)==null||t.close()}));function Cr(e){const t=window.open("","",Object.entries(e).map(([r,i])=>`${r}=${i}`).join(","));Ar(t);const n={value:t};return Ht.push(n),t.addEventListener("close",()=>n.value=void 0),qt(()=>[(()=>{const r=Nr.cloneNode(!0);return qe(r,()=>e.title),r})(),(()=>{const r=Mr.cloneNode(!0);return qe(r,je),r})()],t.document.head),t}function We(e,...t){}function Ft(e,t){const n=new URL(e,self.location.origin);for(const[r,i]of Object.entries(t!=null?t:{}))n.searchParams.set(r,i);return n}function Z(e){const t=GM_getValue(e);if(t!==void 0)return t.contents}function D(e,t){GM_setValue(e,{contents:t})}function Dr(){var n;const e=[{name:"202205231915_gm_value",up(){D("no_leave_check",GM_getValue("nol_eavecheck")),GM_setValue("nol_eavecheck",void 0);for(const r of["username","server","sync_answers","sort_problems"])D(r,GM_getValue(r))}}],t=(n=Z("migrations"))!=null?n:[];for(const{name:r,idx:i}of t)if(r!==e[i].name)throw new Error("bad migrations");for(const{name:r,up:i}of e.slice(t.length))i();D("migrations",e.map((r,i)=>({name:r.name,idx:i})))}function Gt(e,t,n){for(var r=new Array(n),i=0,a=t;i<n;)r[i]=e[a],i=i+1|0,a=a+1|0;return r}function H(e,t){for(;;){var n=t,r=e,i=r.length,a=i===0?1:i,u=n.length,o=a-u|0;if(o===0)return r.apply(null,n);if(o>=0)return function(c,s){return function(f){return H(c,s.concat([f]))}}(r,n);t=Gt(n,a,-o|0),e=r.apply(null,Gt(n,0,a))}}function ae(e,t){var n=e.length;if(n===1)return e(t);switch(n){case 1:return e(t);case 2:return function(r){return e(t,r)};case 3:return function(r,i){return e(t,r,i)};case 4:return function(r,i,a){return e(t,r,i,a)};case 5:return function(r,i,a,u){return e(t,r,i,a,u)};case 6:return function(r,i,a,u,o){return e(t,r,i,a,u,o)};case 7:return function(r,i,a,u,o,c){return e(t,r,i,a,u,o,c)};default:return H(e,[t])}}function x(e){var t=e.length;return t===1?e:function(n){return ae(e,n)}}function Xt(e,t,n){var r=e.length;if(r===2)return e(t,n);switch(r){case 1:return H(e(t),[n]);case 2:return e(t,n);case 3:return function(i){return e(t,n,i)};case 4:return function(i,a){return e(t,n,i,a)};case 5:return function(i,a,u){return e(t,n,i,a,u)};case 6:return function(i,a,u,o){return e(t,n,i,a,u,o)};case 7:return function(i,a,u,o,c){return e(t,n,i,a,u,o,c)};default:return H(e,[t,n])}}function Ee(e){var t=e.length;return t===2?e:function(n,r){return Xt(e,n,r)}}function Yt(e,t,n,r){var i=e.length;if(i===3)return e(t,n,r);switch(i){case 1:return H(e(t),[n,r]);case 2:return H(e(t,n),[r]);case 3:return e(t,n,r);case 4:return function(a){return e(t,n,r,a)};case 5:return function(a,u){return e(t,n,r,a,u)};case 6:return function(a,u,o){return e(t,n,r,a,u,o)};case 7:return function(a,u,o,c){return e(t,n,r,a,u,o,c)};default:return H(e,[t,n,r])}}function Zt(e){var t=e.length;return t===3?e:function(n,r,i){return Yt(e,n,r,i)}}var He={contents:0};function Rr(e){return He.contents=He.contents+1|0,e+("/"+He.contents)}var kr=Rr("CamlinternalLazy.Undefined");function Ir(e,t){var n=t();return e.VAL=n,e.LAZY_DONE=!0,n}function Pr(){throw{RE_EXN_ID:kr,Error:new Error}}function ue(e){if(e.LAZY_DONE)return e.VAL;var t=e.VAL;e.VAL=Pr;try{return Ir(e,t)}catch(n){throw e.VAL=function(){throw n},n}}function oe(e){return{LAZY_DONE:!0,VAL:e}}function g(e){return e===void 0?{BS_PRIVATE_NESTED_SOME_NONE:0}:e!==null&&e.BS_PRIVATE_NESTED_SOME_NONE!==void 0?{BS_PRIVATE_NESTED_SOME_NONE:e.BS_PRIVATE_NESTED_SOME_NONE+1|0}:e}function U(e){if(e!=null)return g(e)}function se(e){if(e!==void 0)return g(e)}function y(e){if(!(e!==null&&e.BS_PRIVATE_NESTED_SOME_NONE!==void 0))return e;var t=e.BS_PRIVATE_NESTED_SOME_NONE;if(t!==0)return{BS_PRIVATE_NESTED_SOME_NONE:t-1|0}}var Fe="username",Ge={contents:{LAZY_DONE:!1,VAL:function(){var e=Z(Fe);if(e==null){D(Fe,void 0);return}else return g(e)}}};function Vr(e){return ue(Ge.contents)}function Lr(e){var t=g(e);Ge.contents=oe(t),D(Fe,t)}var Xe={v:Ge,get:Vr,set:Lr},Ye="server",Ze={contents:{LAZY_DONE:!1,VAL:function(){var e=Z(Ye);if(e==null){D(Ye,void 0);return}else return g(e)}}};function Tr(e){return ue(Ze.contents)}function $r(e){var t=g(e);Ze.contents=oe(t),D(Ye,t)}var Qe={v:Ze,get:Tr,set:$r},Ke="sync_answers",Qt=!0,et={contents:{LAZY_DONE:!1,VAL:function(){var e=Z(Ke);return e==null?(D(Ke,Qt),Qt):g(e)}}};function Jr(e){return ue(et.contents)}function xr(e){var t=g(e);et.contents=oe(t),D(Ke,t)}var tt={v:et,get:Jr,set:xr},nt="no_leave_check",Kt=!0,rt={contents:{LAZY_DONE:!1,VAL:function(){var e=Z(nt);return e==null?(D(nt,Kt),Kt):g(e)}}};function Ur(e){return ue(rt.contents)}function zr(e){var t=g(e);rt.contents=oe(t),D(nt,t)}var it={v:rt,get:Ur,set:zr},at="sort_problems",en=!1,ut={contents:{LAZY_DONE:!1,VAL:function(){var e=Z(at);return e==null?(D(at,en),en):g(e)}}};function qr(e){return ue(ut.contents)}function Br(e){var t=g(e);ut.contents=oe(t),D(at,t)}var ot={v:ut,get:qr,set:Br};class ce{constructor(t){W(this,"_value");this._value=t}get value(){return this._value.get()}}const st=new ce(Xe),tn=new ce(Qe),jr=new ce(tt),Wr=new ce(ot),Hr=new ce(it);class Fr{constructor(){W(this,"token");W(this,"client");W(this,"examId");W(this,"paper");W(this,"queue",new Map);W(this,"onmsg",[])}onmessage(t){this.onmsg.push(t)}updateQueue(t,n){let r=this.queue.get(t);r!==void 0?n(r):(r={},n(r),this.queue.set(t,r))}updateAnswer(t,n){this.updateQueue(t,r=>r.result=n)}updateState(t,n){this.updateQueue(t,r=>{var i;r.context=(i=r.context)!=null?i:{},r.context.state=n})}updateMsg(t,n){this.updateQueue(t,r=>{var i;r.context=(i=r.context)!=null?i:{},r.context.msg=n})}async watch(t){return new Promise((n,r)=>{const i=setInterval(()=>{this.sendQueue().catch(a=>{clearInterval(i),alert("\u4E0E\u670D\u52A1\u5668\u901A\u4FE1\u5F02\u5E38"),r(a)})},t)})}async login(t,n){this.examId=t,this.paper=n}async sendQueue(){if(jr.value!==!0||this.queue.size<1||tn.value===void 0||st.value===void 0||this.examId===void 0||this.paper===void 0)return;let t=[...this.queue.entries()];if(this.queue.clear(),this.client===void 0){const r=tn.value,i=new E.JSONRPCClient(a=>new Promise((u,o)=>{GM.xmlHttpRequest({url:r,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(a),onload:c=>{c.status===200?(i.receive(JSON.parse(c.responseText)),u()):o(new Error(c.statusText))},onerror:c=>o(c.statusText)})}));this.client=i}if(this.token===void 0){We(`login to server: ${st.value}, ${this.examId}`);const r=await this.client.request("login",[st.value,this.examId,this.paper]);this.token=r}const n=await this.client.request("answer_problem",[this.token,t.map(([r,{result:i,context:a}])=>({problem_id:r,result:i,context:a}))]);this.onmsg.forEach(r=>r(n))}}const M=new Fr;function Gr(e){const t=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(n,r){const i=e.call(this,Ft(r)),a=this.send;this.send=function(u){i!==void 0?i(u).then(o=>{a.call(this,o),this.send=a}).catch(We):(a.call(this,u),this.send=a)},t.apply(this,arguments)}}var Se=(e=>(e[e.SingleChoice=1]="SingleChoice",e[e.MultipleChoice=2]="MultipleChoice",e[e.Polling=3]="Polling",e[e.FillBlank=4]="FillBlank",e[e.ShortAnswer=5]="ShortAnswer",e[e.Judgement=6]="Judgement",e))(Se||{});const nn="_mainBody_8f6zw_1",rn="_clickable_8f6zw_11",an="_stateWorkingOn_8f6zw_14",un="_stateSure_8f6zw_17",on="_stateNotSure_8f6zw_20",sn="_answerMsg_8f6zw_23",cn="_answerMsgName_8f6zw_32",ln="_answerMark_8f6zw_35",fn="_answerDetail_8f6zw_53",dn="_answerDetailShortAnswer_8f6zw_65",vn="_settings_8f6zw_71",hn="_settingsEntry_8f6zw_79",mn="_settingsSubmit_8f6zw_93",pn="_settingsSubmitTip_8f6zw_99",gn="_about_8f6zw_102",wn="_uploadImg_8f6zw_112",_n="_uploadImgImage_8f6zw_120",yn="_uploadImgConfirm_8f6zw_125";var le={mainBody:nn,clickable:rn,stateWorkingOn:an,stateSure:un,stateNotSure:on,answerMsg:sn,answerMsgName:cn,answerMark:ln,answerDetail:fn,answerDetailShortAnswer:dn,settings:vn,settingsEntry:hn,settingsSubmit:mn,settingsSubmitTip:pn,about:gn,uploadImg:wn,uploadImgImage:_n,uploadImgConfirm:yn},ct=Object.freeze(Object.defineProperty({__proto__:null,mainBody:nn,clickable:rn,stateWorkingOn:an,stateSure:un,stateNotSure:on,answerMsg:sn,answerMsgName:cn,answerMark:ln,answerDetail:fn,answerDetailShortAnswer:dn,settings:vn,settingsEntry:hn,settingsSubmit:mn,settingsSubmitTip:pn,about:gn,uploadImg:wn,uploadImgImage:_n,uploadImgConfirm:yn,default:le},Symbol.toStringTag,{value:"Module"}));function be(e){return Array.isArray(e)?new Array().concat(...e.map(be)):e instanceof Node?[e]:e==null?[]:[document.createTextNode(String(e))]}function Xr(e,t){for(const n of t)e.appendChild(n)}function Yr(e,t){for(const[n,r]of Object.entries(t))n.startsWith("-")?e.style.setProperty(n,r):e.style[n]=r}function Zr(e,t){for(const[n,r]of Object.entries(t))if(r!==void 0)switch(n){case"class":case"className":e.setAttribute("class",r);break;case"style":Yr(e,r);break;case"dangerouslySetInnerHTML":e.innerHTML=r.__html;break;default:n.startsWith("on")?e.addEventListener(n.slice(2).toLowerCase(),r):n in e?e[n]=r:e.setAttribute(n,r)}}function Oe(e,t,...n){t=t!=null?t:{};let r=be(n).concat(be(t.children));if(typeof e=="function")return e(Xn(Gn({},t),{children:r}));{const i=document.createElement(e);return Xr(i,r),Zr(i,t!=null?t:{}),i}}function Qr(e){return e instanceof Node?e:null}const Kr={toArray:be};var lt=function(e,t){var n,r;r=t.length;var i=[];for(n=0;n<r-1;++n)i.push(t[n]);var a=t[r-1];for(n=0;n<a.length;++n)i.push(a[n]);return e.apply(null,i)};function F(e){return U(Qr(e))}function ei(e){return Kr.toArray(e)}var ti={toArray:ei};function ni(e,t,n){return lt(Oe,[e,t,n])}function O(e,t){return Oe(e,t)}function ri(e,t,n){return lt(Oe,[e,t!==void 0?y(t):void 0,n])}function ii(e,t,n){return lt(Oe,[e,t!==void 0?y(t):void 0,n])}var l={createDOMElementVariadic:ri,createElement:ii};function ai(e,t){return e===t?0:e<t?-1:1}function ui(e,t){if(t>=0&&t<e.length)return g(e[t])}function oi(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=new Array(i),u=0;u<i;++u)a[u]=[e[u],t[u]];return a}function En(e,t){for(var n=e.length,r=t.length,i=new Array(n+r|0),a=0;a<n;++a)i[a]=e[a];for(var u=0;u<r;++u)i[n+u|0]=t[u];return i}function Sn(e,t,n,r,i){if(r<=t){for(var a=0;a<i;++a)n[a+r|0]=e[a+t|0];return}for(var u=i-1|0;u>=0;--u)n[u+r|0]=e[u+t|0]}function si(e,t){for(var n=e.length,r=new Array(n),i=0;i<n;++i)r[i]=t(e[i]);return r}function R(e,t){return si(e,x(t))}function ci(e,t){for(var n=e.length,r=new Array(n),i=0,a=0;a<n;++a){var u=e[a],o=t(u);o!==void 0&&(r[i]=y(o),i=i+1|0)}return r.length=i,r}function Ne(e,t){return ci(e,x(t))}function li(e,t){for(var n=e.length,r=new Array(n),i=0;i<n;++i)r[i]=t(i,e[i]);return r}function fi(e,t){return li(e,Ee(t))}function di(e,t,n){for(var r=t,i=0,a=e.length;i<a;++i)r=n(r,e[i]);return r}function ft(e,t,n){return di(e,t,Ee(n))}function vi(e,t,n){for(var r=t,i=0,a=e.length;i<a;++i)r=n(r,e[i],i);return r}function bn(e,t,n){return vi(e,t,Zt(n))}function hi(e,t,n){var r=e.length;if(r===0)return"";for(var i=r-1|0,a=0,u="";;){var o=u,c=a;if(c===i)return o+n(e[c]);u=o+(n(e[c])+t),a=c+1|0}}function mi(e,t,n){return hi(e,t,x(n))}function pi(e,t){if(e!==void 0)return t(y(e))}function z(e,t){return pi(e,x(t))}function N(e){if(e!==void 0)return y(e);throw{RE_EXN_ID:"Not_found",Error:new Error}}function gi(e,t,n){return e!==void 0?n(y(e)):t}function fe(e,t,n){return gi(e,t,x(n))}function wi(e,t){if(e!==void 0)return g(t(y(e)))}function Q(e,t){return wi(e,x(t))}function _i(e,t){if(e!==void 0)return t(y(e))}function k(e,t){return _i(e,x(t))}function q(e,t){return e!==void 0?y(e):t}function yi(e){return e>12||e<1?12:e-1|0}function Ei(e){return yi(e.nodeType)}function On(e){if(Ei(e)===0)return g(e)}var Si=function(e){if(window.constructor.name!==void 0&&/^HTML\w*Element$/.test(e.constructor.name)||/^\[object HTML\w*Element\]$/.test(e.constructor.toString()))return e},Nn=function(e){var t=e.defaultView;if(t!=null){var n=t.HTMLDocument;if(n!=null&&e instanceof n)return e}},bi=je;function Mn(e,t){return Ne(Array.prototype.slice.call(e.querySelectorAll(t)),On)}function Oi(e){var t=e.children;return l.createDOMElementVariadic("ul",void 0,[ti.toArray(t).map(function(n){return l.createDOMElementVariadic("li",void 0,[n])})])}var B={make:Oi};function Me(e,t,n,r,i,a){var u=N(U(window.open("","",mi([["location","no"],["height",String(t)],["width",String(n)],["left",fe(r,"0",function(c){return String(c)})],["top",fe(i,"0",function(c){return String(c)})]],",",function(c){return c[0]+"="+c[1]}))));window.addEventListener("unload",function(c){u.close()});var o=N(Nn(u.document));return o.head.appendChild(N(F(l.createDOMElementVariadic("title",void 0,[e])))),o.head.appendChild(N(F(l.createDOMElementVariadic("style",void 0,[bi])))),[u,N(U(o.body))]}var An=ai;function Ni(e){for(var t=Object.keys(e),n=t.length,r=new Array(n),i=0;i<n;++i){var a=t[i];r[i]=[a,e[a]]}return r}function Mi(e,t){if(t===0)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return e/t|0}function Ai(e,t,n,r,i){for(;;){var a=n,u=t;if(a>=r)return a;var o=e[a];if(!i(o,u))return a;n=a+1|0,t=o}}function Ci(e,t){var n=e.length;if(n===0||n===1)return n;var r=e[0],i=e[1];if(t(r,i))for(var a=i,u=2;;){var o=u,c=a;if(o>=n)return o;var s=e[o];if(!t(c,s))return o;u=o+1|0,a=s}else return t(i,r)?-Ai(e,i,2,n,t)|0:1}function Cn(e,t,n,r,i,a,u,o,c){for(var s=t+n|0,f=i+a|0,d=t,_=e[t],S=i,w=r[i],m=o;;){var p=m,T=w,de=S,Ve=_,At=d;if(c(Ve,T)<=0){u[p]=Ve;var Ct=At+1|0;if(Ct>=s)return Sn(r,de,u,p+1|0,f-de|0);m=p+1|0,_=e[Ct],d=Ct;continue}u[p]=T;var Dt=de+1|0;if(Dt>=f)return Sn(e,At,u,p+1|0,s-At|0);m=p+1|0,w=r[Dt],S=Dt}}function Dn(e,t,n,r,i,a){for(var u=0;u<i;++u){for(var o=e[t+u|0],c=(r+u|0)-1|0;c>=r&&a(n[c],o)>0;)n[c+1|0]=n[c],c=c-1|0;n[c+1|0]=o}}function Ae(e,t,n,r,i,a){if(i<=5)return Dn(e,t,n,r,i,a);var u=i/2|0,o=i-u|0;return Ae(e,t+u|0,n,r+u|0,o,a),Ae(e,t,e,t+o|0,u,a),Cn(e,t+o|0,u,n,r+u|0,o,n,r,a)}function Di(e,t){var n=e.length;if(n<=5)return Dn(e,0,e,0,n,t);var r=n/2|0,i=n-r|0,a=new Array(i);return Ae(e,r,a,0,i,t),Ae(e,0,e,i,r,t),Cn(e,i,r,a,0,i,e,0,t)}function Ri(e,t){var n=e.slice(0);return Di(n,t),n}function Ce(e,t){return Ri(e,Ee(t))}function A(e){return e!==void 0?e.h:0}function V(e,t,n,r){var i=A(e),a=A(r);return{k:t,v:n,h:i>=a?i+1|0:a+1|0,l:e,r}}function L(e,t){return{k:e,v:t,h:1,l:void 0,r:void 0}}function Rn(e,t){return t!==void 0?e!==void 0?e.h>=t.h:!1:!0}function dt(e,t){return e.v===t?e:{k:e.k,v:t,h:e.h,l:e.l,r:e.r}}function j(e,t,n,r){var i=e!==void 0?e.h:0,a=r!==void 0?r.h:0;if(i>(a+2|0)){var u=e.l,o=e.r;return A(u)>=A(o)?V(u,e.k,e.v,V(o,t,n,r)):V(V(u,e.k,e.v,o.l),o.k,o.v,V(o.r,t,n,r))}if(a<=(i+2|0))return{k:t,v:n,h:i>=a?i+1|0:a+1|0,l:e,r};var c=r.l,s=r.r;return A(s)>=A(c)?V(V(e,t,n,c),r.k,r.v,s):V(V(e,t,n,c.l),c.k,c.v,V(c.r,r.k,r.v,s))}function kn(e,t,n){var r=e.l;return r!==void 0?j(kn(r,t,n),e.k,e.v,e.r):(t.contents=e.k,n.contents=e.v,e.r)}function In(e,t){for(;;){var n=e;if(n===void 0)return;In(n.l,t),t(n.k,n.v),e=n.r}}function ki(e,t){return In(e,Ee(t))}function Pn(e,t,n){for(;;){var r=t,i=e;if(i===void 0)return r;var a=i.k,u=i.v,o=i.l,c=i.r;t=n(Pn(o,r,n),a,u),e=c}}function Ii(e,t,n){return Pn(e,t,Zt(n))}function De(e){var t=e.l,n=e.r,r=t!==void 0?De(t):0,i=n!==void 0?De(n):0;return(1+r|0)+i|0}function Pi(e){return e!==void 0?De(e):0}function Vn(e,t,n){for(;;){var r=t,i=e,a=i.l,u=i.k,o=i.r,c=a!==void 0?Vn(a,r,n):r;n[c]=[u,i.v];var s=c+1|0;if(o===void 0)return s;t=s,e=o}}function Vi(e){if(e===void 0)return[];var t=De(e),n=new Array(t);return Vn(e,0,n),n}function vt(e,t,n){switch(n){case 0:return;case 1:var r=e[t];return L(r[0],r[1]);case 2:var i=e[t],a=e[t-1|0],u=a,o=i;return{k:u[0],v:u[1],h:2,l:L(o[0],o[1]),r:void 0};case 3:var c=e[t],s=e[t-1|0],f=e[t-2|0],d=f,_=s,S=c;return{k:_[0],v:_[1],h:2,l:L(S[0],S[1]),r:L(d[0],d[1])};default:var w=n/2|0,m=vt(e,t,w),p=e[t-w|0],T=vt(e,(t-w|0)-1|0,(n-w|0)-1|0);return V(m,p[0],p[1],T)}}function ht(e,t,n){switch(n){case 0:return;case 1:var r=e[t];return L(r[0],r[1]);case 2:var i=e[t],a=e[t+1|0],u=a,o=i;return{k:u[0],v:u[1],h:2,l:L(o[0],o[1]),r:void 0};case 3:var c=e[t],s=e[t+1|0],f=e[t+2|0],d=f,_=s,S=c;return{k:_[0],v:_[1],h:2,l:L(S[0],S[1]),r:L(d[0],d[1])};default:var w=n/2|0,m=ht(e,t,w),p=e[t+w|0],T=ht(e,(t+w|0)+1|0,(n-w|0)-1|0);return V(m,p[0],p[1],T)}}function mt(e){var t=e.l;e.l=t.r,t.r=e;var n=A(e.l),r=A(e.r);e.h=(n>r?n:r)+1|0;var i=A(t.l),a=e.h;return t.h=(i>a?i:a)+1|0,t}function pt(e){var t=e.r;e.r=t.l,t.l=e;var n=A(e.l),r=A(e.r);e.h=(n>r?n:r)+1|0;var i=A(t.r),a=e.h;return t.h=(i>a?i:a)+1|0,t}function Li(e){var t=e.l,n=pt(t);return e.l=n,mt(e)}function Ti(e){var t=e.r,n=mt(t);return e.r=n,pt(e)}function Re(e){var t=A(e.l),n=A(e.r);return e.h=(t>n?t:n)+1|0,e}function $i(e){var t=e.l,n=e.r,r=A(t),i=A(n);if(r>(2+i|0)){var a=t.l,u=t.r;return Rn(a,u)?Re(mt(e)):Re(Li(e))}if(i>(2+r|0)){var o=n.l,c=n.r;return Rn(c,o)?Re(pt(e)):Re(Ti(e))}return e.h=(r>i?r:i)+1|0,e}function Ji(e,t){for(;;){var n=e;if(n===void 0)return;var r=n.k;if(t===r)return g(n.v);e=t<r?n.l:n.r}}function xi(e,t){for(;;){var n=e;if(n!==void 0){var r=n.k;if(t===r)return n.v;e=t<r?n.l:n.r;continue}throw{RE_EXN_ID:"Not_found",Error:new Error}}}function gt(e,t,n){if(e===void 0)return L(t,n);var r=e.k;if(t===r)return e.k=t,e.v=n,e;var i=e.l,a=e.r;if(t<r){var u=gt(i,t,n);e.l=u}else e.r=gt(a,t,n);return $i(e)}function Ui(e){var t=e.length;if(t!==0){var n=Ci(e,function(u,o){return u[0]<o[0]}),r;n>=0?r=ht(e,0,n):(n=-n|0,r=vt(e,n-1|0,n));for(var i=n;i<t;++i){var a=e[i];r=gt(r,a[0],a[1])}return r}}function G(e,t,n){if(e===void 0)return L(t,n);var r=e.k;if(t===r)return dt(e,n);var i=e.v;return t<r?j(G(e.l,t,n),r,i,e.r):j(e.l,r,i,G(e.r,t,n))}function wt(e,t,n){if(e!==void 0){var r=e.k;if(t===r){var i=n(g(e.v));if(i!==void 0)return dt(e,y(i));var a=e.l,u=e.r;if(a===void 0)return u;if(u===void 0)return a;var o={contents:u.k},c={contents:u.v},s=kn(u,o,c);return j(a,o.contents,c.contents,s)}var f=e.v,d=e.l,_=e.r;if(t<r){var S=wt(d,t,n);return d===S?e:j(S,r,f,_)}var w=wt(_,t,n);return _===w?e:j(d,r,f,w)}var m=n(void 0);return m!==void 0?L(t,y(m)):e}function _t(e,t,n){return wt(e,t,x(n))}var Ln=Ii,Tn=Pi,X=Vi,zi=Ui,$n=Ji,qi=xi,h=ct;function Jn(e,t){return String(Mi(Math.imul(e,100),t))+"%"}function yt(e){return Ce(e,function(t,n){return An(t[0],n[0])})}function ke(e){return Q(e,function(t){switch(t){case 0:return h.stateWorkingOn;case 1:return h.stateSure;case 2:return h.stateNotSure}})}function Et(e){return ke(k(e,function(t){return t.state}))}function xn(e){switch(e){case 0:return 1;case 1:return 0;case 2:return 2}}function Un(e,t){var n=t[1],r=e[1];return r!==void 0?n!==void 0?xn(n)-xn(r)|0:-1:n!==void 0?1:An(e[0],t[0])}function zn(e){return Ce(e,function(t,n){return Un([t[0],k(t[1],function(r){return r.state})],[n[0],k(n[1],function(r){return r.state})])})}function Ie(e){return Ce(e,function(t,n){return Un([t[0],k(t[1].context,function(r){return r.state})],[n[0],k(n[1].context,function(r){return r.state})])})}function qn(e,t){e.ele.setAttribute("title",t)}function Bi(e,t){return{tooltips:bn(Mn(e,".item-body .checkboxInput, .item-body .radioInput"),void 0,function(n,r,i){return G(n,String.fromCharCode(i+65|0),{ele:r})}),choiceMap:t}}function ji(e,t){return R(yt(R(X(Ln(e,void 0,function(n,r,i){var a=i.context;return fe(i.answer,n,function(u){return ft(u,n,function(o,c){return _t(o,c,function(s){return En(q(s,[]),[[r,a]])})})})})),function(n){return[ae(t.choiceMap,n[0]),n[1]]})),function(n){var r=n[1],i=n[0];return z($n(t.tooltips,i),function(a){return qn(a,Jn(r.length,Tn(e)))}),l.createDOMElementVariadic("div",void 0,[l.createDOMElementVariadic("p",void 0,[l.createDOMElementVariadic("strong",void 0,[i])]),O(B.make,{children:R(zn(r),function(a){var u={},o=Et(a[1]);return o!==void 0&&(u.className=y(o)),l.createDOMElementVariadic("p",g(u),[a[0]])})})])})}function Bn(e,t,n){var r=Me("\u8BE6\u7EC6\u7B54\u6848",200,300,n,t);r[1].appendChild(N(F(l.createDOMElementVariadic("div",{className:h.mainBody},[l.createDOMElementVariadic("fieldset",{className:h.answerMark},[l.createDOMElementVariadic("legend",void 0,["\u6807\u8BB0"]),l.createDOMElementVariadic("input",{placeholder:"\u8F93\u5165\u7559\u8A00",type:"text",onChange:function(i){var a=i.target.value;M.updateMsg(e.id,a)}},[]),l.createDOMElementVariadic("button",{className:h.stateWorkingOn,type:"button",onClick:function(i){M.updateState(e.id,0)}},["\u6211\u6B63\u5728\u505A"]),l.createDOMElementVariadic("button",{className:h.stateSure,type:"button",onClick:function(i){M.updateState(e.id,1)}},["\u6211\u5F88\u786E\u5B9A"]),l.createDOMElementVariadic("button",{className:h.stateNotSure,type:"button",onClick:function(i){M.updateState(e.id,2)}},["\u6211\u4E0D\u786E\u5B9A"])]),e.detailHtml]))))}function Wi(e,t,n){var r={details:void 0,detailHtml:null,context:Bi(t,n),id:e},i=N(U(t.querySelector(".item-type")));return i.classList.add(h.clickable),i.addEventListener("click",function(a){var u=i.getBoundingClientRect();return Bn(r,u.top|0,u.left|0)}),r}function Hi(e,t,n){e.details=G(e.details,t,n)}function Fi(e){e.detailHtml=l.createDOMElementVariadic("div",void 0,[l.createDOMElementVariadic("fieldset",{className:h.answerMsg},[l.createDOMElementVariadic("legend",void 0,["\u7559\u8A00"]),O(B.make,{children:R(Ne(Ie(X(e.details)),function(t){var n=t[0];return k(t[1].context,function(r){var i=r.state,a=i===0?q(r.msg,"\u6211\u6B63\u5728\u505A"):r.msg;return Q(a,function(u){return[n,r.state,u]})})}),function(t){var n={},r=ke(t[1]);return r!==void 0&&(n.className=y(r)),l.createDOMElementVariadic("p",g(n),[l.createDOMElementVariadic("span",{className:h.answerMsgName},[t[0]+": "]),t[2]])})})]),l.createDOMElementVariadic("div",{className:h.answerDetail},[ji(e.details,e.context)])])}var St={showDetail:Bn,make:Wi,updateAnswer:Hi,updateUI:Fi};function Gi(e,t){return{tooltips:bn(Mn(e,".item-body .blank-item-dynamic"),void 0,function(n,r,i){return G(n,String.fromCharCode(49+i|0),{ele:r})})}}function Xi(e,t){return R(yt(X(Ln(e,void 0,function(n,r,i){var a=i.context;return fe(i.answer,n,function(u){return ft(Ni(u),n,function(o,c){var s=c[1];return _t(o,c[0],function(f){return g(_t(q(f,void 0),s,function(d){return En(q(d,[]),[[r,a]])}))})})})}))),function(n){var r=n[0],i=yt(X(n[1]));return z($n(t.tooltips,r),function(a){return qn(a,fe(ui(Ce(R(i,function(u){return[u[0],u[1].length]}),function(u,o){return o[1]-u[1]|0}),0),"",function(u){return"("+Jn(u[1],Tn(e))+") "+u[0]}))}),l.createDOMElementVariadic("div",void 0,[l.createDOMElementVariadic("p",void 0,[l.createDOMElementVariadic("strong",void 0,["#"+r])]),O(B.make,{children:R(i,function(a){return l.createDOMElementVariadic("div",void 0,[l.createDOMElementVariadic("p",void 0,[a[0]]),O(B.make,{children:R(zn(a[1]),function(u){var o={},c=Et(u[1]);return c!==void 0&&(o.className=y(c)),l.createDOMElementVariadic("p",g(o),[u[0]])})})])})})])})}function jn(e,t,n){var r=Me("\u8BE6\u7EC6\u7B54\u6848",200,300,n,t);r[1].appendChild(N(F(l.createDOMElementVariadic("div",{className:h.mainBody},[l.createDOMElementVariadic("fieldset",{className:h.answerMark},[l.createDOMElementVariadic("legend",void 0,["\u6807\u8BB0"]),l.createDOMElementVariadic("input",{placeholder:"\u8F93\u5165\u7559\u8A00",type:"text",onChange:function(i){var a=i.target.value;M.updateMsg(e.id,a)}},[]),l.createDOMElementVariadic("button",{className:h.stateWorkingOn,type:"button",onClick:function(i){M.updateState(e.id,0)}},["\u6211\u6B63\u5728\u505A"]),l.createDOMElementVariadic("button",{className:h.stateSure,type:"button",onClick:function(i){M.updateState(e.id,1)}},["\u6211\u5F88\u786E\u5B9A"]),l.createDOMElementVariadic("button",{className:h.stateNotSure,type:"button",onClick:function(i){M.updateState(e.id,2)}},["\u6211\u4E0D\u786E\u5B9A"])]),e.detailHtml]))))}function Yi(e,t,n){var r={details:void 0,detailHtml:null,context:Gi(t),id:e},i=N(U(t.querySelector(".item-type")));return i.classList.add(h.clickable),i.addEventListener("click",function(a){var u=i.getBoundingClientRect();return jn(r,u.top|0,u.left|0)}),r}function Zi(e,t,n){e.details=G(e.details,t,n)}function Qi(e){e.detailHtml=l.createDOMElementVariadic("div",void 0,[l.createDOMElementVariadic("fieldset",{className:h.answerMsg},[l.createDOMElementVariadic("legend",void 0,["\u7559\u8A00"]),O(B.make,{children:R(Ne(Ie(X(e.details)),function(t){var n=t[0];return k(t[1].context,function(r){var i=r.state,a=i===0?q(r.msg,"\u6211\u6B63\u5728\u505A"):r.msg;return Q(a,function(u){return[n,r.state,u]})})}),function(t){var n={},r=ke(t[1]);return r!==void 0&&(n.className=y(r)),l.createDOMElementVariadic("p",g(n),[l.createDOMElementVariadic("span",{className:h.answerMsgName},[t[0]+": "]),t[2]])})})]),l.createDOMElementVariadic("div",{className:h.answerDetail},[Xi(e.details,e.context)])])}var bt={showDetail:jn,make:Yi,updateAnswer:Zi,updateUI:Qi};function Aa(e,t){}function Ki(e,t){return R(Ie(X(e)),function(n){var r=n[1],i=r.answer,a={},u=Et(r.context);return u!==void 0&&(a.className=y(u)),l.createDOMElementVariadic("div",void 0,[l.createDOMElementVariadic("p",g(a),[l.createDOMElementVariadic("strong",void 0,[n[0]])]),l.createDOMElementVariadic("div",{className:h.answerDetailShortAnswer,dangerouslySetInnerHTML:{__html:q(k(i,function(o){return o.content}),"")}},[]),O(B.make,{children:R(q(k(k(i,function(o){return o.attachments}),function(o){return o.filelist}),[]),function(o){return l.createDOMElementVariadic("a",{href:o.fileUrl},[o.fileName])})}),l.createDOMElementVariadic("div",void 0,[])])})}function Wn(e,t,n){var r=Me("\u8BE6\u7EC6\u7B54\u6848",200,300,n,t);r[1].appendChild(N(F(l.createDOMElementVariadic("div",{className:h.mainBody},[l.createDOMElementVariadic("fieldset",{className:h.answerMark},[l.createDOMElementVariadic("legend",void 0,["\u6807\u8BB0"]),l.createDOMElementVariadic("input",{placeholder:"\u8F93\u5165\u7559\u8A00",type:"text",onChange:function(i){var a=i.target.value;M.updateMsg(e.id,a)}},[]),l.createDOMElementVariadic("button",{className:h.stateWorkingOn,type:"button",onClick:function(i){M.updateState(e.id,0)}},["\u6211\u6B63\u5728\u505A"]),l.createDOMElementVariadic("button",{className:h.stateSure,type:"button",onClick:function(i){M.updateState(e.id,1)}},["\u6211\u5F88\u786E\u5B9A"]),l.createDOMElementVariadic("button",{className:h.stateNotSure,type:"button",onClick:function(i){M.updateState(e.id,2)}},["\u6211\u4E0D\u786E\u5B9A"])]),e.detailHtml]))))}function ea(e,t,n){var r={details:void 0,detailHtml:null,context:void 0,id:e},i=N(U(t.querySelector(".item-type")));return i.classList.add(h.clickable),i.addEventListener("click",function(a){var u=i.getBoundingClientRect();return Wn(r,u.top|0,u.left|0)}),r}function ta(e,t,n){e.details=G(e.details,t,n)}function na(e){e.detailHtml=l.createDOMElementVariadic("div",void 0,[l.createDOMElementVariadic("fieldset",{className:h.answerMsg},[l.createDOMElementVariadic("legend",void 0,["\u7559\u8A00"]),O(B.make,{children:R(Ne(Ie(X(e.details)),function(t){var n=t[0];return k(t[1].context,function(r){var i=r.state,a=i===0?q(r.msg,"\u6211\u6B63\u5728\u505A"):r.msg;return Q(a,function(u){return[n,r.state,u]})})}),function(t){var n={},r=ke(t[1]);return r!==void 0&&(n.className=y(r)),l.createDOMElementVariadic("p",g(n),[l.createDOMElementVariadic("span",{className:h.answerMsgName},[t[0]+": "]),t[2]])})})]),l.createDOMElementVariadic("div",{className:h.answerDetail},[Ki(e.details,e.context)])])}var Ot={showDetail:Wn,make:ea,updateAnswer:ta,updateUI:na};function ra(e){throw new Error(e)}var K=ct;function ia(e){var t=e.onSubmit,n=function(m){var p=m.name,T=m.title,de=m.props,Ve=Object.assign(de,{name:p});return l.createDOMElementVariadic("div",{className:K.settingsEntry},[l.createDOMElementVariadic("label",{htmlFor:p},[T]),l.createDOMElementVariadic("input",g(Ve),[])])},r=function(m){var p=m.title,T=m.content;return l.createDOMElementVariadic("p",void 0,[l.createDOMElementVariadic("strong",void 0,[p]),T])},i={},a={title:"\u5C0F\u5199\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF",pattern:"^[a-z][a-z0-9_]*$",required:!0,type:"text",onChange:function(m){var p=m.target.value;i.username=p}},u=Xe.get(void 0);u!==void 0&&(a.value=y(u));var o={required:!0,type:"url",onChange:function(m){var p=m.target.value;i.server=p}},c=Qe.get(void 0);c!==void 0&&(o.value=y(c));var s={type:"checkbox",onChange:function(m){var p=m.target.checked;i.syncAnswers=p}},f=tt.get(void 0);f!==void 0&&(s.checked=y(f));var d={type:"checkbox",onChange:function(m){var p=m.target.checked;i.sortProblems=p}},_=ot.get(void 0);_!==void 0&&(d.checked=y(_));var S={type:"checkbox",onChange:function(m){var p=m.target.checked;i.noLeaveCheck=p}},w=it.get(void 0);return w!==void 0&&(S.checked=y(w)),l.createDOMElementVariadic("div",void 0,[l.createDOMElementVariadic("form",{className:K.settings,onSubmit:function(m){return m.preventDefault(),z(se(i.username),Xe.set),z(se(i.server),Qe.set),z(se(i.syncAnswers),tt.set),z(se(i.noLeaveCheck),it.set),z(se(i.sortProblems),ot.set),ae(t,void 0)}},[O(n,{name:"username",title:"\u7528\u6237\u540D",props:a}),O(n,{name:"server",title:"\u670D\u52A1\u5668",props:o}),O(n,{name:"sync_answers",title:"\u540C\u6B65\u7B54\u6848",props:s}),O(n,{name:"sort_problems",title:"\u6392\u5E8F\u9898\u76EE",props:d}),O(n,{name:"no_leave_check",title:"\u62E6\u622A\u5207\u5C4F\u68C0\u6D4B",props:S}),l.createDOMElementVariadic("div",{className:K.settingsSubmit},[l.createDOMElementVariadic("p",{className:K.settingsSubmitTip},[l.createDOMElementVariadic("i",void 0,["*\u66F4\u6539\u8BBE\u7F6E\u540E\u8BF7\u5237\u65B0\u9875\u9762"])]),l.createDOMElementVariadic("button",{type:"submit"},["\u63D0\u4EA4"])])]),l.createDOMElementVariadic("div",{className:K.about},[l.createDOMElementVariadic("p",void 0,[l.createDOMElementVariadic("strong",void 0,["\u529F\u80FD\u7279\u6027\uFF1A"])]),ni(B.make,{children:null},[O(r,{title:"\u540C\u6B65\u7B54\u6848\uFF1A",content:"\u70B9\u51FB\u9898\u76EE\u663E\u793A\u8BE6\u7EC6\u7B54\u6848\uFF0C\u5728\u9009\u9879/\u586B\u7A7A\u5904\u60AC\u505C\u663E\u793A\u7B80\u7565\u7B54\u6848"}),O(r,{title:"\u6392\u5E8F\u9898\u76EE\uFF1A",content:"\u6839\u636E ID \u5BF9\u9898\u76EE\u548C\u9009\u9879\u8FDB\u884C\u91CD\u65B0\u6392\u5E8F"}),O(r,{title:"\u62E6\u622A\u5207\u5C4F\u68C0\u6D4B\uFF1A",content:"\u968F\u610F\u5207\u6362\u9875\u9762\u3001\u7A97\u53E3\u4E0D\u4F1A\u88AB\u53D1\u73B0"}),O(r,{title:"\u62E6\u622A\u4E0A\u4F20\u622A\u56FE\uFF1A",content:"\u4EC5\u5F53\u7528\u6237\u786E\u8BA4\u540E\uFF0C\u624D\u4F1A\u4E0A\u4F20\u622A\u56FE"}),O(r,{title:"\u62E6\u622A\u5F02\u5E38\u72B6\u6001\uFF1A",content:"\u5373\u4F7F\u672C\u5730\u663E\u793A\u5F02\u5E38\u4E5F\u4E0D\u4F1A\u63A8\u9001\u5230\u670D\u52A1\u5668"})])])])}function aa(e){var t=Me("\u8BBE\u7F6E",300,400,void 0,void 0),n=t[0];t[1].appendChild(N(F(l.createDOMElementVariadic("div",{className:K.mainBody},[O(ia,{onSubmit:function(r){n.close()}})]))))}function ua(e,t){for(;;){var n=e;if(n===void 0)return;var r=n.k;if(t===r)return g(n.v);e=t<r?n.l:n.r}}function Nt(e,t,n){if(e===void 0)return L(t,n);var r=e.k;if(t===r)return dt(e,n);var i=e.v;return t<r?j(Nt(e.l,t,n),r,i,e.r):j(e.l,r,i,Nt(e.r,t,n))}var oa=ki,sa=ua,ca=Si,la=je,fa=ct;function da(e){if(e<=6&&1<=e)return e-1|0}function Pe(e,t){return{updateUI:function(n){return ae(e.updateUI,t)},updateAnswer:function(n,r){return Yt(e.updateAnswer,t,n,{context:r.context,answer:Q(r.answer,function(i){return i})})}}}function va(e){var t=N(k(Nn(document),function(u){return Q(U(u.body),function(o){return[u.head,o]})})),n=t[1];t[0].appendChild(N(F(l.createDOMElementVariadic("style",void 0,[la]))));var r=N(k(U(n.querySelector(".header-title")),ca));r.classList.add(fa.clickable),r.addEventListener("click",function(u){return aa()});var i=R(Array.prototype.slice.call(n.querySelectorAll(".exam-main--body .subject-item")),function(u){return N(On(u))});i.length!==e.length&&ra("wrong number of subject items");var a=ft(oi(e,i),void 0,function(u,o){var c=o[1],s=o[0],f=N(da(s.ProblemType)),d,_=0;if(f>=3)switch(f){case 3:d=Pe({updateUI:bt.updateUI,updateAnswer:bt.updateAnswer},bt.make(s.ProblemID,c,void 0));break;case 4:d=Pe({updateUI:Ot.updateUI,updateAnswer:Ot.updateAnswer},Ot.make(s.ProblemID,c,void 0));break;case 5:_=1;break}else _=1;if(_===1){var S=zi(fi(N(s.Options),function(w,m){return[m.key,String.fromCharCode(65+w|0)]}));d=Pe({updateUI:St.updateUI,updateAnswer:St.updateAnswer},St.make(s.ProblemID,c,function(w){return qi(S,w)}))}return Nt(u,s.ProblemID,d)});return{details:a}}function ha(e,t,n,r){return z(sa(e.details,t),function(i){return Xt(i.updateAnswer,n,r)})}function ma(e){return oa(e.details,function(t,n){return ae(n.updateUI,void 0)})}var Mt={unsafeConvertUpdateDetail:Pe,make:va,updateAnswer:ha,updateUI:ma};const pa=ze("<div><div><button>\u786E\u8BA4\u4E0A\u4F20</button><span><i>*\u5173\u95ED\u7A97\u53E3\u4EE5\u53D6\u6D88\u4E0A\u4F20</i></span></div><div><img></div></div>");class ga{constructor(t){this.inner=Mt.make(t)}updateAnswer({username:t,problem_id:n,result:r,context:i}){Mt.updateAnswer(this.inner,n,t,{answer:r,context:i})}updateUI(){Mt.updateUI(this.inner)}}function wa(e,t){const n=Cr({title:"\u4E0A\u4F20\u56FE\u7247",width:400,height:300});qt(()=>(()=>{const r=pa.cloneNode(!0),i=r.firstChild,a=i.firstChild,u=i.nextSibling,o=u.firstChild;return a.$$click=()=>{n.close(),t()},Sr(o,"src",e),_e(c=>{const s={[le.mainBody]:!0,[le.uploadImg]:!0},f=le.uploadImgConfirm,d=le.uploadImgImage;return c._v$=br(r,s,c._v$),f!==c._v$2&&Bt(i,c._v$2=f),d!==c._v$3&&Bt(u,c._v$3=d),c},{_v$:void 0,_v$2:void 0,_v$3:void 0}),r})(),n.document.body)}Er(["click"]);function Hn(e){return e.forEach(t=>{switch(t.ProblemType){case Se.SingleChoice:case Se.MultipleChoice:case Se.Polling:{t.Options.sort((r,i)=>r.key<i.key?-1:1);break}}}),e.sort((t,n)=>t.ProblemID-n.ProblemID),e}function _a(e){return Wr.value===!0&&(e.data.has_problem_dict===!0?e.data.problems=e.data.problems.sort((t,n)=>t.id-n.id).map(t=>(t.problems=Hn(t.problems),t)):e.data.problems=Hn(e.data.problems)),e}function ya(){document.addEventListener("visibilitychange",e=>{e.preventDefault(),e.stopImmediatePropagation()},!0),window.addEventListener("visibilitychange",e=>{e.preventDefault(),e.stopImmediatePropagation()},!0)}async function Ea(){Dr(),Hr.value===!0&&ya(),Gr(function(e){switch(e.pathname){case"/exam_room/show_paper":this.addEventListener("readystatechange",()=>{if(this.readyState==XMLHttpRequest.DONE){const t=JSON.stringify(_a(JSON.parse(this.responseText)));Object.defineProperties(this,{responseText:{get(){return t}}})}}),this.addEventListener("load",()=>{const t=JSON.parse(this.responseText);let n=[];t.data.has_problem_dict===!0?t.data.problems.forEach(a=>{n=n.concat(a.problems)}):n=t.data.problems;const r=new ga(n);M.onmessage(a=>{a.forEach(u=>r.updateAnswer(u)),r.updateUI()});const i=parseInt(e.searchParams.get("exam_id"));M.login(i,{title:t.data.title,problems:n}),fetch(Ft("/exam_room/cache_results",{exam_id:i.toString()}).toString()).then(a=>a.json()).then(a=>a.data.results.forEach(({problem_id:u,result:o})=>M.updateAnswer(u,o))).catch(We)});return;case"/exam_room/answer_problem":return async t=>{var n;if(typeof t=="string"){const r=JSON.parse(t);if("action"in r)switch(r.action){case 1:case 17:break;default:return console.log("intercept action",r),new Promise(()=>{})}else"results"in r&&((n=r.results)==null||n.forEach(({problem_id:i,result:a})=>M.updateAnswer(i,a)))}return t};default:return e.hostname==="upload-z1.qiniup.com"?async t=>t instanceof FormData&&t.get("file")instanceof File?new Promise(n=>{const r=new FileReader;r.onload=()=>wa(r.result,()=>n(t)),r.readAsDataURL(t.get("file"))}):t:void 0}}),await M.watch(1e4)}Ea().catch(console.error)});
