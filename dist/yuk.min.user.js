// ==UserScript==
// @name         yuk-client
// @version      0.6.1
// @author       doge2x
// @icon         https://www.yuketang.cn/static/images/favicon.ico
// @match        https://examination.xuetangx.com/*
// @grant        GM.xmlHttpRequest
// @grant        GM_getValue
// @grant        GM_setValue
// @run-at       document-start
// ==/UserScript==
(function(v){typeof define=="function"&&define.amd?define(v):v()})(function(){"use strict";var la=Object.defineProperty,_a=Object.defineProperties;var da=Object.getOwnPropertyDescriptors;var Fo=Object.getOwnPropertySymbols;var pa=Object.prototype.hasOwnProperty,va=Object.prototype.propertyIsEnumerable;var kn=(v,q,k)=>q in v?la(v,q,{enumerable:!0,configurable:!0,writable:!0,value:k}):v[q]=k,Wo=(v,q)=>{for(var k in q||(q={}))pa.call(q,k)&&kn(v,k,q[k]);if(Fo)for(var k of Fo(q))va.call(q,k)&&kn(v,k,q[k]);return v},Ko=(v,q)=>_a(v,da(q));var et=(v,q,k)=>(kn(v,typeof q!="symbol"?q+"":q,k),k);var v=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},q={},k={},he={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createJSONRPCErrorResponse=e.JSONRPCErrorCode=e.isJSONRPCResponses=e.isJSONRPCResponse=e.isJSONRPCRequests=e.isJSONRPCRequest=e.isJSONRPCID=e.JSONRPC=void 0,e.JSONRPC="2.0";var t=function(u){return typeof u=="string"||typeof u=="number"||u===null};e.isJSONRPCID=t;var r=function(u){return u.jsonrpc===e.JSONRPC&&u.method!==void 0&&u.result===void 0&&u.error===void 0};e.isJSONRPCRequest=r;var n=function(u){return Array.isArray(u)&&u.every(e.isJSONRPCRequest)};e.isJSONRPCRequests=n;var i=function(u){return u.jsonrpc===e.JSONRPC&&u.id!==void 0&&(u.result!==void 0||u.error!==void 0)};e.isJSONRPCResponse=i;var o=function(u){return Array.isArray(u)&&u.every(e.isJSONRPCResponse)};e.isJSONRPCResponses=o,function(u){u[u.ParseError=-32700]="ParseError",u[u.InvalidRequest=-32600]="InvalidRequest",u[u.MethodNotFound=-32601]="MethodNotFound",u[u.InvalidParams=-32602]="InvalidParams",u[u.InternalError=-32603]="InternalError"}(e.JSONRPCErrorCode||(e.JSONRPCErrorCode={}));var s=function(u,f,a,c){var h={code:f,message:a};return c&&(h.data=c),{jsonrpc:e.JSONRPC,id:u,error:h}};e.createJSONRPCErrorResponse=s})(he);var le={};Object.defineProperty(le,"__esModule",{value:!0}),le.DefaultErrorCode=void 0,le.DefaultErrorCode=0;var Ho=v&&v.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function f(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?o(c.value):i(c.value).then(u,f)}a((n=n.apply(e,t||[])).next())})},Yo=v&&v.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return f([a,c])}}function f(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=a[0]&2?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[a[0]&2,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(a[0]===6&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],i=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(k,"__esModule",{value:!0}),k.JSONRPCClient=void 0;var _e=he,Mr=le,Go=function(){function e(t,r){this._send=t,this.createID=r,this.idToResolveMap=new Map,this.id=0}return e.prototype._createID=function(){return this.createID?this.createID():++this.id},e.prototype.timeout=function(t,r){var n=this;r===void 0&&(r=function(s){return(0,_e.createJSONRPCErrorResponse)(s,Mr.DefaultErrorCode,"Request timeout")});var i=function(s,u){var f=setTimeout(function(){s.forEach(function(a){var c=n.idToResolveMap.get(a);c&&(n.idToResolveMap.delete(a),c(r(a)))})},t);return u().then(function(a){return clearTimeout(f),a},function(a){return clearTimeout(f),Promise.reject(a)})},o=function(s,u){var f=(Array.isArray(s)?s:[s]).map(function(a){return a.id}).filter(Ln);return i(f,function(){return n.requestAdvanced(s,u)})};return{request:function(s,u,f){var a=n._createID();return i([a],function(){return n.requestWithID(s,u,f,a)})},requestAdvanced:function(s,u){return o(s,u)}}},e.prototype.request=function(t,r,n){return this.requestWithID(t,r,n,this._createID())},e.prototype.requestWithID=function(t,r,n,i){return Ho(this,void 0,void 0,function(){var o,s;return Yo(this,function(u){switch(u.label){case 0:return o={jsonrpc:_e.JSONRPC,method:t,params:r,id:i},[4,this.requestAdvanced(o,n)];case 1:return s=u.sent(),s.result!==void 0&&!s.error?[2,s.result]:s.result===void 0&&s.error?[2,Promise.reject(new Error(s.error.message))]:[2,Promise.reject(new Error("An unexpected error occurred"))]}})})},e.prototype.requestAdvanced=function(t,r){var n=this,i=Array.isArray(t);Array.isArray(t)||(t=[t]);var o=t.filter(function(f){return Ln(f.id)}),s=o.map(function(f){return new Promise(function(a){return n.idToResolveMap.set(f.id,a)})}),u=Promise.all(s).then(function(f){return i||!f.length?f:f[0]});return this.send(i?t:t[0],r).then(function(){return u},function(f){return o.forEach(function(a){n.receive((0,_e.createJSONRPCErrorResponse)(a.id,Mr.DefaultErrorCode,f&&f.message||"Failed to send a request"))}),u})},e.prototype.notify=function(t,r,n){this.send({jsonrpc:_e.JSONRPC,method:t,params:r},n).then(void 0,function(){})},e.prototype.send=function(t,r){return this._send(t,r)},e.prototype.rejectAllPendingRequests=function(t){this.idToResolveMap.forEach(function(r,n){return r((0,_e.createJSONRPCErrorResponse)(n,Mr.DefaultErrorCode,t))}),this.idToResolveMap.clear()},e.prototype.receive=function(t){var r=this;Array.isArray(t)||(t=[t]),t.forEach(function(n){var i=r.idToResolveMap.get(n.id);i&&(r.idToResolveMap.delete(n.id),i(n))})},e}();k.JSONRPCClient=Go;var Ln=function(e){return e!=null},We={},Ke=v&&v.__assign||function(){return Ke=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Ke.apply(this,arguments)},jn=v&&v.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function f(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?o(c.value):i(c.value).then(u,f)}a((n=n.apply(e,t||[])).next())})},Dn=v&&v.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return f([a,c])}}function f(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=a[0]&2?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[a[0]&2,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(a[0]===6&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],i=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Vo=v&&v.__spreadArray||function(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,o;n<i;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))};Object.defineProperty(We,"__esModule",{value:!0}),We.JSONRPCServer=void 0;var rt=he,Xo=le,Qo=function(){return(0,rt.createJSONRPCErrorResponse)(null,rt.JSONRPCErrorCode.ParseError,"Parse error")},Zo=function(e){return(0,rt.createJSONRPCErrorResponse)((0,rt.isJSONRPCID)(e.id)?e.id:null,rt.JSONRPCErrorCode.InvalidRequest,"Invalid Request")},ts=function(e){return(0,rt.createJSONRPCErrorResponse)(e,rt.JSONRPCErrorCode.MethodNotFound,"Method not found")},es=function(){function e(t){t===void 0&&(t={});var r;this.mapErrorToJSONRPCErrorResponse=os,this.nameToMethodDictionary={},this.middleware=null,this.errorListener=(r=t.errorListener)!==null&&r!==void 0?r:console.warn}return e.prototype.addMethod=function(t,r){this.addMethodAdvanced(t,this.toJSONRPCMethod(r))},e.prototype.toJSONRPCMethod=function(t){return function(r,n){var i=t(r.params,n);return Promise.resolve(i).then(function(o){return is(r.id,o)})}},e.prototype.addMethodAdvanced=function(t,r){var n;this.nameToMethodDictionary=Ke(Ke({},this.nameToMethodDictionary),(n={},n[t]=r,n))},e.prototype.receiveJSON=function(t,r){var n=this.tryParseRequestJSON(t);return n?this.receive(n,r):Promise.resolve(Qo())},e.prototype.tryParseRequestJSON=function(t){try{return JSON.parse(t)}catch{return null}},e.prototype.receive=function(t,r){return Array.isArray(t)?this.receiveMultiple(t,r):this.receiveSingle(t,r)},e.prototype.receiveMultiple=function(t,r){return jn(this,void 0,void 0,function(){var n,i=this;return Dn(this,function(o){switch(o.label){case 0:return[4,Promise.all(t.map(function(s){return i.receiveSingle(s,r)}))];case 1:return n=o.sent().filter(rs),n.length===1?[2,n[0]]:n.length?[2,n]:[2,null]}})})},e.prototype.receiveSingle=function(t,r){return jn(this,void 0,void 0,function(){var n,i;return Dn(this,function(o){switch(o.label){case 0:return n=this.nameToMethodDictionary[t.method],(0,rt.isJSONRPCRequest)(t)?[3,1]:[2,Zo(t)];case 1:return n?[4,this.callMethod(n,t,r)]:[3,3];case 2:return i=o.sent(),[2,ss(t,i)];case 3:return t.id!==void 0?[2,ts(t.id)]:[2,null];case 4:return[2]}})})},e.prototype.applyMiddleware=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.middleware?this.middleware=this.combineMiddlewares(Vo([this.middleware],t,!0)):this.middleware=this.combineMiddlewares(t)},e.prototype.combineMiddlewares=function(t){return t.length?t.reduce(this.middlewareReducer):null},e.prototype.middlewareReducer=function(t,r){return function(n,i,o){return t(function(s,u){return r(n,s,u)},i,o)}},e.prototype.callMethod=function(t,r,n){var i=this,o=function(u,f){return t(u,f)},s=function(u){return i.errorListener('An unexpected error occurred while executing "'.concat(r.method,'" JSON-RPC method:'),u),Promise.resolve(i.mapErrorToJSONRPCErrorResponseIfNecessary(r.id,u))};try{return(this.middleware||ns)(o,r,n).then(void 0,s)}catch(u){return s(u)}},e.prototype.mapErrorToJSONRPCErrorResponseIfNecessary=function(t,r){return t!==void 0?this.mapErrorToJSONRPCErrorResponse(t,r):null},e}();We.JSONRPCServer=es;var rs=function(e){return e!==null},ns=function(e,t,r){return e(t,r)},is=function(e,t){return e!==void 0?{jsonrpc:rt.JSONRPC,id:e,result:t===void 0?null:t}:null},os=function(e,t){return(0,rt.createJSONRPCErrorResponse)(e,Xo.DefaultErrorCode,t&&t.message||"An unexpected error occurred")},ss=function(e,t){return t||(e.id!==void 0?(0,rt.createJSONRPCErrorResponse)(e.id,rt.JSONRPCErrorCode.InternalError,"Internal error"):null)},He={},us=v&&v.__awaiter||function(e,t,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(c){try{a(n.next(c))}catch(h){s(h)}}function f(c){try{a(n.throw(c))}catch(h){s(h)}}function a(c){c.done?o(c.value):i(c.value).then(u,f)}a((n=n.apply(e,t||[])).next())})},as=v&&v.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(a){return function(c){return f([a,c])}}function f(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=a[0]&2?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[a[0]&2,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(a[0]===6&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(c){a=[6,c],i=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(He,"__esModule",{value:!0}),He.JSONRPCServerAndClient=void 0;var Ye=he,fs=function(){function e(t,r,n){n===void 0&&(n={});var i;this.server=t,this.client=r,this.errorListener=(i=n.errorListener)!==null&&i!==void 0?i:console.warn}return e.prototype.applyServerMiddleware=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];(t=this.server).applyMiddleware.apply(t,r)},e.prototype.addMethod=function(t,r){this.server.addMethod(t,r)},e.prototype.addMethodAdvanced=function(t,r){this.server.addMethodAdvanced(t,r)},e.prototype.timeout=function(t){return this.client.timeout(t)},e.prototype.request=function(t,r,n){return this.client.request(t,r,n)},e.prototype.requestAdvanced=function(t,r){return this.client.requestAdvanced(t,r)},e.prototype.notify=function(t,r,n){this.client.notify(t,r,n)},e.prototype.rejectAllPendingRequests=function(t){this.client.rejectAllPendingRequests(t)},e.prototype.receiveAndSend=function(t,r,n){return us(this,void 0,void 0,function(){var i,o;return as(this,function(s){switch(s.label){case 0:return(0,Ye.isJSONRPCResponse)(t)||(0,Ye.isJSONRPCResponses)(t)?(this.client.receive(t),[3,4]):[3,1];case 1:return(0,Ye.isJSONRPCRequest)(t)||(0,Ye.isJSONRPCRequests)(t)?[4,this.server.receive(t,r)]:[3,3];case 2:return i=s.sent(),i?[2,this.client.send(i,n)]:[3,4];case 3:return o="Received an invalid JSON-RPC message",this.errorListener(o,t),[2,Promise.reject(new Error(o))];case 4:return[2]}})})},e}();He.JSONRPCServerAndClient=fs,function(e){var t=v&&v.__createBinding||(Object.create?function(n,i,o,s){s===void 0&&(s=o),Object.defineProperty(n,s,{enumerable:!0,get:function(){return i[o]}})}:function(n,i,o,s){s===void 0&&(s=o),n[s]=i[o]}),r=v&&v.__exportStar||function(n,i){for(var o in n)o!=="default"&&!Object.prototype.hasOwnProperty.call(i,o)&&t(i,n,o)};Object.defineProperty(e,"__esModule",{value:!0}),r(k,e),r(he,e),r(We,e),r(He,e)}(q);const mt={};function cs(e){mt.context=e}const hs=(e,t)=>e===t,ls=Symbol("solid-track"),Ge={equals:hs};let xn=Wn;const Ht={},jt=1,Ve=2,Jn={owned:null,cleanups:null,context:null,owner:null};var B=null;let de=null,P=null,pe=null,U=null,at=null,Ar=0;function ve(e,t){const r=P,n=B,i=e.length===0?Jn:{owned:null,cleanups:null,context:null,owner:t||n};B=i,P=null;try{return Cr(()=>e(()=>zr(i)),!0)}finally{P=r,B=n}}function Bn(e,t){t=t?Object.assign({},Ge,t):Ge;const r={value:e,observers:null,observerSlots:null,pending:Ht,comparator:t.equals||void 0},n=i=>(typeof i=="function"&&(i=i(r.pending!==Ht?r.pending:r.value)),Nr(r,i));return[Fn.bind(r),n]}function L(e,t,r){const n=$r(e,t,!1,jt);ye(n)}function Un(e,t,r){xn=ys;const n=$r(e,t,!1,jt);n.user=!0,at?at.push(n):ye(n)}function Ir(e,t,r){r=r?Object.assign({},Ge,r):Ge;const n=$r(e,t,!0,0);return n.pending=Ht,n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,ye(n),Fn.bind(n)}function _s(e){if(pe)return e();let t;const r=pe=[];try{t=e()}finally{pe=null}return Cr(()=>{for(let n=0;n<r.length;n+=1){const i=r[n];if(i.pending!==Ht){const o=i.pending;i.pending=Ht,Nr(i,o)}}},!1),t}function Rr(e){let t,r=P;return P=null,t=e(),P=r,t}function ds(e){return B===null||(B.cleanups===null?B.cleanups=[e]:B.cleanups.push(e)),e}function Fn(){const e=de;if(this.sources&&(this.state||e)){const t=U;U=null,this.state===jt||e?ye(this):Xe(this),U=t}if(P){const t=this.observers?this.observers.length:0;P.sources?(P.sources.push(this),P.sourceSlots.push(t)):(P.sources=[this],P.sourceSlots=[t]),this.observers?(this.observers.push(P),this.observerSlots.push(P.sources.length-1)):(this.observers=[P],this.observerSlots=[P.sources.length-1])}return this.value}function Nr(e,t,r){if(pe)return e.pending===Ht&&pe.push(e),e.pending=t,t;if(e.comparator&&e.comparator(e.value,t))return t;let n=!1;return e.value=t,e.observers&&e.observers.length&&Cr(()=>{for(let i=0;i<e.observers.length;i+=1){const o=e.observers[i];n&&de.disposed.has(o),(n&&!o.tState||!n&&!o.state)&&(o.pure?U.push(o):at.push(o),o.observers&&Kn(o)),n||(o.state=jt)}if(U.length>1e6)throw U=[],new Error},!1),t}function ye(e){if(!e.fn)return;zr(e);const t=B,r=P,n=Ar;P=B=e,ps(e,e.value,n),P=r,B=t}function ps(e,t,r){let n;try{n=e.fn(t)}catch(i){Hn(i)}(!e.updatedAt||e.updatedAt<=r)&&(e.observers&&e.observers.length?Nr(e,n):e.value=n,e.updatedAt=r)}function $r(e,t,r,n=jt,i){const o={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:B,context:null,pure:r};return B===null||B!==Jn&&(B.owned?B.owned.push(o):B.owned=[o]),o}function ge(e){const t=de;if(e.state===0||t)return;if(e.state===Ve||t)return Xe(e);if(e.suspense&&Rr(e.suspense.inFallback))return e.suspense.effects.push(e);const r=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Ar);)(e.state||t)&&r.push(e);for(let n=r.length-1;n>=0;n--)if(e=r[n],e.state===jt||t)ye(e);else if(e.state===Ve||t){const i=U;U=null,Xe(e,r[0]),U=i}}function Cr(e,t){if(U)return e();let r=!1;t||(U=[]),at?r=!0:at=[],Ar++;try{const n=e();return vs(r),n}catch(n){Hn(n)}finally{U=null,r||(at=null)}}function vs(e){U&&(Wn(U),U=null),!e&&(at.length?_s(()=>{xn(at),at=null}):at=null)}function Wn(e){for(let t=0;t<e.length;t++)ge(e[t])}function ys(e){let t,r=0;for(t=0;t<e.length;t++){const i=e[t];i.user?e[r++]=i:ge(i)}mt.context&&cs();const n=e.length;for(t=0;t<r;t++)ge(e[t]);for(t=n;t<e.length;t++)ge(e[t])}function Xe(e,t){const r=de;e.state=0;for(let n=0;n<e.sources.length;n+=1){const i=e.sources[n];i.sources&&(i.state===jt||r?i!==t&&ge(i):(i.state===Ve||r)&&Xe(i,t))}}function Kn(e){const t=de;for(let r=0;r<e.observers.length;r+=1){const n=e.observers[r];(!n.state||t)&&(n.state=Ve,n.pure?U.push(n):at.push(n),n.observers&&Kn(n))}}function zr(e){let t;if(e.sources)for(;e.sources.length;){const r=e.sources.pop(),n=e.sourceSlots.pop(),i=r.observers;if(i&&i.length){const o=i.pop(),s=r.observerSlots.pop();n<i.length&&(o.sourceSlots[s]=n,i[n]=o,r.observerSlots[n]=s)}}if(e.owned){for(t=0;t<e.owned.length;t++)zr(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function Hn(e){throw e}const gs=Symbol("fallback");function Yn(e){for(let t=0;t<e.length;t++)e[t]()}function ms(e,t,r={}){let n=[],i=[],o=[],s=0,u=t.length>1?[]:null;return ds(()=>Yn(o)),()=>{let f=e()||[],a,c;return f[ls],Rr(()=>{let l=f.length,_,d,p,m,N,I,D,gt,kt;if(l===0)s!==0&&(Yn(o),o=[],n=[],i=[],s=0,u&&(u=[])),r.fallback&&(n=[gs],i[0]=ve(br=>(o[0]=br,r.fallback())),s=1);else if(s===0){for(i=new Array(l),c=0;c<l;c++)n[c]=f[c],i[c]=ve(h);s=l}else{for(p=new Array(l),m=new Array(l),u&&(N=new Array(l)),I=0,D=Math.min(s,l);I<D&&n[I]===f[I];I++);for(D=s-1,gt=l-1;D>=I&&gt>=I&&n[D]===f[gt];D--,gt--)p[gt]=i[D],m[gt]=o[D],u&&(N[gt]=u[D]);for(_=new Map,d=new Array(gt+1),c=gt;c>=I;c--)kt=f[c],a=_.get(kt),d[c]=a===void 0?-1:a,_.set(kt,c);for(a=I;a<=D;a++)kt=n[a],c=_.get(kt),c!==void 0&&c!==-1?(p[c]=i[a],m[c]=o[a],u&&(N[c]=u[a]),c=d[c],_.set(kt,c)):o[a]();for(c=I;c<l;c++)c in p?(i[c]=p[c],o[c]=m[c],u&&(u[c]=N[c],u[c](c))):i[c]=ve(h);i=i.slice(0,s=l),n=f.slice(0)}return i});function h(l){if(o[c]=l,u){const[_,d]=Bn(c);return u[c]=d,t(f[c],_)}return t(f[c])}}}function W(e,t){return Rr(()=>e(t||{}))}function Nt(e){const t="fallback"in e&&{fallback:()=>e.fallback};return Ir(ms(()=>e.each,e.children,t||void 0))}const ws=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],Ss=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...ws]),bs=new Set(["innerHTML","textContent","innerText","children"]),Es={className:"class",htmlFor:"for"},Gn={class:"className",formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly"},Os=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Ms={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function As(e,t,r){let n=r.length,i=t.length,o=n,s=0,u=0,f=t[i-1].nextSibling,a=null;for(;s<i||u<o;){if(t[s]===r[u]){s++,u++;continue}for(;t[i-1]===r[o-1];)i--,o--;if(i===s){const c=o<n?u?r[u-1].nextSibling:r[o-u]:f;for(;u<o;)e.insertBefore(r[u++],c)}else if(o===u)for(;s<i;)(!a||!a.has(t[s]))&&t[s].remove(),s++;else if(t[s]===r[o-1]&&r[u]===t[i-1]){const c=t[--i].nextSibling;e.insertBefore(r[u++],t[s++].nextSibling),e.insertBefore(r[--o],c),t[i]=r[o]}else{if(!a){a=new Map;let h=u;for(;h<o;)a.set(r[h],h++)}const c=a.get(t[s]);if(c!=null)if(u<c&&c<o){let h=s,l=1,_;for(;++h<i&&h<o&&!((_=a.get(t[h]))==null||_!==c+l);)l++;if(l>c-u){const d=t[s];for(;u<c;)e.insertBefore(r[u++],d)}else e.replaceChild(r[u++],t[s++])}else s++;else t[s++].remove()}}}const Vn="_$DX_DELEGATE";function me(e,t,r){let n;return ve(i=>{n=i,t===document?e():w(t,e(),t.firstChild?null:void 0,r)}),()=>{n(),t.textContent=""}}function x(e,t,r){const n=document.createElement("template");n.innerHTML=e;let i=n.content.firstChild;return r&&(i=i.firstChild),i}function Is(e,t=window.document){const r=t[Vn]||(t[Vn]=new Set);for(let n=0,i=e.length;n<i;n++){const o=e[n];r.has(o)||(r.add(o),t.addEventListener(o,Ps))}}function Qe(e,t,r){r==null?e.removeAttribute(t):e.setAttribute(t,r)}function Rs(e,t,r,n){n==null?e.removeAttributeNS(t,r):e.setAttributeNS(t,r,n)}function C(e,t){t==null?e.removeAttribute("class"):e.className=t}function Ns(e,t,r,n){n?Array.isArray(r)?(e[`$$${t}`]=r[0],e[`$$${t}Data`]=r[1]):e[`$$${t}`]=r:Array.isArray(r)?e.addEventListener(t,i=>r[0](r[1],i)):e.addEventListener(t,r)}function Ze(e,t,r={}){const n=Object.keys(t||{}),i=Object.keys(r);let o,s;for(o=0,s=i.length;o<s;o++){const u=i[o];!u||u==="undefined"||t[u]||(Xn(e,u,!1),delete r[u])}for(o=0,s=n.length;o<s;o++){const u=n[o],f=!!t[u];!u||u==="undefined"||r[u]===f||!f||(Xn(e,u,!0),r[u]=f)}return r}function $s(e,t,r={}){const n=e.style,i=typeof r=="string";if(t==null&&i||typeof t=="string")return n.cssText=t;i&&(n.cssText=void 0,r={}),t||(t={});let o,s;for(s in r)t[s]==null&&n.removeProperty(s),delete r[s];for(s in t)o=t[s],o!==r[s]&&(n.setProperty(s,o),r[s]=o);return r}function Cs(e,t,r,n){typeof t=="function"?L(i=>Zn(e,t(),i,r,n)):Zn(e,t,void 0,r,n)}function w(e,t,r,n){if(r!==void 0&&!n&&(n=[]),typeof t!="function")return Yt(e,t,n,r);L(i=>Yt(e,t(),i,r),n)}function zs(e,t,r,n,i={},o=!1){t||(t={});for(const s in i)if(!(s in t)){if(s==="children")continue;Qn(e,s,null,i[s],r,o)}for(const s in t){if(s==="children"){n||Yt(e,t.children);continue}const u=t[s];i[s]=Qn(e,s,u,i[s],r,o)}}function qs(e){return e.toLowerCase().replace(/-([a-z])/g,(t,r)=>r.toUpperCase())}function Xn(e,t,r){const n=t.trim().split(/\s+/);for(let i=0,o=n.length;i<o;i++)e.classList.toggle(n[i],r)}function Qn(e,t,r,n,i,o){let s,u,f;if(t==="style")return $s(e,r,n);if(t==="classList")return Ze(e,r,n);if(r===n)return n;if(t==="ref")o||r(e);else if(t.slice(0,3)==="on:")e.addEventListener(t.slice(3),r);else if(t.slice(0,10)==="oncapture:")e.addEventListener(t.slice(10),r,!0);else if(t.slice(0,2)==="on"){const a=t.slice(2).toLowerCase(),c=Os.has(a);Ns(e,a,r,c),c&&Is([a])}else if((f=bs.has(t))||!i&&(Gn[t]||(u=Ss.has(t)))||(s=e.nodeName.includes("-")))t==="class"||t==="className"?C(e,r):s&&!u&&!f?e[qs(t)]=r:e[Gn[t]||t]=r;else{const a=i&&t.indexOf(":")>-1&&Ms[t.split(":")[0]];a?Rs(e,a,t,r):Qe(e,Es[t]||t,r)}return r}function Ps(e){const t=`$$${e.type}`;let r=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==r&&Object.defineProperty(e,"target",{configurable:!0,value:r}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return r||document}}),mt.registry&&!mt.done&&(mt.done=!0,document.querySelectorAll("[id^=pl-]").forEach(n=>n.remove()));r!==null;){const n=r[t];if(n&&!r.disabled){const i=r[`${t}Data`];if(i!==void 0?n(i,e):n(e),e.cancelBubble)return}r=r.host&&r.host!==r&&r.host instanceof Node?r.host:r.parentNode}}function Zn(e,t,r={},n,i){return t||(t={}),!i&&"children"in t&&L(()=>r.children=Yt(e,t.children,r.children)),t.ref&&t.ref(e),L(()=>zs(e,t,n,!0,r,!0)),r}function Yt(e,t,r,n,i){for(mt.context&&!r&&(r=[...e.childNodes]);typeof r=="function";)r=r();if(t===r)return r;const o=typeof t,s=n!==void 0;if(e=s&&r[0]&&r[0].parentNode||e,o==="string"||o==="number"){if(mt.context)return r;if(o==="number"&&(t=t.toString()),s){let u=r[0];u&&u.nodeType===3?u.data=t:u=document.createTextNode(t),r=Gt(e,r,n,u)}else r!==""&&typeof r=="string"?r=e.firstChild.data=t:r=e.textContent=t}else if(t==null||o==="boolean"){if(mt.context)return r;r=Gt(e,r,n)}else{if(o==="function")return L(()=>{let u=t();for(;typeof u=="function";)u=u();r=Yt(e,u,r,n)}),()=>r;if(Array.isArray(t)){const u=[];if(qr(u,t,i))return L(()=>r=Yt(e,u,r,n,!0)),()=>r;if(mt.context){for(let f=0;f<u.length;f++)if(u[f].parentNode)return r=u}if(u.length===0){if(r=Gt(e,r,n),s)return r}else Array.isArray(r)?r.length===0?ti(e,u,n):As(e,r,u):(r&&Gt(e),ti(e,u));r=u}else if(t instanceof Node){if(mt.context&&t.parentNode)return r=s?[t]:t;if(Array.isArray(r)){if(s)return r=Gt(e,r,n,t);Gt(e,r,null,t)}else r==null||r===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);r=t}}return r}function qr(e,t,r){let n=!1;for(let i=0,o=t.length;i<o;i++){let s=t[i],u;if(s instanceof Node)e.push(s);else if(!(s==null||s===!0||s===!1))if(Array.isArray(s))n=qr(e,s)||n;else if((u=typeof s)=="string")e.push(document.createTextNode(s));else if(u==="function")if(r){for(;typeof s=="function";)s=s();n=qr(e,Array.isArray(s)?s:[s])||n}else e.push(s),n=!0;else e.push(document.createTextNode(s.toString()))}return n}function ti(e,t,r){for(let n=0,i=t.length;n<i;n++)e.insertBefore(t[n],r)}function Gt(e,t,r,n){if(r===void 0)return e.textContent="";const i=n||document.createTextNode("");if(t.length){let o=!1;for(let s=t.length-1;s>=0;s--){const u=t[s];if(i!==u){const f=u.parentNode===e;!o&&!s?f?e.replaceChild(i,u):e.insertBefore(i,r):f&&u.remove()}else o=!0}}else e.insertBefore(i,r);return[i]}var ei=`._mainBody_o6t0e_1{opacity:.5}._mainBody_o6t0e_1 *{font-size:.75rem;margin:0}._mainBody_o6t0e_1 button,._clickable_o6t0e_11{cursor:pointer}._stateWorkingOn_o6t0e_14{color:#00f}._stateSure_o6t0e_17{color:green}._stateNotSure_o6t0e_20{color:red}._answerMsg_o6t0e_23{border-style:groove;border-width:thin;opacity:.75;margin-bottom:.5rem}._answerMsg_o6t0e_23 ul{padding-left:1rem}._answerMsgName_o6t0e_32{font-weight:700}._answerMark_o6t0e_35{display:flex;justify-content:end;align-items:center;border-style:groove;border-width:thin;margin-bottom:.5rem;opacity:.75}._answerMark_o6t0e_35 button{padding:0;margin-left:.5rem;white-space:nowrap}._answerMark_o6t0e_35 input{height:max-content;width:100%}._answerDetail_o6t0e_53 ._stateWorkingOn_o6t0e_14,._answerDetail_o6t0e_53 ._stateSure_o6t0e_17,._answerDetail_o6t0e_53 ._stateNotSure_o6t0e_20{font-weight:700}._answerDetail_o6t0e_53 ul{padding-left:1.5rem}._answerDetail_o6t0e_53 img{height:auto;width:80%}._answerDetailShortAnswer_o6t0e_65{border-style:groove;border-width:thin;margin:.2rem;padding:.2rem}._answerDetailFill_o6t0e_71{white-space:pre}._settings_o6t0e_74{border-style:groove;border-width:thin;display:flex;flex-direction:column;padding:.5rem;margin-bottom:.5rem}._settingsEntry_o6t0e_82{display:flex;flex-direction:row;margin-bottom:.5rem;justify-content:space-between;align-items:center}._settingsEntry_o6t0e_82 label{font-weight:700}._settingsEntry_o6t0e_82 input{height:max-content;text-align:right}._settingsSubmit_o6t0e_96{display:flex;flex-direction:row;align-items:center;justify-content:end}._settingsSubmitTip_o6t0e_102{margin-right:.5rem}._about_o6t0e_105 p{margin-bottom:.25rem}._about_o6t0e_105 ul{padding-left:1.5rem;margin-bottom:.25rem}._about_o6t0e_105 ul li{margin-bottom:.25rem}._uploadImg_o6t0e_115{display:flex;flex-direction:column}._uploadImg_o6t0e_115 img{width:100%;height:auto}._uploadImgImage_o6t0e_123{border-style:groove;border-width:thin;padding:.5rem}._uploadImgConfirm_o6t0e_128{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-bottom:.5rem}
`;const Ts=x("<title> </title>"),ks=x("<style></style>");function ri(e,t){Pr(e!=null,t!=null?t:"null value")}function ni(e,t,r){Pr(t instanceof e,r!=null?r:"not HTMLElement")}function Pr(e,t){if(e!==!0)throw Error(t!=null?t:"assertion failed")}function ft(...e){return e}function Tr(e){const t=window.open("","",Object.entries(e).map(([n,i])=>`${n}=${i}`).join(","));ri(t);const r=()=>t.close();return window.addEventListener("unload",r),t.addEventListener("close",()=>window.removeEventListener("unload",r)),me(()=>[(()=>{const n=Ts.cloneNode(!0),i=n.firstChild;return L(()=>i.data=e.title),n})(),(()=>{const n=ks.cloneNode(!0);return n.textContent=ei,n})()],t.document.head),t}function kr(e,...t){}function ii(e,t){const r=new URL(e,self.location.origin);for(const[n,i]of Object.entries(t!=null?t:{}))r.searchParams.set(n,i);return r}function oi(e){const t=GM_getValue(e);if(t!==void 0)return t.contents}function we(e,t){GM_setValue(e,{contents:t})}function Ls(){var r;const e=[{name:"202205231915_gm_value",up(){we("no_leave_check",GM_getValue("nol_eavecheck")),GM_setValue("nol_eavecheck",void 0);for(const n of["username","server","sync_answers","sort_problems"])we(n,GM_getValue(n))}}],t=(r=oi("migrations"))!=null?r:[];for(const{name:n,idx:i}of t)if(n!==e[i].name)throw new Error("bad migrations");for(const{name:n,up:i}of e.slice(t.length))i();we("migrations",e.map((n,i)=>({name:n.name,idx:i})))}class Se{constructor(t,r){et(this,"_name");et(this,"_init");et(this,"inited",!1);et(this,"_cached");this._name=t,this._init=r}get(){if(!this.inited){const t=oi(this._name);t===void 0&&this._init!==void 0&&we(this._name,this._init),this._cached=t!=null?t:this._init,this.inited=!0}return this._cached}set(t){t!==void 0&&(we(this._name,t),this._cached=t)}}const Lr=new Se("username"),jr=new Se("server"),Dr=new Se("sync_answers",!0),xr=new Se("sort_problems",!1),Jr=new Se("no_leave_check",!0);class js{constructor(){et(this,"token");et(this,"client");et(this,"examId");et(this,"paper");et(this,"queue",new Map);et(this,"onmsg",[])}onmessage(t){this.onmsg.push(t)}updateQueue(t,r){let n=this.queue.get(t);n!==void 0?r(n):(n={},r(n),this.queue.set(t,n))}updateAnswer(t,r){this.updateQueue(t,n=>n.result=r)}updateState(t,r){this.updateQueue(t,n=>{var i;n.context=(i=n.context)!=null?i:{},n.context.state=r})}updateMsg(t,r){this.updateQueue(t,n=>{var i;n.context=(i=n.context)!=null?i:{},n.context.msg=r})}async watch(t){return new Promise((r,n)=>{const i=setInterval(()=>{this.sendQueue().catch(o=>{clearInterval(i),alert("\u4E0E\u670D\u52A1\u5668\u901A\u4FE1\u5F02\u5E38"),n(o)})},t)})}async login(t,r){this.examId=t,this.paper=r}async sendQueue(){const t=Dr.get(),r=jr.get(),n=Lr.get();if(t!==!0||this.queue.size<1||r===void 0||n===void 0||this.examId===void 0||this.paper===void 0)return;let i=[...this.queue.entries()];if(this.queue.clear(),this.client===void 0){const s=new q.JSONRPCClient(u=>new Promise((f,a)=>{GM.xmlHttpRequest({url:r,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(u),onload:c=>{c.status===200?(s.receive(JSON.parse(c.responseText)),f()):a(new Error(c.statusText))},onerror:c=>a(c.statusText)})}));this.client=s}if(this.token===void 0){kr(`login to server: ${n}, ${this.examId}`);const s=await this.client.request("login",[n,this.examId,this.paper]);this.token=s}const o=await this.client.request("answer_problem",[this.token,i.map(([s,{result:u,context:f}])=>({problem_id:s,result:u,context:f}))]);this.onmsg.forEach(s=>s(o))}}const Ot=new js;function Ds(e){const t=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(r,n){const i=e.call(this,ii(n)),o=this.send;this.send=function(s){i!==void 0?i(s).then(u=>{o.call(this,u),this.send=o}).catch(kr):(o.call(this,s),this.send=o)},t.apply(this,arguments)}}var ct=(e=>(e[e.SingleChoice=1]="SingleChoice",e[e.MultipleChoice=2]="MultipleChoice",e[e.Polling=3]="Polling",e[e.FillBlank=4]="FillBlank",e[e.ShortAnswer=5]="ShortAnswer",e[e.Judgement=6]="Judgement",e))(ct||{}),ht=(e=>(e[e.WorkingOn=0]="WorkingOn",e[e.Sure=1]="Sure",e[e.NotSure=2]="NotSure",e))(ht||{}),M={mainBody:"_mainBody_o6t0e_1",clickable:"_clickable_o6t0e_11",stateWorkingOn:"_stateWorkingOn_o6t0e_14",stateSure:"_stateSure_o6t0e_17",stateNotSure:"_stateNotSure_o6t0e_20",answerMsg:"_answerMsg_o6t0e_23",answerMsgName:"_answerMsgName_o6t0e_32",answerMark:"_answerMark_o6t0e_35",answerDetail:"_answerDetail_o6t0e_53",answerDetailShortAnswer:"_answerDetailShortAnswer_o6t0e_65",answerDetailFill:"_answerDetailFill_o6t0e_71",settings:"_settings_o6t0e_74",settingsEntry:"_settingsEntry_o6t0e_82",settingsSubmit:"_settingsSubmit_o6t0e_96",settingsSubmitTip:"_settingsSubmitTip_o6t0e_102",about:"_about_o6t0e_105",uploadImg:"_uploadImg_o6t0e_115",uploadImgImage:"_uploadImgImage_o6t0e_123",uploadImgConfirm:"_uploadImgConfirm_o6t0e_128"};const lt=Symbol("@ts-pattern/matcher"),tr="@ts-pattern/anonymous-select-key",Br=e=>Boolean(e&&typeof e=="object"),er=e=>e&&!!e[lt],_t=(e,t,r)=>{if(Br(e)){if(er(e)){const n=e[lt](),{matched:i,selections:o}=n.match(t);return i&&o&&Object.keys(o).forEach(s=>r(s,o[s])),i}if(!Br(t))return!1;if(Array.isArray(e))return!!Array.isArray(t)&&e.length===t.length&&e.every((n,i)=>_t(n,t[i],r));if(e instanceof Map)return t instanceof Map&&Array.from(e.keys()).every(n=>_t(e.get(n),t.get(n),r));if(e instanceof Set){if(!(t instanceof Set))return!1;if(e.size===0)return t.size===0;if(e.size===1){const[n]=Array.from(e.values());return er(n)?Array.from(t.values()).every(i=>_t(n,i,r)):t.has(n)}return Array.from(e.values()).every(n=>t.has(n))}return Object.keys(e).every(n=>{const i=e[n];return(n in t||er(o=i)&&o[lt]().matcherType==="optional")&&_t(i,t[n],r);var o})}return Object.is(t,e)},Mt=e=>{var t,r,n;return Br(e)?er(e)?(t=(r=(n=e[lt]()).getSelectionKeys)==null?void 0:r.call(n))!=null?t:[]:Array.isArray(e)?be(e,Mt):be(Object.values(e),Mt):[]},be=(e,t)=>e.reduce((r,n)=>r.concat(t(n)),[]);function si(e){return{[lt]:()=>({match:t=>{let r={};const n=(i,o)=>{r[i]=o};return t===void 0?(Mt(e).forEach(i=>n(i,void 0)),{matched:!0,selections:r}):{matched:_t(e,t,n),selections:r}},getSelectionKeys:()=>Mt(e),matcherType:"optional"})}}function ui(e){return{[lt]:()=>({match:t=>{if(!Array.isArray(t))return{matched:!1};let r={};const n=(i,o)=>{r[i]=(r[i]||[]).concat([o])};return{matched:t.every(i=>_t(e,i,n)),selections:r}},getSelectionKeys:()=>Mt(e)})}}function ai(...e){return{[lt]:()=>({match:t=>{let r={};const n=(i,o)=>{r[i]=o};return{matched:e.every(i=>_t(i,t,n)),selections:r}},getSelectionKeys:()=>be(e,Mt),matcherType:"and"})}}function fi(...e){return{[lt]:()=>({match:t=>{let r={};const n=(i,o)=>{r[i]=o};return be(e,Mt).forEach(i=>n(i,void 0)),{matched:e.some(i=>_t(i,t,n)),selections:r}},getSelectionKeys:()=>be(e,Mt),matcherType:"or"})}}function ci(e){return{[lt]:()=>({match:t=>({matched:!_t(e,t,()=>{})}),getSelectionKeys:()=>[],matcherType:"not"})}}function wt(e){return{[lt]:()=>({match:t=>({matched:Boolean(e(t))})})}}function hi(...e){const t=typeof e[0]=="string"?e[0]:void 0,r=e.length===2?e[1]:typeof e[0]=="string"?void 0:e[0];return{[lt]:()=>({match:n=>{let i={[t!=null?t:tr]:n};return{matched:r===void 0||_t(r,n,(o,s)=>{i[o]=s}),selections:i}},getSelectionKeys:()=>[t!=null?t:tr].concat(r===void 0?[]:Mt(r))})}}const li=wt(function(e){return!0}),xs=li,Js=wt(function(e){return typeof e=="string"}),Bs=wt(function(e){return typeof e=="number"}),Us=wt(function(e){return typeof e=="boolean"}),Fs=wt(function(e){return typeof e=="bigint"}),Ws=wt(function(e){return typeof e=="symbol"}),Ks=wt(function(e){return e==null});var rr={__proto__:null,optional:si,array:ui,intersection:ai,union:fi,not:ci,when:wt,select:hi,any:li,_:xs,string:Js,number:Bs,boolean:Us,bigint:Fs,symbol:Ws,nullish:Ks,instanceOf:function(e){return wt(function(t){return r=>r instanceof t}(e))},typed:function(){return{array:ui,optional:si,intersection:ai,union:fi,not:ci,select:hi,when:wt}}};const Hs=e=>new Ee(e,[]);class Ee{constructor(t,r){this.value=void 0,this.cases=void 0,this.value=t,this.cases=r}with(...t){const r=t[t.length-1],n=[t[0]],i=[];return t.length===3&&typeof t[1]=="function"?(n.push(t[0]),i.push(t[1])):t.length>2&&n.push(...t.slice(1,t.length-1)),new Ee(this.value,this.cases.concat([{match:o=>{let s={};const u=Boolean(n.some(f=>_t(f,o,(a,c)=>{s[a]=c}))&&i.every(f=>f(o)));return{matched:u,value:u&&Object.keys(s).length?tr in s?s[tr]:s:o}},handler:r}]))}when(t,r){return new Ee(this.value,this.cases.concat([{match:n=>({matched:Boolean(t(n)),value:n}),handler:r}]))}otherwise(t){return new Ee(this.value,this.cases.concat([{match:r=>({matched:!0,value:r}),handler:t}])).run()}exhaustive(){return this.run()}run(){let t,r=this.value;for(const n of this.cases){const i=n.match(this.value);if(i.matched){r=i.value,t=n.handler;break}}if(!t){let n;try{n=JSON.stringify(this.value)}catch{n=this.value}throw new Error(`Pattern matching error: no pattern matches value ${n}`)}return t(r,this.value)}}class nr{constructor(t){et(this,"_lazy");this._lazy=t}static from(t){return new nr(()=>t)}then(t){return new nr(()=>t(this.exec()))}exec(){return this._lazy()}}function X(e){return nr.from(e)}function _i(e){return function*(t){for(const r of t)yield e(r)}}function*Ur(e){let t=0;for(const r of e)yield[t++,r]}function Ys(e){return function*(t){const r=t[Symbol.iterator](),n=e[Symbol.iterator]();for(;;){const i=r.next(),o=n.next();if(i.done!==!0&&o.done!==!0)yield[i.value,o.value];else return}}}function Vt(e){return function(t){return Array.from(t).sort(e)}}function Gs(e){for(const t of e)return t}function Dt(e,t){return function(r){let n=e;for(const i of r)n=t(n,i);return n}}function Oe(e){return Array.from(e)}function di(e){return function(t){for(const r of t)e(r)}}var Me="delete",E=5,nt=1<<E,K=nt-1,y={};function Fr(){return{value:!1}}function it(e){e&&(e.value=!0)}function Wr(){}function Xt(e){return e.size===void 0&&(e.size=e.__iterate(pi)),e.size}function $t(e,t){if(typeof t!="number"){var r=t>>>0;if(""+r!==t||r===4294967295)return NaN;t=r}return t<0?Xt(e)+t:t}function pi(){return!0}function ir(e,t,r){return(e===0&&!yi(e)||r!==void 0&&e<=-r)&&(t===void 0||r!==void 0&&t>=r)}function Ae(e,t){return vi(e,t,0)}function or(e,t){return vi(e,t,t)}function vi(e,t,r){return e===void 0?r:yi(e)?t===1/0?t:Math.max(0,t+e)|0:t===void 0||t===e?e:Math.min(t,e)|0}function yi(e){return e<0||e===0&&1/e===-1/0}var gi="@@__IMMUTABLE_ITERABLE__@@";function Y(e){return Boolean(e&&e[gi])}var mi="@@__IMMUTABLE_KEYED__@@";function R(e){return Boolean(e&&e[mi])}var wi="@@__IMMUTABLE_INDEXED__@@";function G(e){return Boolean(e&&e[wi])}function sr(e){return R(e)||G(e)}var $=function(t){return Y(t)?t:Q(t)},ot=function(e){function t(r){return R(r)?r:Ct(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}($),xt=function(e){function t(r){return G(r)?r:vt(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}($),Qt=function(e){function t(r){return Y(r)&&!sr(r)?r:re(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}($);$.Keyed=ot,$.Indexed=xt,$.Set=Qt;var Si="@@__IMMUTABLE_SEQ__@@";function Kr(e){return Boolean(e&&e[Si])}var bi="@@__IMMUTABLE_RECORD__@@";function Zt(e){return Boolean(e&&e[bi])}function St(e){return Y(e)||Zt(e)}var te="@@__IMMUTABLE_ORDERED__@@";function dt(e){return Boolean(e&&e[te])}var Ie=0,pt=1,st=2,Hr=typeof Symbol=="function"&&Symbol.iterator,Ei="@@iterator",ur=Hr||Ei,g=function(t){this.next=t};g.prototype.toString=function(){return"[Iterator]"},g.KEYS=Ie,g.VALUES=pt,g.ENTRIES=st,g.prototype.inspect=g.prototype.toSource=function(){return this.toString()},g.prototype[ur]=function(){return this};function A(e,t,r,n){var i=e===0?t:e===1?r:[t,r];return n?n.value=i:n={value:i,done:!1},n}function V(){return{value:void 0,done:!0}}function Oi(e){return Array.isArray(e)?!0:!!ar(e)}function Mi(e){return e&&typeof e.next=="function"}function Yr(e){var t=ar(e);return t&&t.call(e)}function ar(e){var t=e&&(Hr&&e[Hr]||e[Ei]);if(typeof t=="function")return t}function Vs(e){var t=ar(e);return t&&t===e.entries}function Xs(e){var t=ar(e);return t&&t===e.keys}var ee=Object.prototype.hasOwnProperty;function Ai(e){return Array.isArray(e)||typeof e=="string"?!0:e&&typeof e=="object"&&Number.isInteger(e.length)&&e.length>=0&&(e.length===0?Object.keys(e).length===1:e.hasOwnProperty(e.length-1))}var Q=function(e){function t(r){return r==null?Vr():St(r)?r.toSeq():Zs(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq {","}")},t.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},t.prototype.__iterate=function(n,i){var o=this._cache;if(o){for(var s=o.length,u=0;u!==s;){var f=o[i?s-++u:u++];if(n(f[1],f[0],this)===!1)break}return u}return this.__iterateUncached(n,i)},t.prototype.__iterator=function(n,i){var o=this._cache;if(o){var s=o.length,u=0;return new g(function(){if(u===s)return V();var f=o[i?s-++u:u++];return A(n,f[0],f[1])})}return this.__iteratorUncached(n,i)},t}($),Ct=function(e){function t(r){return r==null?Vr().toKeyedSeq():Y(r)?R(r)?r.toSeq():r.fromEntrySeq():Zt(r)?r.toSeq():Xr(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toKeyedSeq=function(){return this},t}(Q),vt=function(e){function t(r){return r==null?Vr():Y(r)?R(r)?r.entrySeq():r.toIndexedSeq():Zt(r)?r.toSeq().entrySeq():Ri(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toIndexedSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq [","]")},t}(Q),re=function(e){function t(r){return(Y(r)&&!sr(r)?r:vt(r)).toSetSeq()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toSetSeq=function(){return this},t}(Q);Q.isSeq=Kr,Q.Keyed=Ct,Q.Set=re,Q.Indexed=vt,Q.prototype[Si]=!0;var Jt=function(e){function t(r){this._array=r,this.size=r.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(n,i){return this.has(n)?this._array[$t(this,n)]:i},t.prototype.__iterate=function(n,i){for(var o=this._array,s=o.length,u=0;u!==s;){var f=i?s-++u:u++;if(n(o[f],f,this)===!1)break}return u},t.prototype.__iterator=function(n,i){var o=this._array,s=o.length,u=0;return new g(function(){if(u===s)return V();var f=i?s-++u:u++;return A(n,f,o[f])})},t}(vt),Gr=function(e){function t(r){var n=Object.keys(r).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(r):[]);this._object=r,this._keys=n,this.size=n.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(n,i){return i!==void 0&&!this.has(n)?i:this._object[n]},t.prototype.has=function(n){return ee.call(this._object,n)},t.prototype.__iterate=function(n,i){for(var o=this._object,s=this._keys,u=s.length,f=0;f!==u;){var a=s[i?u-++f:f++];if(n(o[a],a,this)===!1)break}return f},t.prototype.__iterator=function(n,i){var o=this._object,s=this._keys,u=s.length,f=0;return new g(function(){if(f===u)return V();var a=s[i?u-++f:f++];return A(n,a,o[a])})},t}(Ct);Gr.prototype[te]=!0;var Qs=function(e){function t(r){this._collection=r,this.size=r.length||r.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.__iterateUncached=function(n,i){if(i)return this.cacheResult().__iterate(n,i);var o=this._collection,s=Yr(o),u=0;if(Mi(s))for(var f;!(f=s.next()).done&&n(f.value,u++,this)!==!1;);return u},t.prototype.__iteratorUncached=function(n,i){if(i)return this.cacheResult().__iterator(n,i);var o=this._collection,s=Yr(o);if(!Mi(s))return new g(V);var u=0;return new g(function(){var f=s.next();return f.done?f:A(n,u++,f.value)})},t}(vt),Ii;function Vr(){return Ii||(Ii=new Jt([]))}function Xr(e){var t=Qr(e);if(t)return t.fromEntrySeq();if(typeof e=="object")return new Gr(e);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+e)}function Ri(e){var t=Qr(e);if(t)return t;throw new TypeError("Expected Array or collection object of values: "+e)}function Zs(e){var t=Qr(e);if(t)return Vs(e)?t.fromEntrySeq():Xs(e)?t.toSetSeq():t;if(typeof e=="object")return new Gr(e);throw new TypeError("Expected Array or collection object of values, or keyed object: "+e)}function Qr(e){return Ai(e)?new Jt(e):Oi(e)?new Qs(e):void 0}var Ni="@@__IMMUTABLE_MAP__@@";function Zr(e){return Boolean(e&&e[Ni])}function $i(e){return Zr(e)&&dt(e)}function Ci(e){return Boolean(e&&typeof e.equals=="function"&&typeof e.hashCode=="function")}function Z(e,t){if(e===t||e!==e&&t!==t)return!0;if(!e||!t)return!1;if(typeof e.valueOf=="function"&&typeof t.valueOf=="function"){if(e=e.valueOf(),t=t.valueOf(),e===t||e!==e&&t!==t)return!0;if(!e||!t)return!1}return!!(Ci(e)&&Ci(t)&&e.equals(t))}var Re=typeof Math.imul=="function"&&Math.imul(4294967295,2)===-2?Math.imul:function(t,r){t|=0,r|=0;var n=t&65535,i=r&65535;return n*i+((t>>>16)*i+n*(r>>>16)<<16>>>0)|0};function fr(e){return e>>>1&1073741824|e&3221225471}var tu=Object.prototype.valueOf;function tt(e){if(e==null)return zi(e);if(typeof e.hashCode=="function")return fr(e.hashCode(e));var t=su(e);if(t==null)return zi(t);switch(typeof t){case"boolean":return t?1108378657:1108378656;case"number":return eu(t);case"string":return t.length>uu?ru(t):tn(t);case"object":case"function":return iu(t);case"symbol":return nu(t);default:if(typeof t.toString=="function")return tn(t.toString());throw new Error("Value type "+typeof t+" cannot be hashed.")}}function zi(e){return e===null?1108378658:1108378659}function eu(e){if(e!==e||e===1/0)return 0;var t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)e/=4294967295,t^=e;return fr(t)}function ru(e){var t=sn[e];return t===void 0&&(t=tn(e),on===au&&(on=0,sn={}),on++,sn[e]=t),t}function tn(e){for(var t=0,r=0;r<e.length;r++)t=31*t+e.charCodeAt(r)|0;return fr(t)}function nu(e){var t=ki[e];return t!==void 0||(t=Ti(),ki[e]=t),t}function iu(e){var t;if(en&&(t=rn.get(e),t!==void 0)||(t=e[Bt],t!==void 0)||!Pi&&(t=e.propertyIsEnumerable&&e.propertyIsEnumerable[Bt],t!==void 0||(t=ou(e),t!==void 0)))return t;if(t=Ti(),en)rn.set(e,t);else{if(qi!==void 0&&qi(e)===!1)throw new Error("Non-extensible objects are not allowed as keys.");if(Pi)Object.defineProperty(e,Bt,{enumerable:!1,configurable:!1,writable:!1,value:t});else if(e.propertyIsEnumerable!==void 0&&e.propertyIsEnumerable===e.constructor.prototype.propertyIsEnumerable)e.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},e.propertyIsEnumerable[Bt]=t;else if(e.nodeType!==void 0)e[Bt]=t;else throw new Error("Unable to set a non-enumerable property on object.")}return t}var qi=Object.isExtensible,Pi=function(){try{return Object.defineProperty({},"@",{}),!0}catch{return!1}}();function ou(e){if(e&&e.nodeType>0)switch(e.nodeType){case 1:return e.uniqueID;case 9:return e.documentElement&&e.documentElement.uniqueID}}function su(e){return e.valueOf!==tu&&typeof e.valueOf=="function"?e.valueOf(e):e}function Ti(){var e=++nn;return nn&1073741824&&(nn=0),e}var en=typeof WeakMap=="function",rn;en&&(rn=new WeakMap);var ki=Object.create(null),nn=0,Bt="__immutablehash__";typeof Symbol=="function"&&(Bt=Symbol(Bt));var uu=16,au=255,on=0,sn={},cr=function(e){function t(r,n){this._iter=r,this._useKeys=n,this.size=r.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(n,i){return this._iter.get(n,i)},t.prototype.has=function(n){return this._iter.has(n)},t.prototype.valueSeq=function(){return this._iter.valueSeq()},t.prototype.reverse=function(){var n=this,i=un(this,!0);return this._useKeys||(i.valueSeq=function(){return n._iter.toSeq().reverse()}),i},t.prototype.map=function(n,i){var o=this,s=Ji(this,n,i);return this._useKeys||(s.valueSeq=function(){return o._iter.toSeq().map(n,i)}),s},t.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s,u){return n(s,u,o)},i)},t.prototype.__iterator=function(n,i){return this._iter.__iterator(n,i)},t}(Ct);cr.prototype[te]=!0;var Li=function(e){function t(r){this._iter=r,this.size=r.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.includes=function(n){return this._iter.includes(n)},t.prototype.__iterate=function(n,i){var o=this,s=0;return i&&Xt(this),this._iter.__iterate(function(u){return n(u,i?o.size-++s:s++,o)},i)},t.prototype.__iterator=function(n,i){var o=this,s=this._iter.__iterator(pt,i),u=0;return i&&Xt(this),new g(function(){var f=s.next();return f.done?f:A(n,i?o.size-++u:u++,f.value,f)})},t}(vt),ji=function(e){function t(r){this._iter=r,this.size=r.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.has=function(n){return this._iter.includes(n)},t.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s){return n(s,s,o)},i)},t.prototype.__iterator=function(n,i){var o=this._iter.__iterator(pt,i);return new g(function(){var s=o.next();return s.done?s:A(n,s.value,s.value,s)})},t}(re),Di=function(e){function t(r){this._iter=r,this.size=r.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.entrySeq=function(){return this._iter.toSeq()},t.prototype.__iterate=function(n,i){var o=this;return this._iter.__iterate(function(s){if(s){Ki(s);var u=Y(s);return n(u?s.get(1):s[1],u?s.get(0):s[0],o)}},i)},t.prototype.__iterator=function(n,i){var o=this._iter.__iterator(pt,i);return new g(function(){for(;;){var s=o.next();if(s.done)return s;var u=s.value;if(u){Ki(u);var f=Y(u);return A(n,f?u.get(0):u[0],f?u.get(1):u[1],s)}}})},t}(Ct);Li.prototype.cacheResult=cr.prototype.cacheResult=ji.prototype.cacheResult=Di.prototype.cacheResult=fn;function xi(e){var t=bt(e);return t._iter=e,t.size=e.size,t.flip=function(){return e},t.reverse=function(){var r=e.reverse.apply(this);return r.flip=function(){return e.reverse()},r},t.has=function(r){return e.includes(r)},t.includes=function(r){return e.has(r)},t.cacheResult=fn,t.__iterateUncached=function(r,n){var i=this;return e.__iterate(function(o,s){return r(s,o,i)!==!1},n)},t.__iteratorUncached=function(r,n){if(r===st){var i=e.__iterator(r,n);return new g(function(){var o=i.next();if(!o.done){var s=o.value[0];o.value[0]=o.value[1],o.value[1]=s}return o})}return e.__iterator(r===pt?Ie:pt,n)},t}function Ji(e,t,r){var n=bt(e);return n.size=e.size,n.has=function(i){return e.has(i)},n.get=function(i,o){var s=e.get(i,y);return s===y?o:t.call(r,s,i,e)},n.__iterateUncached=function(i,o){var s=this;return e.__iterate(function(u,f,a){return i(t.call(r,u,f,a),f,s)!==!1},o)},n.__iteratorUncached=function(i,o){var s=e.__iterator(st,o);return new g(function(){var u=s.next();if(u.done)return u;var f=u.value,a=f[0];return A(i,a,t.call(r,f[1],a,e),u)})},n}function un(e,t){var r=this,n=bt(e);return n._iter=e,n.size=e.size,n.reverse=function(){return e},e.flip&&(n.flip=function(){var i=xi(e);return i.reverse=function(){return e.flip()},i}),n.get=function(i,o){return e.get(t?i:-1-i,o)},n.has=function(i){return e.has(t?i:-1-i)},n.includes=function(i){return e.includes(i)},n.cacheResult=fn,n.__iterate=function(i,o){var s=this,u=0;return o&&Xt(e),e.__iterate(function(f,a){return i(f,t?a:o?s.size-++u:u++,s)},!o)},n.__iterator=function(i,o){var s=0;o&&Xt(e);var u=e.__iterator(st,!o);return new g(function(){var f=u.next();if(f.done)return f;var a=f.value;return A(i,t?a[0]:o?r.size-++s:s++,a[1],f)})},n}function Bi(e,t,r,n){var i=bt(e);return n&&(i.has=function(o){var s=e.get(o,y);return s!==y&&!!t.call(r,s,o,e)},i.get=function(o,s){var u=e.get(o,y);return u!==y&&t.call(r,u,o,e)?u:s}),i.__iterateUncached=function(o,s){var u=this,f=0;return e.__iterate(function(a,c,h){if(t.call(r,a,c,h))return f++,o(a,n?c:f-1,u)},s),f},i.__iteratorUncached=function(o,s){var u=e.__iterator(st,s),f=0;return new g(function(){for(;;){var a=u.next();if(a.done)return a;var c=a.value,h=c[0],l=c[1];if(t.call(r,l,h,e))return A(o,n?h:f++,l,a)}})},i}function fu(e,t,r){var n=qt().asMutable();return e.__iterate(function(i,o){n.update(t.call(r,i,o,e),0,function(s){return s+1})}),n.asImmutable()}function cu(e,t,r){var n=R(e),i=(dt(e)?It():qt()).asMutable();e.__iterate(function(s,u){i.update(t.call(r,s,u,e),function(f){return f=f||[],f.push(n?[u,s]:s),f})});var o=Hi(e);return i.map(function(s){return S(e,o(s))}).asImmutable()}function an(e,t,r,n){var i=e.size;if(ir(t,r,i))return e;var o=Ae(t,i),s=or(r,i);if(o!==o||s!==s)return an(e.toSeq().cacheResult(),t,r,n);var u=s-o,f;u===u&&(f=u<0?0:u);var a=bt(e);return a.size=f===0?f:e.size&&f||void 0,!n&&Kr(e)&&f>=0&&(a.get=function(c,h){return c=$t(this,c),c>=0&&c<f?e.get(c+o,h):h}),a.__iterateUncached=function(c,h){var l=this;if(f===0)return 0;if(h)return this.cacheResult().__iterate(c,h);var _=0,d=!0,p=0;return e.__iterate(function(m,N){if(!(d&&(d=_++<o)))return p++,c(m,n?N:p-1,l)!==!1&&p!==f}),p},a.__iteratorUncached=function(c,h){if(f!==0&&h)return this.cacheResult().__iterator(c,h);if(f===0)return new g(V);var l=e.__iterator(c,h),_=0,d=0;return new g(function(){for(;_++<o;)l.next();if(++d>f)return V();var p=l.next();return n||c===pt||p.done?p:c===Ie?A(c,d-1,void 0,p):A(c,d-1,p.value[1],p)})},a}function hu(e,t,r){var n=bt(e);return n.__iterateUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterate(i,o);var u=0;return e.__iterate(function(f,a,c){return t.call(r,f,a,c)&&++u&&i(f,a,s)}),u},n.__iteratorUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterator(i,o);var u=e.__iterator(st,o),f=!0;return new g(function(){if(!f)return V();var a=u.next();if(a.done)return a;var c=a.value,h=c[0],l=c[1];return t.call(r,l,h,s)?i===st?a:A(i,h,l,a):(f=!1,V())})},n}function Ui(e,t,r,n){var i=bt(e);return i.__iterateUncached=function(o,s){var u=this;if(s)return this.cacheResult().__iterate(o,s);var f=!0,a=0;return e.__iterate(function(c,h,l){if(!(f&&(f=t.call(r,c,h,l))))return a++,o(c,n?h:a-1,u)}),a},i.__iteratorUncached=function(o,s){var u=this;if(s)return this.cacheResult().__iterator(o,s);var f=e.__iterator(st,s),a=!0,c=0;return new g(function(){var h,l,_;do{if(h=f.next(),h.done)return n||o===pt?h:o===Ie?A(o,c++,void 0,h):A(o,c++,h.value[1],h);var d=h.value;l=d[0],_=d[1],a&&(a=t.call(r,_,l,u))}while(a);return o===st?h:A(o,l,_,h)})},i}function lu(e,t){var r=R(e),n=[e].concat(t).map(function(s){return Y(s)?r&&(s=ot(s)):s=r?Xr(s):Ri(Array.isArray(s)?s:[s]),s}).filter(function(s){return s.size!==0});if(n.length===0)return e;if(n.length===1){var i=n[0];if(i===e||r&&R(i)||G(e)&&G(i))return i}var o=new Jt(n);return r?o=o.toKeyedSeq():G(e)||(o=o.toSetSeq()),o=o.flatten(!0),o.size=n.reduce(function(s,u){if(s!==void 0){var f=u.size;if(f!==void 0)return s+f}},0),o}function Fi(e,t,r){var n=bt(e);return n.__iterateUncached=function(i,o){if(o)return this.cacheResult().__iterate(i,o);var s=0,u=!1;function f(a,c){a.__iterate(function(h,l){return(!t||c<t)&&Y(h)?f(h,c+1):(s++,i(h,r?l:s-1,n)===!1&&(u=!0)),!u},o)}return f(e,0),s},n.__iteratorUncached=function(i,o){if(o)return this.cacheResult().__iterator(i,o);var s=e.__iterator(i,o),u=[],f=0;return new g(function(){for(;s;){var a=s.next();if(a.done!==!1){s=u.pop();continue}var c=a.value;if(i===st&&(c=c[1]),(!t||u.length<t)&&Y(c))u.push(s),s=c.__iterator(i,o);else return r?a:A(i,f++,c,a)}return V()})},n}function _u(e,t,r){var n=Hi(e);return e.toSeq().map(function(i,o){return n(t.call(r,i,o,e))}).flatten(!0)}function du(e,t){var r=bt(e);return r.size=e.size&&e.size*2-1,r.__iterateUncached=function(n,i){var o=this,s=0;return e.__iterate(function(u){return(!s||n(t,s++,o)!==!1)&&n(u,s++,o)!==!1},i),s},r.__iteratorUncached=function(n,i){var o=e.__iterator(pt,i),s=0,u;return new g(function(){return(!u||s%2)&&(u=o.next(),u.done)?u:s%2?A(n,s++,t):A(n,s++,u.value,u)})},r}function ne(e,t,r){t||(t=Yi);var n=R(e),i=0,o=e.toSeq().map(function(s,u){return[u,s,i++,r?r(s,u,e):s]}).valueSeq().toArray();return o.sort(function(s,u){return t(s[3],u[3])||s[2]-u[2]}).forEach(n?function(s,u){o[u].length=2}:function(s,u){o[u]=s[1]}),n?Ct(o):G(e)?vt(o):re(o)}function hr(e,t,r){if(t||(t=Yi),r){var n=e.toSeq().map(function(i,o){return[i,r(i,o,e)]}).reduce(function(i,o){return Wi(t,i[1],o[1])?o:i});return n&&n[0]}return e.reduce(function(i,o){return Wi(t,i,o)?o:i})}function Wi(e,t,r){var n=e(r,t);return n===0&&r!==t&&(r==null||r!==r)||n>0}function lr(e,t,r,n){var i=bt(e),o=new Jt(r).map(function(s){return s.size});return i.size=n?o.max():o.min(),i.__iterate=function(s,u){for(var f=this.__iterator(pt,u),a,c=0;!(a=f.next()).done&&s(a.value,c++,this)!==!1;);return c},i.__iteratorUncached=function(s,u){var f=r.map(function(h){return h=$(h),Yr(u?h.reverse():h)}),a=0,c=!1;return new g(function(){var h;return c||(h=f.map(function(l){return l.next()}),c=n?h.every(function(l){return l.done}):h.some(function(l){return l.done})),c?V():A(s,a++,t.apply(null,h.map(function(l){return l.value})))})},i}function S(e,t){return e===t?e:Kr(e)?t:e.constructor(t)}function Ki(e){if(e!==Object(e))throw new TypeError("Expected [K, V] tuple: "+e)}function Hi(e){return R(e)?ot:G(e)?xt:Qt}function bt(e){return Object.create((R(e)?Ct:G(e)?vt:re).prototype)}function fn(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):Q.prototype.cacheResult.call(this)}function Yi(e,t){return e===void 0&&t===void 0?0:e===void 0?1:t===void 0?-1:e>t?1:e<t?-1:0}function Et(e,t){t=t||0;for(var r=Math.max(0,e.length-t),n=new Array(r),i=0;i<r;i++)n[i]=e[i+t];return n}function cn(e,t){if(!e)throw new Error(t)}function ut(e){cn(e!==1/0,"Cannot perform this action with an infinite size.")}function Gi(e){if(Ai(e)&&typeof e!="string")return e;if(dt(e))return e.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+e)}var pu=Object.prototype.toString;function vu(e){if(!e||typeof e!="object"||pu.call(e)!=="[object Object]")return!1;var t=Object.getPrototypeOf(e);if(t===null)return!0;for(var r=t,n=Object.getPrototypeOf(t);n!==null;)r=n,n=Object.getPrototypeOf(r);return r===t}function zt(e){return typeof e=="object"&&(St(e)||Array.isArray(e)||vu(e))}function Ne(e){try{return typeof e=="string"?JSON.stringify(e):String(e)}catch{return JSON.stringify(e)}}function yu(e,t){return St(e)?e.has(t):zt(e)&&ee.call(e,t)}function Vi(e,t,r){return St(e)?e.get(t,r):yu(e,t)?typeof e.get=="function"?e.get(t):e[t]:r}function _r(e){if(Array.isArray(e))return Et(e);var t={};for(var r in e)ee.call(e,r)&&(t[r]=e[r]);return t}function gu(e,t){if(!zt(e))throw new TypeError("Cannot update non-data-structure value: "+e);if(St(e)){if(!e.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+e);return e.remove(t)}if(!ee.call(e,t))return e;var r=_r(e);return Array.isArray(r)?r.splice(t,1):delete r[t],r}function mu(e,t,r){if(!zt(e))throw new TypeError("Cannot update non-data-structure value: "+e);if(St(e)){if(!e.set)throw new TypeError("Cannot update immutable value without .set() method: "+e);return e.set(t,r)}if(ee.call(e,t)&&r===e[t])return e;var n=_r(e);return n[t]=r,n}function ie(e,t,r,n){n||(n=r,r=void 0);var i=Xi(St(e),e,Gi(t),0,r,n);return i===y?r:i}function Xi(e,t,r,n,i,o){var s=t===y;if(n===r.length){var u=s?i:t,f=o(u);return f===u?t:f}if(!s&&!zt(t))throw new TypeError("Cannot update within non-data-structure value in path ["+r.slice(0,n).map(Ne)+"]: "+t);var a=r[n],c=s?y:Vi(t,a,y),h=Xi(c===y?e:St(c),c,r,n+1,i,o);return h===c?t:h===y?gu(t,a):mu(s?e?yt():{}:t,a,h)}function wu(e,t,r){return ie(e,t,y,function(){return r})}function hn(e,t){return wu(this,e,t)}function Su(e,t){return ie(e,t,function(){return y})}function ln(e){return Su(this,e)}function Qi(e,t,r,n){return ie(e,[t],r,n)}function _n(e,t,r){return arguments.length===1?e(this):Qi(this,e,t,r)}function dn(e,t,r){return ie(this,e,t,r)}function Zi(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return eo(this,e)}function to(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if(typeof e!="function")throw new TypeError("Invalid merger function: "+e);return eo(this,t,e)}function eo(e,t,r){for(var n=[],i=0;i<t.length;i++){var o=ot(t[i]);o.size!==0&&n.push(o)}return n.length===0?e:e.toSeq().size===0&&!e.__ownerID&&n.length===1?e.constructor(n[0]):e.withMutations(function(s){for(var u=r?function(a,c){Qi(s,c,y,function(h){return h===y?a:r(h,a,c)})}:function(a,c){s.set(c,a)},f=0;f<n.length;f++)n[f].forEach(u)})}function pn(e,t,r){return vn(e,t,bu(r))}function vn(e,t,r){if(!zt(e))throw new TypeError("Cannot merge into non-data-structure value: "+e);if(St(e))return typeof r=="function"&&e.mergeWith?e.mergeWith.apply(e,[r].concat(t)):e.merge?e.merge.apply(e,t):e.concat.apply(e,t);for(var n=Array.isArray(e),i=e,o=n?xt:ot,s=n?function(f){i===e&&(i=_r(i)),i.push(f)}:function(f,a){var c=ee.call(i,a),h=c&&r?r(i[a],f,a):f;(!c||h!==i[a])&&(i===e&&(i=_r(i)),i[a]=h)},u=0;u<t.length;u++)o(t[u]).forEach(s);return i}function bu(e){function t(r,n,i){return zt(r)&&zt(n)&&Eu(r,n)?vn(r,[n],t):e?e(r,n,i):n}return t}function Eu(e,t){var r=Q(e),n=Q(t);return G(r)===G(n)&&R(r)===R(n)}function ro(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return pn(this,e)}function no(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return pn(this,t,e)}function yn(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return ie(this,e,yt(),function(n){return vn(n,t)})}function gn(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return ie(this,e,yt(),function(n){return pn(n,t)})}function $e(e){var t=this.asMutable();return e(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this}function Ce(){return this.__ownerID?this:this.__ensureOwner(new Wr)}function ze(){return this.__ensureOwner()}function mn(){return this.__altered}var qt=function(e){function t(r){return r==null?yt():Zr(r)&&!dt(r)?r:yt().withMutations(function(n){var i=e(r);ut(i.size),i.forEach(function(o,s){return n.set(s,o)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return yt().withMutations(function(o){for(var s=0;s<n.length;s+=2){if(s+1>=n.length)throw new Error("Missing value for key: "+n[s]);o.set(n[s],n[s+1])}})},t.prototype.toString=function(){return this.__toString("Map {","}")},t.prototype.get=function(n,i){return this._root?this._root.get(0,void 0,n,i):i},t.prototype.set=function(n,i){return so(this,n,i)},t.prototype.remove=function(n){return so(this,n,y)},t.prototype.deleteAll=function(n){var i=$(n);return i.size===0?this:this.withMutations(function(o){i.forEach(function(s){return o.remove(s)})})},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):yt()},t.prototype.sort=function(n){return It(ne(this,n))},t.prototype.sortBy=function(n,i){return It(ne(this,i,n))},t.prototype.map=function(n,i){var o=this;return this.withMutations(function(s){s.forEach(function(u,f){s.set(f,n.call(i,u,f,o))})})},t.prototype.__iterator=function(n,i){return new Ou(this,n,i)},t.prototype.__iterate=function(n,i){var o=this,s=0;return this._root&&this._root.iterate(function(u){return s++,n(u[1],u[0],o)},i),s},t.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?Sn(this.size,this._root,n,this.__hash):this.size===0?yt():(this.__ownerID=n,this.__altered=!1,this)},t}(ot);qt.isMap=Zr;var O=qt.prototype;O[Ni]=!0,O[Me]=O.remove,O.removeAll=O.deleteAll,O.setIn=hn,O.removeIn=O.deleteIn=ln,O.update=_n,O.updateIn=dn,O.merge=O.concat=Zi,O.mergeWith=to,O.mergeDeep=ro,O.mergeDeepWith=no,O.mergeIn=yn,O.mergeDeepIn=gn,O.withMutations=$e,O.wasAltered=mn,O.asImmutable=ze,O["@@transducer/init"]=O.asMutable=Ce,O["@@transducer/step"]=function(e,t){return e.set(t[0],t[1])},O["@@transducer/result"]=function(e){return e.asImmutable()};var qe=function(t,r){this.ownerID=t,this.entries=r};qe.prototype.get=function(t,r,n,i){for(var o=this.entries,s=0,u=o.length;s<u;s++)if(Z(n,o[s][0]))return o[s][1];return i},qe.prototype.update=function(t,r,n,i,o,s,u){for(var f=o===y,a=this.entries,c=0,h=a.length;c<h&&!Z(i,a[c][0]);c++);var l=c<h;if(l?a[c][1]===o:f)return this;if(it(u),(f||!l)&&it(s),!(f&&a.length===1)){if(!l&&!f&&a.length>=$u)return Mu(t,a,i,o);var _=t&&t===this.ownerID,d=_?a:Et(a);return l?f?c===h-1?d.pop():d[c]=d.pop():d[c]=[i,o]:d.push([i,o]),_?(this.entries=d,this):new qe(t,d)}};var oe=function(t,r,n){this.ownerID=t,this.bitmap=r,this.nodes=n};oe.prototype.get=function(t,r,n,i){r===void 0&&(r=tt(n));var o=1<<((t===0?r:r>>>t)&K),s=this.bitmap;return(s&o)===0?i:this.nodes[ao(s&o-1)].get(t+E,r,n,i)},oe.prototype.update=function(t,r,n,i,o,s,u){n===void 0&&(n=tt(i));var f=(r===0?n:n>>>r)&K,a=1<<f,c=this.bitmap,h=(c&a)!==0;if(!h&&o===y)return this;var l=ao(c&a-1),_=this.nodes,d=h?_[l]:void 0,p=bn(d,t,r+E,n,i,o,s,u);if(p===d)return this;if(!h&&p&&_.length>=Cu)return Iu(t,_,c,f,p);if(h&&!p&&_.length===2&&uo(_[l^1]))return _[l^1];if(h&&p&&_.length===1&&uo(p))return p;var m=t&&t===this.ownerID,N=h?p?c:c^a:c|a,I=h?p?fo(_,l,p,m):Nu(_,l,m):Ru(_,l,p,m);return m?(this.bitmap=N,this.nodes=I,this):new oe(t,N,I)};var Pe=function(t,r,n){this.ownerID=t,this.count=r,this.nodes=n};Pe.prototype.get=function(t,r,n,i){r===void 0&&(r=tt(n));var o=(t===0?r:r>>>t)&K,s=this.nodes[o];return s?s.get(t+E,r,n,i):i},Pe.prototype.update=function(t,r,n,i,o,s,u){n===void 0&&(n=tt(i));var f=(r===0?n:n>>>r)&K,a=o===y,c=this.nodes,h=c[f];if(a&&!h)return this;var l=bn(h,t,r+E,n,i,o,s,u);if(l===h)return this;var _=this.count;if(!h)_++;else if(!l&&(_--,_<zu))return Au(t,c,_,f);var d=t&&t===this.ownerID,p=fo(c,f,l,d);return d?(this.count=_,this.nodes=p,this):new Pe(t,_,p)};var se=function(t,r,n){this.ownerID=t,this.keyHash=r,this.entries=n};se.prototype.get=function(t,r,n,i){for(var o=this.entries,s=0,u=o.length;s<u;s++)if(Z(n,o[s][0]))return o[s][1];return i},se.prototype.update=function(t,r,n,i,o,s,u){n===void 0&&(n=tt(i));var f=o===y;if(n!==this.keyHash)return f?this:(it(u),it(s),En(this,t,r,n,[i,o]));for(var a=this.entries,c=0,h=a.length;c<h&&!Z(i,a[c][0]);c++);var l=c<h;if(l?a[c][1]===o:f)return this;if(it(u),(f||!l)&&it(s),f&&h===2)return new At(t,this.keyHash,a[c^1]);var _=t&&t===this.ownerID,d=_?a:Et(a);return l?f?c===h-1?d.pop():d[c]=d.pop():d[c]=[i,o]:d.push([i,o]),_?(this.entries=d,this):new se(t,this.keyHash,d)};var At=function(t,r,n){this.ownerID=t,this.keyHash=r,this.entry=n};At.prototype.get=function(t,r,n,i){return Z(n,this.entry[0])?this.entry[1]:i},At.prototype.update=function(t,r,n,i,o,s,u){var f=o===y,a=Z(i,this.entry[0]);if(a?o===this.entry[1]:f)return this;if(it(u),f){it(s);return}return a?t&&t===this.ownerID?(this.entry[1]=o,this):new At(t,this.keyHash,[i,o]):(it(s),En(this,t,r,tt(i),[i,o]))},qe.prototype.iterate=se.prototype.iterate=function(e,t){for(var r=this.entries,n=0,i=r.length-1;n<=i;n++)if(e(r[t?i-n:n])===!1)return!1},oe.prototype.iterate=Pe.prototype.iterate=function(e,t){for(var r=this.nodes,n=0,i=r.length-1;n<=i;n++){var o=r[t?i-n:n];if(o&&o.iterate(e,t)===!1)return!1}},At.prototype.iterate=function(e,t){return e(this.entry)};var Ou=function(e){function t(r,n,i){this._type=n,this._reverse=i,this._stack=r._root&&io(r._root)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){for(var n=this._type,i=this._stack;i;){var o=i.node,s=i.index++,u=void 0;if(o.entry){if(s===0)return wn(n,o.entry)}else if(o.entries){if(u=o.entries.length-1,s<=u)return wn(n,o.entries[this._reverse?u-s:s])}else if(u=o.nodes.length-1,s<=u){var f=o.nodes[this._reverse?u-s:s];if(f){if(f.entry)return wn(n,f.entry);i=this._stack=io(f,i)}continue}i=this._stack=this._stack.__prev}return V()},t}(g);function wn(e,t){return A(e,t[0],t[1])}function io(e,t){return{node:e,index:0,__prev:t}}function Sn(e,t,r,n){var i=Object.create(O);return i.size=e,i._root=t,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var oo;function yt(){return oo||(oo=Sn(0))}function so(e,t,r){var n,i;if(e._root){var o=Fr(),s=Fr();if(n=bn(e._root,e.__ownerID,0,void 0,t,r,o,s),!s.value)return e;i=e.size+(o.value?r===y?-1:1:0)}else{if(r===y)return e;i=1,n=new qe(e.__ownerID,[[t,r]])}return e.__ownerID?(e.size=i,e._root=n,e.__hash=void 0,e.__altered=!0,e):n?Sn(i,n):yt()}function bn(e,t,r,n,i,o,s,u){return e?e.update(t,r,n,i,o,s,u):o===y?e:(it(u),it(s),new At(t,n,[i,o]))}function uo(e){return e.constructor===At||e.constructor===se}function En(e,t,r,n,i){if(e.keyHash===n)return new se(t,n,[e.entry,i]);var o=(r===0?e.keyHash:e.keyHash>>>r)&K,s=(r===0?n:n>>>r)&K,u,f=o===s?[En(e,t,r+E,n,i)]:(u=new At(t,n,i),o<s?[e,u]:[u,e]);return new oe(t,1<<o|1<<s,f)}function Mu(e,t,r,n){e||(e=new Wr);for(var i=new At(e,tt(r),[r,n]),o=0;o<t.length;o++){var s=t[o];i=i.update(e,0,void 0,s[0],s[1])}return i}function Au(e,t,r,n){for(var i=0,o=0,s=new Array(r),u=0,f=1,a=t.length;u<a;u++,f<<=1){var c=t[u];c!==void 0&&u!==n&&(i|=f,s[o++]=c)}return new oe(e,i,s)}function Iu(e,t,r,n,i){for(var o=0,s=new Array(nt),u=0;r!==0;u++,r>>>=1)s[u]=r&1?t[o++]:void 0;return s[n]=i,new Pe(e,o+1,s)}function ao(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function fo(e,t,r,n){var i=n?e:Et(e);return i[t]=r,i}function Ru(e,t,r,n){var i=e.length+1;if(n&&t+1===i)return e[t]=r,e;for(var o=new Array(i),s=0,u=0;u<i;u++)u===t?(o[u]=r,s=-1):o[u]=e[u+s];return o}function Nu(e,t,r){var n=e.length-1;if(r&&t===n)return e.pop(),e;for(var i=new Array(n),o=0,s=0;s<n;s++)s===t&&(o=1),i[s]=e[s+o];return i}var $u=nt/4,Cu=nt/2,zu=nt/4,co="@@__IMMUTABLE_LIST__@@";function ho(e){return Boolean(e&&e[co])}var dr=function(e){function t(r){var n=pr();if(r==null)return n;if(ho(r))return r;var i=e(r),o=i.size;return o===0?n:(ut(o),o>0&&o<nt?ke(0,o,E,null,new Pt(i.toArray())):n.withMutations(function(s){s.setSize(o),i.forEach(function(u,f){return s.set(f,u)})}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("List [","]")},t.prototype.get=function(n,i){if(n=$t(this,n),n>=0&&n<this.size){n+=this._origin;var o=po(this,n);return o&&o.array[n&K]}return i},t.prototype.set=function(n,i){return qu(this,n,i)},t.prototype.remove=function(n){return this.has(n)?n===0?this.shift():n===this.size-1?this.pop():this.splice(n,1):this},t.prototype.insert=function(n,i){return this.splice(n,0,i)},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=E,this._root=this._tail=this.__hash=void 0,this.__altered=!0,this):pr()},t.prototype.push=function(){var n=arguments,i=this.size;return this.withMutations(function(o){Tt(o,0,i+n.length);for(var s=0;s<n.length;s++)o.set(i+s,n[s])})},t.prototype.pop=function(){return Tt(this,0,-1)},t.prototype.unshift=function(){var n=arguments;return this.withMutations(function(i){Tt(i,-n.length);for(var o=0;o<n.length;o++)i.set(o,n[o])})},t.prototype.shift=function(){return Tt(this,1)},t.prototype.concat=function(){for(var n=arguments,i=[],o=0;o<arguments.length;o++){var s=n[o],u=e(typeof s!="string"&&Oi(s)?s:[s]);u.size!==0&&i.push(u)}return i.length===0?this:this.size===0&&!this.__ownerID&&i.length===1?this.constructor(i[0]):this.withMutations(function(f){i.forEach(function(a){return a.forEach(function(c){return f.push(c)})})})},t.prototype.setSize=function(n){return Tt(this,0,n)},t.prototype.map=function(n,i){var o=this;return this.withMutations(function(s){for(var u=0;u<o.size;u++)s.set(u,n.call(i,s.get(u),u,o))})},t.prototype.slice=function(n,i){var o=this.size;return ir(n,i,o)?this:Tt(this,Ae(n,o),or(i,o))},t.prototype.__iterator=function(n,i){var o=i?this.size:0,s=lo(this,i);return new g(function(){var u=s();return u===Te?V():A(n,i?--o:o++,u)})},t.prototype.__iterate=function(n,i){for(var o=i?this.size:0,s=lo(this,i),u;(u=s())!==Te&&n(u,i?--o:o++,this)!==!1;);return o},t.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?ke(this._origin,this._capacity,this._level,this._root,this._tail,n,this.__hash):this.size===0?pr():(this.__ownerID=n,this.__altered=!1,this)},t}(xt);dr.isList=ho;var z=dr.prototype;z[co]=!0,z[Me]=z.remove,z.merge=z.concat,z.setIn=hn,z.deleteIn=z.removeIn=ln,z.update=_n,z.updateIn=dn,z.mergeIn=yn,z.mergeDeepIn=gn,z.withMutations=$e,z.wasAltered=mn,z.asImmutable=ze,z["@@transducer/init"]=z.asMutable=Ce,z["@@transducer/step"]=function(e,t){return e.push(t)},z["@@transducer/result"]=function(e){return e.asImmutable()};var Pt=function(t,r){this.array=t,this.ownerID=r};Pt.prototype.removeBefore=function(t,r,n){if(n===r?1<<r:this.array.length===0)return this;var i=n>>>r&K;if(i>=this.array.length)return new Pt([],t);var o=i===0,s;if(r>0){var u=this.array[i];if(s=u&&u.removeBefore(t,r-E,n),s===u&&o)return this}if(o&&!s)return this;var f=ue(this,t);if(!o)for(var a=0;a<i;a++)f.array[a]=void 0;return s&&(f.array[i]=s),f},Pt.prototype.removeAfter=function(t,r,n){if(n===(r?1<<r:0)||this.array.length===0)return this;var i=n-1>>>r&K;if(i>=this.array.length)return this;var o;if(r>0){var s=this.array[i];if(o=s&&s.removeAfter(t,r-E,n),o===s&&i===this.array.length-1)return this}var u=ue(this,t);return u.array.splice(i+1),o&&(u.array[i]=o),u};var Te={};function lo(e,t){var r=e._origin,n=e._capacity,i=Le(n),o=e._tail;return s(e._root,e._level,0);function s(a,c,h){return c===0?u(a,h):f(a,c,h)}function u(a,c){var h=c===i?o&&o.array:a&&a.array,l=c>r?0:r-c,_=n-c;return _>nt&&(_=nt),function(){if(l===_)return Te;var d=t?--_:l++;return h&&h[d]}}function f(a,c,h){var l,_=a&&a.array,d=h>r?0:r-h>>c,p=(n-h>>c)+1;return p>nt&&(p=nt),function(){for(;;){if(l){var m=l();if(m!==Te)return m;l=null}if(d===p)return Te;var N=t?--p:d++;l=s(_&&_[N],c-E,h+(N<<c))}}}}function ke(e,t,r,n,i,o,s){var u=Object.create(z);return u.size=t-e,u._origin=e,u._capacity=t,u._level=r,u._root=n,u._tail=i,u.__ownerID=o,u.__hash=s,u.__altered=!1,u}var _o;function pr(){return _o||(_o=ke(0,0,E))}function qu(e,t,r){if(t=$t(e,t),t!==t)return e;if(t>=e.size||t<0)return e.withMutations(function(s){t<0?Tt(s,t).set(0,r):Tt(s,0,t+1).set(t,r)});t+=e._origin;var n=e._tail,i=e._root,o=Fr();return t>=Le(e._capacity)?n=On(n,e.__ownerID,0,t,r,o):i=On(i,e.__ownerID,e._level,t,r,o),o.value?e.__ownerID?(e._root=i,e._tail=n,e.__hash=void 0,e.__altered=!0,e):ke(e._origin,e._capacity,e._level,i,n):e}function On(e,t,r,n,i,o){var s=n>>>r&K,u=e&&s<e.array.length;if(!u&&i===void 0)return e;var f;if(r>0){var a=e&&e.array[s],c=On(a,t,r-E,n,i,o);return c===a?e:(f=ue(e,t),f.array[s]=c,f)}return u&&e.array[s]===i?e:(o&&it(o),f=ue(e,t),i===void 0&&s===f.array.length-1?f.array.pop():f.array[s]=i,f)}function ue(e,t){return t&&e&&t===e.ownerID?e:new Pt(e?e.array.slice():[],t)}function po(e,t){if(t>=Le(e._capacity))return e._tail;if(t<1<<e._level+E){for(var r=e._root,n=e._level;r&&n>0;)r=r.array[t>>>n&K],n-=E;return r}}function Tt(e,t,r){t!==void 0&&(t|=0),r!==void 0&&(r|=0);var n=e.__ownerID||new Wr,i=e._origin,o=e._capacity,s=i+t,u=r===void 0?o:r<0?o+r:i+r;if(s===i&&u===o)return e;if(s>=u)return e.clear();for(var f=e._level,a=e._root,c=0;s+c<0;)a=new Pt(a&&a.array.length?[void 0,a]:[],n),f+=E,c+=1<<f;c&&(s+=c,i+=c,u+=c,o+=c);for(var h=Le(o),l=Le(u);l>=1<<f+E;)a=new Pt(a&&a.array.length?[a]:[],n),f+=E;var _=e._tail,d=l<h?po(e,u-1):l>h?new Pt([],n):_;if(_&&l>h&&s<o&&_.array.length){a=ue(a,n);for(var p=a,m=f;m>E;m-=E){var N=h>>>m&K;p=p.array[N]=ue(p.array[N],n)}p.array[h>>>E&K]=_}if(u<o&&(d=d&&d.removeAfter(n,0,u)),s>=l)s-=l,u-=l,f=E,a=null,d=d&&d.removeBefore(n,0,s);else if(s>i||l<h){for(c=0;a;){var I=s>>>f&K;if(I!==l>>>f&K)break;I&&(c+=(1<<f)*I),f-=E,a=a.array[I]}a&&s>i&&(a=a.removeBefore(n,f,s-c)),a&&l<h&&(a=a.removeAfter(n,f,l-c)),c&&(s-=c,u-=c)}return e.__ownerID?(e.size=u-s,e._origin=s,e._capacity=u,e._level=f,e._root=a,e._tail=d,e.__hash=void 0,e.__altered=!0,e):ke(s,u,f,a,d)}function Le(e){return e<nt?0:e-1>>>E<<E}var It=function(e){function t(r){return r==null?je():$i(r)?r:je().withMutations(function(n){var i=ot(r);ut(i.size),i.forEach(function(o,s){return n.set(s,o)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("OrderedMap {","}")},t.prototype.get=function(n,i){var o=this._map.get(n);return o!==void 0?this._list.get(o)[1]:i},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this.__altered=!0,this):je()},t.prototype.set=function(n,i){return yo(this,n,i)},t.prototype.remove=function(n){return yo(this,n,y)},t.prototype.__iterate=function(n,i){var o=this;return this._list.__iterate(function(s){return s&&n(s[1],s[0],o)},i)},t.prototype.__iterator=function(n,i){return this._list.fromEntrySeq().__iterator(n,i)},t.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n),o=this._list.__ensureOwner(n);return n?Mn(i,o,n,this.__hash):this.size===0?je():(this.__ownerID=n,this.__altered=!1,this._map=i,this._list=o,this)},t}(qt);It.isOrderedMap=$i,It.prototype[te]=!0,It.prototype[Me]=It.prototype.remove;function Mn(e,t,r,n){var i=Object.create(It.prototype);return i.size=e?e.size:0,i._map=e,i._list=t,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var vo;function je(){return vo||(vo=Mn(yt(),pr()))}function yo(e,t,r){var n=e._map,i=e._list,o=n.get(t),s=o!==void 0,u,f;if(r===y){if(!s)return e;i.size>=nt&&i.size>=n.size*2?(f=i.filter(function(a,c){return a!==void 0&&o!==c}),u=f.toKeyedSeq().map(function(a){return a[0]}).flip().toMap(),e.__ownerID&&(u.__ownerID=f.__ownerID=e.__ownerID)):(u=n.remove(t),f=o===i.size-1?i.pop():i.set(o,void 0))}else if(s){if(r===i.get(o)[1])return e;u=n,f=i.set(o,[t,r])}else u=n.set(t,i.size),f=i.set(i.size,[t,r]);return e.__ownerID?(e.size=u.size,e._map=u,e._list=f,e.__hash=void 0,e.__altered=!0,e):Mn(u,f)}var go="@@__IMMUTABLE_STACK__@@";function An(e){return Boolean(e&&e[go])}var In=function(e){function t(r){return r==null?vr():An(r)?r:vr().pushAll(r)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("Stack [","]")},t.prototype.get=function(n,i){var o=this._head;for(n=$t(this,n);o&&n--;)o=o.next;return o?o.value:i},t.prototype.peek=function(){return this._head&&this._head.value},t.prototype.push=function(){var n=arguments;if(arguments.length===0)return this;for(var i=this.size+arguments.length,o=this._head,s=arguments.length-1;s>=0;s--)o={value:n[s],next:o};return this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):De(i,o)},t.prototype.pushAll=function(n){if(n=e(n),n.size===0)return this;if(this.size===0&&An(n))return n;ut(n.size);var i=this.size,o=this._head;return n.__iterate(function(s){i++,o={value:s,next:o}},!0),this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):De(i,o)},t.prototype.pop=function(){return this.slice(1)},t.prototype.clear=function(){return this.size===0?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):vr()},t.prototype.slice=function(n,i){if(ir(n,i,this.size))return this;var o=Ae(n,this.size),s=or(i,this.size);if(s!==this.size)return e.prototype.slice.call(this,n,i);for(var u=this.size-o,f=this._head;o--;)f=f.next;return this.__ownerID?(this.size=u,this._head=f,this.__hash=void 0,this.__altered=!0,this):De(u,f)},t.prototype.__ensureOwner=function(n){return n===this.__ownerID?this:n?De(this.size,this._head,n,this.__hash):this.size===0?vr():(this.__ownerID=n,this.__altered=!1,this)},t.prototype.__iterate=function(n,i){var o=this;if(i)return new Jt(this.toArray()).__iterate(function(f,a){return n(f,a,o)},i);for(var s=0,u=this._head;u&&n(u.value,s++,this)!==!1;)u=u.next;return s},t.prototype.__iterator=function(n,i){if(i)return new Jt(this.toArray()).__iterator(n,i);var o=0,s=this._head;return new g(function(){if(s){var u=s.value;return s=s.next,A(n,o++,u)}return V()})},t}(xt);In.isStack=An;var H=In.prototype;H[go]=!0,H.shift=H.pop,H.unshift=H.push,H.unshiftAll=H.pushAll,H.withMutations=$e,H.wasAltered=mn,H.asImmutable=ze,H["@@transducer/init"]=H.asMutable=Ce,H["@@transducer/step"]=function(e,t){return e.unshift(t)},H["@@transducer/result"]=function(e){return e.asImmutable()};function De(e,t,r,n){var i=Object.create(H);return i.size=e,i._head=t,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}var mo;function vr(){return mo||(mo=De(0))}var wo="@@__IMMUTABLE_SET__@@";function Rn(e){return Boolean(e&&e[wo])}function So(e){return Rn(e)&&dt(e)}function bo(e,t){if(e===t)return!0;if(!Y(t)||e.size!==void 0&&t.size!==void 0&&e.size!==t.size||e.__hash!==void 0&&t.__hash!==void 0&&e.__hash!==t.__hash||R(e)!==R(t)||G(e)!==G(t)||dt(e)!==dt(t))return!1;if(e.size===0&&t.size===0)return!0;var r=!sr(e);if(dt(e)){var n=e.entries();return t.every(function(f,a){var c=n.next().value;return c&&Z(c[1],f)&&(r||Z(c[0],a))})&&n.next().done}var i=!1;if(e.size===void 0)if(t.size===void 0)typeof e.cacheResult=="function"&&e.cacheResult();else{i=!0;var o=e;e=t,t=o}var s=!0,u=t.__iterate(function(f,a){if(r?!e.has(f):i?!Z(f,e.get(a,y)):!Z(e.get(a,y),f))return s=!1,!1});return s&&e.size===u}function Ut(e,t){var r=function(n){e.prototype[n]=t[n]};return Object.keys(t).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(r),e}function yr(e){if(!e||typeof e!="object")return e;if(!Y(e)){if(!zt(e))return e;e=Q(e)}if(R(e)){var t={};return e.__iterate(function(n,i){t[i]=yr(n)}),t}var r=[];return e.__iterate(function(n){r.push(yr(n))}),r}var gr=function(e){function t(r){return r==null?xe():Rn(r)&&!dt(r)?r:xe().withMutations(function(n){var i=e(r);ut(i.size),i.forEach(function(o){return n.add(o)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(n){return this(ot(n).keySeq())},t.intersect=function(n){return n=$(n).toArray(),n.length?J.intersect.apply(t(n.pop()),n):xe()},t.union=function(n){return n=$(n).toArray(),n.length?J.union.apply(t(n.pop()),n):xe()},t.prototype.toString=function(){return this.__toString("Set {","}")},t.prototype.has=function(n){return this._map.has(n)},t.prototype.add=function(n){return mr(this,this._map.set(n,n))},t.prototype.remove=function(n){return mr(this,this._map.remove(n))},t.prototype.clear=function(){return mr(this,this._map.clear())},t.prototype.map=function(n,i){var o=this,s=!1,u=mr(this,this._map.mapEntries(function(f){var a=f[1],c=n.call(i,a,a,o);return c!==a&&(s=!0),[c,c]},i));return s?u:this},t.prototype.union=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return n=n.filter(function(o){return o.size!==0}),n.length===0?this:this.size===0&&!this.__ownerID&&n.length===1?this.constructor(n[0]):this.withMutations(function(o){for(var s=0;s<n.length;s++)e(n[s]).forEach(function(u){return o.add(u)})})},t.prototype.intersect=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(s){return e(s)});var o=[];return this.forEach(function(s){n.every(function(u){return u.includes(s)})||o.push(s)}),this.withMutations(function(s){o.forEach(function(u){s.remove(u)})})},t.prototype.subtract=function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length===0)return this;n=n.map(function(s){return e(s)});var o=[];return this.forEach(function(s){n.some(function(u){return u.includes(s)})&&o.push(s)}),this.withMutations(function(s){o.forEach(function(u){s.remove(u)})})},t.prototype.sort=function(n){return Be(ne(this,n))},t.prototype.sortBy=function(n,i){return Be(ne(this,i,n))},t.prototype.wasAltered=function(){return this._map.wasAltered()},t.prototype.__iterate=function(n,i){var o=this;return this._map.__iterate(function(s){return n(s,s,o)},i)},t.prototype.__iterator=function(n,i){return this._map.__iterator(n,i)},t.prototype.__ensureOwner=function(n){if(n===this.__ownerID)return this;var i=this._map.__ensureOwner(n);return n?this.__make(i,n):this.size===0?this.__empty():(this.__ownerID=n,this._map=i,this)},t}(Qt);gr.isSet=Rn;var J=gr.prototype;J[wo]=!0,J[Me]=J.remove,J.merge=J.concat=J.union,J.withMutations=$e,J.asImmutable=ze,J["@@transducer/init"]=J.asMutable=Ce,J["@@transducer/step"]=function(e,t){return e.add(t)},J["@@transducer/result"]=function(e){return e.asImmutable()},J.__empty=xe,J.__make=Eo;function mr(e,t){return e.__ownerID?(e.size=t.size,e._map=t,e):t===e._map?e:t.size===0?e.__empty():e.__make(t)}function Eo(e,t){var r=Object.create(J);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}var Oo;function xe(){return Oo||(Oo=Eo(yt()))}var Pu=function(e){function t(r,n,i){if(!(this instanceof t))return new t(r,n,i);if(cn(i!==0,"Cannot step a Range by 0"),r=r||0,n===void 0&&(n=1/0),i=i===void 0?1:Math.abs(i),n<r&&(i=-i),this._start=r,this._end=n,this._step=i,this.size=Math.max(0,Math.ceil((n-r)/i-1)+1),this.size===0){if(Nn)return Nn;Nn=this}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return this.size===0?"Range []":"Range [ "+this._start+"..."+this._end+(this._step!==1?" by "+this._step:"")+" ]"},t.prototype.get=function(n,i){return this.has(n)?this._start+$t(this,n)*this._step:i},t.prototype.includes=function(n){var i=(n-this._start)/this._step;return i>=0&&i<this.size&&i===Math.floor(i)},t.prototype.slice=function(n,i){return ir(n,i,this.size)?this:(n=Ae(n,this.size),i=or(i,this.size),i<=n?new t(0,0):new t(this.get(n,this._end),this.get(i,this._end),this._step))},t.prototype.indexOf=function(n){var i=n-this._start;if(i%this._step===0){var o=i/this._step;if(o>=0&&o<this.size)return o}return-1},t.prototype.lastIndexOf=function(n){return this.indexOf(n)},t.prototype.__iterate=function(n,i){for(var o=this.size,s=this._step,u=i?this._start+(o-1)*s:this._start,f=0;f!==o&&n(u,i?o-++f:f++,this)!==!1;)u+=i?-s:s;return f},t.prototype.__iterator=function(n,i){var o=this.size,s=this._step,u=i?this._start+(o-1)*s:this._start,f=0;return new g(function(){if(f===o)return V();var a=u;return u+=i?-s:s,A(n,i?o-++f:f++,a)})},t.prototype.equals=function(n){return n instanceof t?this._start===n._start&&this._end===n._end&&this._step===n._step:bo(this,n)},t}(vt),Nn;function Mo(e,t,r){for(var n=Gi(t),i=0;i!==n.length;)if(e=Vi(e,n[i++],y),e===y)return r;return e}function Ao(e,t){return Mo(this,e,t)}function Tu(e,t){return Mo(e,t,y)!==y}function ku(e){return Tu(this,e)}function Io(){ut(this.size);var e={};return this.__iterate(function(t,r){e[r]=t}),e}$.isIterable=Y,$.isKeyed=R,$.isIndexed=G,$.isAssociative=sr,$.isOrdered=dt,$.Iterator=g,Ut($,{toArray:function(){ut(this.size);var t=new Array(this.size||0),r=R(this),n=0;return this.__iterate(function(i,o){t[n++]=r?[o,i]:i}),t},toIndexedSeq:function(){return new Li(this)},toJS:function(){return yr(this)},toKeyedSeq:function(){return new cr(this,!0)},toMap:function(){return qt(this.toKeyedSeq())},toObject:Io,toOrderedMap:function(){return It(this.toKeyedSeq())},toOrderedSet:function(){return Be(R(this)?this.valueSeq():this)},toSet:function(){return gr(R(this)?this.valueSeq():this)},toSetSeq:function(){return new ji(this)},toSeq:function(){return G(this)?this.toIndexedSeq():R(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return In(R(this)?this.valueSeq():this)},toList:function(){return dr(R(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(t,r){return this.size===0?t+r:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+r},concat:function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return S(this,lu(this,t))},includes:function(t){return this.some(function(r){return Z(r,t)})},entries:function(){return this.__iterator(st)},every:function(t,r){ut(this.size);var n=!0;return this.__iterate(function(i,o,s){if(!t.call(r,i,o,s))return n=!1,!1}),n},filter:function(t,r){return S(this,Bi(this,t,r,!0))},find:function(t,r,n){var i=this.findEntry(t,r);return i?i[1]:n},forEach:function(t,r){return ut(this.size),this.__iterate(r?t.bind(r):t)},join:function(t){ut(this.size),t=t!==void 0?""+t:",";var r="",n=!0;return this.__iterate(function(i){n?n=!1:r+=t,r+=i!=null?i.toString():""}),r},keys:function(){return this.__iterator(Ie)},map:function(t,r){return S(this,Ji(this,t,r))},reduce:function(t,r,n){return Ro(this,t,r,n,arguments.length<2,!1)},reduceRight:function(t,r,n){return Ro(this,t,r,n,arguments.length<2,!0)},reverse:function(){return S(this,un(this,!0))},slice:function(t,r){return S(this,an(this,t,r,!0))},some:function(t,r){return!this.every(wr(t),r)},sort:function(t){return S(this,ne(this,t))},values:function(){return this.__iterator(pt)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return this.size!==void 0?this.size===0:!this.some(function(){return!0})},count:function(t,r){return Xt(t?this.toSeq().filter(t,r):this)},countBy:function(t,r){return fu(this,t,r)},equals:function(t){return bo(this,t)},entrySeq:function(){var t=this;if(t._cache)return new Jt(t._cache);var r=t.toSeq().map(ju).toIndexedSeq();return r.fromEntrySeq=function(){return t.toSeq()},r},filterNot:function(t,r){return this.filter(wr(t),r)},findEntry:function(t,r,n){var i=n;return this.__iterate(function(o,s,u){if(t.call(r,o,s,u))return i=[s,o],!1}),i},findKey:function(t,r){var n=this.findEntry(t,r);return n&&n[0]},findLast:function(t,r,n){return this.toKeyedSeq().reverse().find(t,r,n)},findLastEntry:function(t,r,n){return this.toKeyedSeq().reverse().findEntry(t,r,n)},findLastKey:function(t,r){return this.toKeyedSeq().reverse().findKey(t,r)},first:function(t){return this.find(pi,null,t)},flatMap:function(t,r){return S(this,_u(this,t,r))},flatten:function(t){return S(this,Fi(this,t,!0))},fromEntrySeq:function(){return new Di(this)},get:function(t,r){return this.find(function(n,i){return Z(i,t)},void 0,r)},getIn:Ao,groupBy:function(t,r){return cu(this,t,r)},has:function(t){return this.get(t,y)!==y},hasIn:ku,isSubset:function(t){return t=typeof t.includes=="function"?t:$(t),this.every(function(r){return t.includes(r)})},isSuperset:function(t){return t=typeof t.isSubset=="function"?t:$(t),t.isSubset(this)},keyOf:function(t){return this.findKey(function(r){return Z(r,t)})},keySeq:function(){return this.toSeq().map(Lu).toIndexedSeq()},last:function(t){return this.toSeq().reverse().first(t)},lastKeyOf:function(t){return this.toKeyedSeq().reverse().keyOf(t)},max:function(t){return hr(this,t)},maxBy:function(t,r){return hr(this,r,t)},min:function(t){return hr(this,t?No(t):Co)},minBy:function(t,r){return hr(this,r?No(r):Co,t)},rest:function(){return this.slice(1)},skip:function(t){return t===0?this:this.slice(Math.max(0,t))},skipLast:function(t){return t===0?this:this.slice(0,-Math.max(0,t))},skipWhile:function(t,r){return S(this,Ui(this,t,r,!0))},skipUntil:function(t,r){return this.skipWhile(wr(t),r)},sortBy:function(t,r){return S(this,ne(this,r,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return this.slice(-Math.max(0,t))},takeWhile:function(t,r){return S(this,hu(this,t,r))},takeUntil:function(t,r){return this.takeWhile(wr(t),r)},update:function(t){return t(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=Du(this))}});var F=$.prototype;F[gi]=!0,F[ur]=F.values,F.toJSON=F.toArray,F.__toStringMapper=Ne,F.inspect=F.toSource=function(){return this.toString()},F.chain=F.flatMap,F.contains=F.includes,Ut(ot,{flip:function(){return S(this,xi(this))},mapEntries:function(t,r){var n=this,i=0;return S(this,this.toSeq().map(function(o,s){return t.call(r,[s,o],i++,n)}).fromEntrySeq())},mapKeys:function(t,r){var n=this;return S(this,this.toSeq().flip().map(function(i,o){return t.call(r,i,o,n)}).flip())}});var Je=ot.prototype;Je[mi]=!0,Je[ur]=F.entries,Je.toJSON=Io,Je.__toStringMapper=function(e,t){return Ne(t)+": "+Ne(e)},Ut(xt,{toKeyedSeq:function(){return new cr(this,!1)},filter:function(t,r){return S(this,Bi(this,t,r,!1))},findIndex:function(t,r){var n=this.findEntry(t,r);return n?n[0]:-1},indexOf:function(t){var r=this.keyOf(t);return r===void 0?-1:r},lastIndexOf:function(t){var r=this.lastKeyOf(t);return r===void 0?-1:r},reverse:function(){return S(this,un(this,!1))},slice:function(t,r){return S(this,an(this,t,r,!1))},splice:function(t,r){var n=arguments.length;if(r=Math.max(r||0,0),n===0||n===2&&!r)return this;t=Ae(t,t<0?this.count():this.size);var i=this.slice(0,t);return S(this,n===1?i:i.concat(Et(arguments,2),this.slice(t+r)))},findLastIndex:function(t,r){var n=this.findLastEntry(t,r);return n?n[0]:-1},first:function(t){return this.get(0,t)},flatten:function(t){return S(this,Fi(this,t,!1))},get:function(t,r){return t=$t(this,t),t<0||this.size===1/0||this.size!==void 0&&t>this.size?r:this.find(function(n,i){return i===t},void 0,r)},has:function(t){return t=$t(this,t),t>=0&&(this.size!==void 0?this.size===1/0||t<this.size:this.indexOf(t)!==-1)},interpose:function(t){return S(this,du(this,t))},interleave:function(){var t=[this].concat(Et(arguments)),r=lr(this.toSeq(),vt.of,t),n=r.flatten(!0);return r.size&&(n.size=r.size*t.length),S(this,n)},keySeq:function(){return Pu(0,this.size)},last:function(t){return this.get(-1,t)},skipWhile:function(t,r){return S(this,Ui(this,t,r,!1))},zip:function(){var t=[this].concat(Et(arguments));return S(this,lr(this,$o,t))},zipAll:function(){var t=[this].concat(Et(arguments));return S(this,lr(this,$o,t,!0))},zipWith:function(t){var r=Et(arguments);return r[0]=this,S(this,lr(this,t,r))}});var ae=xt.prototype;ae[wi]=!0,ae[te]=!0,Ut(Qt,{get:function(t,r){return this.has(t)?t:r},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}});var fe=Qt.prototype;fe.has=F.includes,fe.contains=fe.includes,fe.keys=fe.values,Ut(Ct,Je),Ut(vt,ae),Ut(re,fe);function Ro(e,t,r,n,i,o){return ut(e.size),e.__iterate(function(s,u,f){i?(i=!1,r=s):r=t.call(n,r,s,u,f)},o),r}function Lu(e,t){return t}function ju(e,t){return[t,e]}function wr(e){return function(){return!e.apply(this,arguments)}}function No(e){return function(){return-e.apply(this,arguments)}}function $o(){return Et(arguments)}function Co(e,t){return e<t?1:e>t?-1:0}function Du(e){if(e.size===1/0)return 0;var t=dt(e),r=R(e),n=t?1:0,i=e.__iterate(r?t?function(o,s){n=31*n+zo(tt(o),tt(s))|0}:function(o,s){n=n+zo(tt(o),tt(s))|0}:t?function(o){n=31*n+tt(o)|0}:function(o){n=n+tt(o)|0});return xu(i,n)}function xu(e,t){return t=Re(t,3432918353),t=Re(t<<15|t>>>-15,461845907),t=Re(t<<13|t>>>-13,5),t=(t+3864292196|0)^e,t=Re(t^t>>>16,2246822507),t=Re(t^t>>>13,3266489909),t=fr(t^t>>>16),t}function zo(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}var Be=function(e){function t(r){return r==null?$n():So(r)?r:$n().withMutations(function(n){var i=Qt(r);ut(i.size),i.forEach(function(o){return n.add(o)})})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(n){return this(ot(n).keySeq())},t.prototype.toString=function(){return this.__toString("OrderedSet {","}")},t}(gr);Be.isOrderedSet=So;var Ft=Be.prototype;Ft[te]=!0,Ft.zip=ae.zip,Ft.zipWith=ae.zipWith,Ft.zipAll=ae.zipAll,Ft.__empty=$n,Ft.__make=qo;function qo(e,t){var r=Object.create(Ft);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}var Po;function $n(){return Po||(Po=qo(je()))}function Ju(e){if(Zt(e))throw new Error("Can not call `Record` with an immutable Record as default values. Use a plain javascript object instead.");if(St(e))throw new Error("Can not call `Record` with an immutable Collection as default values. Use a plain javascript object instead.");if(e===null||typeof e!="object")throw new Error("Can not call `Record` with a non-object as default values. Use a plain javascript object instead.")}var j=function(t,r){var n;Ju(t);var i=function(u){var f=this;if(u instanceof i)return u;if(!(this instanceof i))return new i(u);if(!n){n=!0;var a=Object.keys(t),c=o._indices={};o._name=r,o._keys=a,o._defaultValues=t;for(var h=0;h<a.length;h++){var l=a[h];c[l]=h,o[l]?typeof console=="object"&&console.warn&&console.warn("Cannot define "+zn(this)+' with property "'+l+'" since that property name is part of the Record API.'):Bu(o,l)}}return this.__ownerID=void 0,this._values=dr().withMutations(function(_){_.setSize(f._keys.length),ot(u).forEach(function(d,p){_.set(f._indices[p],d===f._defaultValues[p]?void 0:d)})}),this},o=i.prototype=Object.create(b);return o.constructor=i,r&&(i.displayName=r),i};j.prototype.toString=function(){for(var t=zn(this)+" { ",r=this._keys,n,i=0,o=r.length;i!==o;i++)n=r[i],t+=(i?", ":"")+n+": "+Ne(this.get(n));return t+" }"},j.prototype.equals=function(t){return this===t||Zt(t)&&ce(this).equals(ce(t))},j.prototype.hashCode=function(){return ce(this).hashCode()},j.prototype.has=function(t){return this._indices.hasOwnProperty(t)},j.prototype.get=function(t,r){if(!this.has(t))return r;var n=this._indices[t],i=this._values.get(n);return i===void 0?this._defaultValues[t]:i},j.prototype.set=function(t,r){if(this.has(t)){var n=this._values.set(this._indices[t],r===this._defaultValues[t]?void 0:r);if(n!==this._values&&!this.__ownerID)return Cn(this,n)}return this},j.prototype.remove=function(t){return this.set(t)},j.prototype.clear=function(){var t=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:Cn(this,t)},j.prototype.wasAltered=function(){return this._values.wasAltered()},j.prototype.toSeq=function(){return ce(this)},j.prototype.toJS=function(){return yr(this)},j.prototype.entries=function(){return this.__iterator(st)},j.prototype.__iterator=function(t,r){return ce(this).__iterator(t,r)},j.prototype.__iterate=function(t,r){return ce(this).__iterate(t,r)},j.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var r=this._values.__ensureOwner(t);return t?Cn(this,r,t):(this.__ownerID=t,this._values=r,this)},j.isRecord=Zt,j.getDescriptiveName=zn;var b=j.prototype;b[bi]=!0,b[Me]=b.remove,b.deleteIn=b.removeIn=ln,b.getIn=Ao,b.hasIn=F.hasIn,b.merge=Zi,b.mergeWith=to,b.mergeIn=yn,b.mergeDeep=ro,b.mergeDeepWith=no,b.mergeDeepIn=gn,b.setIn=hn,b.update=_n,b.updateIn=dn,b.withMutations=$e,b.asMutable=Ce,b.asImmutable=ze,b[ur]=b.entries,b.toJSON=b.toObject=F.toObject,b.inspect=b.toSource=function(){return this.toString()};function Cn(e,t,r){var n=Object.create(Object.getPrototypeOf(e));return n._values=t,n.__ownerID=r,n}function zn(e){return e.constructor.displayName||e.constructor.name||"Record"}function ce(e){return Xr(e._keys.map(function(t){return[t,e.get(t)]}))}function Bu(e,t){try{Object.defineProperty(e,t,{get:function(){return this.get(t)},set:function(r){cn(this.__ownerID,"Cannot set on an immutable record."),this.set(t,r)}})}catch{}}const Uu=x('<div><fieldset><legend>\u6807\u8BB0</legend><input type="text" placeholder="\u7559\u8A00"><button type="button">\u6211\u6B63\u5728\u505A</button><button type="button">\u6211\u5F88\u786E\u5B9A</button><button type="button">\u6211\u4E0D\u786E\u5B9A</button></fieldset><div><fieldset><legend> \u7559\u8A00 </legend><ul></ul></fieldset><div></div></div></div>'),Fu=x("<li><span></span></li>"),To=x("<div><p><strong></strong></p><ul></ul></div>"),ko=x("<li></li>"),Wu=x("<li><p></p><ul></ul></li>"),Ku=x("<div></div>"),Hu=x("<ul></ul>"),Yu=x("<li><a></a></li>"),Gu=x("<p><strong></strong></p>");function qn(e,t){return e===t?0:e<t?-1:1}function Lo(e){switch(e){case ht.Sure:return 0;case ht.WorkingOn:return 1;case ht.NotSure:return 2}}function jo([e,t],[r,n]){return Hs(ft(t,n)).with(ft(void 0,void 0),()=>qn(e,r)).with(ft(void 0,rr.not(void 0)),()=>1).with(ft(rr.not(void 0),void 0),()=>-1).with(ft(rr.not(void 0),rr.not(void 0)),([i,o])=>{const s=Lo(o)-Lo(i);return s===0?qn(e,r):s}).exhaustive()}function Do([e,t],[r,n]){var i,o;return jo(ft(e,(i=t.context)==null?void 0:i.state),ft(r,(o=n.context)==null?void 0:o.state))}function xo([e,t],[r,n]){return jo(ft(e,t==null?void 0:t.state),ft(r,n==null?void 0:n.state))}function Sr(e){if(e!==void 0)switch(e){case ht.WorkingOn:return M.stateWorkingOn;case ht.NotSure:return M.stateNotSure;case ht.Sure:return M.stateSure}}function Jo(e,t){return`${Math.floor(e*100/t)}%`}function Pn([e],[t]){return qn(e,t)}class Tn{constructor(t,r,n){et(this,"_details",qt());this.updateUI=ve(()=>{const[i,o]=Bn(qt(),{}),s=()=>o(this._details),u=n(i);let f=r.querySelector(".item-type");return ni(HTMLElement,f),f.classList.add(M.clickable),f.addEventListener("click",()=>{let a=f==null?void 0:f.getBoundingClientRect();const c=Tr({title:"\u8BE6\u7EC6\u7B54\u6848",height:200,width:300,top:a==null?void 0:a.top,left:a==null?void 0:a.left});me(()=>(()=>{const h=Uu.cloneNode(!0),l=h.firstChild,_=l.firstChild,d=_.nextSibling,p=d.nextSibling,m=p.nextSibling,N=m.nextSibling,I=l.nextSibling,D=I.firstChild,gt=D.firstChild,kt=gt.nextSibling,br=D.nextSibling;return d.addEventListener("change",T=>Ot.updateMsg(t,T.currentTarget.value)),p.addEventListener("click",()=>Ot.updateState(t,ht.WorkingOn)),m.addEventListener("click",()=>Ot.updateState(t,ht.Sure)),N.addEventListener("click",()=>Ot.updateState(t,ht.NotSure)),w(kt,W(Nt,{get each(){return X(i()).then(Vt(Do)).then(Oe).exec()},children:([T,{context:Wt}])=>{if(Wt===void 0)return;let Rt=Wt.msg;if(Wt.state===ht.WorkingOn&&(Rt=Rt!=null?Rt:"\u6211\u6B63\u5728\u505A"),Rt!==void 0)return(()=>{const Kt=Fu.cloneNode(!0),Fe=Kt.firstChild;return w(Fe,`${T}: `),w(Kt,Rt,null),L(Lt=>{const Er=Sr(Wt.state),Or=M.answerMsgName;return Er!==Lt._v$8&&C(Kt,Lt._v$8=Er),Or!==Lt._v$9&&C(Fe,Lt._v$9=Or),Lt},{_v$8:void 0,_v$9:void 0}),Kt})()}})),w(br,W(u,{})),L(T=>{const Wt=M.mainBody,Rt=M.answerMark,Kt=M.stateWorkingOn,Fe=M.stateSure,Lt=M.stateNotSure,Er={[M.answerMsg]:!0},Or={[M.answerDetail]:!0};return Wt!==T._v$&&C(h,T._v$=Wt),Rt!==T._v$2&&C(l,T._v$2=Rt),Kt!==T._v$3&&C(p,T._v$3=Kt),Fe!==T._v$4&&C(m,T._v$4=Fe),Lt!==T._v$5&&C(N,T._v$5=Lt),T._v$6=Ze(D,Er,T._v$6),T._v$7=Ze(br,Or,T._v$7),T},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0}),h})(),c.document.body)}),s})}updateAnswer(t,r){this._details=this._details.set(t,r)}}class Bo{constructor(t){this._ele=t}setContent(t){this._ele.setAttribute("title",t)}}class Vu extends Tn{constructor(t,r,n){const i=X(r.querySelectorAll(".item-body .checkboxInput, .item-body .radioInput")).then(o=>Array.from(o)).then(Ur).then(Dt(new Map,(o,[s,u])=>o.set(String.fromCharCode(s+65),new Bo(u)))).exec();super(t,r,o=>{const s=Ir(()=>X(o()).then(Dt(new Map,(u,[f,{answer:a,context:c}])=>{var h;if(a!==void 0)for(let l of a){l=n(l);const _=(h=u.get(l))!=null?h:[];_.push([f,c]),u.set(l,_)}return u})).then(Vt(Pn)).then(Oe).exec());return Un(()=>{X(s()).then(di(([u,f])=>{var a;(a=i.get(u))==null||a.setContent(Jo(f.length,o().size))}))}),()=>W(Nt,{get each(){return s()},children:([u,f])=>(()=>{const a=To.cloneNode(!0),c=a.firstChild,h=c.firstChild,l=c.nextSibling;return w(h,u),w(l,W(Nt,{get each(){return f.sort(xo)},children:([_,d])=>(()=>{const p=ko.cloneNode(!0);return w(p,_),L(()=>C(p,Sr(d==null?void 0:d.state))),p})()})),a})()})})}}class Xu extends Tn{constructor(t,r){const n=X(r.querySelectorAll(".item-body .blank-item-dynamic")).then(Array.from).then(Ur).then(Dt(new Map,(i,[o,s])=>i.set(String.fromCharCode(o+49),new Bo(s)))).exec();super(t,r,i=>{const o=()=>X(i()).then(Dt(new Map,(s,[u,{answer:f,context:a}])=>f===void 0?s:X(f).then(Object.entries).then(Dt(s,(c,[h,l])=>{var p,m;l=l.trim();const _=(p=c.get(h))!=null?p:new Map,d=(m=_.get(l))!=null?m:[];return d.push([u,a]),c.set(h,_.set(l,d))})).exec())).then(_i(([s,u])=>ft(s,X(u).then(Vt(Pn)).then(Oe).exec()))).then(Vt(Pn)).then(Oe).exec();return Un(()=>{X(o()).then(di(([s,u])=>{var a;const f=X(u).then(_i(([c,h])=>ft(c,h.length))).then(Vt(([c,h],[l,_])=>_-h)).then(Gs).exec();(a=n.get(s))==null||a.setContent(f===void 0?"":`(${Jo(f[1],i().size)}) ${f[0]}`)}))}),()=>W(Nt,{get each(){return o()},children:([s,u])=>(()=>{const f=To.cloneNode(!0),a=f.firstChild,c=a.firstChild,h=a.nextSibling;return w(c,`#${s}`),w(h,W(Nt,{each:u,children:([l,_])=>{if(l!=="")return(()=>{const d=Wu.cloneNode(!0),p=d.firstChild,m=p.nextSibling;return w(p,l),w(m,W(Nt,{get each(){return _.sort(xo)},children:([N,I])=>(()=>{const D=ko.cloneNode(!0);return w(D,N),L(()=>C(D,Sr(I==null?void 0:I.state))),D})()})),L(()=>C(p,M.answerDetailFill)),d})()}})),f})()})})}}class Qu extends Tn{constructor(t,r){super(t,r,n=>{const i=Ir(()=>X(n()).then(Vt(Do)).then(Oe).exec());return()=>W(Nt,{get each(){return i()},children:([o,{answer:s,context:u}])=>{var l;const f=s==null?void 0:s.content,a=(l=s==null?void 0:s.attachments)==null?void 0:l.filelist;let c,h;if(f!==void 0&&(c=(()=>{const _=Ku.cloneNode(!0);return _.innerHTML=f,L(()=>C(_,M.answerDetailShortAnswer)),_})()),a!==void 0&&(h=(()=>{const _=Hu.cloneNode(!0);return w(_,W(Nt,{each:a,children:({fileUrl:d,fileName:p})=>(()=>{const m=Yu.cloneNode(!0),N=m.firstChild;return Qe(N,"href",d),w(N,p),m})()})),_})()),!(c===void 0&&h===void 0))return[(()=>{const _=Gu.cloneNode(!0),d=_.firstChild;return w(d,o),L(()=>C(_,Sr(u==null?void 0:u.state))),_})(),c,h]}})})}}const Zu=x("<div><label></label><input></div>"),ta=x('<div><form><div><p><i> *\u66F4\u6539\u8BBE\u7F6E\u540E\u8BF7\u5237\u65B0\u9875\u9762 </i></p><button type="submit"> \u63D0\u4EA4 </button></div></form><div><p><strong> \u529F\u80FD\u7279\u6027\uFF1A </strong></p><ul></ul></div></div>'),ea=x("<li><strong></strong></li>"),ra=x("<div></div>");function Ue(e){const t=Ko(Wo({},e.extra),{name:e.name});return(()=>{const r=Zu.cloneNode(!0),n=r.firstChild,i=n.nextSibling;return w(n,()=>e.title),Cs(i,t,!1,!1),L(o=>{const s=M.settingsEntry,u=e.name;return s!==o._v$&&C(r,o._v$=s),u!==o._v$2&&Qe(n,"for",o._v$2=u),o},{_v$:void 0,_v$2:void 0}),r})()}function na(e){const t={};function r(i){return o=>t[i]=o.currentTarget.value}function n(i){return o=>t[i]=o.currentTarget.checked}return(()=>{const i=ta.cloneNode(!0),o=i.firstChild,s=o.firstChild,u=s.firstChild,f=o.nextSibling,a=f.firstChild,c=a.nextSibling;return o.addEventListener("submit",h=>{h.preventDefault(),Lr.set(t.username),jr.set(t.server),Dr.set(t.syncAnswers),xr.set(t.sortProblems),Jr.set(t.noLeaveCheck),e.onSubmit()}),w(o,W(Ue,{name:"username",title:"\u7528\u6237\u540D",get extra(){return{type:"text",pattern:"^[a-z][a-z0-9_]*$",title:"\u5C0F\u5199\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF",required:!0,value:Lr.get(),onChange:r("username")}}}),s),w(o,W(Ue,{name:"server",title:"\u670D\u52A1\u5668",get extra(){return{type:"url",required:!0,value:jr.get(),onChange:r("server")}}}),s),w(o,W(Ue,{name:"sync_answers",title:"\u540C\u6B65\u7B54\u6848",get extra(){return{type:"checkbox",checked:Dr.get(),onChange:n("syncAnswers")}}}),s),w(o,W(Ue,{name:"sort_problems",title:"\u6392\u5E8F\u9898\u76EE",get extra(){return{type:"checkbox",checked:xr.get(),onChange:n("sortProblems")}}}),s),w(o,W(Ue,{name:"no_leave_check",title:"\u62E6\u622A\u5207\u5C4F\u68C0\u6D4B",get extra(){return{type:"checkbox",checked:Jr.get(),onChange:n("noLeaveCheck")}}}),s),w(c,()=>[["\u540C\u6B65\u7B54\u6848\uFF1A","\u70B9\u51FB\u9898\u76EE\u663E\u793A\u8BE6\u7EC6\u7B54\u6848\uFF0C\u5728\u9009\u9879/\u586B\u7A7A\u5904\u60AC\u505C\u663E\u793A\u7B80\u7565\u7B54\u6848"],["\u6392\u5E8F\u9898\u76EE\uFF1A","\u6839\u636E ID \u5BF9\u9898\u76EE\u548C\u9009\u9879\u8FDB\u884C\u91CD\u65B0\u6392\u5E8F"],["\u62E6\u622A\u5207\u5C4F\u68C0\u6D4B\uFF1A","\u968F\u610F\u5207\u6362\u9875\u9762\u3001\u7A97\u53E3\u4E0D\u4F1A\u88AB\u53D1\u73B0"],["\u62E6\u622A\u4E0A\u4F20\u622A\u56FE\uFF1A","\u4EC5\u5F53\u7528\u6237\u786E\u8BA4\u540E\uFF0C\u624D\u4F1A\u4E0A\u4F20\u622A\u56FE"],["\u62E6\u622A\u5F02\u5E38\u72B6\u6001\uFF1A","\u5373\u4F7F\u672C\u5730\u663E\u793A\u5F02\u5E38\u4E5F\u4E0D\u4F1A\u63A8\u9001\u5230\u670D\u52A1\u5668"]].map(([h,l])=>(()=>{const _=ea.cloneNode(!0),d=_.firstChild;return w(d,h),w(_,l,null),_})())),L(h=>{const l=M.settingsSubmit,_=M.settingsSubmitTip,d=M.about;return l!==h._v$3&&C(s,h._v$3=l),_!==h._v$4&&C(u,h._v$4=_),d!==h._v$5&&C(f,h._v$5=d),h},{_v$3:void 0,_v$4:void 0,_v$5:void 0}),i})()}function ia(){const e=Tr({title:"\u8BBE\u7F6E",width:400,height:300});me(()=>(()=>{const t=ra.cloneNode(!0);return w(t,W(na,{onSubmit:()=>e.close()})),L(()=>C(t,M.mainBody)),t})(),e.document.body)}const oa=x("<style></style>"),sa=x('<div><div><button type="button">\u786E\u8BA4\u4E0A\u4F20</button><span><i>*\u5173\u95ED\u7A97\u53E3\u4EE5\u53D6\u6D88\u4E0A\u4F20</i></span></div><div><img></div></div>');class ua{constructor(t){me(()=>(()=>{const i=oa.cloneNode(!0);return i.textContent=ei,i})(),document.head);const r=document.body.querySelector(".header-title");ni(HTMLElement,r),r.classList.add(M.clickable),r.addEventListener("click",()=>ia());let n=Array.from(document.body.querySelectorAll(".exam-main--body .subject-item"));Pr(n.length===t.length,"number subject items mismatches problems"),this._details=X(n).then(Ys(t)).then(Dt(new Map,(i,[o,s])=>{let u;switch(s.ProblemType){case ct.SingleChoice:case ct.MultipleChoice:case ct.Polling:case ct.Judgement:ri(s.Options,"null choices");const f=s.ProblemType===ct.Judgement?new Map([["true","\u6B63\u786E"],["false","\u9519\u8BEF"]]):X(s.Options).then(Ur).then(Dt(new Map,(a,[c,{key:h}])=>a.set(h,String.fromCharCode(65+c)))).exec();u=new Vu(s.ProblemID,o,a=>{var c;return(c=f.get(a))!=null?c:a});break;case ct.FillBlank:u=new Xu(s.ProblemID,o);break;case ct.ShortAnswer:u=new Qu(s.ProblemID,o);break}return i.set(s.ProblemID,u)})).exec()}updateAnswer({username:t,problem_id:r,result:n,context:i}){var o;(o=this._details.get(r))==null||o.updateAnswer(t,{answer:n,context:i})}updateUI(){this._details.forEach(t=>t.updateUI())}}function aa(e,t){const r=Tr({title:"\u4E0A\u4F20\u56FE\u7247",width:400,height:300});me(()=>(()=>{const n=sa.cloneNode(!0),i=n.firstChild,o=i.firstChild,s=i.nextSibling,u=s.firstChild;return o.addEventListener("click",()=>{r.close(),t()}),Qe(u,"src",e),L(f=>{const a={[M.mainBody]:!0,[M.uploadImg]:!0},c=M.uploadImgConfirm,h=M.uploadImgImage;return f._v$=Ze(n,a,f._v$),c!==f._v$2&&C(i,f._v$2=c),h!==f._v$3&&C(s,f._v$3=h),f},{_v$:void 0,_v$2:void 0,_v$3:void 0}),n})(),r.document.body)}function Uo(e){return e.forEach(t=>{switch(t.ProblemType){case ct.SingleChoice:case ct.MultipleChoice:case ct.Polling:{t.Options.sort((n,i)=>n.key<i.key?-1:1);break}}}),e.sort((t,r)=>t.ProblemID-r.ProblemID),e}function fa(e){return xr.get()===!0&&(e.data.has_problem_dict===!0?e.data.problems=e.data.problems.sort((t,r)=>t.id-r.id).map(t=>(t.problems=Uo(t.problems),t)):e.data.problems=Uo(e.data.problems)),e}function ca(){document.addEventListener("visibilitychange",e=>{e.preventDefault(),e.stopImmediatePropagation()},!0),window.addEventListener("visibilitychange",e=>{e.preventDefault(),e.stopImmediatePropagation()},!0)}async function ha(){Ls(),Jr.get()===!0&&ca(),Ds(function(e){switch(e.pathname){case"/exam_room/show_paper":this.addEventListener("readystatechange",()=>{if(this.readyState==XMLHttpRequest.DONE){const t=JSON.stringify(fa(JSON.parse(this.responseText)));Object.defineProperties(this,{responseText:{get(){return t}}})}}),this.addEventListener("load",()=>{const t=JSON.parse(this.responseText);let r=[];t.data.has_problem_dict===!0?t.data.problems.forEach(o=>{r=r.concat(o.problems)}):r=t.data.problems;const n=new ua(r);Ot.onmessage(o=>{o.forEach(s=>n.updateAnswer(s)),n.updateUI()});const i=parseInt(e.searchParams.get("exam_id"));Ot.login(i,{title:t.data.title,problems:r}),fetch(ii("/exam_room/cache_results",{exam_id:i.toString()}).toString()).then(o=>o.json()).then(o=>o.data.results.forEach(({problem_id:s,result:u})=>Ot.updateAnswer(s,u))).catch(kr)});return;case"/exam_room/answer_problem":return async t=>{var r;if(typeof t=="string"){const n=JSON.parse(t);if("action"in n)switch(n.action){case 1:case 17:break;default:return console.log("intercept action",n),new Promise(()=>{})}else"results"in n&&((r=n.results)==null||r.forEach(({problem_id:i,result:o})=>Ot.updateAnswer(i,o)))}return t};default:return e.hostname==="upload-z1.qiniup.com"?async t=>t instanceof FormData&&t.get("file")instanceof File?new Promise(r=>{const n=new FileReader;n.onload=()=>aa(n.result,()=>r(t)),n.readAsDataURL(t.get("file"))}):t:void 0}}),await Ot.watch(1e4)}ha().catch(console.error)});
