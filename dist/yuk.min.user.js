// ==UserScript==
// @name         yuk-client
// @version      0.3.2
// @author       doge2x
// @icon         https://www.yuketang.cn/static/images/favicon.ico
// @namespace    https://github.com/doge2x/yuk
// @match        https://examination.xuetangx.com/*
// @grant        GM.xmlHttpRequest
// @grant        GM_getValue
// @grant        GM_setValue
// @run-at       document-start
// ==/UserScript==

(()=>{"use strict";var e=[,(e,r,n)=>{n.r(r),n.d(r,{Client:()=>u});var t=n(2),i=n(9),o=n(14),a=function(e,r,n,t){return new(n||(n=Promise))((function(i,o){function a(e){try{c(t.next(e))}catch(e){o(e)}}function u(e){try{c(t.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(a,u)}c((t=t.apply(e,r||[])).next())}))};class u{constructor(){this.onmsg=[],this.queue=new Map;const e=new t.JSONRPCClient((r=>a(this,void 0,void 0,(function*(){const n=o.SERVER.value;void 0!==n&&(yield new Promise(((t,i)=>a(this,void 0,void 0,(function*(){GM.xmlHttpRequest({url:n,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(r),onload:r=>{200===r.status?(e.receive(JSON.parse(r.responseText)),t()):i(new Error(r.statusText))},onerror:e=>i(e.statusText)})})))))}))));this.client=e}watch(e){return a(this,void 0,void 0,(function*(){return new Promise(((r,n)=>{const t=setInterval((()=>{this.sendQueue().catch((e=>{clearInterval(t),alert("与服务器通信异常"),n(e)}))}),e)}))}))}sendQueue(){return a(this,void 0,void 0,(function*(){if(this.queue.size<1||void 0===o.USERNAME.value||void 0===o.SERVER.value||void 0===o.EXAM_ID.value||!1===o.SYNC_ANSWERS.value)return;let e=[...this.queue.values()];if(this.queue.clear(),void 0===o.TOKEN.value){(0,i.devLog)(`login to server: ${o.USERNAME.value}, ${o.EXAM_ID.value}`);const e=yield this.client.request("login",[o.USERNAME.value,o.EXAM_ID.value]);(0,i.devLog)("got token",e),o.TOKEN.value=e}this.postAnswers(o.TOKEN.value,e)}))}postAnswers(e,r){return a(this,void 0,void 0,(function*(){(0,i.devLog)("send answers",r);const n=yield this.client.request("answer_problem",[e,r]);(0,i.devLog)("receive answers",n),this.onmsg.forEach((e=>e(n)))}))}answerProblem(e){return a(this,void 0,void 0,(function*(){e.forEach((e=>{this.queue.set(e.problem_id,e)}))}))}onmessage(e){this.onmsg.push(e)}}},function(e,r,n){var t=this&&this.__createBinding||(Object.create?function(e,r,n,t){void 0===t&&(t=n),Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[n]}})}:function(e,r,n,t){void 0===t&&(t=n),e[t]=r[n]}),i=this&&this.__exportStar||function(e,r){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||t(r,e,n)};Object.defineProperty(r,"__esModule",{value:!0}),i(n(3),r),i(n(4),r),i(n(6),r),i(n(7),r)},function(e,r,n){var t=this&&this.__awaiter||function(e,r,n,t){return new(n||(n=Promise))((function(i,o){function a(e){try{c(t.next(e))}catch(e){o(e)}}function u(e){try{c(t.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(a,u)}c((t=t.apply(e,r||[])).next())}))},i=this&&this.__generator||function(e,r){var n,t,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,t&&(i=2&o[0]?t.return:o[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,o[1])).done)return i;switch(t=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,t=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=r.call(e,a)}catch(e){o=[6,e],t=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.JSONRPCClient=void 0;var o=n(4),a=n(5),u=function(){function e(e,r){this._send=e,this.createID=r,this.idToResolveMap=new Map,this.id=0}return e.prototype._createID=function(){return this.createID?this.createID():++this.id},e.prototype.timeout=function(e,r){var n=this;void 0===r&&(r=function(e){return(0,o.createJSONRPCErrorResponse)(e,a.DefaultErrorCode,"Request timeout")});var t=function(t,i){var o=setTimeout((function(){t.forEach((function(e){var t=n.idToResolveMap.get(e);t&&(n.idToResolveMap.delete(e),t(r(e)))}))}),e);return i().then((function(e){return clearTimeout(o),e}),(function(e){return clearTimeout(o),Promise.reject(e)}))};return{request:function(e,r,i){var o=n._createID();return t([o],(function(){return n.requestWithID(e,r,i,o)}))},requestAdvanced:function(e,r){return function(e,r){var i=(Array.isArray(e)?e:[e]).map((function(e){return e.id})).filter(c);return t(i,(function(){return n.requestAdvanced(e,r)}))}(e,r)}}},e.prototype.request=function(e,r,n){return this.requestWithID(e,r,n,this._createID())},e.prototype.requestWithID=function(e,r,n,a){return t(this,void 0,void 0,(function(){var t,u;return i(this,(function(i){switch(i.label){case 0:return t={jsonrpc:o.JSONRPC,method:e,params:r,id:a},[4,this.requestAdvanced(t,n)];case 1:return void 0===(u=i.sent()).result||u.error?void 0===u.result&&u.error?[2,Promise.reject(new Error(u.error.message))]:[2,Promise.reject(new Error("An unexpected error occurred"))]:[2,u.result]}}))}))},e.prototype.requestAdvanced=function(e,r){var n=this,t=Array.isArray(e);Array.isArray(e)||(e=[e]);var i=e.filter((function(e){return c(e.id)})),u=i.map((function(e){return new Promise((function(r){return n.idToResolveMap.set(e.id,r)}))})),l=Promise.all(u).then((function(e){return t||!e.length?e:e[0]}));return this.send(t?e:e[0],r).then((function(){return l}),(function(e){return i.forEach((function(r){n.receive((0,o.createJSONRPCErrorResponse)(r.id,a.DefaultErrorCode,e&&e.message||"Failed to send a request"))})),l}))},e.prototype.notify=function(e,r,n){this.send({jsonrpc:o.JSONRPC,method:e,params:r},n).then(void 0,(function(){}))},e.prototype.send=function(e,r){return this._send(e,r)},e.prototype.rejectAllPendingRequests=function(e){this.idToResolveMap.forEach((function(r,n){return r((0,o.createJSONRPCErrorResponse)(n,a.DefaultErrorCode,e))})),this.idToResolveMap.clear()},e.prototype.receive=function(e){var r=this;Array.isArray(e)||(e=[e]),e.forEach((function(e){var n=r.idToResolveMap.get(e.id);n&&(r.idToResolveMap.delete(e.id),n(e))}))},e}();r.JSONRPCClient=u;var c=function(e){return null!=e}},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createJSONRPCErrorResponse=r.JSONRPCErrorCode=r.isJSONRPCResponses=r.isJSONRPCResponse=r.isJSONRPCRequests=r.isJSONRPCRequest=r.isJSONRPCID=r.JSONRPC=void 0,r.JSONRPC="2.0";r.isJSONRPCID=function(e){return"string"==typeof e||"number"==typeof e||null===e};r.isJSONRPCRequest=function(e){return e.jsonrpc===r.JSONRPC&&void 0!==e.method&&void 0===e.result&&void 0===e.error};r.isJSONRPCRequests=function(e){return Array.isArray(e)&&e.every(r.isJSONRPCRequest)};r.isJSONRPCResponse=function(e){return e.jsonrpc===r.JSONRPC&&void 0!==e.id&&(void 0!==e.result||void 0!==e.error)};r.isJSONRPCResponses=function(e){return Array.isArray(e)&&e.every(r.isJSONRPCResponse)},function(e){e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError"}(r.JSONRPCErrorCode||(r.JSONRPCErrorCode={}));r.createJSONRPCErrorResponse=function(e,n,t,i){var o={code:n,message:t};return i&&(o.data=i),{jsonrpc:r.JSONRPC,id:e,error:o}}},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.DefaultErrorCode=void 0,r.DefaultErrorCode=0},function(e,r,n){var t=this&&this.__assign||function(){return t=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var i in r=arguments[n])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e},t.apply(this,arguments)},i=this&&this.__awaiter||function(e,r,n,t){return new(n||(n=Promise))((function(i,o){function a(e){try{c(t.next(e))}catch(e){o(e)}}function u(e){try{c(t.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(a,u)}c((t=t.apply(e,r||[])).next())}))},o=this&&this.__generator||function(e,r){var n,t,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,t&&(i=2&o[0]?t.return:o[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,o[1])).done)return i;switch(t=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,t=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=r.call(e,a)}catch(e){o=[6,e],t=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},a=this&&this.__spreadArray||function(e,r,n){if(n||2===arguments.length)for(var t,i=0,o=r.length;i<o;i++)!t&&i in r||(t||(t=Array.prototype.slice.call(r,0,i)),t[i]=r[i]);return e.concat(t||Array.prototype.slice.call(r))};Object.defineProperty(r,"__esModule",{value:!0}),r.JSONRPCServer=void 0;var u=n(4),c=n(5),l=function(e){return(0,u.createJSONRPCErrorResponse)((0,u.isJSONRPCID)(e.id)?e.id:null,u.JSONRPCErrorCode.InvalidRequest,"Invalid Request")},f=function(){function e(e){var r;void 0===e&&(e={}),this.mapErrorToJSONRPCErrorResponse=m,this.nameToMethodDictionary={},this.middleware=null,this.errorListener=null!==(r=e.errorListener)&&void 0!==r?r:console.warn}return e.prototype.addMethod=function(e,r){this.addMethodAdvanced(e,this.toJSONRPCMethod(r))},e.prototype.toJSONRPCMethod=function(e){return function(r,n){var t=e(r.params,n);return Promise.resolve(t).then((function(e){return v(r.id,e)}))}},e.prototype.addMethodAdvanced=function(e,r){var n;this.nameToMethodDictionary=t(t({},this.nameToMethodDictionary),((n={})[e]=r,n))},e.prototype.receiveJSON=function(e,r){var n=this.tryParseRequestJSON(e);return n?this.receive(n,r):Promise.resolve((0,u.createJSONRPCErrorResponse)(null,u.JSONRPCErrorCode.ParseError,"Parse error"))},e.prototype.tryParseRequestJSON=function(e){try{return JSON.parse(e)}catch(e){return null}},e.prototype.receive=function(e,r){return Array.isArray(e)?this.receiveMultiple(e,r):this.receiveSingle(e,r)},e.prototype.receiveMultiple=function(e,r){return i(this,void 0,void 0,(function(){var n,t=this;return o(this,(function(i){switch(i.label){case 0:return[4,Promise.all(e.map((function(e){return t.receiveSingle(e,r)})))];case 1:return 1===(n=i.sent().filter(s)).length?[2,n[0]]:n.length?[2,n]:[2,null]}}))}))},e.prototype.receiveSingle=function(e,r){return i(this,void 0,void 0,(function(){var n,t;return o(this,(function(i){switch(i.label){case 0:return n=this.nameToMethodDictionary[e.method],(0,u.isJSONRPCRequest)(e)?[3,1]:[2,l(e)];case 1:return n?[4,this.callMethod(n,e,r)]:[3,3];case 2:return t=i.sent(),[2,_(e,t)];case 3:return void 0!==e.id?[2,(o=e.id,(0,u.createJSONRPCErrorResponse)(o,u.JSONRPCErrorCode.MethodNotFound,"Method not found"))]:[2,null];case 4:return[2]}var o}))}))},e.prototype.applyMiddleware=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.middleware?this.middleware=this.combineMiddlewares(a([this.middleware],e,!0)):this.middleware=this.combineMiddlewares(e)},e.prototype.combineMiddlewares=function(e){return e.length?e.reduce(this.middlewareReducer):null},e.prototype.middlewareReducer=function(e,r){return function(n,t,i){return e((function(e,t){return r(n,e,t)}),t,i)}},e.prototype.callMethod=function(e,r,n){var t=this,i=function(e){return t.errorListener('An unexpected error occurred while executing "'.concat(r.method,'" JSON-RPC method:'),e),Promise.resolve(t.mapErrorToJSONRPCErrorResponseIfNecessary(r.id,e))};try{return(this.middleware||d)((function(r,n){return e(r,n)}),r,n).then(void 0,i)}catch(e){return i(e)}},e.prototype.mapErrorToJSONRPCErrorResponseIfNecessary=function(e,r){return void 0!==e?this.mapErrorToJSONRPCErrorResponse(e,r):null},e}();r.JSONRPCServer=f;var s=function(e){return null!==e},d=function(e,r,n){return e(r,n)},v=function(e,r){return void 0!==e?{jsonrpc:u.JSONRPC,id:e,result:void 0===r?null:r}:null},m=function(e,r){return(0,u.createJSONRPCErrorResponse)(e,c.DefaultErrorCode,r&&r.message||"An unexpected error occurred")},_=function(e,r){return r||(void 0!==e.id?(0,u.createJSONRPCErrorResponse)(e.id,u.JSONRPCErrorCode.InternalError,"Internal error"):null)}},function(e,r,n){var t=this&&this.__awaiter||function(e,r,n,t){return new(n||(n=Promise))((function(i,o){function a(e){try{c(t.next(e))}catch(e){o(e)}}function u(e){try{c(t.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(a,u)}c((t=t.apply(e,r||[])).next())}))},i=this&&this.__generator||function(e,r){var n,t,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,t&&(i=2&o[0]?t.return:o[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,o[1])).done)return i;switch(t=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,t=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=r.call(e,a)}catch(e){o=[6,e],t=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.JSONRPCServerAndClient=void 0;var o=n(4),a=function(){function e(e,r,n){var t;void 0===n&&(n={}),this.server=e,this.client=r,this.errorListener=null!==(t=n.errorListener)&&void 0!==t?t:console.warn}return e.prototype.applyServerMiddleware=function(){for(var e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];(e=this.server).applyMiddleware.apply(e,r)},e.prototype.addMethod=function(e,r){this.server.addMethod(e,r)},e.prototype.addMethodAdvanced=function(e,r){this.server.addMethodAdvanced(e,r)},e.prototype.timeout=function(e){return this.client.timeout(e)},e.prototype.request=function(e,r,n){return this.client.request(e,r,n)},e.prototype.requestAdvanced=function(e,r){return this.client.requestAdvanced(e,r)},e.prototype.notify=function(e,r,n){this.client.notify(e,r,n)},e.prototype.rejectAllPendingRequests=function(e){this.client.rejectAllPendingRequests(e)},e.prototype.receiveAndSend=function(e,r,n){return t(this,void 0,void 0,(function(){var t,a;return i(this,(function(i){switch(i.label){case 0:return(0,o.isJSONRPCResponse)(e)||(0,o.isJSONRPCResponses)(e)?(this.client.receive(e),[3,4]):[3,1];case 1:return(0,o.isJSONRPCRequest)(e)||(0,o.isJSONRPCRequests)(e)?[4,this.server.receive(e,r)]:[3,3];case 2:return(t=i.sent())?[2,this.client.send(t,n)]:[3,4];case 3:return a="Received an invalid JSON-RPC message",this.errorListener(a,e),[2,Promise.reject(new Error(a))];case 4:return[2]}}))}))},e}();r.JSONRPCServerAndClient=a},(e,r,n)=>{function t(e){return GM_getValue(e)}function i(e,r){GM_setValue(e,{contents:r})}n.r(r),n.d(r,{getValue:()=>t,setValue:()=>i})},(e,r,n)=>{n.r(r),n.d(r,{Map2:()=>a,devLog:()=>o,newURL:()=>l,openWin:()=>c,percent:()=>u});var t=n(10),i=n(13);function o(e,...r){0}class a extends Map{constructor(e){super(),this.def=e}setWith(e,r){var n;super.set(e,r(null!==(n=super.get(e))&&void 0!==n?n:this.def()))}}function u(e){return`${Math.floor(100*e)}%`}function c(e,r){r=null!=r?r:{};const n=window.open(void 0,void 0,Object.entries({location:"no",height:r.height,width:r.width,left:r.left,top:r.top,resizable:"yes",menubar:"no",scrollbars:"yes",status:"no",titlebar:"no",toolbar:"no"}).map((([e,r])=>`${e}=${r}`)).join(","));return window.addEventListener("unload",(()=>n.close())),n.document.head.append(i.default.createElement(i.default.Fragment,null,i.default.createElement("title",null,e),i.default.createElement("style",null,t.default.toString()))),n}function l(e,r){const n=new URL(e,self.location.origin);for(const[e,t]of Object.entries(null!=r?r:{}))n.searchParams.set(e,t);return n}},(e,r,n)=>{n.r(r),n.d(r,{about:()=>_,answerDetail:()=>l,answerDetailShortAnswer:()=>f,clickable:()=>c,default:()=>y,mainBody:()=>u,settings:()=>s,settingsEntry:()=>d,settingsSubmit:()=>v,settingsSubmitTip:()=>m,uploadImg:()=>h,uploadImgConfirm:()=>g,uploadImgImage:()=>p});var t=n(11),i=n.n(t),o=n(12),a=n.n(o)()(i());a.push([e.id,".KtSQfh45DkzY1g4GTjHG {\n  font-size: 0.75rem;\n  opacity: 0.5;\n}\n.nl0fbl1STsJ1E_ijRd86 {\n  cursor: pointer;\n}\n.E2WC5WHEPccqZwiUT6nE p {\n  margin: 0;\n}\n.E2WC5WHEPccqZwiUT6nE ul {\n  margin: 0;\n  padding-left: 1.5rem;\n}\n.E2WC5WHEPccqZwiUT6nE img {\n  height: auto;\n  width: 80%;\n}\n.yZjHuTE6p_FgmbomqPFx {\n  border-style: groove;\n  border-width: thin;\n  margin: 0.2rem;\n  padding: 0.2rem;\n}\n._o1gebpEn7x9Td7Hes6g {\n  display: flex;\n  flex-direction: column;\n}\n.YalNJJWiNdYPl5FzO1a_ {\n  display: flex;\n  flex-direction: row;\n  margin-bottom: 0.5rem;\n  justify-content: space-between;\n  align-items: center;\n}\n.YalNJJWiNdYPl5FzO1a_ label {\n  font-weight: bold;\n}\n.YalNJJWiNdYPl5FzO1a_ input {\n  height: fit-content;\n  text-align: right;\n}\n.GkQ9CK5Dl58odGzSBLOP {\n  display: flex;\n  flex-direction: column;\n  justify-content: end;\n  align-items: end;\n}\n.CY2oPnMnonyamRy15TxZ {\n  margin-bottom: 0.5rem;\n}\n.GkQ9CK5Dl58odGzSBLOP button {\n  cursor: pointer;\n}\n.ssrv8ndZGNgvTL1Osr92 p {\n  margin-bottom: 0.25rem;\n}\n.ssrv8ndZGNgvTL1Osr92 ul {\n  padding-left: 1.5rem;\n  margin: 0 0 0.25rem 0;\n}\n.ssrv8ndZGNgvTL1Osr92 ul li {\n  margin-bottom: 0.25rem;\n}\n.UJVcq5yyVfeOtVL0dWlT {\n  display: flex;\n  flex-direction: column;\n}\n.UJVcq5yyVfeOtVL0dWlT img {\n  width: 100%;\n  height: auto;\n}\n.SB_KxqWR3Sju8ih5VCQj {\n  border-style: groove;\n  border-width: thin;\n  padding: 0.5rem;\n}\n.YM_eQySt5C11IITqy_br {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.5rem;\n}\n",""]);var u="KtSQfh45DkzY1g4GTjHG",c="nl0fbl1STsJ1E_ijRd86",l="E2WC5WHEPccqZwiUT6nE",f="yZjHuTE6p_FgmbomqPFx",s="_o1gebpEn7x9Td7Hes6g",d="YalNJJWiNdYPl5FzO1a_",v="GkQ9CK5Dl58odGzSBLOP",m="CY2oPnMnonyamRy15TxZ",_="ssrv8ndZGNgvTL1Osr92",h="UJVcq5yyVfeOtVL0dWlT",p="SB_KxqWR3Sju8ih5VCQj",g="YM_eQySt5C11IITqy_br";const y=a},e=>{e.exports=function(e){return e[1]}},e=>{e.exports=function(e){var r=[];return r.toString=function(){return this.map((function(r){var n="",t=void 0!==r[5];return r[4]&&(n+="@supports (".concat(r[4],") {")),r[2]&&(n+="@media ".concat(r[2]," {")),t&&(n+="@layer".concat(r[5].length>0?" ".concat(r[5]):""," {")),n+=e(r),t&&(n+="}"),r[2]&&(n+="}"),r[4]&&(n+="}"),n})).join("")},r.i=function(e,n,t,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(t)for(var u=0;u<this.length;u++){var c=this[u][0];null!=c&&(a[c]=!0)}for(var l=0;l<e.length;l++){var f=[].concat(e[l]);t&&a[f[0]]||(void 0!==o&&(void 0===f[5]||(f[1]="@layer".concat(f[5].length>0?" ".concat(f[5]):""," {").concat(f[1],"}")),f[5]=o),n&&(f[2]?(f[1]="@media ".concat(f[2]," {").concat(f[1],"}"),f[2]=n):f[2]=n),i&&(f[4]?(f[1]="@supports (".concat(f[4],") {").concat(f[1],"}"),f[4]=i):f[4]="".concat(i)),r.push(f))}},r}},(e,r,n)=>{function t(e){return Array.isArray(e)?(new Array).concat(...e.map(t)):e instanceof Node?[e]:null==e?[]:[document.createTextNode(String(e))]}function i(e,r){for(const n of r)e.appendChild(n)}function o(e,r){for(const[n,t]of Object.entries(r))n.startsWith("-")?e.style.setProperty(n,t):e.style[n]=t}function a(e,r,...n){r=null!=r?r:{};let a=t(n).concat(t(r.children));if("function"==typeof e)return e(Object.assign(Object.assign({},r),{children:a}));{const n=document.createElement(e);return i(n,a),function(e,r){for(const[n,t]of Object.entries(r))if(void 0!==t)switch(n){case"class":case"className":e.setAttribute("class",t);break;case"style":o(e,t);break;case"dangerouslySetInnerHTML":e.innerHTML=t.__html;break;default:n.startsWith("on")?e.addEventListener(n.slice(2).toLowerCase(),t):n in e?e[n]=t:e.setAttribute(n,t)}}(n,null!=r?r:{}),n}}function u(e){let r=document.createDocumentFragment();return i(r,t(e.children)),r}function c(e){return e instanceof Node?e:null}n.r(r),n.d(r,{Children:()=>l,Fragment:()=>u,createElement:()=>a,default:()=>f,toNode:()=>c});const l={toArray:t},f={createElement:a,Fragment:u}},(e,r,n)=>{n.r(r),n.d(r,{EXAM_ID:()=>s,NO_LEAVE_CHECK:()=>l,SERVER:()=>a,SORT_PROBLEMS:()=>c,SYNC_ANSWERS:()=>u,TOKEN:()=>f,USERNAME:()=>o});var t=n(15);class i{constructor(e){this._value=e}get value(){return this._value.get()}set value(e){this._value.set(e)}}const o=new i(t.Username),a=new i(t.Server),u=new i(t.SyncAnswers),c=new i(t.SortProblems),l=new i(t.NoLeaveCheck),f=new i(t.Token),s=new i(t.ExamId)},(e,r,n)=>{n.r(r),n.d(r,{ExamId:()=>N,GM:()=>u,GMEntry:()=>c,NoLeaveCheck:()=>b,Option2:()=>l,Server:()=>_,SortProblems:()=>O,SyncAnswers:()=>g,Token:()=>A,Username:()=>d});var t=n(8),i=n(16),o=n(21),a=n(19);var u={getValue:function(e){return o.nullable_to_opt(t.getValue(e))},setValue:function(e,r){t.setValue(e,r)}};var c={Make:function(e){var r={contents:{LAZY_DONE:!1,VAL:function(){var r=t.getValue(e.name);return null==r?(t.setValue(e.name,e.init),e.init):o.some(r)}}};return{v:r,get:function(e){return a.force(r.contents)},set:function(n){r.contents=i.from_val(n),t.setValue(e.name,n)}}}};var l={Make:function(e){var r={contents:void 0};return{v:r,get:function(e){return r.contents},set:function(e){r.contents=e}}}},f="username",s={contents:{LAZY_DONE:!1,VAL:function(){var e=t.getValue(f);return null==e?void t.setValue(f,void 0):o.some(e)}}};var d={v:s,get:function(e){return a.force(s.contents)},set:function(e){s.contents=i.from_val(e),t.setValue(f,e)}},v="server",m={contents:{LAZY_DONE:!1,VAL:function(){var e=t.getValue(v);return null==e?void t.setValue(v,void 0):o.some(e)}}};var _={v:m,get:function(e){return a.force(m.contents)},set:function(e){m.contents=i.from_val(e),t.setValue(v,e)}},h="sync_answers",p={contents:{LAZY_DONE:!1,VAL:function(){var e=t.getValue(h);return null==e?(t.setValue(h,true),true):o.some(e)}}};var g={v:p,get:function(e){return a.force(p.contents)},set:function(e){p.contents=i.from_val(e),t.setValue(h,e)}},y="nol_eavecheck",E={contents:{LAZY_DONE:!1,VAL:function(){var e=t.getValue(y);return null==e?(t.setValue(y,true),true):o.some(e)}}};var b={v:E,get:function(e){return a.force(E.contents)},set:function(e){E.contents=i.from_val(e),t.setValue(y,e)}},w="sort_problems",S={contents:{LAZY_DONE:!1,VAL:function(){var e=t.getValue(w);return null==e?(t.setValue(w,false),false):o.some(e)}}};var O={v:S,get:function(e){return a.force(S.contents)},set:function(e){S.contents=i.from_val(e),t.setValue(w,e)}},R={contents:void 0};var A={v:R,get:function(e){return R.contents},set:function(e){R.contents=e}},D={contents:void 0};var N={v:D,get:function(e){return D.contents},set:function(e){D.contents=e}}},(e,r,n)=>{n.r(r),n.d(r,{Undefined:()=>u,force_val:()=>c,from_fun:()=>o,from_val:()=>a,is_val:()=>l,lazy_from_fun:()=>f,lazy_from_val:()=>s,lazy_is_val:()=>d});var t=n(17),i=n(19);function o(e){return{LAZY_DONE:!1,VAL:function(){return t._1(e,void 0)}}}function a(e){return{LAZY_DONE:!0,VAL:e}}var u=i.Undefined,c=i.force_val,l=i.is_val,f=o,s=a,d=i.is_val},(e,r,n)=>{n.r(r),n.d(r,{_1:()=>o,_2:()=>u,_3:()=>l,_4:()=>s,_5:()=>v,_6:()=>_,_7:()=>p,_8:()=>y,__1:()=>a,__2:()=>c,__3:()=>f,__4:()=>d,__5:()=>m,__6:()=>h,__7:()=>g,__8:()=>E,app:()=>i});var t=n(18);function i(e,r){for(;;){var n=r,o=e,a=o.length,u=0===a?1:a,c=u-n.length|0;if(0===c)return o.apply(null,n);if(c>=0)return function(e,r){return function(n){return i(e,r.concat([n]))}}(o,n);r=t.sub(n,u,0|-c),e=o.apply(null,t.sub(n,0,u))}}function o(e,r){var n=e.length;if(1===n)return e(r);switch(n){case 1:return e(r);case 2:return function(n){return e(r,n)};case 3:return function(n,t){return e(r,n,t)};case 4:return function(n,t,i){return e(r,n,t,i)};case 5:return function(n,t,i,o){return e(r,n,t,i,o)};case 6:return function(n,t,i,o,a){return e(r,n,t,i,o,a)};case 7:return function(n,t,i,o,a,u){return e(r,n,t,i,o,a,u)};default:return i(e,[r])}}function a(e){return 1===e.length?e:function(r){return o(e,r)}}function u(e,r,n){var t=e.length;if(2===t)return e(r,n);switch(t){case 1:return i(e(r),[n]);case 2:return e(r,n);case 3:return function(t){return e(r,n,t)};case 4:return function(t,i){return e(r,n,t,i)};case 5:return function(t,i,o){return e(r,n,t,i,o)};case 6:return function(t,i,o,a){return e(r,n,t,i,o,a)};case 7:return function(t,i,o,a,u){return e(r,n,t,i,o,a,u)};default:return i(e,[r,n])}}function c(e){return 2===e.length?e:function(r,n){return u(e,r,n)}}function l(e,r,n,t){var o=e.length;if(3===o)return e(r,n,t);switch(o){case 1:return i(e(r),[n,t]);case 2:return i(e(r,n),[t]);case 3:return e(r,n,t);case 4:return function(i){return e(r,n,t,i)};case 5:return function(i,o){return e(r,n,t,i,o)};case 6:return function(i,o,a){return e(r,n,t,i,o,a)};case 7:return function(i,o,a,u){return e(r,n,t,i,o,a,u)};default:return i(e,[r,n,t])}}function f(e){return 3===e.length?e:function(r,n,t){return l(e,r,n,t)}}function s(e,r,n,t,o){var a=e.length;if(4===a)return e(r,n,t,o);switch(a){case 1:return i(e(r),[n,t,o]);case 2:return i(e(r,n),[t,o]);case 3:return i(e(r,n,t),[o]);case 4:return e(r,n,t,o);case 5:return function(i){return e(r,n,t,o,i)};case 6:return function(i,a){return e(r,n,t,o,i,a)};case 7:return function(i,a,u){return e(r,n,t,o,i,a,u)};default:return i(e,[r,n,t,o])}}function d(e){return 4===e.length?e:function(r,n,t,i){return s(e,r,n,t,i)}}function v(e,r,n,t,o,a){var u=e.length;if(5===u)return e(r,n,t,o,a);switch(u){case 1:return i(e(r),[n,t,o,a]);case 2:return i(e(r,n),[t,o,a]);case 3:return i(e(r,n,t),[o,a]);case 4:return i(e(r,n,t,o),[a]);case 5:return e(r,n,t,o,a);case 6:return function(i){return e(r,n,t,o,a,i)};case 7:return function(i,u){return e(r,n,t,o,a,i,u)};default:return i(e,[r,n,t,o,a])}}function m(e){return 5===e.length?e:function(r,n,t,i,o){return v(e,r,n,t,i,o)}}function _(e,r,n,t,o,a,u){var c=e.length;if(6===c)return e(r,n,t,o,a,u);switch(c){case 1:return i(e(r),[n,t,o,a,u]);case 2:return i(e(r,n),[t,o,a,u]);case 3:return i(e(r,n,t),[o,a,u]);case 4:return i(e(r,n,t,o),[a,u]);case 5:return i(e(r,n,t,o,a),[u]);case 6:return e(r,n,t,o,a,u);case 7:return function(i){return e(r,n,t,o,a,u,i)};default:return i(e,[r,n,t,o,a,u])}}function h(e){return 6===e.length?e:function(r,n,t,i,o,a){return _(e,r,n,t,i,o,a)}}function p(e,r,n,t,o,a,u,c){var l=e.length;if(7===l)return e(r,n,t,o,a,u,c);switch(l){case 1:return i(e(r),[n,t,o,a,u,c]);case 2:return i(e(r,n),[t,o,a,u,c]);case 3:return i(e(r,n,t),[o,a,u,c]);case 4:return i(e(r,n,t,o),[a,u,c]);case 5:return i(e(r,n,t,o,a),[u,c]);case 6:return i(e(r,n,t,o,a,u),[c]);case 7:return e(r,n,t,o,a,u,c);default:return i(e,[r,n,t,o,a,u,c])}}function g(e){return 7===e.length?e:function(r,n,t,i,o,a,u){return p(e,r,n,t,i,o,a,u)}}function y(e,r,n,t,o,a,u,c,l){var f=e.length;if(8===f)return e(r,n,t,o,a,u,c,l);switch(f){case 1:return i(e(r),[n,t,o,a,u,c,l]);case 2:return i(e(r,n),[t,o,a,u,c,l]);case 3:return i(e(r,n,t),[o,a,u,c,l]);case 4:return i(e(r,n,t,o),[a,u,c,l]);case 5:return i(e(r,n,t,o,a),[u,c,l]);case 6:return i(e(r,n,t,o,a,u),[c,l]);case 7:return i(e(r,n,t,o,a,u,c),[l]);default:return i(e,[r,n,t,o,a,u,c,l])}}function E(e){return 8===e.length?e:function(r,n,t,i,o,a,u,c){return y(e,r,n,t,i,o,a,u,c)}}},(e,r,n)=>{function t(e,r,n){for(var t=new Array(n),i=0,o=r;i<n;)t[i]=e[o],i=i+1|0,o=o+1|0;return t}function i(e){var r=function(e,r){for(;;){var n=r,t=e;if(!n)return t;r=n.tl,e=n.hd.length+t|0}}(0,e),n=new Array(r);return function(e,r,n){for(;;){var t=n,i=r;if(!t)return;for(var o=t.hd,a=o.length,u=i,c=0;c<a;)e[u]=o[c],u=u+1|0,c=c+1|0;n=t.tl,r=u}}(n,0,e),n}function o(e,r,n){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};e[r]=n}function a(e,r){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return e[r]}function u(e,r){for(var n=new Array(e),t=0;t<e;++t)n[t]=r;return n}function c(e){for(var r=new Array(e),n=0;n<e;++n)r[n]=0;return r}function l(e,r,n,t,i){if(t<=r)for(var o=0;o<i;++o)n[o+t|0]=e[o+r|0];else for(var a=i-1|0;a>=0;--a)n[a+t|0]=e[a+r|0]}function f(e){return e.slice(0)}n.r(r),n.d(r,{blit:()=>l,concat:()=>i,dup:()=>f,get:()=>a,make:()=>u,make_float:()=>c,set:()=>o,sub:()=>t})},(e,r,n)=>{function t(e){return e.LAZY_DONE}n.r(r),n.d(r,{Undefined:()=>i,force:()=>u,force_val:()=>c,is_val:()=>t});var i=n(20).create("CamlinternalLazy.Undefined");function o(e,r){var n=r();return e.VAL=n,e.LAZY_DONE=!0,n}function a(){throw{RE_EXN_ID:i,Error:new Error}}function u(e){if(e.LAZY_DONE)return e.VAL;var r=e.VAL;e.VAL=a;try{return o(e,r)}catch(r){throw e.VAL=function(){throw r},r}}function c(e){if(e.LAZY_DONE)return e.VAL;var r=e.VAL;return e.VAL=a,o(e,r)}},(e,r,n)=>{n.r(r),n.d(r,{caml_exn_slot_name:()=>a,caml_is_extension:()=>o,create:()=>i,id:()=>t});var t={contents:0};function i(e){return t.contents=t.contents+1|0,e+"/"+t.contents}function o(e){return null!=e&&"string"==typeof e.RE_EXN_ID}function a(e){return e.RE_EXN_ID}},(e,r,n)=>{function t(e){return void 0!==e.BS_PRIVATE_NESTED_SOME_NONE}function i(e){return void 0===e?{BS_PRIVATE_NESTED_SOME_NONE:0}:null!==e&&void 0!==e.BS_PRIVATE_NESTED_SOME_NONE?{BS_PRIVATE_NESTED_SOME_NONE:e.BS_PRIVATE_NESTED_SOME_NONE+1|0}:e}function o(e){return null==e?void 0:i(e)}function a(e){return void 0===e?void 0:i(e)}function u(e){return null===e?void 0:i(e)}function c(e){if(null===e||void 0===e.BS_PRIVATE_NESTED_SOME_NONE)return e;var r=e.BS_PRIVATE_NESTED_SOME_NONE;return 0===r?void 0:{BS_PRIVATE_NESTED_SOME_NONE:r-1|0}}function l(e){return void 0===e?void 0:c(e)}function f(e){return void 0!==e?e.VAL:e}n.r(r),n.d(r,{isNested:()=>t,null_to_opt:()=>u,nullable_to_opt:()=>o,option_get:()=>l,option_unwrap:()=>f,some:()=>i,undefined_to_opt:()=>a,valFromOption:()=>c})},(e,r,n)=>{n.r(r),n.d(r,{hookXHR:()=>i});var t=n(9);function i(e){const r=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(n,i){const o=e.call(this,(0,t.newURL)(i)),a=this.send;this.send=function(e){void 0!==o?o(e).then((e=>{a.call(this,e),this.send=a})).catch(t.devLog):(a.call(this,e),this.send=a)},r.apply(this,arguments)}}},(e,r,n)=>{var t;function i(e){return e===t.SingleChoice||e===t.MultipleChoice||e===t.Polling}n.r(r),n.d(r,{ProblemType:()=>t,isChoice:()=>i}),function(e){e[e.SingleChoice=1]="SingleChoice",e[e.MultipleChoice=2]="MultipleChoice",e[e.Polling=3]="Polling",e[e.FillBlank=4]="FillBlank",e[e.ShortAnswer=5]="ShortAnswer",e[e.Judgement=6]="Judgement"}(t||(t={}))},(e,r,n)=>{n.r(r),n.d(r,{CHOICE_MAP:()=>c,UI:()=>l,showConfirmUpload:()=>f});var t=n(25),i=n(13),o=n(59),a=n(9),u=n(10);const c=new a.Map2((()=>new Map));class l{constructor(e){document.head.append(i.default.createElement("style",null,u.default.toString()));const r=document.body.querySelector(".header-title");r.classList.add(u.clickable),r.addEventListener("click",(()=>{(0,o.showSettings)()}));let n=[];!0===e.data.has_problem_dict?e.data.problems.forEach((e=>{n=n.concat(e.problems)})):n=e.data.problems;const a=new Map;document.body.querySelectorAll(".exam-main--body .subject-item").forEach(((e,r)=>{var i;const o=n[r],u=null!==(i=c.get(o.problem_id))&&void 0!==i?i:new Map;a.set(o.problem_id,new t.Detail(o,e,(e=>{var r;return null!==(r=u.get(e))&&void 0!==r?r:e})))})),this.problems=a}updateAnswer({username:e,problem_id:r,result:n}){var t;null===(t=this.problems.get(r))||void 0===t||t.updateAnswer(e,n)}updateUI(){this.problems.forEach((e=>e.updateUI()))}}function f(e,r){const n=(0,a.openWin)("上传图片",{width:300,height:200});n.document.body.append(i.default.createElement("div",{className:[u.uploadImg,u.mainBody].join(" ")},i.default.createElement("div",{className:[u.uploadImgConfirm].join(" ")},i.default.createElement("button",{"on-click":()=>{r(),n.close()},className:[u.clickable].join(" ")},"确认上传"),i.default.createElement("span",null,i.default.createElement("i",null,"*关闭窗口以取消上传"))),i.default.createElement("div",{className:[u.uploadImgImage].join(" ")},i.default.createElement("img",{src:e}))))}},(e,r,n)=>{n.r(r),n.d(r,{Detail:()=>o});var t=n(26),i=n(23);class o{constructor(e,r,n){let o,a;switch(e.ProblemType){case i.ProblemType.SingleChoice:case i.ProblemType.MultipleChoice:case i.ProblemType.Judgement:case i.ProblemType.Polling:o=t.ChoiceDetail.make(r,n),a=t.ChoiceDetail;break;case i.ProblemType.FillBlank:o=t.BlankDetail.make(r,void 0),a=t.BlankDetail;break;case i.ProblemType.ShortAnswer:o=t.TextDetail.make(r,void 0),a=t.TextDetail}this.updateUI=()=>a.updateUI(o),this.updateAnswer=(e,r)=>a.updateAnswer(o,e,r)}}},(e,r,n)=>{n.r(r),n.d(r,{Answer:()=>p,BlankDetail:()=>N,ChoiceDetail:()=>R,Detail:()=>E,React:()=>{},ReactDOMRe:()=>{},TextDetail:()=>k,Tooltip:()=>y,percent:()=>b,sortByKey:()=>w,style:()=>h});var t=n(17),i=n(27),o=n(29),a=n(46),u=n(52),c=n(30),l=n(53),f=n(34),s=n(21),d=n(54),v=n(56),m=n(10),_=n(58),h=m,p={};function g(e,r){e.ele.setAttribute("title",r)}var y={make:function(e){return{ele:e}},setContent:g};var E={Make:function(e){var r=function(e,r,n){return f.forEach(o.openWin("详细答案",200,300,n,r,void 0),(function(r){var n=r[1];return f.forEach(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:o.joinStrings([h.mainBody,h.answerDetail]," ")},[e.detailHtml])),(function(e){return f.forEach(s.nullable_to_opt(n.body),(function(r){r.appendChild(e)}))}))}))};return{updateAnswer:function(e,r,n){e.detail=d.set(e.detail,r,n)},updateUI:function(r){r.detailHtml=t._2(e.updateUI,r.detail,r.context)},showDetail:r,make:function(n,i){var o={detail:void 0,detailHtml:null,context:t._2(e.make,n,i)};return f.forEach(s.nullable_to_opt(n.querySelector(".item-type")),(function(e){e.classList.add(h.clickable),e.addEventListener("click",(function(n){var t=e.getBoundingClientRect();return r(o,0|t.top,0|t.left)}))})),o}}}};function b(e,r){return String(l.div(Math.imul(e,100),r))+"%"}function w(e){return v.stableSortBy(e,(function(e,r){return a.compare(e[0],r[0])}))}function S(e,r){return{tooltips:c.reduceWithIndex(o.querySelectorAllElements(e,".item-body .checkboxInput, .item-body .radioInput"),void 0,(function(e,r,n){return d.set(e,String.fromCharCode(n+65|0),{ele:r})})),choiceMap:r}}function O(e,r,n){return f.forEach(o.openWin("详细答案",200,300,n,r,void 0),(function(r){var n=r[1];return f.forEach(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:o.joinStrings([h.mainBody,h.answerDetail]," ")},[e.detailHtml])),(function(e){return f.forEach(s.nullable_to_opt(n.body),(function(r){r.appendChild(e)}))}))}))}var R={updateAnswer:function(e,r,n){e.detail=d.set(e.detail,r,n)},updateUI:function(e){var r,n;e.detailHtml=(r=e.detail,n=e.context,c.map(w(c.map(d.toArray(d.reduce(r,void 0,(function(e,r,n){return c.reduce(n,e,(function(e,n){return d.update(e,n,(function(e){return c.concat(f.getWithDefault(e,[]),[r])}))}))}))),(function(e){return[t._1(n.choiceMap,e[0]),e[1]]}))),(function(e){var t=e[1],a=e[0];return f.forEach(d.get(n.tooltips,a),(function(e){return g(e,b(t.length,d.size(r)))})),i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,[a])]),i.createElement(o.UList.make,{children:c.map(_.stableSort(t),(function(e){return i.DOMRe.createDOMElementVariadic("p",void 0,[e])}))})])})))},showDetail:O,make:function(e,r){var n={detail:void 0,detailHtml:null,context:S(e,r)};return f.forEach(s.nullable_to_opt(e.querySelector(".item-type")),(function(e){e.classList.add(h.clickable),e.addEventListener("click",(function(r){var t=e.getBoundingClientRect();return O(n,0|t.top,0|t.left)}))})),n}};function A(e,r){return{tooltips:c.reduceWithIndex(o.querySelectorAllElements(e,".item-body .blank-item-dynamic"),void 0,(function(e,r,n){return d.set(e,String(n+1|0),{ele:r})}))}}function D(e,r,n){return f.forEach(o.openWin("详细答案",200,300,n,r,void 0),(function(r){var n=r[1];return f.forEach(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:o.joinStrings([h.mainBody,h.answerDetail]," ")},[e.detailHtml])),(function(e){return f.forEach(s.nullable_to_opt(n.body),(function(r){r.appendChild(e)}))}))}))}var N={updateAnswer:function(e,r,n){e.detail=d.set(e.detail,r,n)},updateUI:function(e){var r,n;e.detailHtml=(r=e.detail,n=e.context,c.map(w(d.toArray(d.reduce(r,void 0,(function(e,r,n){return c.reduce(w(u.entries(n)),e,(function(e,n){var t=n[1];return d.update(e,n[0],(function(e){return s.some(d.update(f.getWithDefault(e,void 0),t,(function(e){return c.concat(f.getWithDefault(e,[]),[r])})))}))}))})))),(function(e){var t=e[0],a=w(d.toArray(e[1]));return f.forEach(d.get(n.tooltips,t),(function(e){return f.forEach(c.get(v.stableSortBy(c.map(a,(function(e){return[e[0],e[1].length]})),(function(e,r){return r[1]-e[1]|0})),0),(function(n){return g(e,"("+b(n[1],d.size(r))+") "+n[0])}))})),i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,["#"+t])]),i.createElement(o.UList.make,{children:c.map(a,(function(e){return i.createElementVariadic(i.Fragment.make,{children:null},[i.DOMRe.createDOMElementVariadic("p",void 0,[e[0]]),i.createElement(o.UList.make,{children:c.map(_.stableSort(e[1]),(function(e){return i.DOMRe.createDOMElementVariadic("p",void 0,[e])}))})])}))})])})))},showDetail:D,make:function(e,r){var n={detail:void 0,detailHtml:null,context:A(e)};return f.forEach(s.nullable_to_opt(e.querySelector(".item-type")),(function(e){e.classList.add(h.clickable),e.addEventListener("click",(function(r){var t=e.getBoundingClientRect();return D(n,0|t.top,0|t.left)}))})),n}};function M(e,r,n){return f.forEach(o.openWin("详细答案",200,300,n,r,void 0),(function(r){var n=r[1];return f.forEach(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:o.joinStrings([h.mainBody,h.answerDetail]," ")},[e.detailHtml])),(function(e){return f.forEach(s.nullable_to_opt(n.body),(function(r){r.appendChild(e)}))}))}))}var k={updateAnswer:function(e,r,n){e.detail=d.set(e.detail,r,n)},updateUI:function(e){var r;e.detailHtml=(r=e.detail,e.context,c.map(w(d.toArray(r)),(function(e){var r=e[1];return i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,[e[0]])]),f.mapWithDefault(r.content,null,(function(e){return i.DOMRe.createDOMElementVariadic("div",{className:h.answerDetailShortAnswer,dangerouslySetInnerHTML:{__html:e}},[])})),f.mapWithDefault(f.flatMap(r.attachments,(function(e){return e.filelist})),null,(function(e){return i.createElement(o.UList.make,{children:c.map(e,(function(e){return i.DOMRe.createDOMElementVariadic("a",{href:e.fileUrl},[e.fileName])}))})})),i.DOMRe.createDOMElementVariadic("div",void 0,[])])})))},showDetail:M,make:function(e,r){var n={detail:void 0,detailHtml:null,context:void 0};return f.forEach(s.nullable_to_opt(e.querySelector(".item-type")),(function(e){e.classList.add(h.clickable),e.addEventListener("click",(function(r){var t=e.getBoundingClientRect();return M(n,0|t.top,0|t.left)}))})),n}}},(e,r,n)=>{n.r(r),n.d(r,{Children:()=>c,DOMRe:()=>s,Fragment:()=>d,Props:()=>{},createElement:()=>f,createElementVariadic:()=>l,recks:()=>a,toNode:()=>u});var t=n(13),i=n(21),o=n(28),a=t;function u(e){return i.nullable_to_opt(a.toNode(e))}var c={toArray:function(e){return a.Children.toArray(e)}};function l(e,r,n){return o.spliceApply(t.createElement,[e,r,n])}function f(e,r){return t.createElement(e,r)}var s={createDOMElementVariadic:function(e,r,n){return o.spliceApply(t.createElement,[e,void 0!==r?i.valFromOption(r):void 0,n])},createElement:function(e,r,n){return o.spliceApply(t.createElement,[e,void 0!==r?i.valFromOption(r):void 0,n])}};var d={make:function(e){var r=e.children;return a.Fragment({children:r})}}},(e,r,n)=>{n.r(r),n.d(r,{spliceApply:()=>t,spliceObjApply:()=>i});var t=function(e,r){var n,t;t=r.length;var i=[];for(n=0;n<t-1;++n)i.push(r[n]);var o=r[t-1];for(n=0;n<o.length;++n)i.push(o[n]);return e.apply(null,i)},i=function(e,r,n){var t,i;i=n.length;var o=[];for(t=0;t<i-1;++t)o.push(n[t]);var a=n[i-1];for(t=0;t<a.length;++t)o.push(a[t]);return e[r].apply(e,o)}},(e,r,n)=>{n.r(r),n.d(r,{React:()=>{},ReactDOMRe:()=>{},UList:()=>v,joinStrings:()=>s,openWin:()=>m,querySelectorAllElements:()=>d,styleCss:()=>f});var t=n(27),i=n(30),o=n(34),a=n(21),u=n(10),c=n(35),l=n(44),f=u.default;function s(e,r){return i.joinWith(e,r,(function(e){return e}))}function d(e,r){return i.keepMap(Array.prototype.slice.call(e.querySelectorAll(r)),c.ofNode)}var v={make:function(e){var r=e.children;return t.DOMRe.createDOMElementVariadic("ul",void 0,[t.Children.toArray(r).map((function(e){return t.DOMRe.createDOMElementVariadic("li",void 0,[e])}))])}};function m(e,r,n,u,c,s){return o.flatMap(a.nullable_to_opt(window.open("","",i.joinWith([["location","no"],["height",String(r)],["width",String(n)],["left",String(o.getWithDefault(u,0))],["top",String(o.getWithDefault(c,0))]],",",(function(e){return e[0]+"="+e[1]})))),(function(r){return o.map(l.asHtmlDocument(r.document),(function(n){return o.forEach(t.toNode(t.createElementVariadic(t.Fragment.make,{children:null},[t.DOMRe.createDOMElementVariadic("title",void 0,[e]),t.DOMRe.createDOMElementVariadic("style",void 0,[f.toString()])])),(function(e){n.head.appendChild(e)})),[r,n]}))}))}},(e,r,n)=>{n.r(r),n.d(r,{blit:()=>x,blitUnsafe:()=>I,cmp:()=>pe,cmpU:()=>he,concat:()=>A,concatMany:()=>D,eq:()=>_e,eqU:()=>me,every:()=>ae,every2:()=>se,every2U:()=>fe,everyU:()=>oe,fill:()=>k,forEach:()=>P,forEachU:()=>C,forEachWithIndex:()=>K,forEachWithIndexU:()=>z,get:()=>u,getBy:()=>V,getByU:()=>L,getExn:()=>c,getIndexBy:()=>q,getIndexByU:()=>j,joinWith:()=>we,joinWithU:()=>be,keep:()=>B,keepMap:()=>H,keepMapU:()=>F,keepU:()=>J,keepWithIndex:()=>X,keepWithIndexU:()=>W,make:()=>h,makeBy:()=>g,makeByAndShuffle:()=>E,makeByAndShuffleU:()=>y,makeByU:()=>p,map:()=>T,mapU:()=>U,mapWithIndex:()=>Y,mapWithIndexU:()=>G,partition:()=>ye,partitionU:()=>ge,range:()=>b,rangeBy:()=>w,reduce:()=>Q,reduceReverse:()=>ee,reduceReverse2:()=>ne,reduceReverse2U:()=>re,reduceReverseU:()=>$,reduceU:()=>Z,reduceWithIndex:()=>ie,reduceWithIndexU:()=>te,reverse:()=>_,reverseInPlace:()=>m,set:()=>l,setExn:()=>f,shuffle:()=>v,shuffleInPlace:()=>d,slice:()=>N,sliceToEnd:()=>M,some:()=>ce,some2:()=>ve,some2U:()=>de,someU:()=>ue,unzip:()=>Ee,zip:()=>S,zipBy:()=>R,zipByU:()=>O});var t=n(31),i=n(17),o=n(32),a=n(21);function u(e,r){if(r>=0&&r<e.length)return a.some(e[r])}function c(e,r){if(!(r>=0&&r<e.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.ml",27,4],Error:new Error};return e[r]}function l(e,r,n){return r>=0&&r<e.length&&(e[r]=n,!0)}function f(e,r,n){if(!(r>=0&&r<e.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.ml",33,2],Error:new Error};e[r]=n}function s(e,r,n){var t=e[r];e[r]=e[n],e[n]=t}function d(e){for(var r=e.length,n=0;n<r;++n)s(e,n,o.random_int(n,r))}function v(e){var r=e.slice(0);return d(r),r}function m(e){for(var r=e.length,n=0,t=r/2|0;n<t;++n)s(e,0+n|0,((0+r|0)-n|0)-1|0)}function _(e){for(var r=e.length,n=new Array(r),t=0;t<r;++t)n[t]=e[(r-1|0)-t|0];return n}function h(e,r){if(e<=0)return[];for(var n=new Array(e),t=0;t<e;++t)n[t]=r;return n}function p(e,r){if(e<=0)return[];for(var n=new Array(e),t=0;t<e;++t)n[t]=r(t);return n}function g(e,r){return p(e,i.__1(r))}function y(e,r){var n=p(e,r);return d(n),n}function E(e,r){return y(e,i.__1(r))}function b(e,r){var n=r-e|0;if(n<0)return[];for(var t=new Array(n+1|0),i=0;i<=n;++i)t[i]=e+i|0;return t}function w(e,r,n){var t=r-e|0;if(t<0||n<=0)return[];for(var i=1+(t/n|0)|0,o=new Array(i),a=e,u=0;u<i;++u)o[u]=a,a=a+n|0;return o}function S(e,r){for(var n=e.length,t=r.length,i=n<t?n:t,o=new Array(i),a=0;a<i;++a)o[a]=[e[a],r[a]];return o}function O(e,r,n){for(var t=e.length,i=r.length,o=t<i?t:i,a=new Array(o),u=0;u<o;++u)a[u]=n(e[u],r[u]);return a}function R(e,r,n){return O(e,r,i.__2(n))}function A(e,r){for(var n=e.length,t=r.length,i=new Array(n+t|0),o=0;o<n;++o)i[o]=e[o];for(var a=0;a<t;++a)i[n+a|0]=r[a];return i}function D(e){for(var r=e.length,n=0,t=0;t<r;++t)n=n+e[t].length|0;var i=new Array(n);n=0;for(var o=0;o<r;++o)for(var a=e[o],u=0,c=a.length;u<c;++u)i[n]=a[u],n=n+1|0;return i}function N(e,r,n){if(n<=0)return[];var i=e.length,o=r<0?t.caml_int_max(i+r|0,0):r,a=i-o|0,u=a<n?a:n;if(u<=0)return[];for(var c=new Array(u),l=0;l<u;++l)c[l]=e[o+l|0];return c}function M(e,r){for(var n=e.length,i=r<0?t.caml_int_max(n+r|0,0):r,o=n-i|0,a=new Array(o),u=0;u<o;++u)a[u]=e[i+u|0];return a}function k(e,r,n,i){if(!(n<=0)){var o=e.length,a=r<0?t.caml_int_max(o+r|0,0):r,u=o-a|0,c=u<n?u:n;if(!(c<=0))for(var l=a,f=a+c|0;l<f;++l)e[l]=i}}function I(e,r,n,t,i){if(t<=r)for(var o=0;o<i;++o)n[o+t|0]=e[o+r|0];else for(var a=i-1|0;a>=0;--a)n[a+t|0]=e[a+r|0]}function x(e,r,n,i,o){var a=e.length,u=n.length,c=r<0?t.caml_int_max(a+r|0,0):r,l=i<0?t.caml_int_max(u+i|0,0):i,f=t.caml_int_min(o,t.caml_int_min(a-c|0,u-l|0));if(l<=c)for(var s=0;s<f;++s)n[s+l|0]=e[s+c|0];else for(var d=f-1|0;d>=0;--d)n[d+l|0]=e[d+c|0]}function C(e,r){for(var n=0,t=e.length;n<t;++n)r(e[n])}function P(e,r){return C(e,i.__1(r))}function U(e,r){for(var n=e.length,t=new Array(n),i=0;i<n;++i)t[i]=r(e[i]);return t}function T(e,r){return U(e,i.__1(r))}function L(e,r){for(var n,t=e.length,i=0;void 0===n&&i<t;){var o=e[i];r(o)&&(n=a.some(o)),i=i+1|0}return n}function V(e,r){return L(e,i.__1(r))}function j(e,r){for(var n,t=e.length,i=0;void 0===n&&i<t;){r(e[i])&&(n=i),i=i+1|0}return n}function q(e,r){return j(e,i.__1(r))}function J(e,r){for(var n=e.length,t=new Array(n),i=0,o=0;o<n;++o){var a=e[o];r(a)&&(t[i]=a,i=i+1|0)}return t.length=i,t}function B(e,r){return J(e,i.__1(r))}function W(e,r){for(var n=e.length,t=new Array(n),i=0,o=0;o<n;++o){var a=e[o];r(a,o)&&(t[i]=a,i=i+1|0)}return t.length=i,t}function X(e,r){return W(e,i.__2(r))}function F(e,r){for(var n=e.length,t=new Array(n),i=0,o=0;o<n;++o){var u=r(e[o]);void 0!==u&&(t[i]=a.valFromOption(u),i=i+1|0)}return t.length=i,t}function H(e,r){return F(e,i.__1(r))}function z(e,r){for(var n=0,t=e.length;n<t;++n)r(n,e[n])}function K(e,r){return z(e,i.__2(r))}function G(e,r){for(var n=e.length,t=new Array(n),i=0;i<n;++i)t[i]=r(i,e[i]);return t}function Y(e,r){return G(e,i.__2(r))}function Z(e,r,n){for(var t=r,i=0,o=e.length;i<o;++i)t=n(t,e[i]);return t}function Q(e,r,n){return Z(e,r,i.__2(n))}function $(e,r,n){for(var t=r,i=e.length-1|0;i>=0;--i)t=n(t,e[i]);return t}function ee(e,r,n){return $(e,r,i.__2(n))}function re(e,r,n,i){for(var o=n,a=t.caml_int_min(e.length,r.length)-1|0;a>=0;--a)o=i(o,e[a],r[a]);return o}function ne(e,r,n,t){return re(e,r,n,i.__3(t))}function te(e,r,n){for(var t=r,i=0,o=e.length;i<o;++i)t=n(t,e[i],i);return t}function ie(e,r,n){return te(e,r,i.__3(n))}function oe(e,r){for(var n=e.length,t=0;;){var i=t;if(i===n)return!0;if(!r(e[i]))return!1;t=i+1|0}}function ae(e,r){return oe(e,i.__1(r))}function ue(e,r){for(var n=e.length,t=0;;){var i=t;if(i===n)return!1;if(r(e[i]))return!0;t=i+1|0}}function ce(e,r){return ue(e,i.__1(r))}function le(e,r,n,t,i){for(;;){var o=n;if(o===i)return!0;if(!t(e[o],r[o]))return!1;n=o+1|0}}function fe(e,r,n){return le(e,r,0,n,t.caml_int_min(e.length,r.length))}function se(e,r,n){return fe(e,r,i.__2(n))}function de(e,r,n){for(var i=0,o=t.caml_int_min(e.length,r.length);;){var a=i;if(a===o)return!1;if(n(e[a],r[a]))return!0;i=a+1|0}}function ve(e,r,n){return de(e,r,i.__2(n))}function me(e,r,n){var t=e.length;return t===r.length&&le(e,r,0,n,t)}function _e(e,r,n){return me(e,r,i.__2(n))}function he(e,r,n){var t=e.length,i=r.length;if(t>i)return 1;if(t<i)return-1;for(var o=0;;){var a=o;if(a===t)return 0;var u=n(e[a],r[a]);if(0!==u)return u;o=a+1|0}}function pe(e,r,n){return he(e,r,i.__2(n))}function ge(e,r){for(var n=e.length,t=0,i=0,o=new Array(n),a=new Array(n),u=0;u<n;++u){var c=e[u];r(c)?(o[t]=c,t=t+1|0):(a[i]=c,i=i+1|0)}return o.length=t,a.length=i,[o,a]}function ye(e,r){return ge(e,i.__1(r))}function Ee(e){for(var r=e.length,n=new Array(r),t=new Array(r),i=0;i<r;++i){var o=e[i];n[i]=o[0],t[i]=o[1]}return[n,t]}function be(e,r,n){var t=e.length;if(0===t)return"";for(var i=t-1|0,o=0,a="";;){var u=a,c=o;if(c===i)return u+n(e[c]);a=u+(n(e[c])+r),o=c+1|0}}function we(e,r,n){return be(e,r,i.__1(n))}},(e,r,n)=>{function t(e,r){return e<r?-1:e===r?0:1}function i(e,r){return e?r?0:1:r?-1:0}function o(e,r){return e===r?0:e<r?-1:e>r||e==e?1:r==r?-1:0}function a(e,r){return e===r?0:e<r?-1:1}function u(e,r){return e?r:e}function c(e,r){return e<r?e:r}function l(e,r){return e<r?e:r}function f(e,r){return e<r?e:r}function s(e,r){return e<r?e:r}function d(e,r){return e||r}function v(e,r){return e>r?e:r}function m(e,r){return e>r?e:r}function _(e,r){return e>r?e:r}function h(e,r){return e>r?e:r}function p(e,r){return e[1]===r[1]&&e[0]===r[0]}function g(e,r){var n=r[0],t=e[0];return t>n||!(t<n)&&e[1]>=r[1]}function y(e,r){return!p(e,r)}function E(e,r){return!g(e,r)}function b(e,r){return e[0]>r[0]||!(e[0]<r[0])&&e[1]>r[1]}function w(e,r){return!b(e,r)}function S(e,r){return g(e,r)?r:e}function O(e,r){return b(e,r)?e:r}n.r(r),n.d(r,{caml_bool_compare:()=>i,caml_bool_max:()=>d,caml_bool_min:()=>u,caml_float_compare:()=>o,caml_float_max:()=>m,caml_float_min:()=>l,caml_int32_max:()=>h,caml_int32_min:()=>s,caml_int_compare:()=>t,caml_int_max:()=>v,caml_int_min:()=>c,caml_string_compare:()=>a,caml_string_max:()=>_,caml_string_min:()=>f,i64_eq:()=>p,i64_ge:()=>g,i64_gt:()=>b,i64_le:()=>w,i64_lt:()=>E,i64_max:()=>O,i64_min:()=>S,i64_neq:()=>y})},(e,r,n)=>{n.r(r),n.d(r,{ceil:()=>l,ceil_int:()=>o,floor:()=>f,floor_int:()=>u,random_int:()=>c,unsafe_ceil:()=>i,unsafe_floor:()=>a});var t=n(33);function i(e){return Math.ceil(e)}function o(e){return e>t.max?t.max:e<t.min?t.min:Math.ceil(e)}function a(e){return Math.floor(e)}function u(e){return e>t.max?t.max:e<t.min?t.min:Math.floor(e)}function c(e,r){return u(Math.random()*(r-e|0))+e|0}var l=o,f=u},(e,r,n)=>{function t(e,r){return e===r}n.r(r),n.d(r,{equal:()=>t,max:()=>i,min:()=>o});var i=2147483647,o=-2147483648},(e,r,n)=>{n.r(r),n.d(r,{cmp:()=>w,cmpU:()=>b,eq:()=>E,eqU:()=>y,flatMap:()=>_,flatMapU:()=>m,forEach:()=>c,forEachU:()=>u,getExn:()=>l,getWithDefault:()=>h,isNone:()=>g,isSome:()=>p,keep:()=>a,keepU:()=>o,map:()=>v,mapU:()=>d,mapWithDefault:()=>s,mapWithDefaultU:()=>f});var t=n(17),i=n(21);function o(e,r){if(void 0!==e&&r(i.valFromOption(e)))return e}function a(e,r){return o(e,t.__1(r))}function u(e,r){if(void 0!==e)return r(i.valFromOption(e))}function c(e,r){return u(e,t.__1(r))}function l(e){if(void 0!==e)return i.valFromOption(e);throw{RE_EXN_ID:"Not_found",Error:new Error}}function f(e,r,n){return void 0!==e?n(i.valFromOption(e)):r}function s(e,r,n){return f(e,r,t.__1(n))}function d(e,r){if(void 0!==e)return i.some(r(i.valFromOption(e)))}function v(e,r){return d(e,t.__1(r))}function m(e,r){if(void 0!==e)return r(i.valFromOption(e))}function _(e,r){return m(e,t.__1(r))}function h(e,r){return void 0!==e?i.valFromOption(e):r}function p(e){return void 0!==e}function g(e){return void 0===e}function y(e,r,n){return void 0!==e?void 0!==r&&n(i.valFromOption(e),i.valFromOption(r)):void 0===r}function E(e,r,n){return y(e,r,t.__2(n))}function b(e,r,n){return void 0!==e?void 0!==r?n(i.valFromOption(e),i.valFromOption(r)):1:void 0!==r?-1:0}function w(e,r,n){return b(e,r,t.__2(n))}},(e,r,n)=>{n.r(r),n.d(r,{Impl:()=>m,asHtmlElement:()=>v,insertAdjacentElement:()=>h,insertAdjacentHTML:()=>p,insertAdjacentText:()=>g,nodeType:()=>y,ofNode:()=>d});var t=n(21),i=n(36),o=n(37),a=n(39),u=n(40),c=n(41),l=n(38),f=n(42),s=n(43);function d(e){if(0===i.nodeType(e))return t.some(e)}var v=function(e){if(void 0!==window.constructor.name&&/^HTML\w*Element$/.test(e.constructor.name)||/^\[object HTML\w*Element\]$/.test(e.constructor.toString()))return e};function m(e){return{asHtmlElement:v,ofNode:d,insertAdjacentElement:function(e,r,n){e.insertAdjacentElement(o.encodeInsertPosition(r),n)},insertAdjacentHTML:function(e,r,n){e.insertAdjacentHTML(o.encodeInsertPosition(r),n)},insertAdjacentText:function(e,r,n){e.insertAdjacentText(o.encodeInsertPosition(r),n)}}}var _=i.Impl({});function h(e,r,n){e.insertAdjacentElement(o.encodeInsertPosition(r),n)}function p(e,r,n){e.insertAdjacentHTML(o.encodeInsertPosition(r),n)}function g(e,r,n){e.insertAdjacentText(o.encodeInsertPosition(r),n)}l.Impl({}),f.Impl({}),c.Impl({}),s.Impl({}),u.Impl({}),a.Impl({});var y=_.nodeType},(e,r,n)=>{n.r(r),n.d(r,{Impl:()=>i,nodeType:()=>o});var t=n(37);function i(e){return{nodeType:function(e){return t.decodeNodeType(e.nodeType)}}}function o(e){return t.decodeNodeType(e.nodeType)}n(38).Impl({})},(e,r,n)=>{function t(e){return e}function i(e){return e+1>>>0>2?3:e+1|0}function o(e){switch(e){case"BackCompat":return 0;case"CSS1Compat":return 1;default:return 2}}function a(e){switch(e){case 0:return"true";case 1:return"false";case 2:return"inherit";case 3:return""}}function u(e){switch(e){case"false":return 1;case"inherit":return 2;case"true":return 0;default:return 3}}function c(e){if(e>2||e<0)throw{RE_EXN_ID:"Invalid_argument",_1:"invalid deltaMode",Error:new Error};return e}function l(e){switch(e){case 0:return"on";case 1:return"off";case 2:return""}}function f(e){switch(e){case"off":return 1;case"on":return 0;default:return 2}}function s(e){switch(e){case 0:return"ltr";case 1:return"rtl";case 2:return""}}function d(e){switch(e){case"ltr":return 0;case"rtl":return 1;default:return 2}}n.r(r),n.d(r,{EventPhase:()=>v,WhatToShow:()=>w,decodeCompareResult:()=>i,decodeCompatMode:()=>o,decodeContentEditable:()=>u,decodeDeltaMode:()=>c,decodeDesignMode:()=>f,decodeDir:()=>d,decodeNodeType:()=>p,decodePointerType:()=>g,decodeReadyState:()=>y,decodeShadowRootMode:()=>E,decodeVisibilityState:()=>b,encodeCompareHow:()=>t,encodeContentEditable:()=>a,encodeDesignMode:()=>l,encodeDir:()=>s,encodeFilterAction:()=>m,encodeInsertPosition:()=>_,encodeModifierKey:()=>h});var v={decode:function(e){return e>3||e<0?4:e}};function m(e){return e+1|0}function _(e){switch(e){case 0:return"beforebegin";case 1:return"afterbegin";case 2:return"beforeend";case 3:return"afterend"}}function h(e){switch(e){case 0:return"Alt";case 1:return"AltGraph";case 2:return"CapsLock";case 3:return"Control";case 4:return"Fn";case 5:return"FnLock";case 6:return"Hyper";case 7:return"Meta";case 8:return"NumLock";case 9:return"ScrollLock";case 10:return"Shift";case 11:return"Super";case 12:return"Symbol";case 13:return"SymbolLock"}}function p(e){return e>12||e<1?12:e-1|0}function g(e){switch(e){case"mouse":return 0;case"pen":return 1;case"touch|":return 2;default:return 3}}function y(e){switch(e){case"complete":return 2;case"interactive":return 1;case"loading":return 0;default:return 3}}function E(e){switch(e){case"closed":return 1;case"open":return 0;default:throw{RE_EXN_ID:"Invalid_argument",_1:"Unknown shadowRootMode",Error:new Error}}}function b(e){switch(e){case"hidden":return 1;case"prerender":return 2;case"unloaded":return 3;case"visible":return 0;default:return 4}}var w={_All:-1,_Element:1,_Attribute:2,_Text:4,_CDATASection:8,_EntityReference:16,_Entity:32,_ProcessingInstruction:64,_Comment:128,_Document:256,_DocumentType:512,_DocumentFragment:1024,_Notation:2048,many:function e(r){return r?r.hd|e(r.tl):0}}},(e,r,n)=>{function t(e){return{}}n.r(r),n.d(r,{Impl:()=>t})},(e,r,n)=>{function t(e){return{}}n.r(r),n.d(r,{Impl:()=>t})},(e,r,n)=>{function t(e){return{}}n.r(r),n.d(r,{Impl:()=>t})},(e,r,n)=>{function t(e){return{}}n.r(r),n.d(r,{Impl:()=>t})},(e,r,n)=>{function t(e){return{}}n.r(r),n.d(r,{Impl:()=>t})},(e,r,n)=>{function t(e){return{}}n.r(r),n.d(r,{Impl:()=>t})},(e,r,n)=>{n.r(r),n.d(r,{Impl:()=>l,asHtmlDocument:()=>s,compatMode:()=>v,nodeType:()=>_,ofNode:()=>d,visibilityState:()=>m});var t=n(21),i=n(36),o=n(37),a=n(41),u=n(38),c=n(45);function l(e){return{asHtmlDocument:function(e){var r=e.defaultView;if(null!=r){var n=r.HTMLDocument;if(null!=n&&e instanceof n)return e}},ofNode:function(e){if(8===i.nodeType(e))return t.some(e)},compatMode:function(e){return o.decodeCompatMode(e.compatMode)},visibilityState:function(e){return o.decodeVisibilityState(e.visibilityState)}}}var f=i.Impl({});u.Impl({}),c.Impl({}),a.Impl({});var s=function(e){var r=e.defaultView;if(null!=r){var n=r.HTMLDocument;if(null!=n&&e instanceof n)return e}};function d(e){if(8===i.nodeType(e))return t.some(e)}function v(e){return o.decodeCompatMode(e.compatMode)}function m(e){return o.decodeVisibilityState(e.visibilityState)}var _=f.nodeType},(e,r,n)=>{function t(e){return{}}n.r(r),n.d(r,{Impl:()=>t})},(e,r,n)=>{n.r(r),n.d(r,{blit:()=>H,capitalize:()=>W,capitalize_ascii:()=>L,compare:()=>j,concat:()=>d,contains:()=>C,contains_from:()=>x,equal:()=>z,escaped:()=>y,index:()=>b,index_from:()=>O,index_from_opt:()=>R,index_opt:()=>S,init:()=>l,iter:()=>v,iteri:()=>m,lowercase:()=>B,lowercase_ascii:()=>T,make:()=>F,map:()=>_,mapi:()=>h,rcontains_from:()=>P,rindex:()=>D,rindex_from:()=>N,rindex_from_opt:()=>I,rindex_opt:()=>k,split_on_char:()=>q,sub:()=>f,trim:()=>g,uncapitalize:()=>X,uncapitalize_ascii:()=>V,uppercase:()=>J,uppercase_ascii:()=>U});var t=n(31),i=n(47),o=n(17),a=n(49),u=n(51),c=n(50);function l(e,r){return a.bytes_to_string(i.init(e,r))}function f(e,r,n){return a.bytes_to_string(i.sub(a.bytes_of_string(e),r,n))}function s(e,r){if(e>=r)return e;throw{RE_EXN_ID:"Invalid_argument",_1:"String.concat",Error:new Error}}function d(e,r){if(!r)return"";var n=e.length;return a.bytes_to_string(function(e,r,n,t,i){for(;;){var o=i,u=r;if(!o)return e;var c=o.tl,l=o.hd;if(!c)return a.caml_blit_string(l,0,e,u,l.length),e;a.caml_blit_string(l,0,e,u,l.length),a.caml_blit_string(n,0,e,u+l.length|0,t),i=c,r=(u+l.length|0)+t|0}}(a.caml_create_bytes(function(e,r,n){for(;;){var t=n,i=e;if(!t)return i;var o=t.tl,a=t.hd;if(!o)return a.length+i|0;n=o,e=s((a.length+r|0)+i|0,i)}}(0,n,r)),0,e,n,r))}function v(e,r){for(var n=0,t=r.length;n<t;++n)o._1(e,r.charCodeAt(n))}function m(e,r){for(var n=0,t=r.length;n<t;++n)o._2(e,n,r.charCodeAt(n))}function _(e,r){return a.bytes_to_string(i.map(e,a.bytes_of_string(r)))}function h(e,r){return a.bytes_to_string(i.mapi(e,a.bytes_of_string(r)))}function p(e){return e>13||e<9?32===e:11!==e}function g(e){return""===e||!p(e.charCodeAt(0))&&!p(e.charCodeAt(e.length-1|0))?e:a.bytes_to_string(i.trim(a.bytes_of_string(e)))}function y(e){return function(r){for(;;){var n=r;if(n>=e.length)return!1;var t=e.charCodeAt(n);if(t<32)return!0;if(t>92||t<34){if(t>=127)return!0;r=n+1|0}else{if(t>91||t<35)return!0;r=n+1|0}}}(0)?a.bytes_to_string(i.escaped(a.bytes_of_string(e))):e}function E(e,r,n,t){for(;;){var i=n;if(i>=r)throw{RE_EXN_ID:"Not_found",Error:new Error};if(e.charCodeAt(i)===t)return i;n=i+1|0}}function b(e,r){return E(e,e.length,0,r)}function w(e,r,n,t){for(;;){var i=n;if(i>=r)return;if(e.charCodeAt(i)===t)return i;n=i+1|0}}function S(e,r){return w(e,e.length,0,r)}function O(e,r,n){var t=e.length;if(r<0||r>t)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from / Bytes.index_from",Error:new Error};return E(e,t,r,n)}function R(e,r,n){var t=e.length;if(r<0||r>t)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from_opt / Bytes.index_from_opt",Error:new Error};return w(e,t,r,n)}function A(e,r,n){for(;;){var t=r;if(t<0)throw{RE_EXN_ID:"Not_found",Error:new Error};if(e.charCodeAt(t)===n)return t;r=t-1|0}}function D(e,r){return A(e,e.length-1|0,r)}function N(e,r,n){if(r<-1||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from / Bytes.rindex_from",Error:new Error};return A(e,r,n)}function M(e,r,n){for(;;){var t=r;if(t<0)return;if(e.charCodeAt(t)===n)return t;r=t-1|0}}function k(e,r){return M(e,e.length-1|0,r)}function I(e,r,n){if(r<-1||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from_opt / Bytes.rindex_from_opt",Error:new Error};return M(e,r,n)}function x(e,r,n){var t=e.length;if(r<0||r>t)throw{RE_EXN_ID:"Invalid_argument",_1:"String.contains_from / Bytes.contains_from",Error:new Error};try{return E(e,t,r,n),!0}catch(e){var i=c.internalToOCamlException(e);if("Not_found"===i.RE_EXN_ID)return!1;throw i}}function C(e,r){return x(e,0,r)}function P(e,r,n){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rcontains_from / Bytes.rcontains_from",Error:new Error};try{return A(e,r,n),!0}catch(e){var t=c.internalToOCamlException(e);if("Not_found"===t.RE_EXN_ID)return!1;throw t}}function U(e){return a.bytes_to_string(i.uppercase_ascii(a.bytes_of_string(e)))}function T(e){return a.bytes_to_string(i.lowercase_ascii(a.bytes_of_string(e)))}function L(e){return a.bytes_to_string(i.capitalize_ascii(a.bytes_of_string(e)))}function V(e){return a.bytes_to_string(i.uncapitalize_ascii(a.bytes_of_string(e)))}var j=t.caml_string_compare;function q(e,r){for(var n=0,t=r.length,i=r.length-1|0;i>=0;--i)r.charCodeAt(i)===e&&(n={hd:f(r,i+1|0,(t-i|0)-1|0),tl:n},t=i);return{hd:f(r,0,t),tl:n}}function J(e){return a.bytes_to_string(i.uppercase(a.bytes_of_string(e)))}function B(e){return a.bytes_to_string(i.lowercase(a.bytes_of_string(e)))}function W(e){return a.bytes_to_string(i.capitalize(a.bytes_of_string(e)))}function X(e){return a.bytes_to_string(i.uncapitalize(a.bytes_of_string(e)))}var F=u.make,H=i.blit_string;function z(e,r){return e===r}},(e,r,n)=>{n.r(r),n.d(r,{blit:()=>y,blit_string:()=>E,capitalize:()=>ee,capitalize_ascii:()=>P,cat:()=>R,compare:()=>Z,concat:()=>O,contains:()=>G,contains_from:()=>K,copy:()=>s,empty:()=>f,equal:()=>ne,escaped:()=>N,extend:()=>p,fill:()=>g,index:()=>L,index_from:()=>q,index_from_opt:()=>J,index_opt:()=>j,init:()=>l,iter:()=>b,iteri:()=>w,lowercase:()=>$,lowercase_ascii:()=>x,make:()=>c,map:()=>M,mapi:()=>k,of_string:()=>v,rcontains_from:()=>Y,rindex:()=>W,rindex_from:()=>X,rindex_from_opt:()=>z,rindex_opt:()=>H,sub:()=>m,sub_string:()=>_,to_string:()=>d,trim:()=>D,uncapitalize:()=>re,uncapitalize_ascii:()=>U,unsafe_of_string:()=>ie,unsafe_to_string:()=>te,uppercase:()=>Q,uppercase_ascii:()=>I});var t=n(31),i=n(48),o=n(17),a=n(49),u=n(50);function c(e,r){var n=a.caml_create_bytes(e);return a.caml_fill_bytes(n,0,e,r),n}function l(e,r){for(var n=a.caml_create_bytes(e),t=0;t<e;++t)n[t]=o._1(r,t);return n}var f=[];function s(e){var r=e.length,n=a.caml_create_bytes(r);return a.caml_blit_bytes(e,0,n,0,r),n}function d(e){return a.bytes_to_string(s(e))}function v(e){return s(a.bytes_of_string(e))}function m(e,r,n){if(r<0||n<0||r>(e.length-n|0))throw{RE_EXN_ID:"Invalid_argument",_1:"String.sub / Bytes.sub",Error:new Error};var t=a.caml_create_bytes(n);return a.caml_blit_bytes(e,r,t,0,n),t}function _(e,r,n){return a.bytes_to_string(m(e,r,n))}function h(e,r){var n=e+r|0,t=r<0,i=n<0;if(e<0){if(!t)return n;if(i)return n;throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.extend",Error:new Error}}if(t)return n;if(i)throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.extend",Error:new Error};return n}function p(e,r,n){var i=h(h(e.length,r),n),o=a.caml_create_bytes(i),u=r<0?[0|-r,0]:[0,r],c=u[1],l=u[0],f=t.caml_int_min(e.length-l|0,i-c|0);return f>0&&a.caml_blit_bytes(e,l,o,c,f),o}function g(e,r,n,t){if(r<0||n<0||r>(e.length-n|0))throw{RE_EXN_ID:"Invalid_argument",_1:"String.fill / Bytes.fill",Error:new Error};return a.caml_fill_bytes(e,r,n,t)}function y(e,r,n,t,i){if(i<0||r<0||r>(e.length-i|0)||t<0||t>(n.length-i|0))throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.blit",Error:new Error};return a.caml_blit_bytes(e,r,n,t,i)}function E(e,r,n,t,i){if(i<0||r<0||r>(e.length-i|0)||t<0||t>(n.length-i|0))throw{RE_EXN_ID:"Invalid_argument",_1:"String.blit / Bytes.blit_string",Error:new Error};return a.caml_blit_string(e,r,n,t,i)}function b(e,r){for(var n=0,t=r.length;n<t;++n)o._1(e,r[n])}function w(e,r){for(var n=0,t=r.length;n<t;++n)o._2(e,n,r[n])}function S(e,r){if(e>=r)return e;throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.concat",Error:new Error}}function O(e,r){if(!r)return f;for(var n=e.length,t=a.caml_create_bytes(function(e,r,n){for(;;){var t=n,i=e;if(!t)return i;var o=t.tl,a=t.hd;if(!o)return a.length+i|0;n=o,e=S((a.length+r|0)+i|0,i)}}(0,n,r)),i=0,o=r;;){var u=o,c=i;if(!u)return t;var l=u.tl,s=u.hd;if(!l)return a.caml_blit_bytes(s,0,t,c,s.length),t;a.caml_blit_bytes(s,0,t,c,s.length),a.caml_blit_bytes(e,0,t,c+s.length|0,n),o=l,i=(c+s.length|0)+n|0}}function R(e,r){var n=e.length,t=r.length,i=a.caml_create_bytes(n+t|0);return a.caml_blit_bytes(e,0,i,0,n),a.caml_blit_bytes(r,0,i,n,t),i}function A(e){return e>13||e<9?32===e:11!==e}function D(e){for(var r=e.length,n=0;n<r&&A(e[n]);)n=n+1|0;for(var t=r-1|0;t>=n&&A(e[t]);)t=t-1|0;return t>=n?m(e,n,1+(t-n|0)|0):f}function N(e){for(var r=0,n=0,t=e.length;n<t;++n){var i=e[n];r=r+(i>=32?i>92||i<34?i>=127?4:1:i>91||i<35?2:1:i>=11?13!==i?4:2:i>=8?2:4)|0}if(r===e.length)return s(e);var o=a.caml_create_bytes(r);r=0;for(var u=0,c=e.length;u<c;++u){var l=e[u],f=0;if(l>=35)92!==l?l>=127?f=1:o[r]=l:f=2;else if(l>=32)l>=34?f=2:o[r]=l;else if(l>=14)f=1;else switch(l){case 8:o[r]=92,o[r=r+1|0]=98;break;case 9:o[r]=92,o[r=r+1|0]=116;break;case 10:o[r]=92,o[r=r+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:f=1;break;case 13:o[r]=92,o[r=r+1|0]=114}switch(f){case 1:o[r]=92,o[r=r+1|0]=48+(l/100|0)|0,o[r=r+1|0]=48+(l/10|0)%10|0,o[r=r+1|0]=48+l%10|0;break;case 2:o[r]=92,o[r=r+1|0]=l}r=r+1|0}return o}function M(e,r){var n=r.length;if(0===n)return r;for(var t=a.caml_create_bytes(n),i=0;i<n;++i)t[i]=o._1(e,r[i]);return t}function k(e,r){var n=r.length;if(0===n)return r;for(var t=a.caml_create_bytes(n),i=0;i<n;++i)t[i]=o._2(e,i,r[i]);return t}function I(e){return M(i.uppercase_ascii,e)}function x(e){return M(i.lowercase_ascii,e)}function C(e,r){if(0===r.length)return r;var n=s(r);return n[0]=o._1(e,r[0]),n}function P(e){return C(i.uppercase_ascii,e)}function U(e){return C(i.lowercase_ascii,e)}function T(e,r,n,t){for(;;){var i=n;if(i>=r)throw{RE_EXN_ID:"Not_found",Error:new Error};if(e[i]===t)return i;n=i+1|0}}function L(e,r){return T(e,e.length,0,r)}function V(e,r,n,t){for(;;){var i=n;if(i>=r)return;if(e[i]===t)return i;n=i+1|0}}function j(e,r){return V(e,e.length,0,r)}function q(e,r,n){var t=e.length;if(r<0||r>t)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from / Bytes.index_from",Error:new Error};return T(e,t,r,n)}function J(e,r,n){var t=e.length;if(r<0||r>t)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from_opt / Bytes.index_from_opt",Error:new Error};return V(e,t,r,n)}function B(e,r,n){for(;;){var t=r;if(t<0)throw{RE_EXN_ID:"Not_found",Error:new Error};if(e[t]===n)return t;r=t-1|0}}function W(e,r){return B(e,e.length-1|0,r)}function X(e,r,n){if(r<-1||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from / Bytes.rindex_from",Error:new Error};return B(e,r,n)}function F(e,r,n){for(;;){var t=r;if(t<0)return;if(e[t]===n)return t;r=t-1|0}}function H(e,r){return F(e,e.length-1|0,r)}function z(e,r,n){if(r<-1||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from_opt / Bytes.rindex_from_opt",Error:new Error};return F(e,r,n)}function K(e,r,n){var t=e.length;if(r<0||r>t)throw{RE_EXN_ID:"Invalid_argument",_1:"String.contains_from / Bytes.contains_from",Error:new Error};try{return T(e,t,r,n),!0}catch(e){var i=u.internalToOCamlException(e);if("Not_found"===i.RE_EXN_ID)return!1;throw i}}function G(e,r){return K(e,0,r)}function Y(e,r,n){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rcontains_from / Bytes.rcontains_from",Error:new Error};try{return B(e,r,n),!0}catch(e){var t=u.internalToOCamlException(e);if("Not_found"===t.RE_EXN_ID)return!1;throw t}}var Z=a.caml_bytes_compare;function Q(e){return M(i.uppercase,e)}function $(e){return M(i.lowercase,e)}function ee(e){return C(i.uppercase,e)}function re(e){return C(i.lowercase,e)}var ne=a.caml_bytes_equal,te=a.bytes_to_string,ie=a.bytes_of_string},(e,r,n)=>{n.r(r),n.d(r,{chr:()=>i,compare:()=>f,equal:()=>s,escaped:()=>o,lowercase:()=>a,lowercase_ascii:()=>c,uppercase:()=>u,uppercase_ascii:()=>l});var t=n(49);function i(e){if(e<0||e>255)throw{RE_EXN_ID:"Invalid_argument",_1:"Char.chr",Error:new Error};return e}function o(e){var r=0;if(e>=40){if(92===e)return"\\\\";r=e>=127?1:2}else if(e>=32){if(e>=39)return"\\'";r=2}else if(e>=14)r=1;else switch(e){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:r=1;break;case 13:return"\\r"}switch(r){case 1:var n=[0,0,0,0];return n[0]=92,n[1]=48+(e/100|0)|0,n[2]=48+(e/10|0)%10|0,n[3]=48+e%10|0,t.bytes_to_string(n);case 2:var i=[0];return i[0]=e,t.bytes_to_string(i)}}function a(e){return e>=65&&e<=90||e>=192&&e<=214||e>=216&&e<=222?e+32|0:e}function u(e){return e>=97&&e<=122||e>=224&&e<=246||e>=248&&e<=254?e-32|0:e}function c(e){return e>=65&&e<=90?e+32|0:e}function l(e){return e>=97&&e<=122?e-32|0:e}function f(e,r){return e-r|0}function s(e,r){return 0==(e-r|0)}},(e,r,n)=>{function t(e,r,n){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};e[r]=n}function i(e,r){if(r<0||r>=e.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return e[r]}function o(e,r,n,t){if(!(n<=0))for(var i=r,o=n+r|0;i<o;++i)e[i]=t}function a(e){if(e<0)throw{RE_EXN_ID:"Invalid_argument",_1:"String.create",Error:new Error};for(var r=new Array(e),n=0;n<e;++n)r[n]=0;return r}function u(e,r,n,t,i){if(!(i<=0))if(e!==n){var o=e.length-r|0;if(i<=o)for(var a=0;a<i;++a)n[t+a|0]=e[r+a|0];else{for(var u=0;u<o;++u)n[t+u|0]=e[r+u|0];for(var c=o;c<i;++c)n[t+c|0]=0}}else{if(r<t){for(var l=(e.length-t|0)-1|0,f=i-1|0,s=l>f?f:l;s>=0;--s)e[t+s|0]=e[r+s|0];return}if(r<=t)return;for(var d=(e.length-r|0)-1|0,v=i-1|0,m=d>v?v:d,_=0;_<=m;++_)e[t+_|0]=e[r+_|0]}}function c(e){var r=e.length,n="",t=r;if(r<=4096&&r===e.length)return String.fromCharCode.apply(null,e);for(var i=0;t>0;){for(var o=t<1024?t:1024,a=new Array(o),u=0;u<o;++u)a[u]=e[u+i|0];n+=String.fromCharCode.apply(null,a),t=t-o|0,i=i+o|0}return n}function l(e,r,n,t,i){if(!(i<=0)){var o=e.length-r|0;if(i<=o)for(var a=0;a<i;++a)n[t+a|0]=e.charCodeAt(r+a|0);else{for(var u=0;u<o;++u)n[t+u|0]=e.charCodeAt(r+u|0);for(var c=o;c<i;++c)n[t+c|0]=0}}}function f(e){for(var r=e.length,n=new Array(r),t=0;t<r;++t)n[t]=e.charCodeAt(t);return n}function s(e,r,n,t,i){for(;;){var o=n;if(o>=t)return i;var a=e[o],u=r[o];if(a>u)return 1;if(a<u)return-1;n=o+1|0}}function d(e,r){var n=e.length,t=r.length;return n===t?s(e,r,0,n,0):n<t?s(e,r,0,n,-1):s(e,r,0,t,1)}function v(e,r){var n=e.length;if(n!==r.length)return!1;for(var t=0;;){var i=t;if(i===n)return!0;if(e[i]!==r[i])return!1;t=i+1|0}}function m(e,r){return d(e,r)>0}function _(e,r){return d(e,r)>=0}function h(e,r){return d(e,r)<0}function p(e,r){return d(e,r)<=0}n.r(r),n.d(r,{bytes_of_string:()=>f,bytes_to_string:()=>c,caml_blit_bytes:()=>u,caml_blit_string:()=>l,caml_bytes_compare:()=>d,caml_bytes_equal:()=>v,caml_bytes_greaterequal:()=>_,caml_bytes_greaterthan:()=>m,caml_bytes_lessequal:()=>p,caml_bytes_lessthan:()=>h,caml_create_bytes:()=>a,caml_fill_bytes:()=>o,get:()=>i,set:()=>t})},(e,r,n)=>{n.r(r),n.d(r,{$$Error:()=>o,caml_as_js_exn:()=>u,internalToOCamlException:()=>a});var t=n(21),i=n(20),o=i.create("Caml_js_exceptions.Error");function a(e){return i.caml_is_extension(e)?e:{RE_EXN_ID:o,_1:e}}function u(e){if(e.RE_EXN_ID===o)return t.some(e._1)}},(e,r,n)=>{function t(e,r){if(r>=e.length||r<0)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return e.charCodeAt(r)}function i(e,r){return String.fromCharCode(r).repeat(e)}n.r(r),n.d(r,{get:()=>t,make:()=>i})},(e,r,n)=>{n.r(r),n.d(r,{entries:()=>a,fromArray:()=>l,fromList:()=>c,get:()=>i,map:()=>f,unsafeDeleteKey:()=>o,values:()=>u});var t=n(21);function i(e,r){if(r in e)return t.some(e[r])}var o=function(e,r){delete e[r]};function a(e){for(var r=Object.keys(e),n=r.length,t=new Array(n),i=0;i<n;++i){var o=r[i];t[i]=[o,e[o]]}return t}function u(e){for(var r=Object.keys(e),n=r.length,t=new Array(n),i=0;i<n;++i)t[i]=e[r[i]];return t}function c(e){for(var r={},n=e;;){var t=n;if(!t)return r;var i=t.hd;r[i[0]]=i[1],n=t.tl}}function l(e){for(var r={},n=e.length,t=0;t<n;++t){var i=e[t];r[i[0]]=i[1]}return r}function f(e,r){for(var n={},t=Object.keys(r),i=t.length,o=0;o<i;++o){var a=t[o];n[a]=e(r[a])}return n}},(e,r,n)=>{function t(e,r){if(0===r)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return e/r|0}function i(e,r){if(0===r)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return e%r}n.r(r),n.d(r,{div:()=>t,mod_:()=>i})},(e,r,n)=>{n.r(r),n.d(r,{checkInvariantInternal:()=>K,cmp:()=>p,cmpU:()=>h,empty:()=>{},eq:()=>y,eqU:()=>g,every:()=>D,everyU:()=>A,findFirstBy:()=>b,findFirstByU:()=>E,forEach:()=>S,forEachU:()=>w,fromArray:()=>C,get:()=>X,getExn:()=>z,getUndefined:()=>F,getWithDefault:()=>H,has:()=>_,isEmpty:()=>m,keep:()=>Q,keepU:()=>Z,keysToArray:()=>P,map:()=>te,mapU:()=>ne,mapWithKey:()=>oe,mapWithKeyU:()=>ie,maxKey:()=>V,maxKeyUndefined:()=>j,maxUndefined:()=>W,maximum:()=>B,merge:()=>Y,mergeMany:()=>v,mergeU:()=>G,minKey:()=>T,minKeyUndefined:()=>L,minUndefined:()=>J,minimum:()=>q,partition:()=>ee,partitionU:()=>$,reduce:()=>R,reduceU:()=>O,remove:()=>s,removeMany:()=>d,set:()=>u,size:()=>k,some:()=>M,someU:()=>N,split:()=>re,toArray:()=>x,toList:()=>I,update:()=>l,updateU:()=>c,valuesToArray:()=>U});var t=n(17),i=n(21),o=n(55),a=n(57);function u(e,r,n){if(void 0===e)return o.singleton(r,n);var t=e.k;if(r===t)return o.updateValue(e,n);var i=e.v;return r<t?o.bal(u(e.l,r,n),t,i,e.r):o.bal(e.l,t,i,u(e.r,r,n))}function c(e,r,n){if(void 0!==e){var t=e.k;if(r===t){var a=n(i.some(e.v));if(void 0!==a)return o.updateValue(e,i.valFromOption(a));var u=e.l,l=e.r;if(void 0===u)return l;if(void 0===l)return u;var f={contents:l.k},s={contents:l.v},d=o.removeMinAuxWithRef(l,f,s);return o.bal(u,f.contents,s.contents,d)}var v=e.v,m=e.l,_=e.r;if(r<t){var h=c(m,r,n);return m===h?e:o.bal(h,t,v,_)}var p=c(_,r,n);return _===p?e:o.bal(m,t,v,p)}var g=n(void 0);return void 0!==g?o.singleton(r,i.valFromOption(g)):e}function l(e,r,n){return c(e,r,t.__1(n))}function f(e,r){var n=e.k,t=e.l,i=e.r;if(r===n){if(void 0===t)return i;if(void 0===i)return t;var a={contents:i.k},u={contents:i.v},c=o.removeMinAuxWithRef(i,a,u);return o.bal(t,a.contents,u.contents,c)}if(r<n){if(void 0===t)return e;var l=f(t,r);return l===t?e:o.bal(l,n,e.v,i)}if(void 0===i)return e;var s=f(i,r);return o.bal(t,n,e.v,s)}function s(e,r){if(void 0!==e)return f(e,r)}function d(e,r){var n=r.length;if(void 0!==e)for(var t=e,i=0;;){var o=i;if(o>=n)return t;var a=f(t,r[o]);if(void 0===a)return a;i=o+1|0,t=a}}function v(e,r){for(var n=r.length,t=e,i=0;i<n;++i){var o=r[i];t=u(t,o[0],o[1])}return t}var m=o.isEmpty,_=a.has,h=a.cmpU,p=a.cmp,g=a.eqU,y=a.eq,E=o.findFirstByU,b=o.findFirstBy,w=o.forEachU,S=o.forEach,O=o.reduceU,R=o.reduce,A=o.everyU,D=o.every,N=o.someU,M=o.some,k=o.size,I=o.toList,x=o.toArray,C=a.fromArray,P=o.keysToArray,U=o.valuesToArray,T=o.minKey,L=o.minKeyUndefined,V=o.maxKey,j=o.maxKeyUndefined,q=o.minimum,J=o.minUndefined,B=o.maximum,W=o.maxUndefined,X=a.get,F=a.getUndefined,H=a.getWithDefault,z=a.getExn,K=o.checkInvariantInternal,G=a.mergeU,Y=a.merge,Z=o.keepSharedU,Q=o.keepShared,$=o.partitionSharedU,ee=o.partitionShared,re=a.split,ne=o.mapU,te=o.map,ie=o.mapWithKeyU,oe=o.mapWithKey},(e,r,n)=>{n.r(r),n.d(r,{bal:()=>d,balMutate:()=>Re,checkInvariantInternal:()=>te,cmp:()=>me,cmpU:()=>ve,concat:()=>F,concatOrJoin:()=>H,copy:()=>u,create:()=>c,eq:()=>he,eqU:()=>_e,every:()=>j,everyU:()=>V,fillArray:()=>ae,findFirstBy:()=>M,findFirstByU:()=>N,forEach:()=>I,forEachU:()=>k,fromArray:()=>De,fromSortedArrayAux:()=>se,fromSortedArrayRevAux:()=>fe,fromSortedArrayUnsafe:()=>de,get:()=>pe,getExn:()=>ye,getUndefined:()=>ge,getWithDefault:()=>Ee,has:()=>be,isEmpty:()=>A,join:()=>X,keepMap:()=>Y,keepMapU:()=>G,keepShared:()=>K,keepSharedU:()=>z,keysToArray:()=>ce,lengthNode:()=>$,map:()=>C,mapU:()=>x,mapWithKey:()=>U,mapWithKeyU:()=>P,maxKey:()=>p,maxKeyUndefined:()=>g,maxUndefined:()=>O,maximum:()=>S,minKey:()=>m,minKeyUndefined:()=>_,minUndefined:()=>b,minimum:()=>E,partitionShared:()=>Q,partitionSharedU:()=>Z,reduce:()=>L,reduceU:()=>T,removeMinAuxWithRef:()=>R,removeMinAuxWithRootMutate:()=>Ne,singleton:()=>l,size:()=>ee,some:()=>J,someU:()=>q,stackAllLeft:()=>D,toArray:()=>ue,toList:()=>ne,updateMutate:()=>Ae,updateValue:()=>s,valuesToArray:()=>le});var t=n(17),i=n(21),o=n(56);function a(e){return void 0!==e?e.h:0}function u(e){return void 0!==e?{k:e.k,v:e.v,h:e.h,l:u(e.l),r:u(e.r)}:e}function c(e,r,n,t){var i=a(e),o=a(t);return{k:r,v:n,h:i>=o?i+1|0:o+1|0,l:e,r:t}}function l(e,r){return{k:e,v:r,h:1,l:void 0,r:void 0}}function f(e,r){return void 0===r||void 0!==e&&e.h>=r.h}function s(e,r){return e.v===r?e:{k:e.k,v:r,h:e.h,l:e.l,r:e.r}}function d(e,r,n,t){var i=void 0!==e?e.h:0,o=void 0!==t?t.h:0;if(i>(o+2|0)){var u=e.l,l=e.r;return a(u)>=a(l)?c(u,e.k,e.v,c(l,r,n,t)):c(c(u,e.k,e.v,l.l),l.k,l.v,c(l.r,r,n,t))}if(o<=(i+2|0))return{k:r,v:n,h:i>=o?i+1|0:o+1|0,l:e,r:t};var f=t.l,s=t.r;return a(s)>=a(f)?c(c(e,r,n,f),t.k,t.v,s):c(c(e,r,n,f.l),f.k,f.v,c(f.r,t.k,t.v,s))}function v(e){for(;;){var r=e,n=r.l;if(void 0===n)return r.k;e=n}}function m(e){if(void 0!==e)return i.some(v(e))}function _(e){if(void 0!==e)return v(e)}function h(e){for(;;){var r=e,n=r.r;if(void 0===n)return r.k;e=n}}function p(e){if(void 0!==e)return i.some(h(e))}function g(e){if(void 0!==e)return h(e)}function y(e){for(;;){var r=e,n=r.l;if(void 0===n)return[r.k,r.v];e=n}}function E(e){if(void 0!==e)return y(e)}function b(e){if(void 0!==e)return y(e)}function w(e){for(;;){var r=e,n=r.r;if(void 0===n)return[r.k,r.v];e=n}}function S(e){if(void 0!==e)return w(e)}function O(e){if(void 0!==e)return w(e)}function R(e,r,n){var t=e.l;return void 0!==t?d(R(t,r,n),e.k,e.v,e.r):(r.contents=e.k,n.contents=e.v,e.r)}function A(e){return void 0===e}function D(e,r){for(;;){if(void 0===e)return r;r={hd:e,tl:r},e=e.l}}function N(e,r){if(void 0!==e){var n=N(e.l,r);if(void 0!==n)return n;var t=e.k,i=e.v;if(r(t,i))return[t,i];var o=N(e.r,r);return void 0!==o?o:void 0}}function M(e,r){return N(e,t.__2(r))}function k(e,r){for(;;){var n=e;if(void 0===n)return;k(n.l,r),r(n.k,n.v),e=n.r}}function I(e,r){return k(e,t.__2(r))}function x(e,r){if(void 0!==e){var n=x(e.l,r),t=r(e.v),i=x(e.r,r);return{k:e.k,v:t,h:e.h,l:n,r:i}}}function C(e,r){return x(e,t.__1(r))}function P(e,r){if(void 0!==e){var n=e.k,t=P(e.l,r),i=r(n,e.v),o=P(e.r,r);return{k:n,v:i,h:e.h,l:t,r:o}}}function U(e,r){return P(e,t.__2(r))}function T(e,r,n){for(;;){var t=r,i=e;if(void 0===i)return t;var o=i.k,a=i.v,u=i.l,c=i.r;r=n(T(u,t,n),o,a),e=c}}function L(e,r,n){return T(e,r,t.__3(n))}function V(e,r){for(;;){var n=e;if(void 0===n)return!0;if(!r(n.k,n.v))return!1;if(!V(n.l,r))return!1;e=n.r}}function j(e,r){return V(e,t.__2(r))}function q(e,r){for(;;){var n=e;if(void 0===n)return!1;if(r(n.k,n.v))return!0;if(q(n.l,r))return!0;e=n.r}}function J(e,r){return q(e,t.__2(r))}function B(e,r,n){return void 0!==e?d(B(e.l,r,n),e.k,e.v,e.r):l(r,n)}function W(e,r,n){return void 0!==e?d(e.l,e.k,e.v,W(e.r,r,n)):l(r,n)}function X(e,r,n,t){if(void 0===e)return B(t,r,n);if(void 0===t)return W(e,r,n);var i=e.k,o=e.v,a=e.h,u=e.l,l=e.r,f=t.k,s=t.v,v=t.h,m=t.l,_=t.r;return a>(v+2|0)?d(u,i,o,X(l,r,n,t)):v>(a+2|0)?d(X(e,r,n,m),f,s,_):c(e,r,n,t)}function F(e,r){if(void 0===e)return r;if(void 0===r)return e;var n={contents:r.k},t={contents:r.v},i=R(r,n,t);return X(e,n.contents,t.contents,i)}function H(e,r,n,t){return void 0!==n?X(e,r,i.valFromOption(n),t):F(e,t)}function z(e,r){if(void 0!==e){var n=e.k,t=e.v,i=z(e.l,r),o=r(n,t),a=z(e.r,r);return o?X(i,n,t,a):F(i,a)}}function K(e,r){return z(e,t.__2(r))}function G(e,r){if(void 0!==e){var n=e.k,t=e.v,o=G(e.l,r),a=r(n,t),u=G(e.r,r);return void 0!==a?X(o,n,i.valFromOption(a),u):F(o,u)}}function Y(e,r){return G(e,t.__2(r))}function Z(e,r){if(void 0===e)return[void 0,void 0];var n=e.k,t=e.v,i=Z(e.l,r),o=i[1],a=i[0],u=r(n,t),c=Z(e.r,r),l=c[1],f=c[0];return u?[X(a,n,t,f),F(o,l)]:[F(a,f),X(o,n,t,l)]}function Q(e,r){return Z(e,t.__2(r))}function $(e){var r=e.l,n=e.r;return(1+(void 0!==r?$(r):0)|0)+(void 0!==n?$(n):0)|0}function ee(e){return void 0!==e?$(e):0}function re(e,r){for(;;){var n=r,t=e;if(void 0===t)return n;var i=t.k,o=t.v,a=t.l;r={hd:[i,o],tl:re(t.r,n)},e=a}}function ne(e){return re(e,0)}function te(e){for(;;){var r=e;if(void 0===r)return;var n=r.l,t=r.r,i=a(n)-a(t)|0;if(!(i<=2&&i>=-2))throw{RE_EXN_ID:"Assert_failure",_1:["belt_internalAVLtree.ml",373,4],Error:new Error};te(n),e=t}}function ie(e,r,n){for(;;){var t=r,i=e,o=i.k,a=i.l,u=i.r,c=void 0!==a?ie(a,t,n):t;n[c]=o;var l=c+1|0;if(void 0===u)return l;r=l,e=u}}function oe(e,r,n){for(;;){var t=r,i=e,o=i.l,a=i.r,u=void 0!==o?oe(o,t,n):t;n[u]=i.v;var c=u+1|0;if(void 0===a)return c;r=c,e=a}}function ae(e,r,n){for(;;){var t=r,i=e,o=i.l,a=i.k,u=i.r,c=void 0!==o?ae(o,t,n):t;n[c]=[a,i.v];var l=c+1|0;if(void 0===u)return l;r=l,e=u}}function ue(e){if(void 0===e)return[];var r=$(e),n=new Array(r);return ae(e,0,n),n}function ce(e){if(void 0===e)return[];var r=$(e),n=new Array(r);return ie(e,0,n),n}function le(e){if(void 0===e)return[];var r=$(e),n=new Array(r);return oe(e,0,n),n}function fe(e,r,n){switch(n){case 0:return;case 1:var t=e[r];return l(t[0],t[1]);case 2:var i=e[r],o=e[r-1|0],a=i;return{k:o[0],v:o[1],h:2,l:l(a[0],a[1]),r:void 0};case 3:var u=e[r],f=e[r-1|0],s=e[r-2|0],d=f,v=u;return{k:d[0],v:d[1],h:2,l:l(v[0],v[1]),r:l(s[0],s[1])};default:var m=n/2|0,_=fe(e,r,m),h=e[r-m|0],p=fe(e,(r-m|0)-1|0,(n-m|0)-1|0);return c(_,h[0],h[1],p)}}function se(e,r,n){switch(n){case 0:return;case 1:var t=e[r];return l(t[0],t[1]);case 2:var i=e[r],o=e[r+1|0],a=i;return{k:o[0],v:o[1],h:2,l:l(a[0],a[1]),r:void 0};case 3:var u=e[r],f=e[r+1|0],s=e[r+2|0],d=f,v=u;return{k:d[0],v:d[1],h:2,l:l(v[0],v[1]),r:l(s[0],s[1])};default:var m=n/2|0,_=se(e,r,m),h=e[r+m|0],p=se(e,1+(r+m|0)|0,(n-m|0)-1|0);return c(_,h[0],h[1],p)}}function de(e){return se(e,0,e.length)}function ve(e,r,n,t){var i=ee(e),o=ee(r);if(i!==o)return i<o?-1:1;for(var a=D(e,0),u=D(r,0);;){var c=u,l=a;if(!l)return 0;if(!c)return 0;var f=c.hd,s=l.hd,d=n(s.k,f.k);if(0!==d)return d;var v=t(s.v,f.v);if(0!==v)return v;u=D(f.r,c.tl),a=D(s.r,l.tl)}}function me(e,r,n,i){return ve(e,r,n,t.__2(i))}function _e(e,r,n,t){if(ee(e)!==ee(r))return!1;for(var i=D(e,0),o=D(r,0);;){var a=o,u=i;if(!u)return!0;if(!a)return!0;var c=a.hd,l=u.hd;if(0!==n(l.k,c.k)||!t(l.v,c.v))return!1;o=D(c.r,a.tl),i=D(l.r,u.tl)}}function he(e,r,n,i){return _e(e,r,n,t.__2(i))}function pe(e,r,n){for(;;){var t=e;if(void 0===t)return;var o=n(r,t.k);if(0===o)return i.some(t.v);e=o<0?t.l:t.r}}function ge(e,r,n){for(;;){var t=e;if(void 0===t)return;var i=n(r,t.k);if(0===i)return t.v;e=i<0?t.l:t.r}}function ye(e,r,n){for(;;){var t=e;if(void 0===t)throw{RE_EXN_ID:"Not_found",Error:new Error};var i=n(r,t.k);if(0===i)return t.v;e=i<0?t.l:t.r}}function Ee(e,r,n,t){for(;;){var i=e;if(void 0===i)return n;var o=t(r,i.k);if(0===o)return i.v;e=o<0?i.l:i.r}}function be(e,r,n){for(;;){var t=e;if(void 0===t)return!1;var i=n(r,t.k);if(0===i)return!0;e=i<0?t.l:t.r}}function we(e){var r=e.l;e.l=r.r,r.r=e;var n=a(e.l),t=a(e.r);e.h=(n>t?n:t)+1|0;var i=a(r.l),o=e.h;return r.h=(i>o?i:o)+1|0,r}function Se(e){var r=e.r;e.r=r.l,r.l=e;var n=a(e.l),t=a(e.r);e.h=(n>t?n:t)+1|0;var i=a(r.r),o=e.h;return r.h=(i>o?i:o)+1|0,r}function Oe(e){var r=a(e.l),n=a(e.r);return e.h=(r>n?r:n)+1|0,e}function Re(e){var r,n,t=e.l,i=e.r,o=a(t),u=a(i);if(o>(2+u|0))return f(t.l,t.r)?Oe(we(e)):Oe((n=Se((r=e).l),r.l=n,we(r)));if(u>(2+o|0)){var c=i.l;return f(i.r,c)?Oe(Se(e)):Oe(function(e){var r=we(e.r);return e.r=r,Se(e)}(e))}return e.h=(o>u?o:u)+1|0,e}function Ae(e,r,n,t){if(void 0===e)return l(r,n);var i=t(r,e.k);if(0===i)return e.v=n,e;var o=e.l,a=e.r;if(i<0){var u=Ae(o,r,n,t);e.l=u}else e.r=Ae(a,r,n,t);return Re(e)}function De(e,r){var n=e.length;if(0!==n){var t,i=o.strictlySortedLengthU(e,(function(e,n){return r(e[0],n[0])<0}));t=i>=0?se(e,0,i):fe(e,(i=0|-i)-1|0,i);for(var a=i;a<n;++a){var u=e[a];t=Ae(t,u[0],u[1],r)}return t}}function Ne(e,r){var n=r.r,t=r.l;return void 0!==t?(r.l=Ne(e,t),Re(r)):(e.k=r.k,e.v=r.v,n)}},(e,r,n)=>{n.r(r),n.d(r,{$$String:()=>{},Int:()=>{},binarySearchBy:()=>S,binarySearchByU:()=>w,diff:()=>_,diffU:()=>m,intersect:()=>v,intersectU:()=>d,isSorted:()=>c,isSortedU:()=>u,stableSortBy:()=>b,stableSortByU:()=>E,stableSortInPlaceBy:()=>y,stableSortInPlaceByU:()=>g,strictlySortedLength:()=>a,strictlySortedLengthU:()=>o,union:()=>s,unionU:()=>f});var t=n(17),i=n(30);function o(e,r){var n=e.length;if(0===n||1===n)return n;var t=e[0],i=e[1];if(!r(t,i))return r(i,t)?0|-function(e,r,n,t,i){for(;;){var o=n,a=r;if(o>=t)return o;var u=e[o];if(!i(u,a))return o;n=o+1|0,r=u}}(e,i,2,n,r):1;for(var o=i,a=2;;){var u=a,c=o;if(u>=n)return u;var l=e[u];if(!r(c,l))return u;a=u+1|0,o=l}}function a(e,r){return o(e,t.__2(r))}function u(e,r){var n=e.length;if(0===n)return!0;for(var t=0,i=n-1|0;;){var o=t;if(o===i)return!0;if(r(e[o],e[o+1|0])>0)return!1;t=o+1|0}}function c(e,r){return u(e,t.__2(r))}function l(e,r,n,t,o,a,u,c,l){for(var f=r+n|0,s=o+a|0,d=r,v=e[r],m=o,_=t[o],h=c;;){var p=h,g=_,y=m,E=v,b=d;if(l(E,g)<=0){u[p]=E;var w=b+1|0;if(w>=f)return i.blitUnsafe(t,y,u,p+1|0,s-y|0);h=p+1|0,v=e[w],d=w}else{u[p]=g;var S=y+1|0;if(S>=s)return i.blitUnsafe(e,b,u,p+1|0,f-b|0);h=p+1|0,_=t[S],m=S}}}function f(e,r,n,t,o,a,u,c,l){for(var f=r+n|0,s=o+a|0,d=r,v=e[r],m=o,_=t[o],h=c;;){var p=h,g=_,y=m,E=v,b=d,w=l(E,g);if(w<0){u[p]=E;var S=b+1|0,O=p+1|0;if(S<f){h=O,v=e[S],d=S;continue}return i.blitUnsafe(t,y,u,O,s-y|0),(O+s|0)-y|0}if(0!==w){u[p]=g;var R=y+1|0,A=p+1|0;if(!(R<s))return i.blitUnsafe(e,b,u,A,f-b|0),(A+f|0)-b|0;h=A,_=t[R],m=R}else{u[p]=E;var D=b+1|0,N=y+1|0,M=p+1|0;if(!(D<f&&N<s))return D===f?(i.blitUnsafe(t,N,u,M,s-N|0),(M+s|0)-N|0):(i.blitUnsafe(e,D,u,M,f-D|0),(M+f|0)-D|0);h=M,_=t[N],m=N,v=e[D],d=D}}}function s(e,r,n,i,o,a,u,c,l){return f(e,r,n,i,o,a,u,c,t.__2(l))}function d(e,r,n,t,i,o,a,u,c){for(var l=r+n|0,f=i+o|0,s=r,d=e[r],v=i,m=t[i],_=u;;){var h=_,p=v,g=d,y=s,E=c(g,m);if(E<0){var b=y+1|0;if(b>=l)return h;d=e[b],s=b}else if(0!==E){var w=p+1|0;if(w>=f)return h;m=t[w],v=w}else{a[h]=g;var S=y+1|0,O=p+1|0,R=h+1|0;if(!(S<l&&O<f))return R;_=R,m=t[O],v=O,d=e[S],s=S}}}function v(e,r,n,i,o,a,u,c,l){return d(e,r,n,i,o,a,u,c,t.__2(l))}function m(e,r,n,t,o,a,u,c,l){for(var f=r+n|0,s=o+a|0,d=r,v=e[r],m=o,_=t[o],h=c;;){var p=h,g=m,y=v,E=d,b=l(y,_);if(b<0){u[p]=y;var w=p+1|0,S=E+1|0;if(S>=f)return w;h=w,v=e[S],d=S}else if(0!==b){var O=g+1|0;if(!(O<s))return i.blitUnsafe(e,E,u,p,f-E|0),(p+f|0)-E|0;_=t[O],m=O}else{var R=E+1|0,A=g+1|0;if(!(R<f&&A<s))return R===f?p:(i.blitUnsafe(e,R,u,p,f-R|0),(p+f|0)-R|0);_=t[A],m=A,v=e[R],d=R}}}function _(e,r,n,i,o,a,u,c,l){return m(e,r,n,i,o,a,u,c,t.__2(l))}function h(e,r,n,t,i,o){for(var a=0;a<i;++a){for(var u=e[r+a|0],c=(t+a|0)-1|0;c>=t&&o(n[c],u)>0;)n[c+1|0]=n[c],c=c-1|0;n[c+1|0]=u}}function p(e,r,n,t,i,o){if(i<=5)return h(e,r,n,t,i,o);var a=i/2|0,u=i-a|0;return p(e,r+a|0,n,t+a|0,u,o),p(e,r,e,r+u|0,a,o),l(e,r+u|0,a,n,t+a|0,u,n,t,o)}function g(e,r){var n=e.length;if(n<=5)return h(e,0,e,0,n,r);var t=n/2|0,i=n-t|0,o=new Array(i);return p(e,t,o,0,i,r),p(e,0,e,i,t,r),l(e,i,t,o,0,i,e,0,r)}function y(e,r){return g(e,t.__2(r))}function E(e,r){var n=e.slice(0);return g(n,r),n}function b(e,r){return E(e,t.__2(r))}function w(e,r,n){var t=e.length;if(0===t)return-1;if(n(r,e[0])<0)return-1;if(n(r,e[t-1|0])>0)return 0|-(t+1|0);for(var i=0,o=t-1|0;;){var a=o,u=i,c=(u+a|0)/2|0,l=n(r,e[c]);if(0===l)return c;if(l<0){if(a===c)return 0===n(e[u],r)?u:0|-(a+1|0);o=c}else{if(u===c)return 0===n(e[a],r)?a:0|-(a+1|0);i=c}}}function S(e,r,n){return w(e,r,t.__2(n))}},(e,r,n)=>{n.r(r),n.d(r,{A:()=>{},N:()=>{},S:()=>{},add:()=>c,addMutate:()=>R,cmp:()=>b,cmpU:()=>E,compareAux:()=>y,eq:()=>O,eqAux:()=>w,eqU:()=>S,fromArray:()=>A,get:()=>l,getExn:()=>s,getUndefined:()=>f,getWithDefault:()=>d,has:()=>v,merge:()=>g,mergeU:()=>p,remove:()=>m,split:()=>h,splitAux:()=>_});var t=n(31),i=n(17),o=n(21),a=n(56),u=n(55);function c(e,r,n){if(void 0===e)return u.singleton(r,n);var t=e.k;if(r===t)return u.updateValue(e,n);var i=e.v;return r<t?u.bal(c(e.l,r,n),t,i,e.r):u.bal(e.l,t,i,c(e.r,r,n))}function l(e,r){for(;;){var n=e;if(void 0===n)return;var t=n.k;if(r===t)return o.some(n.v);e=r<t?n.l:n.r}}function f(e,r){for(;;){var n=e;if(void 0===n)return;var t=n.k;if(r===t)return n.v;e=r<t?n.l:n.r}}function s(e,r){for(;;){var n=e;if(void 0===n)throw{RE_EXN_ID:"Not_found",Error:new Error};var t=n.k;if(r===t)return n.v;e=r<t?n.l:n.r}}function d(e,r,n){for(;;){var t=e;if(void 0===t)return n;var i=t.k;if(r===i)return t.v;e=r<i?t.l:t.r}}function v(e,r){for(;;){var n=e;if(void 0===n)return!1;var t=n.k;if(r===t)return!0;e=r<t?n.l:n.r}}function m(e,r){if(void 0===e)return e;var n=e.k,t=e.l,i=e.r;if(r!==n)return r<n?u.bal(m(t,r),n,e.v,i):u.bal(t,n,e.v,m(i,r));if(void 0===t)return i;if(void 0===i)return t;var o={contents:i.k},a={contents:i.v},c=u.removeMinAuxWithRef(i,o,a);return u.bal(t,o.contents,a.contents,c)}function _(e,r){var n=r.k,t=r.v,i=r.l,a=r.r;if(e===n)return[i,o.some(t),a];if(e<n){if(void 0===i)return[void 0,void 0,r];var c=_(e,i);return[c[0],c[1],u.join(c[2],n,t,a)]}if(void 0===a)return[r,void 0,void 0];var l=_(e,a);return[u.join(i,n,t,l[0]),l[1],l[2]]}function h(e,r){return void 0!==r?_(e,r):[void 0,void 0,void 0]}function p(e,r,n){if(void 0!==e){if(e.h>=(void 0!==r?r.h:0)){var t=e.k,i=e.v,a=e.l,c=e.r,l=h(t,r);return u.concatOrJoin(p(a,l[0],n),t,n(t,o.some(i),l[1]),p(c,l[2],n))}}else if(void 0===r)return;var f=r.k,s=r.v,d=r.l,v=r.r,m=h(f,e);return u.concatOrJoin(p(m[0],d,n),f,n(f,m[1],o.some(s)),p(m[2],v,n))}function g(e,r,n){return p(e,r,i.__3(n))}function y(e,r,n){for(;;){var i=r,o=e;if(!o)return 0;if(!i)return 0;var a=i.hd,c=o.hd,l=t.caml_string_compare(c.k,a.k);if(0!==l)return l;var f=n(c.v,a.v);if(0!==f)return f;r=u.stackAllLeft(a.r,i.tl),e=u.stackAllLeft(c.r,o.tl)}}function E(e,r,n){var t=u.size(e),i=u.size(r);return t===i?y(u.stackAllLeft(e,0),u.stackAllLeft(r,0),n):t<i?-1:1}function b(e,r,n){return E(e,r,i.__2(n))}function w(e,r,n){for(;;){var t=r,i=e;if(!i)return!0;if(!t)return!0;var o=t.hd,a=i.hd;if(a.k!==o.k||!n(a.v,o.v))return!1;r=u.stackAllLeft(o.r,t.tl),e=u.stackAllLeft(a.r,i.tl)}}function S(e,r,n){return u.size(e)===u.size(r)&&w(u.stackAllLeft(e,0),u.stackAllLeft(r,0),n)}function O(e,r,n){return S(e,r,i.__2(n))}function R(e,r,n){if(void 0===e)return u.singleton(r,n);var t=e.k;if(r===t)return e.k=r,e.v=n,e;var i=e.l,o=e.r;if(r<t){var a=R(i,r,n);e.l=a}else e.r=R(o,r,n);return u.balMutate(e)}function A(e){var r=e.length;if(0!==r){var n,t=a.strictlySortedLengthU(e,(function(e,r){return e[0]<r[0]}));t>=0?n=u.fromSortedArrayAux(e,0,t):(t=0|-t,n=u.fromSortedArrayRevAux(e,t-1|0,t));for(var i=t;i<r;++i){var o=e[i];n=R(n,o[0],o[1])}return n}}},(e,r,n)=>{n.r(r),n.d(r,{binarySearch:()=>m,diff:()=>l,intersect:()=>c,isSorted:()=>o,stableSort:()=>v,stableSortInPlace:()=>d,strictlySortedLength:()=>i,union:()=>u});var t=n(30);function i(e){var r=e.length;if(0===r||1===r)return r;var n=e[0],t=e[1];if(!(n<t))return n>t?0|-function(e,r,n,t){for(;;){var i=n,o=r;if(i>=t)return i;var a=e[i];if(o<=a)return i;n=i+1|0,r=a}}(e,t,2,r):1;for(var i=t,o=2;;){var a=o,u=i;if(a>=r)return a;var c=e[a];if(u>=c)return a;o=a+1|0,i=c}}function o(e){var r=e.length;if(0===r)return!0;for(var n=0,t=r-1|0;;){var i=n;if(i===t)return!0;if(e[i]>e[i+1|0])return!1;n=i+1|0}}function a(e,r,n,i,o,a,u,c){for(var l=r+n|0,f=o+a|0,s=r,d=e[r],v=o,m=i[o],_=c;;){var h=_,p=m,g=v,y=d,E=s;if(y<=p){u[h]=y;var b=E+1|0;if(b>=l)return t.blitUnsafe(i,g,u,h+1|0,f-g|0);_=h+1|0,d=e[b],s=b}else{u[h]=p;var w=g+1|0;if(w>=f)return t.blitUnsafe(e,E,u,h+1|0,l-E|0);_=h+1|0,m=i[w],v=w}}}function u(e,r,n,i,o,a,u,c){for(var l=r+n|0,f=o+a|0,s=r,d=e[r],v=o,m=i[o],_=c;;){var h=_,p=m,g=v,y=d,E=s;if(y<p){u[h]=y;var b=E+1|0,w=h+1|0;if(b<l){_=w,d=e[b],s=b;continue}return t.blitUnsafe(i,g,u,w,f-g|0),(w+f|0)-g|0}if(y!==p){u[h]=p;var S=g+1|0,O=h+1|0;if(!(S<f))return t.blitUnsafe(e,E,u,O,l-E|0),(O+l|0)-E|0;_=O,m=i[S],v=S}else{u[h]=y;var R=E+1|0,A=g+1|0,D=h+1|0;if(!(R<l&&A<f))return R===l?(t.blitUnsafe(i,A,u,D,f-A|0),(D+f|0)-A|0):(t.blitUnsafe(e,R,u,D,l-R|0),(D+l|0)-R|0);_=D,m=i[A],v=A,d=e[R],s=R}}}function c(e,r,n,t,i,o,a,u){for(var c=r+n|0,l=i+o|0,f=r,s=e[r],d=i,v=t[i],m=u;;){var _=m,h=v,p=d,g=s,y=f;if(g<h){var E=y+1|0;if(E>=c)return _;s=e[E],f=E}else if(g!==h){var b=p+1|0;if(b>=l)return _;v=t[b],d=b}else{a[_]=g;var w=y+1|0,S=p+1|0,O=_+1|0;if(!(w<c&&S<l))return O;m=O,v=t[S],d=S,s=e[w],f=w}}}function l(e,r,n,i,o,a,u,c){for(var l=r+n|0,f=o+a|0,s=r,d=e[r],v=o,m=i[o],_=c;;){var h=_,p=m,g=v,y=d,E=s;if(y<p){u[h]=y;var b=h+1|0,w=E+1|0;if(w>=l)return b;_=b,d=e[w],s=w}else if(y!==p){var S=g+1|0;if(!(S<f))return t.blitUnsafe(e,E,u,h,l-E|0),(h+l|0)-E|0;m=i[S],v=S}else{var O=E+1|0,R=g+1|0;if(!(O<l&&R<f))return O===l?h:(t.blitUnsafe(e,O,u,h,l-O|0),(h+l|0)-O|0);m=i[R],v=R,d=e[O],s=O}}}function f(e,r,n,t,i){for(var o=0;o<i;++o){for(var a=e[r+o|0],u=(t+o|0)-1|0;u>=t&&n[u]>a;)n[u+1|0]=n[u],u=u-1|0;n[u+1|0]=a}}function s(e,r,n,t,i){if(i<=5)return f(e,r,n,t,i);var o=i/2|0,u=i-o|0;return s(e,r+o|0,n,t+o|0,u),s(e,r,e,r+u|0,o),a(e,r+u|0,o,n,t+o|0,u,n,t)}function d(e){var r=e.length;if(r<=5)return f(e,0,e,0,r);var n=r/2|0,t=r-n|0,i=new Array(t);return s(e,n,i,0,t),s(e,0,e,t,n),a(e,t,n,i,0,t,e,0)}function v(e){var r=e.slice(0);return d(r),r}function m(e,r){var n=e.length;if(0===n)return-1;if(r<e[0])return-1;if(r>e[n-1|0])return 0|-(n+1|0);for(var t=0,i=n-1|0;;){var o=i,a=t,u=(a+o|0)/2|0,c=e[u];if(r===c)return u;if(r<c){if(o===u)return e[a]===r?a:0|-(o+1|0);i=u}else{if(a===u)return e[o]===r?o:0|-(o+1|0);t=u}}}},(e,r,n)=>{n.r(r),n.d(r,{Entries:()=>m,React:()=>{},ReactDOMRe:()=>{},Settings:()=>h,showSettings:()=>p,style:()=>d});var t=n(17),i=n(27),o=n(29),a=n(15),u=n(30),c=n(34),l=n(21),f=n(10),s=n(60),d=f;function v(e){var r=u.reduce(e,[[],[]],(function(e,r){var n,o=r.ty,a=r.title,f=r.name;if(0===o.TAG){var v=o._0,m=v.onSubmit;n=["text",v.value,void 0,v.pattern,!0,function(e){return t._1(m,e.value)}]}else{var _=o._0,h=_.onSubmit;n=["checkbox",void 0,_.checked,void 0,!1,function(e){return t._1(h,e.checked)}]}var p=n[5],g={title:a,name:f,required:n[4],type:n[0]},y=n[2];void 0!==y&&(g.checked=l.valFromOption(y));var E=n[3];void 0!==E&&(g.pattern=l.valFromOption(E));var b=n[1];void 0!==b&&(g.value=l.valFromOption(b));var w=i.DOMRe.createDOMElementVariadic("input",l.some(g),[]);return[u.concat(e[0],[i.DOMRe.createDOMElementVariadic("div",{className:d.settingsEntry},[i.DOMRe.createDOMElementVariadic("label",{htmlFor:f},[a]),w])]),u.concat(e[1],[function(e){return c.forEach(c.flatMap(i.toNode(w),s.ofNode),p)}])]})),n=r[1];return[r[0],function(e){return u.forEach(n,(function(e){return t._1(e,void 0)}))}]}var m={make:v};function _(e){var r=e.onSubmit,n=v([{name:"username",title:"用户名",ty:{TAG:0,_0:{value:a.Username.get(void 0),pattern:"[a-z][_a-z0-9]*",onSubmit:function(e){return a.Username.set(e)}}}},{name:"server",title:"服务器",ty:{TAG:0,_0:{value:a.Server.get(void 0),pattern:"https?://.+",onSubmit:function(e){return a.Server.set(e)}}}},{name:"sync_answers",title:"同步答案",ty:{TAG:1,_0:{checked:a.SyncAnswers.get(void 0),onSubmit:function(e){return a.SyncAnswers.set(e)}}}},{name:"sort_problems",title:"排序答案",ty:{TAG:1,_0:{checked:a.SortProblems.get(void 0),onSubmit:function(e){return a.SortProblems.set(e)}}}},{name:"no_leave_check",title:"拦截切屏检测",ty:{TAG:1,_0:{checked:a.NoLeaveCheck.get(void 0),onSubmit:function(e){return a.NoLeaveCheck.set(e)}}}}]),u=n[1],c=function(e){var r=e.title,n=e.content;return i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,[r]),n])};return i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("form",{onSubmit:function(e){return e.preventDefault(),t._1(r,void 0),t._1(u,void 0)}},[i.DOMRe.createDOMElementVariadic("div",void 0,[n[0]]),i.DOMRe.createDOMElementVariadic("div",{className:d.settingsSubmit},[i.DOMRe.createDOMElementVariadic("div",{className:d.settingsSubmitTip},[i.DOMRe.createDOMElementVariadic("i",void 0,["*更改设置后请刷新页面"])]),i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("button",void 0,["提交"])])])]),i.DOMRe.createDOMElementVariadic("div",{className:d.about},[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,["功能特性："])]),i.createElementVariadic(o.UList.make,{children:null},[i.createElement(c,{title:"同步答案：",content:"点击题目显示详细答案，在选项/填空处悬停显示简略答案"}),i.createElement(c,{title:"排序题目：",content:"根据 ID 对题目和选项进行重新排序"}),i.createElement(c,{title:"拦截切屏检测：",content:"随意切换页面、窗口不会被发现"}),i.createElement(c,{title:"拦截上传截图：",content:"仅当用户确认后，才会上传截图"}),i.createElement(c,{title:"拦截异常状态：",content:"即使本地显示异常也不会推送到服务器"})])])])}var h={make:_};function p(e){return c.map(o.openWin("设置",300,400,void 0,void 0,void 0),(function(e){var r=e[0];return c.map(l.nullable_to_opt(e[1].body),(function(e){return c.map(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:o.joinStrings([d.mainBody,d.settings]," ")},[i.createElement(_,{onSubmit:function(e){r.close()}})])),(function(r){e.appendChild(r)}))}))}))}},(e,r,n)=>{n.r(r),n.d(r,{Impl:()=>c,asHtmlElement:()=>h,contentEditable:()=>s,dir:()=>v,insertAdjacentElement:()=>g,insertAdjacentHTML:()=>y,insertAdjacentText:()=>E,nodeType:()=>_,ofElement:()=>b,ofNode:()=>p,setContentEditable:()=>d,setDir:()=>m});var t=n(36),i=n(37),o=n(35),a=n(38),u=n(42);function c(e){return{ofElement:o.asHtmlElement,contentEditable:function(e){return i.decodeContentEditable(e.contentEditable)},setContentEditable:function(e,r){e.contentEditable=i.encodeContentEditable(r)},dir:function(e){return i.decodeDir(e.dir)},setDir:function(e,r){e.dir=i.encodeDir(r)}}}var l=t.Impl({});a.Impl({}),u.Impl({});var f=o.Impl({});function s(e){return i.decodeContentEditable(e.contentEditable)}function d(e,r){e.contentEditable=i.encodeContentEditable(r)}function v(e){return i.decodeDir(e.dir)}function m(e,r){e.dir=i.encodeDir(r)}var _=l.nodeType,h=f.asHtmlElement,p=f.ofNode,g=f.insertAdjacentElement,y=f.insertAdjacentHTML,E=f.insertAdjacentText,b=o.asHtmlElement}],r={};function n(t){var i=r[t];if(void 0!==i)return i.exports;var o=r[t]={id:t,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return n.d(r,{a:r}),r},n.d=(e,r)=>{for(var t in r)n.o(r,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},n.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};(()=>{n.r(t);var e=n(1),r=n(22),i=n(23),o=n(24),a=n(9),u=n(14),c=function(e,r,n,t){return new(n||(n=Promise))((function(i,o){function a(e){try{c(t.next(e))}catch(e){o(e)}}function u(e){try{c(t.throw(e))}catch(e){o(e)}}function c(e){var r;e.done?i(e.value):(r=e.value,r instanceof n?r:new n((function(e){e(r)}))).then(a,u)}c((t=t.apply(e,r||[])).next())}))};function l(e){return!0===u.SORT_PROBLEMS.value&&e.sort(((e,r)=>e.problem_id-r.problem_id)),e.forEach((e=>{if((0,i.isChoice)(e.ProblemType)){const r=e.Options;!0===u.SORT_PROBLEMS.value&&r.sort(((e,r)=>e.key<r.key?-1:1)),r.forEach(((r,n)=>{o.CHOICE_MAP.setWith(e.problem_id,(e=>e.set(r.key,String.fromCharCode(65+n))))}))}})),e}(function(){return c(this,void 0,void 0,(function*(){!0===u.NO_LEAVE_CHECK.value&&(document.addEventListener("visibilitychange",(e=>{e.preventDefault(),e.stopImmediatePropagation()}),!0),window.addEventListener("visibilitychange",(e=>{e.preventDefault(),e.stopImmediatePropagation()}),!0));const n=new e.Client;(0,r.hookXHR)((function(e){switch(e.pathname){case"/exam_room/show_paper":this.addEventListener("readystatechange",(()=>{if(this.readyState==XMLHttpRequest.DONE){const r=JSON.stringify((!0===(e=JSON.parse(this.responseText)).data.has_problem_dict?e.data.problems=e.data.problems.sort(((e,r)=>e.id-r.id)).map((e=>(e.problems=l(e.problems),e))):e.data.problems=l(e.data.problems),(0,a.devLog)(o.CHOICE_MAP),e));Object.defineProperties(this,{responseText:{get:()=>r}})}var e})),this.addEventListener("load",(()=>{const r=JSON.parse(this.responseText);(0,a.devLog)("intercept paper",r);const t=new o.UI(r);n.onmessage((e=>{e.forEach((e=>t.updateAnswer(e))),t.updateUI()})),(()=>c(this,void 0,void 0,(function*(){u.EXAM_ID.value=parseInt(e.searchParams.get("exam_id"));const r=yield fetch((0,a.newURL)("/exam_room/cache_results",{exam_id:u.EXAM_ID.value.toString()}).toString()).then((e=>e.json()));n.answerProblem(r.data.results)})))().catch(a.devLog)}));break;case"/exam_room/answer_problem":return e=>c(this,void 0,void 0,(function*(){var r;if("string"==typeof e){const t=JSON.parse(e);if("action"in t)switch(t.action){case 1:case 17:break;default:return console.log("intercept action",t),new Promise((()=>{}))}else"results"in t&&((0,a.devLog)("intercept answers",t),n.answerProblem(null!==(r=t.results)&&void 0!==r?r:[]).catch(a.devLog))}return e}));default:if("upload-z1.qiniup.com"===e.hostname)return e=>c(this,void 0,void 0,(function*(){return e instanceof FormData&&e.get("file")instanceof File?new Promise((r=>{const n=new FileReader;n.onload=()=>(0,o.showConfirmUpload)(n.result,(()=>r(e))),n.readAsDataURL(e.get("file"))})):e}))}})),yield n.watch(1e4)}))})().catch(console.error)})()})();