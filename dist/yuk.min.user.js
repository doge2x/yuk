// ==UserScript==
// @name         yuk-client
// @version      0.3.3
// @author       doge2x
// @icon         https://www.yuketang.cn/static/images/favicon.ico
// @match        https://examination.xuetangx.com/*
// @grant        GM.xmlHttpRequest
// @grant        GM_getValue
// @grant        GM_setValue
// @run-at       document-start
// ==/UserScript==

(()=>{"use strict";var r=[,(r,e,n)=>{n.r(e),n.d(e,{Client:()=>u});var t=n(2),i=n(8),o=n(9),a=function(r,e,n,t){return new(n||(n=Promise))((function(i,o){function a(r){try{c(t.next(r))}catch(r){o(r)}}function u(r){try{c(t.throw(r))}catch(r){o(r)}}function c(r){var e;r.done?i(r.value):(e=r.value,e instanceof n?e:new n((function(r){r(e)}))).then(a,u)}c((t=t.apply(r,e||[])).next())}))};class u{constructor(){this.onmsg=[],this.queue=new Map;const r=new t.JSONRPCClient((e=>a(this,void 0,void 0,(function*(){const n=o.SERVER.value;void 0!==n&&(yield new Promise(((t,i)=>a(this,void 0,void 0,(function*(){GM.xmlHttpRequest({url:n,method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(e),onload:e=>{200===e.status?(r.receive(JSON.parse(e.responseText)),t()):i(new Error(e.statusText))},onerror:r=>i(r.statusText)})})))))}))));this.client=r}watch(r){return a(this,void 0,void 0,(function*(){return new Promise(((e,n)=>{const t=setInterval((()=>{this.sendQueue().catch((r=>{clearInterval(t),alert("与服务器通信异常"),n(r)}))}),r)}))}))}sendQueue(){return a(this,void 0,void 0,(function*(){if(this.queue.size<1||void 0===o.USERNAME.value||void 0===o.SERVER.value||void 0===o.EXAM_ID.value||!1===o.SYNC_ANSWERS.value)return;let r=[...this.queue.values()];if(this.queue.clear(),void 0===o.TOKEN.value){(0,i.devLog)(`login to server: ${o.USERNAME.value}, ${o.EXAM_ID.value}`);const r=yield this.client.request("login",[o.USERNAME.value,o.EXAM_ID.value]);(0,i.devLog)("got token",r),o.TOKEN.value=r}this.postAnswers(o.TOKEN.value,r)}))}postAnswers(r,e){return a(this,void 0,void 0,(function*(){(0,i.devLog)("send answers",e);const n=yield this.client.request("answer_problem",[r,e]);(0,i.devLog)("receive answers",n),this.onmsg.forEach((r=>r(n)))}))}answerProblem(r){return a(this,void 0,void 0,(function*(){r.forEach((r=>{this.queue.set(r.problem_id,r)}))}))}onmessage(r){this.onmsg.push(r)}}},function(r,e,n){var t=this&&this.__createBinding||(Object.create?function(r,e,n,t){void 0===t&&(t=n),Object.defineProperty(r,t,{enumerable:!0,get:function(){return e[n]}})}:function(r,e,n,t){void 0===t&&(t=n),r[t]=e[n]}),i=this&&this.__exportStar||function(r,e){for(var n in r)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||t(e,r,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n(3),e),i(n(4),e),i(n(6),e),i(n(7),e)},function(r,e,n){var t=this&&this.__awaiter||function(r,e,n,t){return new(n||(n=Promise))((function(i,o){function a(r){try{c(t.next(r))}catch(r){o(r)}}function u(r){try{c(t.throw(r))}catch(r){o(r)}}function c(r){var e;r.done?i(r.value):(e=r.value,e instanceof n?e:new n((function(r){r(e)}))).then(a,u)}c((t=t.apply(r,e||[])).next())}))},i=this&&this.__generator||function(r,e){var n,t,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,t&&(i=2&o[0]?t.return:o[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,o[1])).done)return i;switch(t=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,t=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(r,a)}catch(r){o=[6,r],t=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.JSONRPCClient=void 0;var o=n(4),a=n(5),u=function(){function r(r,e){this._send=r,this.createID=e,this.idToResolveMap=new Map,this.id=0}return r.prototype._createID=function(){return this.createID?this.createID():++this.id},r.prototype.timeout=function(r,e){var n=this;void 0===e&&(e=function(r){return(0,o.createJSONRPCErrorResponse)(r,a.DefaultErrorCode,"Request timeout")});var t=function(t,i){var o=setTimeout((function(){t.forEach((function(r){var t=n.idToResolveMap.get(r);t&&(n.idToResolveMap.delete(r),t(e(r)))}))}),r);return i().then((function(r){return clearTimeout(o),r}),(function(r){return clearTimeout(o),Promise.reject(r)}))};return{request:function(r,e,i){var o=n._createID();return t([o],(function(){return n.requestWithID(r,e,i,o)}))},requestAdvanced:function(r,e){return function(r,e){var i=(Array.isArray(r)?r:[r]).map((function(r){return r.id})).filter(c);return t(i,(function(){return n.requestAdvanced(r,e)}))}(r,e)}}},r.prototype.request=function(r,e,n){return this.requestWithID(r,e,n,this._createID())},r.prototype.requestWithID=function(r,e,n,a){return t(this,void 0,void 0,(function(){var t,u;return i(this,(function(i){switch(i.label){case 0:return t={jsonrpc:o.JSONRPC,method:r,params:e,id:a},[4,this.requestAdvanced(t,n)];case 1:return void 0===(u=i.sent()).result||u.error?void 0===u.result&&u.error?[2,Promise.reject(new Error(u.error.message))]:[2,Promise.reject(new Error("An unexpected error occurred"))]:[2,u.result]}}))}))},r.prototype.requestAdvanced=function(r,e){var n=this,t=Array.isArray(r);Array.isArray(r)||(r=[r]);var i=r.filter((function(r){return c(r.id)})),u=i.map((function(r){return new Promise((function(e){return n.idToResolveMap.set(r.id,e)}))})),f=Promise.all(u).then((function(r){return t||!r.length?r:r[0]}));return this.send(t?r:r[0],e).then((function(){return f}),(function(r){return i.forEach((function(e){n.receive((0,o.createJSONRPCErrorResponse)(e.id,a.DefaultErrorCode,r&&r.message||"Failed to send a request"))})),f}))},r.prototype.notify=function(r,e,n){this.send({jsonrpc:o.JSONRPC,method:r,params:e},n).then(void 0,(function(){}))},r.prototype.send=function(r,e){return this._send(r,e)},r.prototype.rejectAllPendingRequests=function(r){this.idToResolveMap.forEach((function(e,n){return e((0,o.createJSONRPCErrorResponse)(n,a.DefaultErrorCode,r))})),this.idToResolveMap.clear()},r.prototype.receive=function(r){var e=this;Array.isArray(r)||(r=[r]),r.forEach((function(r){var n=e.idToResolveMap.get(r.id);n&&(e.idToResolveMap.delete(r.id),n(r))}))},r}();e.JSONRPCClient=u;var c=function(r){return null!=r}},(r,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createJSONRPCErrorResponse=e.JSONRPCErrorCode=e.isJSONRPCResponses=e.isJSONRPCResponse=e.isJSONRPCRequests=e.isJSONRPCRequest=e.isJSONRPCID=e.JSONRPC=void 0,e.JSONRPC="2.0";e.isJSONRPCID=function(r){return"string"==typeof r||"number"==typeof r||null===r};e.isJSONRPCRequest=function(r){return r.jsonrpc===e.JSONRPC&&void 0!==r.method&&void 0===r.result&&void 0===r.error};e.isJSONRPCRequests=function(r){return Array.isArray(r)&&r.every(e.isJSONRPCRequest)};e.isJSONRPCResponse=function(r){return r.jsonrpc===e.JSONRPC&&void 0!==r.id&&(void 0!==r.result||void 0!==r.error)};e.isJSONRPCResponses=function(r){return Array.isArray(r)&&r.every(e.isJSONRPCResponse)},function(r){r[r.ParseError=-32700]="ParseError",r[r.InvalidRequest=-32600]="InvalidRequest",r[r.MethodNotFound=-32601]="MethodNotFound",r[r.InvalidParams=-32602]="InvalidParams",r[r.InternalError=-32603]="InternalError"}(e.JSONRPCErrorCode||(e.JSONRPCErrorCode={}));e.createJSONRPCErrorResponse=function(r,n,t,i){var o={code:n,message:t};return i&&(o.data=i),{jsonrpc:e.JSONRPC,id:r,error:o}}},(r,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultErrorCode=void 0,e.DefaultErrorCode=0},function(r,e,n){var t=this&&this.__assign||function(){return t=Object.assign||function(r){for(var e,n=1,t=arguments.length;n<t;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i]);return r},t.apply(this,arguments)},i=this&&this.__awaiter||function(r,e,n,t){return new(n||(n=Promise))((function(i,o){function a(r){try{c(t.next(r))}catch(r){o(r)}}function u(r){try{c(t.throw(r))}catch(r){o(r)}}function c(r){var e;r.done?i(r.value):(e=r.value,e instanceof n?e:new n((function(r){r(e)}))).then(a,u)}c((t=t.apply(r,e||[])).next())}))},o=this&&this.__generator||function(r,e){var n,t,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,t&&(i=2&o[0]?t.return:o[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,o[1])).done)return i;switch(t=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,t=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(r,a)}catch(r){o=[6,r],t=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},a=this&&this.__spreadArray||function(r,e,n){if(n||2===arguments.length)for(var t,i=0,o=e.length;i<o;i++)!t&&i in e||(t||(t=Array.prototype.slice.call(e,0,i)),t[i]=e[i]);return r.concat(t||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.JSONRPCServer=void 0;var u=n(4),c=n(5),f=function(r){return(0,u.createJSONRPCErrorResponse)((0,u.isJSONRPCID)(r.id)?r.id:null,u.JSONRPCErrorCode.InvalidRequest,"Invalid Request")},l=function(){function r(r){var e;void 0===r&&(r={}),this.mapErrorToJSONRPCErrorResponse=m,this.nameToMethodDictionary={},this.middleware=null,this.errorListener=null!==(e=r.errorListener)&&void 0!==e?e:console.warn}return r.prototype.addMethod=function(r,e){this.addMethodAdvanced(r,this.toJSONRPCMethod(e))},r.prototype.toJSONRPCMethod=function(r){return function(e,n){var t=r(e.params,n);return Promise.resolve(t).then((function(r){return v(e.id,r)}))}},r.prototype.addMethodAdvanced=function(r,e){var n;this.nameToMethodDictionary=t(t({},this.nameToMethodDictionary),((n={})[r]=e,n))},r.prototype.receiveJSON=function(r,e){var n=this.tryParseRequestJSON(r);return n?this.receive(n,e):Promise.resolve((0,u.createJSONRPCErrorResponse)(null,u.JSONRPCErrorCode.ParseError,"Parse error"))},r.prototype.tryParseRequestJSON=function(r){try{return JSON.parse(r)}catch(r){return null}},r.prototype.receive=function(r,e){return Array.isArray(r)?this.receiveMultiple(r,e):this.receiveSingle(r,e)},r.prototype.receiveMultiple=function(r,e){return i(this,void 0,void 0,(function(){var n,t=this;return o(this,(function(i){switch(i.label){case 0:return[4,Promise.all(r.map((function(r){return t.receiveSingle(r,e)})))];case 1:return 1===(n=i.sent().filter(s)).length?[2,n[0]]:n.length?[2,n]:[2,null]}}))}))},r.prototype.receiveSingle=function(r,e){return i(this,void 0,void 0,(function(){var n,t;return o(this,(function(i){switch(i.label){case 0:return n=this.nameToMethodDictionary[r.method],(0,u.isJSONRPCRequest)(r)?[3,1]:[2,f(r)];case 1:return n?[4,this.callMethod(n,r,e)]:[3,3];case 2:return t=i.sent(),[2,_(r,t)];case 3:return void 0!==r.id?[2,(o=r.id,(0,u.createJSONRPCErrorResponse)(o,u.JSONRPCErrorCode.MethodNotFound,"Method not found"))]:[2,null];case 4:return[2]}var o}))}))},r.prototype.applyMiddleware=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];this.middleware?this.middleware=this.combineMiddlewares(a([this.middleware],r,!0)):this.middleware=this.combineMiddlewares(r)},r.prototype.combineMiddlewares=function(r){return r.length?r.reduce(this.middlewareReducer):null},r.prototype.middlewareReducer=function(r,e){return function(n,t,i){return r((function(r,t){return e(n,r,t)}),t,i)}},r.prototype.callMethod=function(r,e,n){var t=this,i=function(r){return t.errorListener('An unexpected error occurred while executing "'.concat(e.method,'" JSON-RPC method:'),r),Promise.resolve(t.mapErrorToJSONRPCErrorResponseIfNecessary(e.id,r))};try{return(this.middleware||d)((function(e,n){return r(e,n)}),e,n).then(void 0,i)}catch(r){return i(r)}},r.prototype.mapErrorToJSONRPCErrorResponseIfNecessary=function(r,e){return void 0!==r?this.mapErrorToJSONRPCErrorResponse(r,e):null},r}();e.JSONRPCServer=l;var s=function(r){return null!==r},d=function(r,e,n){return r(e,n)},v=function(r,e){return void 0!==r?{jsonrpc:u.JSONRPC,id:r,result:void 0===e?null:e}:null},m=function(r,e){return(0,u.createJSONRPCErrorResponse)(r,c.DefaultErrorCode,e&&e.message||"An unexpected error occurred")},_=function(r,e){return e||(void 0!==r.id?(0,u.createJSONRPCErrorResponse)(r.id,u.JSONRPCErrorCode.InternalError,"Internal error"):null)}},function(r,e,n){var t=this&&this.__awaiter||function(r,e,n,t){return new(n||(n=Promise))((function(i,o){function a(r){try{c(t.next(r))}catch(r){o(r)}}function u(r){try{c(t.throw(r))}catch(r){o(r)}}function c(r){var e;r.done?i(r.value):(e=r.value,e instanceof n?e:new n((function(r){r(e)}))).then(a,u)}c((t=t.apply(r,e||[])).next())}))},i=this&&this.__generator||function(r,e){var n,t,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,t&&(i=2&o[0]?t.return:o[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,o[1])).done)return i;switch(t=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,t=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(r,a)}catch(r){o=[6,r],t=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.JSONRPCServerAndClient=void 0;var o=n(4),a=function(){function r(r,e,n){var t;void 0===n&&(n={}),this.server=r,this.client=e,this.errorListener=null!==(t=n.errorListener)&&void 0!==t?t:console.warn}return r.prototype.applyServerMiddleware=function(){for(var r,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];(r=this.server).applyMiddleware.apply(r,e)},r.prototype.addMethod=function(r,e){this.server.addMethod(r,e)},r.prototype.addMethodAdvanced=function(r,e){this.server.addMethodAdvanced(r,e)},r.prototype.timeout=function(r){return this.client.timeout(r)},r.prototype.request=function(r,e,n){return this.client.request(r,e,n)},r.prototype.requestAdvanced=function(r,e){return this.client.requestAdvanced(r,e)},r.prototype.notify=function(r,e,n){this.client.notify(r,e,n)},r.prototype.rejectAllPendingRequests=function(r){this.client.rejectAllPendingRequests(r)},r.prototype.receiveAndSend=function(r,e,n){return t(this,void 0,void 0,(function(){var t,a;return i(this,(function(i){switch(i.label){case 0:return(0,o.isJSONRPCResponse)(r)||(0,o.isJSONRPCResponses)(r)?(this.client.receive(r),[3,4]):[3,1];case 1:return(0,o.isJSONRPCRequest)(r)||(0,o.isJSONRPCRequests)(r)?[4,this.server.receive(r,e)]:[3,3];case 2:return(t=i.sent())?[2,this.client.send(t,n)]:[3,4];case 3:return a="Received an invalid JSON-RPC message",this.errorListener(a,r),[2,Promise.reject(new Error(a))];case 4:return[2]}}))}))},r}();e.JSONRPCServerAndClient=a},(r,e,n)=>{function t(r,...e){0}function i(r,e){const n=new URL(r,self.location.origin);for(const[r,t]of Object.entries(null!=e?e:{}))n.searchParams.set(r,t);return n}n.r(e),n.d(e,{devLog:()=>t,newURL:()=>i})},(r,e,n)=>{n.r(e),n.d(e,{EXAM_ID:()=>s,NO_LEAVE_CHECK:()=>f,SERVER:()=>a,SORT_PROBLEMS:()=>c,SYNC_ANSWERS:()=>u,TOKEN:()=>l,USERNAME:()=>o});var t=n(10);class i{constructor(r){this._value=r}get value(){return this._value.get()}set value(r){this._value.set(r)}}const o=new i(t.Username),a=new i(t.Server),u=new i(t.SyncAnswers),c=new i(t.SortProblems),f=new i(t.NoLeaveCheck),l=new i(t.Token),s=new i(t.ExamId)},(r,e,n)=>{n.r(e),n.d(e,{ExamId:()=>k,GM:()=>u,GMEntry:()=>c,NoLeaveCheck:()=>b,Option2:()=>f,Server:()=>_,SortProblems:()=>A,SyncAnswers:()=>g,Token:()=>R,Username:()=>d});var t=n(11),i=n(12),o=n(17),a=n(15);var u={getValue:function(r){return o.nullable_to_opt(t.getValue(r))},setValue:function(r,e){t.setValue(r,e)}};var c={Make:function(r){var e={contents:{LAZY_DONE:!1,VAL:function(){var e=t.getValue(r.name);return null==e?(t.setValue(r.name,r.init),r.init):o.some(e)}}};return{v:e,get:function(r){return a.force(e.contents)},set:function(n){e.contents=i.from_val(n),t.setValue(r.name,n)}}}};var f={Make:function(r){var e={contents:void 0};return{v:e,get:function(r){return e.contents},set:function(r){e.contents=r}}}},l="username",s={contents:{LAZY_DONE:!1,VAL:function(){var r=t.getValue(l);return null==r?void t.setValue(l,void 0):o.some(r)}}};var d={v:s,get:function(r){return a.force(s.contents)},set:function(r){s.contents=i.from_val(r),t.setValue(l,r)}},v="server",m={contents:{LAZY_DONE:!1,VAL:function(){var r=t.getValue(v);return null==r?void t.setValue(v,void 0):o.some(r)}}};var _={v:m,get:function(r){return a.force(m.contents)},set:function(r){m.contents=i.from_val(r),t.setValue(v,r)}},h="sync_answers",p={contents:{LAZY_DONE:!1,VAL:function(){var r=t.getValue(h);return null==r?(t.setValue(h,true),true):o.some(r)}}};var g={v:p,get:function(r){return a.force(p.contents)},set:function(r){p.contents=i.from_val(r),t.setValue(h,r)}},y="nol_eavecheck",E={contents:{LAZY_DONE:!1,VAL:function(){var r=t.getValue(y);return null==r?(t.setValue(y,true),true):o.some(r)}}};var b={v:E,get:function(r){return a.force(E.contents)},set:function(r){E.contents=i.from_val(r),t.setValue(y,r)}},w="sort_problems",S={contents:{LAZY_DONE:!1,VAL:function(){var r=t.getValue(w);return null==r?(t.setValue(w,false),false):o.some(r)}}};var A={v:S,get:function(r){return a.force(S.contents)},set:function(r){S.contents=i.from_val(r),t.setValue(w,r)}},O={contents:void 0};var R={v:O,get:function(r){return O.contents},set:function(r){O.contents=r}},D={contents:void 0};var k={v:D,get:function(r){return D.contents},set:function(r){D.contents=r}}},(r,e,n)=>{function t(r){return GM_getValue(r)}function i(r,e){GM_setValue(r,e)}n.r(e),n.d(e,{getValue:()=>t,setValue:()=>i})},(r,e,n)=>{n.r(e),n.d(e,{Undefined:()=>u,force_val:()=>c,from_fun:()=>o,from_val:()=>a,is_val:()=>f,lazy_from_fun:()=>l,lazy_from_val:()=>s,lazy_is_val:()=>d});var t=n(13),i=n(15);function o(r){return{LAZY_DONE:!1,VAL:function(){return t._1(r,void 0)}}}function a(r){return{LAZY_DONE:!0,VAL:r}}var u=i.Undefined,c=i.force_val,f=i.is_val,l=o,s=a,d=i.is_val},(r,e,n)=>{n.r(e),n.d(e,{_1:()=>o,_2:()=>u,_3:()=>f,_4:()=>s,_5:()=>v,_6:()=>_,_7:()=>p,_8:()=>y,__1:()=>a,__2:()=>c,__3:()=>l,__4:()=>d,__5:()=>m,__6:()=>h,__7:()=>g,__8:()=>E,app:()=>i});var t=n(14);function i(r,e){for(;;){var n=e,o=r,a=o.length,u=0===a?1:a,c=u-n.length|0;if(0===c)return o.apply(null,n);if(c>=0)return function(r,e){return function(n){return i(r,e.concat([n]))}}(o,n);e=t.sub(n,u,0|-c),r=o.apply(null,t.sub(n,0,u))}}function o(r,e){var n=r.length;if(1===n)return r(e);switch(n){case 1:return r(e);case 2:return function(n){return r(e,n)};case 3:return function(n,t){return r(e,n,t)};case 4:return function(n,t,i){return r(e,n,t,i)};case 5:return function(n,t,i,o){return r(e,n,t,i,o)};case 6:return function(n,t,i,o,a){return r(e,n,t,i,o,a)};case 7:return function(n,t,i,o,a,u){return r(e,n,t,i,o,a,u)};default:return i(r,[e])}}function a(r){return 1===r.length?r:function(e){return o(r,e)}}function u(r,e,n){var t=r.length;if(2===t)return r(e,n);switch(t){case 1:return i(r(e),[n]);case 2:return r(e,n);case 3:return function(t){return r(e,n,t)};case 4:return function(t,i){return r(e,n,t,i)};case 5:return function(t,i,o){return r(e,n,t,i,o)};case 6:return function(t,i,o,a){return r(e,n,t,i,o,a)};case 7:return function(t,i,o,a,u){return r(e,n,t,i,o,a,u)};default:return i(r,[e,n])}}function c(r){return 2===r.length?r:function(e,n){return u(r,e,n)}}function f(r,e,n,t){var o=r.length;if(3===o)return r(e,n,t);switch(o){case 1:return i(r(e),[n,t]);case 2:return i(r(e,n),[t]);case 3:return r(e,n,t);case 4:return function(i){return r(e,n,t,i)};case 5:return function(i,o){return r(e,n,t,i,o)};case 6:return function(i,o,a){return r(e,n,t,i,o,a)};case 7:return function(i,o,a,u){return r(e,n,t,i,o,a,u)};default:return i(r,[e,n,t])}}function l(r){return 3===r.length?r:function(e,n,t){return f(r,e,n,t)}}function s(r,e,n,t,o){var a=r.length;if(4===a)return r(e,n,t,o);switch(a){case 1:return i(r(e),[n,t,o]);case 2:return i(r(e,n),[t,o]);case 3:return i(r(e,n,t),[o]);case 4:return r(e,n,t,o);case 5:return function(i){return r(e,n,t,o,i)};case 6:return function(i,a){return r(e,n,t,o,i,a)};case 7:return function(i,a,u){return r(e,n,t,o,i,a,u)};default:return i(r,[e,n,t,o])}}function d(r){return 4===r.length?r:function(e,n,t,i){return s(r,e,n,t,i)}}function v(r,e,n,t,o,a){var u=r.length;if(5===u)return r(e,n,t,o,a);switch(u){case 1:return i(r(e),[n,t,o,a]);case 2:return i(r(e,n),[t,o,a]);case 3:return i(r(e,n,t),[o,a]);case 4:return i(r(e,n,t,o),[a]);case 5:return r(e,n,t,o,a);case 6:return function(i){return r(e,n,t,o,a,i)};case 7:return function(i,u){return r(e,n,t,o,a,i,u)};default:return i(r,[e,n,t,o,a])}}function m(r){return 5===r.length?r:function(e,n,t,i,o){return v(r,e,n,t,i,o)}}function _(r,e,n,t,o,a,u){var c=r.length;if(6===c)return r(e,n,t,o,a,u);switch(c){case 1:return i(r(e),[n,t,o,a,u]);case 2:return i(r(e,n),[t,o,a,u]);case 3:return i(r(e,n,t),[o,a,u]);case 4:return i(r(e,n,t,o),[a,u]);case 5:return i(r(e,n,t,o,a),[u]);case 6:return r(e,n,t,o,a,u);case 7:return function(i){return r(e,n,t,o,a,u,i)};default:return i(r,[e,n,t,o,a,u])}}function h(r){return 6===r.length?r:function(e,n,t,i,o,a){return _(r,e,n,t,i,o,a)}}function p(r,e,n,t,o,a,u,c){var f=r.length;if(7===f)return r(e,n,t,o,a,u,c);switch(f){case 1:return i(r(e),[n,t,o,a,u,c]);case 2:return i(r(e,n),[t,o,a,u,c]);case 3:return i(r(e,n,t),[o,a,u,c]);case 4:return i(r(e,n,t,o),[a,u,c]);case 5:return i(r(e,n,t,o,a),[u,c]);case 6:return i(r(e,n,t,o,a,u),[c]);case 7:return r(e,n,t,o,a,u,c);default:return i(r,[e,n,t,o,a,u,c])}}function g(r){return 7===r.length?r:function(e,n,t,i,o,a,u){return p(r,e,n,t,i,o,a,u)}}function y(r,e,n,t,o,a,u,c,f){var l=r.length;if(8===l)return r(e,n,t,o,a,u,c,f);switch(l){case 1:return i(r(e),[n,t,o,a,u,c,f]);case 2:return i(r(e,n),[t,o,a,u,c,f]);case 3:return i(r(e,n,t),[o,a,u,c,f]);case 4:return i(r(e,n,t,o),[a,u,c,f]);case 5:return i(r(e,n,t,o,a),[u,c,f]);case 6:return i(r(e,n,t,o,a,u),[c,f]);case 7:return i(r(e,n,t,o,a,u,c),[f]);default:return i(r,[e,n,t,o,a,u,c,f])}}function E(r){return 8===r.length?r:function(e,n,t,i,o,a,u,c){return y(r,e,n,t,i,o,a,u,c)}}},(r,e,n)=>{function t(r,e,n){for(var t=new Array(n),i=0,o=e;i<n;)t[i]=r[o],i=i+1|0,o=o+1|0;return t}function i(r){var e=function(r,e){for(;;){var n=e,t=r;if(!n)return t;e=n.tl,r=n.hd.length+t|0}}(0,r),n=new Array(e);return function(r,e,n){for(;;){var t=n,i=e;if(!t)return;for(var o=t.hd,a=o.length,u=i,c=0;c<a;)r[u]=o[c],u=u+1|0,c=c+1|0;n=t.tl,e=u}}(n,0,r),n}function o(r,e,n){if(e<0||e>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};r[e]=n}function a(r,e){if(e<0||e>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return r[e]}function u(r,e){for(var n=new Array(r),t=0;t<r;++t)n[t]=e;return n}function c(r){for(var e=new Array(r),n=0;n<r;++n)e[n]=0;return e}function f(r,e,n,t,i){if(t<=e)for(var o=0;o<i;++o)n[o+t|0]=r[o+e|0];else for(var a=i-1|0;a>=0;--a)n[a+t|0]=r[a+e|0]}function l(r){return r.slice(0)}n.r(e),n.d(e,{blit:()=>f,concat:()=>i,dup:()=>l,get:()=>a,make:()=>u,make_float:()=>c,set:()=>o,sub:()=>t})},(r,e,n)=>{function t(r){return r.LAZY_DONE}n.r(e),n.d(e,{Undefined:()=>i,force:()=>u,force_val:()=>c,is_val:()=>t});var i=n(16).create("CamlinternalLazy.Undefined");function o(r,e){var n=e();return r.VAL=n,r.LAZY_DONE=!0,n}function a(){throw{RE_EXN_ID:i,Error:new Error}}function u(r){if(r.LAZY_DONE)return r.VAL;var e=r.VAL;r.VAL=a;try{return o(r,e)}catch(e){throw r.VAL=function(){throw e},e}}function c(r){if(r.LAZY_DONE)return r.VAL;var e=r.VAL;return r.VAL=a,o(r,e)}},(r,e,n)=>{n.r(e),n.d(e,{caml_exn_slot_name:()=>a,caml_is_extension:()=>o,create:()=>i,id:()=>t});var t={contents:0};function i(r){return t.contents=t.contents+1|0,r+"/"+t.contents}function o(r){return null!=r&&"string"==typeof r.RE_EXN_ID}function a(r){return r.RE_EXN_ID}},(r,e,n)=>{function t(r){return void 0!==r.BS_PRIVATE_NESTED_SOME_NONE}function i(r){return void 0===r?{BS_PRIVATE_NESTED_SOME_NONE:0}:null!==r&&void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?{BS_PRIVATE_NESTED_SOME_NONE:r.BS_PRIVATE_NESTED_SOME_NONE+1|0}:r}function o(r){return null==r?void 0:i(r)}function a(r){return void 0===r?void 0:i(r)}function u(r){return null===r?void 0:i(r)}function c(r){if(null===r||void 0===r.BS_PRIVATE_NESTED_SOME_NONE)return r;var e=r.BS_PRIVATE_NESTED_SOME_NONE;return 0===e?void 0:{BS_PRIVATE_NESTED_SOME_NONE:e-1|0}}function f(r){return void 0===r?void 0:c(r)}function l(r){return void 0!==r?r.VAL:r}n.r(e),n.d(e,{isNested:()=>t,null_to_opt:()=>u,nullable_to_opt:()=>o,option_get:()=>f,option_unwrap:()=>l,some:()=>i,undefined_to_opt:()=>a,valFromOption:()=>c})},(r,e,n)=>{n.r(e),n.d(e,{hookXHR:()=>i});var t=n(8);function i(r){const e=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(n,i){const o=r.call(this,(0,t.newURL)(i)),a=this.send;this.send=function(r){void 0!==o?o(r).then((r=>{a.call(this,r),this.send=a})).catch(t.devLog):(a.call(this,r),this.send=a)},e.apply(this,arguments)}}},(r,e,n)=>{var t;n.r(e),n.d(e,{ProblemType:()=>t}),function(r){r[r.SingleChoice=1]="SingleChoice",r[r.MultipleChoice=2]="MultipleChoice",r[r.Polling=3]="Polling",r[r.FillBlank=4]="FillBlank",r[r.ShortAnswer=5]="ShortAnswer",r[r.Judgement=6]="Judgement"}(t||(t={}))},(r,e,n)=>{n.r(e),n.d(e,{UI:()=>i,showConfirmUpload:()=>o});var t=n(21);class i{constructor(r){let e=[];!0===r.data.has_problem_dict?r.data.problems.forEach((r=>{e=e.concat(r.problems)})):e=r.data.problems,this.inner=t.UI.make(e)}updateAnswer({username:r,problem_id:e,result:n}){t.UI.updateAnswer(this.inner,e,r,n)}updateUI(){t.UI.updateUI(this.inner)}}function o(r,e){t.showConfirmUpload(r,e)}},(r,e,n)=>{n.r(e),n.d(e,{Problem:()=>w,React:()=>{},ReactDOMRe:()=>{},UI:()=>S,showConfirmUpload:()=>E,style:()=>y,styleCss:()=>g});var t=n(13),i=n(22),o=n(25),a=n(45),u=n(59),c=n(60),f=n(26),l=n(62),s=n(30),d=n(17),v=n(54),m=n(31),_=n(34),h=n(43),p=n(61),g=m.default,y=m;function E(r,e){var n=o.openWin("上传图片",200,300,void 0,void 0,void 0),a=n[0];n[1].appendChild(s.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:o.joinStrings([y.mainBody,y.uploadImg]," ")},[i.DOMRe.createDOMElementVariadic("div",{className:y.uploadImgConfirm},[i.DOMRe.createDOMElementVariadic("button",{className:y.clickable,onClick:function(r){t._1(e,void 0),a.close()}},["确认上传"]),i.DOMRe.createDOMElementVariadic("span",void 0,[i.DOMRe.createDOMElementVariadic("i",void 0,["*关闭窗口以取消上传"])])]),i.DOMRe.createDOMElementVariadic("div",{className:y.uploadImgImage},[i.DOMRe.createDOMElementVariadic("img",{src:r},[])])]))))}function b(r){if(r<=6&&1<=r)return r-1|0}var w={probelmTypeToJs:function(r){return r+1|0},probelmTypeFromJs:b};var S={make:function(r){var e=s.getExn(s.flatMap(h.asHtmlDocument(document),(function(r){return s.map(d.nullable_to_opt(r.body),(function(e){return[r.head,e]}))}))),n=e[1];e[0].appendChild(s.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("style",void 0,[g.toString()]))));var t=s.getExn(s.flatMap(d.nullable_to_opt(n.querySelector(".header-title")),p.ofElement));t.classList.add(y.clickable),t.addEventListener("click",(function(r){return c.showSettings(void 0)}));var o=f.map(Array.prototype.slice.call(n.querySelectorAll(".exam-main--body .subject-item")),(function(r){return s.getExn(_.ofNode(r))}));return o.length!==r.length&&u.raiseError("wrong number of subject items"),{details:f.reduce(f.zip(r,o),void 0,(function(r,e){var n,t=e[1],i=e[0],o=s.getExn(b(i.ProblemType)),u=0;if(o>=3)switch(o){case 3:var c=a.Blank.make(t,void 0);n={updateUI:function(r){return a.Blank.updateUI(c)},updateAnswer:function(r,e){return a.Blank.updateAnswer(c,r,e)}};break;case 4:var d=a.ShortAnswer.make(t,void 0);n={updateUI:function(r){return a.ShortAnswer.updateUI(d)},updateAnswer:function(r,e){return a.ShortAnswer.updateAnswer(d,r,e)}};break;case 5:u=1}else u=1;if(1===u){var m=v.fromArray(f.mapWithIndex(s.getExn(i.Options),(function(r,e){return[e.key,String.fromCharCode(65+r|0)]}))),_=a.Choice.make(t,(function(r){return v.getExn(m,r)}));n={updateUI:function(r){return a.Choice.updateUI(_)},updateAnswer:function(r,e){return a.Choice.updateAnswer(_,r,e)}}}return l.set(r,i.problem_id,n)}))}},updateAnswer:function(r,e,n,i){return s.forEach(l.get(r.details,e),(function(r){return t._2(r.updateAnswer,n,i)}))},updateUI:function(r){return l.forEach(r.details,(function(r,e){return t._1(e.updateUI,void 0)}))}}},(r,e,n)=>{n.r(e),n.d(e,{Children:()=>c,DOMRe:()=>s,Fragment:()=>d,Props:()=>{},createElement:()=>l,createElementVariadic:()=>f,recks:()=>a,toNode:()=>u});var t=n(23),i=n(17),o=n(24),a=t;function u(r){return i.nullable_to_opt(a.toNode(r))}var c={toArray:function(r){return a.Children.toArray(r)}};function f(r,e,n){return o.spliceApply(t.createElement,[r,e,n])}function l(r,e){return t.createElement(r,e)}var s={createDOMElementVariadic:function(r,e,n){return o.spliceApply(t.createElement,[r,void 0!==e?i.valFromOption(e):void 0,n])},createElement:function(r,e,n){return o.spliceApply(t.createElement,[r,void 0!==e?i.valFromOption(e):void 0,n])}};var d={make:function(r){var e=r.children;return a.Fragment({children:e})}}},(r,e,n)=>{function t(r){return Array.isArray(r)?(new Array).concat(...r.map(t)):r instanceof Node?[r]:null==r?[]:[document.createTextNode(String(r))]}function i(r,e){for(const n of e)r.appendChild(n)}function o(r,e){for(const[n,t]of Object.entries(e))n.startsWith("-")?r.style.setProperty(n,t):r.style[n]=t}function a(r,e,...n){e=null!=e?e:{};let a=t(n).concat(t(e.children));if("function"==typeof r)return r(Object.assign(Object.assign({},e),{children:a}));{const n=document.createElement(r);return i(n,a),function(r,e){for(const[n,t]of Object.entries(e))if(void 0!==t)switch(n){case"class":case"className":r.setAttribute("class",t);break;case"style":o(r,t);break;case"dangerouslySetInnerHTML":r.innerHTML=t.__html;break;default:n.startsWith("on")?r.addEventListener(n.slice(2).toLowerCase(),t):n in r?r[n]=t:r.setAttribute(n,t)}}(n,null!=e?e:{}),n}}function u(r){let e=document.createDocumentFragment();return i(e,t(r.children)),e}function c(r){return r instanceof Node?r:null}n.r(e),n.d(e,{Children:()=>f,Fragment:()=>u,createElement:()=>a,default:()=>l,toNode:()=>c});const f={toArray:t},l={createElement:a,Fragment:u}},(r,e,n)=>{n.r(e),n.d(e,{spliceApply:()=>t,spliceObjApply:()=>i});var t=function(r,e){var n,t;t=e.length;var i=[];for(n=0;n<t-1;++n)i.push(e[n]);var o=e[t-1];for(n=0;n<o.length;++n)i.push(o[n]);return r.apply(null,i)},i=function(r,e,n){var t,i;i=n.length;var o=[];for(t=0;t<i-1;++t)o.push(n[t]);var a=n[i-1];for(t=0;t<a.length;++t)o.push(a[t]);return r[e].apply(r,o)}},(r,e,n)=>{n.r(e),n.d(e,{React:()=>{},ReactDOMRe:()=>{},UList:()=>v,joinStrings:()=>s,openWin:()=>m,querySelectorAllElements:()=>d,styleCss:()=>l});var t=n(22),i=n(26),o=n(30),a=n(17),u=n(31),c=n(34),f=n(43),l=u.default;function s(r,e){return i.joinWith(r,e,(function(r){return r}))}function d(r,e){return i.keepMap(Array.prototype.slice.call(r.querySelectorAll(e)),c.ofNode)}var v={make:function(r){var e=r.children;return t.DOMRe.createDOMElementVariadic("ul",void 0,[t.Children.toArray(e).map((function(r){return t.DOMRe.createDOMElementVariadic("li",void 0,[r])}))])}};function m(r,e,n,u,c,s){var d=o.getExn(a.nullable_to_opt(window.open("","",i.joinWith([["location","no"],["height",String(e)],["width",String(n)],["left",o.mapWithDefault(u,"0",(function(r){return String(r)}))],["top",o.mapWithDefault(c,"0",(function(r){return String(r)}))]],",",(function(r){return r[0]+"="+r[1]}))))),v=o.getExn(f.asHtmlDocument(d.document));return v.head.appendChild(o.getExn(t.toNode(t.DOMRe.createDOMElementVariadic("title",void 0,[r])))),v.head.appendChild(o.getExn(t.toNode(t.DOMRe.createDOMElementVariadic("style",void 0,[l.toString()])))),[d,o.getExn(a.nullable_to_opt(v.body))]}},(r,e,n)=>{n.r(e),n.d(e,{blit:()=>I,blitUnsafe:()=>x,cmp:()=>pr,cmpU:()=>hr,concat:()=>R,concatMany:()=>D,eq:()=>_r,eqU:()=>mr,every:()=>ar,every2:()=>sr,every2U:()=>lr,everyU:()=>or,fill:()=>N,forEach:()=>C,forEachU:()=>U,forEachWithIndex:()=>K,forEachWithIndexU:()=>z,get:()=>u,getBy:()=>V,getByU:()=>L,getExn:()=>c,getIndexBy:()=>j,getIndexByU:()=>q,joinWith:()=>wr,joinWithU:()=>br,keep:()=>B,keepMap:()=>H,keepMapU:()=>X,keepU:()=>J,keepWithIndex:()=>F,keepWithIndexU:()=>W,make:()=>h,makeBy:()=>g,makeByAndShuffle:()=>E,makeByAndShuffleU:()=>y,makeByU:()=>p,map:()=>T,mapU:()=>P,mapWithIndex:()=>Y,mapWithIndexU:()=>G,partition:()=>yr,partitionU:()=>gr,range:()=>b,rangeBy:()=>w,reduce:()=>$,reduceReverse:()=>rr,reduceReverse2:()=>nr,reduceReverse2U:()=>er,reduceReverseU:()=>Q,reduceU:()=>Z,reduceWithIndex:()=>ir,reduceWithIndexU:()=>tr,reverse:()=>_,reverseInPlace:()=>m,set:()=>f,setExn:()=>l,shuffle:()=>v,shuffleInPlace:()=>d,slice:()=>k,sliceToEnd:()=>M,some:()=>cr,some2:()=>vr,some2U:()=>dr,someU:()=>ur,unzip:()=>Er,zip:()=>S,zipBy:()=>O,zipByU:()=>A});var t=n(27),i=n(13),o=n(28),a=n(17);function u(r,e){if(e>=0&&e<r.length)return a.some(r[e])}function c(r,e){if(!(e>=0&&e<r.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.ml",27,4],Error:new Error};return r[e]}function f(r,e,n){return e>=0&&e<r.length&&(r[e]=n,!0)}function l(r,e,n){if(!(e>=0&&e<r.length))throw{RE_EXN_ID:"Assert_failure",_1:["belt_Array.ml",33,2],Error:new Error};r[e]=n}function s(r,e,n){var t=r[e];r[e]=r[n],r[n]=t}function d(r){for(var e=r.length,n=0;n<e;++n)s(r,n,o.random_int(n,e))}function v(r){var e=r.slice(0);return d(e),e}function m(r){for(var e=r.length,n=0,t=e/2|0;n<t;++n)s(r,0+n|0,((0+e|0)-n|0)-1|0)}function _(r){for(var e=r.length,n=new Array(e),t=0;t<e;++t)n[t]=r[(e-1|0)-t|0];return n}function h(r,e){if(r<=0)return[];for(var n=new Array(r),t=0;t<r;++t)n[t]=e;return n}function p(r,e){if(r<=0)return[];for(var n=new Array(r),t=0;t<r;++t)n[t]=e(t);return n}function g(r,e){return p(r,i.__1(e))}function y(r,e){var n=p(r,e);return d(n),n}function E(r,e){return y(r,i.__1(e))}function b(r,e){var n=e-r|0;if(n<0)return[];for(var t=new Array(n+1|0),i=0;i<=n;++i)t[i]=r+i|0;return t}function w(r,e,n){var t=e-r|0;if(t<0||n<=0)return[];for(var i=1+(t/n|0)|0,o=new Array(i),a=r,u=0;u<i;++u)o[u]=a,a=a+n|0;return o}function S(r,e){for(var n=r.length,t=e.length,i=n<t?n:t,o=new Array(i),a=0;a<i;++a)o[a]=[r[a],e[a]];return o}function A(r,e,n){for(var t=r.length,i=e.length,o=t<i?t:i,a=new Array(o),u=0;u<o;++u)a[u]=n(r[u],e[u]);return a}function O(r,e,n){return A(r,e,i.__2(n))}function R(r,e){for(var n=r.length,t=e.length,i=new Array(n+t|0),o=0;o<n;++o)i[o]=r[o];for(var a=0;a<t;++a)i[n+a|0]=e[a];return i}function D(r){for(var e=r.length,n=0,t=0;t<e;++t)n=n+r[t].length|0;var i=new Array(n);n=0;for(var o=0;o<e;++o)for(var a=r[o],u=0,c=a.length;u<c;++u)i[n]=a[u],n=n+1|0;return i}function k(r,e,n){if(n<=0)return[];var i=r.length,o=e<0?t.caml_int_max(i+e|0,0):e,a=i-o|0,u=a<n?a:n;if(u<=0)return[];for(var c=new Array(u),f=0;f<u;++f)c[f]=r[o+f|0];return c}function M(r,e){for(var n=r.length,i=e<0?t.caml_int_max(n+e|0,0):e,o=n-i|0,a=new Array(o),u=0;u<o;++u)a[u]=r[i+u|0];return a}function N(r,e,n,i){if(!(n<=0)){var o=r.length,a=e<0?t.caml_int_max(o+e|0,0):e,u=o-a|0,c=u<n?u:n;if(!(c<=0))for(var f=a,l=a+c|0;f<l;++f)r[f]=i}}function x(r,e,n,t,i){if(t<=e)for(var o=0;o<i;++o)n[o+t|0]=r[o+e|0];else for(var a=i-1|0;a>=0;--a)n[a+t|0]=r[a+e|0]}function I(r,e,n,i,o){var a=r.length,u=n.length,c=e<0?t.caml_int_max(a+e|0,0):e,f=i<0?t.caml_int_max(u+i|0,0):i,l=t.caml_int_min(o,t.caml_int_min(a-c|0,u-f|0));if(f<=c)for(var s=0;s<l;++s)n[s+f|0]=r[s+c|0];else for(var d=l-1|0;d>=0;--d)n[d+f|0]=r[d+c|0]}function U(r,e){for(var n=0,t=r.length;n<t;++n)e(r[n])}function C(r,e){return U(r,i.__1(e))}function P(r,e){for(var n=r.length,t=new Array(n),i=0;i<n;++i)t[i]=e(r[i]);return t}function T(r,e){return P(r,i.__1(e))}function L(r,e){for(var n,t=r.length,i=0;void 0===n&&i<t;){var o=r[i];e(o)&&(n=a.some(o)),i=i+1|0}return n}function V(r,e){return L(r,i.__1(e))}function q(r,e){for(var n,t=r.length,i=0;void 0===n&&i<t;){e(r[i])&&(n=i),i=i+1|0}return n}function j(r,e){return q(r,i.__1(e))}function J(r,e){for(var n=r.length,t=new Array(n),i=0,o=0;o<n;++o){var a=r[o];e(a)&&(t[i]=a,i=i+1|0)}return t.length=i,t}function B(r,e){return J(r,i.__1(e))}function W(r,e){for(var n=r.length,t=new Array(n),i=0,o=0;o<n;++o){var a=r[o];e(a,o)&&(t[i]=a,i=i+1|0)}return t.length=i,t}function F(r,e){return W(r,i.__2(e))}function X(r,e){for(var n=r.length,t=new Array(n),i=0,o=0;o<n;++o){var u=e(r[o]);void 0!==u&&(t[i]=a.valFromOption(u),i=i+1|0)}return t.length=i,t}function H(r,e){return X(r,i.__1(e))}function z(r,e){for(var n=0,t=r.length;n<t;++n)e(n,r[n])}function K(r,e){return z(r,i.__2(e))}function G(r,e){for(var n=r.length,t=new Array(n),i=0;i<n;++i)t[i]=e(i,r[i]);return t}function Y(r,e){return G(r,i.__2(e))}function Z(r,e,n){for(var t=e,i=0,o=r.length;i<o;++i)t=n(t,r[i]);return t}function $(r,e,n){return Z(r,e,i.__2(n))}function Q(r,e,n){for(var t=e,i=r.length-1|0;i>=0;--i)t=n(t,r[i]);return t}function rr(r,e,n){return Q(r,e,i.__2(n))}function er(r,e,n,i){for(var o=n,a=t.caml_int_min(r.length,e.length)-1|0;a>=0;--a)o=i(o,r[a],e[a]);return o}function nr(r,e,n,t){return er(r,e,n,i.__3(t))}function tr(r,e,n){for(var t=e,i=0,o=r.length;i<o;++i)t=n(t,r[i],i);return t}function ir(r,e,n){return tr(r,e,i.__3(n))}function or(r,e){for(var n=r.length,t=0;;){var i=t;if(i===n)return!0;if(!e(r[i]))return!1;t=i+1|0}}function ar(r,e){return or(r,i.__1(e))}function ur(r,e){for(var n=r.length,t=0;;){var i=t;if(i===n)return!1;if(e(r[i]))return!0;t=i+1|0}}function cr(r,e){return ur(r,i.__1(e))}function fr(r,e,n,t,i){for(;;){var o=n;if(o===i)return!0;if(!t(r[o],e[o]))return!1;n=o+1|0}}function lr(r,e,n){return fr(r,e,0,n,t.caml_int_min(r.length,e.length))}function sr(r,e,n){return lr(r,e,i.__2(n))}function dr(r,e,n){for(var i=0,o=t.caml_int_min(r.length,e.length);;){var a=i;if(a===o)return!1;if(n(r[a],e[a]))return!0;i=a+1|0}}function vr(r,e,n){return dr(r,e,i.__2(n))}function mr(r,e,n){var t=r.length;return t===e.length&&fr(r,e,0,n,t)}function _r(r,e,n){return mr(r,e,i.__2(n))}function hr(r,e,n){var t=r.length,i=e.length;if(t>i)return 1;if(t<i)return-1;for(var o=0;;){var a=o;if(a===t)return 0;var u=n(r[a],e[a]);if(0!==u)return u;o=a+1|0}}function pr(r,e,n){return hr(r,e,i.__2(n))}function gr(r,e){for(var n=r.length,t=0,i=0,o=new Array(n),a=new Array(n),u=0;u<n;++u){var c=r[u];e(c)?(o[t]=c,t=t+1|0):(a[i]=c,i=i+1|0)}return o.length=t,a.length=i,[o,a]}function yr(r,e){return gr(r,i.__1(e))}function Er(r){for(var e=r.length,n=new Array(e),t=new Array(e),i=0;i<e;++i){var o=r[i];n[i]=o[0],t[i]=o[1]}return[n,t]}function br(r,e,n){var t=r.length;if(0===t)return"";for(var i=t-1|0,o=0,a="";;){var u=a,c=o;if(c===i)return u+n(r[c]);a=u+(n(r[c])+e),o=c+1|0}}function wr(r,e,n){return br(r,e,i.__1(n))}},(r,e,n)=>{function t(r,e){return r<e?-1:r===e?0:1}function i(r,e){return r?e?0:1:e?-1:0}function o(r,e){return r===e?0:r<e?-1:r>e||r==r?1:e==e?-1:0}function a(r,e){return r===e?0:r<e?-1:1}function u(r,e){return r?e:r}function c(r,e){return r<e?r:e}function f(r,e){return r<e?r:e}function l(r,e){return r<e?r:e}function s(r,e){return r<e?r:e}function d(r,e){return r||e}function v(r,e){return r>e?r:e}function m(r,e){return r>e?r:e}function _(r,e){return r>e?r:e}function h(r,e){return r>e?r:e}function p(r,e){return r[1]===e[1]&&r[0]===e[0]}function g(r,e){var n=e[0],t=r[0];return t>n||!(t<n)&&r[1]>=e[1]}function y(r,e){return!p(r,e)}function E(r,e){return!g(r,e)}function b(r,e){return r[0]>e[0]||!(r[0]<e[0])&&r[1]>e[1]}function w(r,e){return!b(r,e)}function S(r,e){return g(r,e)?e:r}function A(r,e){return b(r,e)?r:e}n.r(e),n.d(e,{caml_bool_compare:()=>i,caml_bool_max:()=>d,caml_bool_min:()=>u,caml_float_compare:()=>o,caml_float_max:()=>m,caml_float_min:()=>f,caml_int32_max:()=>h,caml_int32_min:()=>s,caml_int_compare:()=>t,caml_int_max:()=>v,caml_int_min:()=>c,caml_string_compare:()=>a,caml_string_max:()=>_,caml_string_min:()=>l,i64_eq:()=>p,i64_ge:()=>g,i64_gt:()=>b,i64_le:()=>w,i64_lt:()=>E,i64_max:()=>A,i64_min:()=>S,i64_neq:()=>y})},(r,e,n)=>{n.r(e),n.d(e,{ceil:()=>f,ceil_int:()=>o,floor:()=>l,floor_int:()=>u,random_int:()=>c,unsafe_ceil:()=>i,unsafe_floor:()=>a});var t=n(29);function i(r){return Math.ceil(r)}function o(r){return r>t.max?t.max:r<t.min?t.min:Math.ceil(r)}function a(r){return Math.floor(r)}function u(r){return r>t.max?t.max:r<t.min?t.min:Math.floor(r)}function c(r,e){return u(Math.random()*(e-r|0))+r|0}var f=o,l=u},(r,e,n)=>{function t(r,e){return r===e}n.r(e),n.d(e,{equal:()=>t,max:()=>i,min:()=>o});var i=2147483647,o=-2147483648},(r,e,n)=>{n.r(e),n.d(e,{cmp:()=>w,cmpU:()=>b,eq:()=>E,eqU:()=>y,flatMap:()=>_,flatMapU:()=>m,forEach:()=>c,forEachU:()=>u,getExn:()=>f,getWithDefault:()=>h,isNone:()=>g,isSome:()=>p,keep:()=>a,keepU:()=>o,map:()=>v,mapU:()=>d,mapWithDefault:()=>s,mapWithDefaultU:()=>l});var t=n(13),i=n(17);function o(r,e){if(void 0!==r&&e(i.valFromOption(r)))return r}function a(r,e){return o(r,t.__1(e))}function u(r,e){if(void 0!==r)return e(i.valFromOption(r))}function c(r,e){return u(r,t.__1(e))}function f(r){if(void 0!==r)return i.valFromOption(r);throw{RE_EXN_ID:"Not_found",Error:new Error}}function l(r,e,n){return void 0!==r?n(i.valFromOption(r)):e}function s(r,e,n){return l(r,e,t.__1(n))}function d(r,e){if(void 0!==r)return i.some(e(i.valFromOption(r)))}function v(r,e){return d(r,t.__1(e))}function m(r,e){if(void 0!==r)return e(i.valFromOption(r))}function _(r,e){return m(r,t.__1(e))}function h(r,e){return void 0!==r?i.valFromOption(r):e}function p(r){return void 0!==r}function g(r){return void 0===r}function y(r,e,n){return void 0!==r?void 0!==e&&n(i.valFromOption(r),i.valFromOption(e)):void 0===e}function E(r,e,n){return y(r,e,t.__2(n))}function b(r,e,n){return void 0!==r?void 0!==e?n(i.valFromOption(r),i.valFromOption(e)):1:void 0!==e?-1:0}function w(r,e,n){return b(r,e,t.__2(n))}},(r,e,n)=>{n.r(e),n.d(e,{about:()=>_,answerDetail:()=>f,answerDetailShortAnswer:()=>l,clickable:()=>c,default:()=>y,mainBody:()=>u,settings:()=>s,settingsEntry:()=>d,settingsSubmit:()=>v,settingsSubmitTip:()=>m,uploadImg:()=>h,uploadImgConfirm:()=>g,uploadImgImage:()=>p});var t=n(32),i=n.n(t),o=n(33),a=n.n(o)()(i());a.push([r.id,".KtSQfh45DkzY1g4GTjHG {\n  font-size: 0.75rem;\n  opacity: 0.5;\n}\n.nl0fbl1STsJ1E_ijRd86 {\n  cursor: pointer;\n}\n.E2WC5WHEPccqZwiUT6nE p {\n  margin: 0;\n}\n.E2WC5WHEPccqZwiUT6nE ul {\n  margin: 0;\n  padding-left: 1.5rem;\n}\n.E2WC5WHEPccqZwiUT6nE img {\n  height: auto;\n  width: 80%;\n}\n.yZjHuTE6p_FgmbomqPFx {\n  border-style: groove;\n  border-width: thin;\n  margin: 0.2rem;\n  padding: 0.2rem;\n}\n._o1gebpEn7x9Td7Hes6g {\n  display: flex;\n  flex-direction: column;\n}\n.YalNJJWiNdYPl5FzO1a_ {\n  display: flex;\n  flex-direction: row;\n  margin-bottom: 0.5rem;\n  justify-content: space-between;\n  align-items: center;\n}\n.YalNJJWiNdYPl5FzO1a_ label {\n  font-weight: bold;\n}\n.YalNJJWiNdYPl5FzO1a_ input {\n  height: fit-content;\n  text-align: right;\n}\n.GkQ9CK5Dl58odGzSBLOP {\n  display: flex;\n  flex-direction: column;\n  justify-content: end;\n  align-items: end;\n}\n.CY2oPnMnonyamRy15TxZ {\n  margin-bottom: 0.5rem;\n}\n.GkQ9CK5Dl58odGzSBLOP button {\n  cursor: pointer;\n}\n.ssrv8ndZGNgvTL1Osr92 p {\n  margin-bottom: 0.25rem;\n}\n.ssrv8ndZGNgvTL1Osr92 ul {\n  padding-left: 1.5rem;\n  margin: 0 0 0.25rem 0;\n}\n.ssrv8ndZGNgvTL1Osr92 ul li {\n  margin-bottom: 0.25rem;\n}\n.UJVcq5yyVfeOtVL0dWlT {\n  display: flex;\n  flex-direction: column;\n}\n.UJVcq5yyVfeOtVL0dWlT img {\n  width: 100%;\n  height: auto;\n}\n.SB_KxqWR3Sju8ih5VCQj {\n  border-style: groove;\n  border-width: thin;\n  padding: 0.5rem;\n}\n.YM_eQySt5C11IITqy_br {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.5rem;\n}\n",""]);var u="KtSQfh45DkzY1g4GTjHG",c="nl0fbl1STsJ1E_ijRd86",f="E2WC5WHEPccqZwiUT6nE",l="yZjHuTE6p_FgmbomqPFx",s="_o1gebpEn7x9Td7Hes6g",d="YalNJJWiNdYPl5FzO1a_",v="GkQ9CK5Dl58odGzSBLOP",m="CY2oPnMnonyamRy15TxZ",_="ssrv8ndZGNgvTL1Osr92",h="UJVcq5yyVfeOtVL0dWlT",p="SB_KxqWR3Sju8ih5VCQj",g="YM_eQySt5C11IITqy_br";const y=a},r=>{r.exports=function(r){return r[1]}},r=>{r.exports=function(r){var e=[];return e.toString=function(){return this.map((function(e){var n="",t=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),t&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=r(e),t&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(r,n,t,i,o){"string"==typeof r&&(r=[[null,r,void 0]]);var a={};if(t)for(var u=0;u<this.length;u++){var c=this[u][0];null!=c&&(a[c]=!0)}for(var f=0;f<r.length;f++){var l=[].concat(r[f]);t&&a[l[0]]||(void 0!==o&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=o),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),e.push(l))}},e}},(r,e,n)=>{n.r(e),n.d(e,{Impl:()=>m,asHtmlElement:()=>v,insertAdjacentElement:()=>h,insertAdjacentHTML:()=>p,insertAdjacentText:()=>g,nodeType:()=>y,ofNode:()=>d});var t=n(17),i=n(35),o=n(36),a=n(38),u=n(39),c=n(40),f=n(37),l=n(41),s=n(42);function d(r){if(0===i.nodeType(r))return t.some(r)}var v=function(r){if(void 0!==window.constructor.name&&/^HTML\w*Element$/.test(r.constructor.name)||/^\[object HTML\w*Element\]$/.test(r.constructor.toString()))return r};function m(r){return{asHtmlElement:v,ofNode:d,insertAdjacentElement:function(r,e,n){r.insertAdjacentElement(o.encodeInsertPosition(e),n)},insertAdjacentHTML:function(r,e,n){r.insertAdjacentHTML(o.encodeInsertPosition(e),n)},insertAdjacentText:function(r,e,n){r.insertAdjacentText(o.encodeInsertPosition(e),n)}}}var _=i.Impl({});function h(r,e,n){r.insertAdjacentElement(o.encodeInsertPosition(e),n)}function p(r,e,n){r.insertAdjacentHTML(o.encodeInsertPosition(e),n)}function g(r,e,n){r.insertAdjacentText(o.encodeInsertPosition(e),n)}f.Impl({}),l.Impl({}),c.Impl({}),s.Impl({}),u.Impl({}),a.Impl({});var y=_.nodeType},(r,e,n)=>{n.r(e),n.d(e,{Impl:()=>i,nodeType:()=>o});var t=n(36);function i(r){return{nodeType:function(r){return t.decodeNodeType(r.nodeType)}}}function o(r){return t.decodeNodeType(r.nodeType)}n(37).Impl({})},(r,e,n)=>{function t(r){return r}function i(r){return r+1>>>0>2?3:r+1|0}function o(r){switch(r){case"BackCompat":return 0;case"CSS1Compat":return 1;default:return 2}}function a(r){switch(r){case 0:return"true";case 1:return"false";case 2:return"inherit";case 3:return""}}function u(r){switch(r){case"false":return 1;case"inherit":return 2;case"true":return 0;default:return 3}}function c(r){if(r>2||r<0)throw{RE_EXN_ID:"Invalid_argument",_1:"invalid deltaMode",Error:new Error};return r}function f(r){switch(r){case 0:return"on";case 1:return"off";case 2:return""}}function l(r){switch(r){case"off":return 1;case"on":return 0;default:return 2}}function s(r){switch(r){case 0:return"ltr";case 1:return"rtl";case 2:return""}}function d(r){switch(r){case"ltr":return 0;case"rtl":return 1;default:return 2}}n.r(e),n.d(e,{EventPhase:()=>v,WhatToShow:()=>w,decodeCompareResult:()=>i,decodeCompatMode:()=>o,decodeContentEditable:()=>u,decodeDeltaMode:()=>c,decodeDesignMode:()=>l,decodeDir:()=>d,decodeNodeType:()=>p,decodePointerType:()=>g,decodeReadyState:()=>y,decodeShadowRootMode:()=>E,decodeVisibilityState:()=>b,encodeCompareHow:()=>t,encodeContentEditable:()=>a,encodeDesignMode:()=>f,encodeDir:()=>s,encodeFilterAction:()=>m,encodeInsertPosition:()=>_,encodeModifierKey:()=>h});var v={decode:function(r){return r>3||r<0?4:r}};function m(r){return r+1|0}function _(r){switch(r){case 0:return"beforebegin";case 1:return"afterbegin";case 2:return"beforeend";case 3:return"afterend"}}function h(r){switch(r){case 0:return"Alt";case 1:return"AltGraph";case 2:return"CapsLock";case 3:return"Control";case 4:return"Fn";case 5:return"FnLock";case 6:return"Hyper";case 7:return"Meta";case 8:return"NumLock";case 9:return"ScrollLock";case 10:return"Shift";case 11:return"Super";case 12:return"Symbol";case 13:return"SymbolLock"}}function p(r){return r>12||r<1?12:r-1|0}function g(r){switch(r){case"mouse":return 0;case"pen":return 1;case"touch|":return 2;default:return 3}}function y(r){switch(r){case"complete":return 2;case"interactive":return 1;case"loading":return 0;default:return 3}}function E(r){switch(r){case"closed":return 1;case"open":return 0;default:throw{RE_EXN_ID:"Invalid_argument",_1:"Unknown shadowRootMode",Error:new Error}}}function b(r){switch(r){case"hidden":return 1;case"prerender":return 2;case"unloaded":return 3;case"visible":return 0;default:return 4}}var w={_All:-1,_Element:1,_Attribute:2,_Text:4,_CDATASection:8,_EntityReference:16,_Entity:32,_ProcessingInstruction:64,_Comment:128,_Document:256,_DocumentType:512,_DocumentFragment:1024,_Notation:2048,many:function r(e){return e?e.hd|r(e.tl):0}}},(r,e,n)=>{function t(r){return{}}n.r(e),n.d(e,{Impl:()=>t})},(r,e,n)=>{function t(r){return{}}n.r(e),n.d(e,{Impl:()=>t})},(r,e,n)=>{function t(r){return{}}n.r(e),n.d(e,{Impl:()=>t})},(r,e,n)=>{function t(r){return{}}n.r(e),n.d(e,{Impl:()=>t})},(r,e,n)=>{function t(r){return{}}n.r(e),n.d(e,{Impl:()=>t})},(r,e,n)=>{function t(r){return{}}n.r(e),n.d(e,{Impl:()=>t})},(r,e,n)=>{n.r(e),n.d(e,{Impl:()=>f,asHtmlDocument:()=>s,compatMode:()=>v,nodeType:()=>_,ofNode:()=>d,visibilityState:()=>m});var t=n(17),i=n(35),o=n(36),a=n(40),u=n(37),c=n(44);function f(r){return{asHtmlDocument:function(r){var e=r.defaultView;if(null!=e){var n=e.HTMLDocument;if(null!=n&&r instanceof n)return r}},ofNode:function(r){if(8===i.nodeType(r))return t.some(r)},compatMode:function(r){return o.decodeCompatMode(r.compatMode)},visibilityState:function(r){return o.decodeVisibilityState(r.visibilityState)}}}var l=i.Impl({});u.Impl({}),c.Impl({}),a.Impl({});var s=function(r){var e=r.defaultView;if(null!=e){var n=e.HTMLDocument;if(null!=n&&r instanceof n)return r}};function d(r){if(8===i.nodeType(r))return t.some(r)}function v(r){return o.decodeCompatMode(r.compatMode)}function m(r){return o.decodeVisibilityState(r.visibilityState)}var _=l.nodeType},(r,e,n)=>{function t(r){return{}}n.r(e),n.d(e,{Impl:()=>t})},(r,e,n)=>{n.r(e),n.d(e,{Answer:()=>p,Blank:()=>k,Choice:()=>O,Detail:()=>E,React:()=>{},ReactDOMRe:()=>{},ShortAnswer:()=>N,Tooltip:()=>y,percent:()=>b,sortByKey:()=>w,style:()=>h});var t=n(13),i=n(22),o=n(25),a=n(46),u=n(52),c=n(26),f=n(53),l=n(30),s=n(17),d=n(54),v=n(56),m=n(31),_=n(58),h=m,p={};function g(r,e){r.ele.setAttribute("title",e)}var y={make:function(r){return{ele:r}},setContent:g};var E={Make:function(r){var e=function(r,e,n){o.openWin("详细答案",200,300,n,e,void 0)[1].appendChild(l.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:o.joinStrings([h.mainBody,h.answerDetail]," ")},[r.detailHtml]))))};return{showDetail:e,make:function(n,i){var o={detail:void 0,detailHtml:null,context:t._2(r.make,n,i)},a=l.getExn(s.nullable_to_opt(n.querySelector(".item-type")));return a.classList.add(h.clickable),a.addEventListener("click",(function(r){var n=a.getBoundingClientRect();return e(o,0|n.top,0|n.left)})),o},updateAnswer:function(r,e,n){r.detail=d.set(r.detail,e,n)},updateUI:function(e){e.detailHtml=t._2(r.updateUI,e.detail,e.context)}}}};function b(r,e){return String(f.div(Math.imul(r,100),e))+"%"}function w(r){return v.stableSortBy(r,(function(r,e){return a.compare(r[0],e[0])}))}function S(r,e){return{tooltips:c.reduceWithIndex(o.querySelectorAllElements(r,".item-body .checkboxInput, .item-body .radioInput"),void 0,(function(r,e,n){return d.set(r,String.fromCharCode(n+65|0),{ele:e})})),choiceMap:e}}function A(r,e,n){o.openWin("详细答案",200,300,n,e,void 0)[1].appendChild(l.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:o.joinStrings([h.mainBody,h.answerDetail]," ")},[r.detailHtml]))))}var O={showDetail:A,make:function(r,e){var n={detail:void 0,detailHtml:null,context:S(r,e)},t=l.getExn(s.nullable_to_opt(r.querySelector(".item-type")));return t.classList.add(h.clickable),t.addEventListener("click",(function(r){var e=t.getBoundingClientRect();return A(n,0|e.top,0|e.left)})),n},updateAnswer:function(r,e,n){r.detail=d.set(r.detail,e,n)},updateUI:function(r){var e,n;r.detailHtml=(e=r.detail,n=r.context,c.map(w(c.map(d.toArray(d.reduce(e,void 0,(function(r,e,n){return c.reduce(n,r,(function(r,n){return d.update(r,n,(function(r){return c.concat(l.getWithDefault(r,[]),[e])}))}))}))),(function(r){return[t._1(n.choiceMap,r[0]),r[1]]}))),(function(r){var t=r[1],a=r[0];return l.forEach(d.get(n.tooltips,a),(function(r){return g(r,b(t.length,d.size(e)))})),i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,[a])]),i.createElement(o.UList.make,{children:c.map(_.stableSort(t),(function(r){return i.DOMRe.createDOMElementVariadic("p",void 0,[r])}))})])})))}};function R(r,e){return{tooltips:c.reduceWithIndex(o.querySelectorAllElements(r,".item-body .blank-item-dynamic"),void 0,(function(r,e,n){return d.set(r,String.fromCharCode(49+n|0),{ele:e})}))}}function D(r,e,n){o.openWin("详细答案",200,300,n,e,void 0)[1].appendChild(l.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:o.joinStrings([h.mainBody,h.answerDetail]," ")},[r.detailHtml]))))}var k={showDetail:D,make:function(r,e){var n={detail:void 0,detailHtml:null,context:R(r)},t=l.getExn(s.nullable_to_opt(r.querySelector(".item-type")));return t.classList.add(h.clickable),t.addEventListener("click",(function(r){var e=t.getBoundingClientRect();return D(n,0|e.top,0|e.left)})),n},updateAnswer:function(r,e,n){r.detail=d.set(r.detail,e,n)},updateUI:function(r){var e,n;r.detailHtml=(e=r.detail,n=r.context,c.map(w(d.toArray(d.reduce(e,void 0,(function(r,e,n){return c.reduce(w(u.entries(n)),r,(function(r,n){var t=n[1];return d.update(r,n[0],(function(r){return s.some(d.update(l.getWithDefault(r,void 0),t,(function(r){return c.concat(l.getWithDefault(r,[]),[e])})))}))}))})))),(function(r){var t=r[0],a=w(d.toArray(r[1]));return l.forEach(d.get(n.tooltips,t),(function(r){return g(r,l.mapWithDefault(c.get(v.stableSortBy(c.map(a,(function(r){return[r[0],r[1].length]})),(function(r,e){return e[1]-r[1]|0})),0),"",(function(r){return"("+b(r[1],d.size(e))+") "+r[0]})))})),i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,["#"+t])]),i.createElement(o.UList.make,{children:c.map(a,(function(r){return i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",void 0,[r[0]]),i.createElement(o.UList.make,{children:c.map(_.stableSort(r[1]),(function(r){return i.DOMRe.createDOMElementVariadic("p",void 0,[r])}))})])}))})])})))}};function M(r,e,n){o.openWin("详细答案",200,300,n,e,void 0)[1].appendChild(l.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:o.joinStrings([h.mainBody,h.answerDetail]," ")},[r.detailHtml]))))}var N={showDetail:M,make:function(r,e){var n={detail:void 0,detailHtml:null,context:void 0},t=l.getExn(s.nullable_to_opt(r.querySelector(".item-type")));return t.classList.add(h.clickable),t.addEventListener("click",(function(r){var e=t.getBoundingClientRect();return M(n,0|e.top,0|e.left)})),n},updateAnswer:function(r,e,n){r.detail=d.set(r.detail,e,n)},updateUI:function(r){var e;r.detailHtml=(e=r.detail,r.context,c.map(w(d.toArray(e)),(function(r){var e=r[1];return i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,[r[0]])]),l.mapWithDefault(e.content,null,(function(r){return i.DOMRe.createDOMElementVariadic("div",{className:h.answerDetailShortAnswer,dangerouslySetInnerHTML:{__html:r}},[])})),l.mapWithDefault(l.flatMap(e.attachments,(function(r){return r.filelist})),null,(function(r){return i.createElement(o.UList.make,{children:c.map(r,(function(r){return i.DOMRe.createDOMElementVariadic("a",{href:r.fileUrl},[r.fileName])}))})})),i.DOMRe.createDOMElementVariadic("div",void 0,[])])})))}}},(r,e,n)=>{n.r(e),n.d(e,{blit:()=>H,capitalize:()=>W,capitalize_ascii:()=>L,compare:()=>q,concat:()=>d,contains:()=>U,contains_from:()=>I,equal:()=>z,escaped:()=>y,index:()=>b,index_from:()=>A,index_from_opt:()=>O,index_opt:()=>S,init:()=>f,iter:()=>v,iteri:()=>m,lowercase:()=>B,lowercase_ascii:()=>T,make:()=>X,map:()=>_,mapi:()=>h,rcontains_from:()=>C,rindex:()=>D,rindex_from:()=>k,rindex_from_opt:()=>x,rindex_opt:()=>N,split_on_char:()=>j,sub:()=>l,trim:()=>g,uncapitalize:()=>F,uncapitalize_ascii:()=>V,uppercase:()=>J,uppercase_ascii:()=>P});var t=n(27),i=n(47),o=n(13),a=n(49),u=n(51),c=n(50);function f(r,e){return a.bytes_to_string(i.init(r,e))}function l(r,e,n){return a.bytes_to_string(i.sub(a.bytes_of_string(r),e,n))}function s(r,e){if(r>=e)return r;throw{RE_EXN_ID:"Invalid_argument",_1:"String.concat",Error:new Error}}function d(r,e){if(!e)return"";var n=r.length;return a.bytes_to_string(function(r,e,n,t,i){for(;;){var o=i,u=e;if(!o)return r;var c=o.tl,f=o.hd;if(!c)return a.caml_blit_string(f,0,r,u,f.length),r;a.caml_blit_string(f,0,r,u,f.length),a.caml_blit_string(n,0,r,u+f.length|0,t),i=c,e=(u+f.length|0)+t|0}}(a.caml_create_bytes(function(r,e,n){for(;;){var t=n,i=r;if(!t)return i;var o=t.tl,a=t.hd;if(!o)return a.length+i|0;n=o,r=s((a.length+e|0)+i|0,i)}}(0,n,e)),0,r,n,e))}function v(r,e){for(var n=0,t=e.length;n<t;++n)o._1(r,e.charCodeAt(n))}function m(r,e){for(var n=0,t=e.length;n<t;++n)o._2(r,n,e.charCodeAt(n))}function _(r,e){return a.bytes_to_string(i.map(r,a.bytes_of_string(e)))}function h(r,e){return a.bytes_to_string(i.mapi(r,a.bytes_of_string(e)))}function p(r){return r>13||r<9?32===r:11!==r}function g(r){return""===r||!p(r.charCodeAt(0))&&!p(r.charCodeAt(r.length-1|0))?r:a.bytes_to_string(i.trim(a.bytes_of_string(r)))}function y(r){return function(e){for(;;){var n=e;if(n>=r.length)return!1;var t=r.charCodeAt(n);if(t<32)return!0;if(t>92||t<34){if(t>=127)return!0;e=n+1|0}else{if(t>91||t<35)return!0;e=n+1|0}}}(0)?a.bytes_to_string(i.escaped(a.bytes_of_string(r))):r}function E(r,e,n,t){for(;;){var i=n;if(i>=e)throw{RE_EXN_ID:"Not_found",Error:new Error};if(r.charCodeAt(i)===t)return i;n=i+1|0}}function b(r,e){return E(r,r.length,0,e)}function w(r,e,n,t){for(;;){var i=n;if(i>=e)return;if(r.charCodeAt(i)===t)return i;n=i+1|0}}function S(r,e){return w(r,r.length,0,e)}function A(r,e,n){var t=r.length;if(e<0||e>t)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from / Bytes.index_from",Error:new Error};return E(r,t,e,n)}function O(r,e,n){var t=r.length;if(e<0||e>t)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from_opt / Bytes.index_from_opt",Error:new Error};return w(r,t,e,n)}function R(r,e,n){for(;;){var t=e;if(t<0)throw{RE_EXN_ID:"Not_found",Error:new Error};if(r.charCodeAt(t)===n)return t;e=t-1|0}}function D(r,e){return R(r,r.length-1|0,e)}function k(r,e,n){if(e<-1||e>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from / Bytes.rindex_from",Error:new Error};return R(r,e,n)}function M(r,e,n){for(;;){var t=e;if(t<0)return;if(r.charCodeAt(t)===n)return t;e=t-1|0}}function N(r,e){return M(r,r.length-1|0,e)}function x(r,e,n){if(e<-1||e>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from_opt / Bytes.rindex_from_opt",Error:new Error};return M(r,e,n)}function I(r,e,n){var t=r.length;if(e<0||e>t)throw{RE_EXN_ID:"Invalid_argument",_1:"String.contains_from / Bytes.contains_from",Error:new Error};try{return E(r,t,e,n),!0}catch(r){var i=c.internalToOCamlException(r);if("Not_found"===i.RE_EXN_ID)return!1;throw i}}function U(r,e){return I(r,0,e)}function C(r,e,n){if(e<0||e>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rcontains_from / Bytes.rcontains_from",Error:new Error};try{return R(r,e,n),!0}catch(r){var t=c.internalToOCamlException(r);if("Not_found"===t.RE_EXN_ID)return!1;throw t}}function P(r){return a.bytes_to_string(i.uppercase_ascii(a.bytes_of_string(r)))}function T(r){return a.bytes_to_string(i.lowercase_ascii(a.bytes_of_string(r)))}function L(r){return a.bytes_to_string(i.capitalize_ascii(a.bytes_of_string(r)))}function V(r){return a.bytes_to_string(i.uncapitalize_ascii(a.bytes_of_string(r)))}var q=t.caml_string_compare;function j(r,e){for(var n=0,t=e.length,i=e.length-1|0;i>=0;--i)e.charCodeAt(i)===r&&(n={hd:l(e,i+1|0,(t-i|0)-1|0),tl:n},t=i);return{hd:l(e,0,t),tl:n}}function J(r){return a.bytes_to_string(i.uppercase(a.bytes_of_string(r)))}function B(r){return a.bytes_to_string(i.lowercase(a.bytes_of_string(r)))}function W(r){return a.bytes_to_string(i.capitalize(a.bytes_of_string(r)))}function F(r){return a.bytes_to_string(i.uncapitalize(a.bytes_of_string(r)))}var X=u.make,H=i.blit_string;function z(r,e){return r===e}},(r,e,n)=>{n.r(e),n.d(e,{blit:()=>y,blit_string:()=>E,capitalize:()=>rr,capitalize_ascii:()=>C,cat:()=>O,compare:()=>Z,concat:()=>A,contains:()=>G,contains_from:()=>K,copy:()=>s,empty:()=>l,equal:()=>nr,escaped:()=>k,extend:()=>p,fill:()=>g,index:()=>L,index_from:()=>j,index_from_opt:()=>J,index_opt:()=>q,init:()=>f,iter:()=>b,iteri:()=>w,lowercase:()=>Q,lowercase_ascii:()=>I,make:()=>c,map:()=>M,mapi:()=>N,of_string:()=>v,rcontains_from:()=>Y,rindex:()=>W,rindex_from:()=>F,rindex_from_opt:()=>z,rindex_opt:()=>H,sub:()=>m,sub_string:()=>_,to_string:()=>d,trim:()=>D,uncapitalize:()=>er,uncapitalize_ascii:()=>P,unsafe_of_string:()=>ir,unsafe_to_string:()=>tr,uppercase:()=>$,uppercase_ascii:()=>x});var t=n(27),i=n(48),o=n(13),a=n(49),u=n(50);function c(r,e){var n=a.caml_create_bytes(r);return a.caml_fill_bytes(n,0,r,e),n}function f(r,e){for(var n=a.caml_create_bytes(r),t=0;t<r;++t)n[t]=o._1(e,t);return n}var l=[];function s(r){var e=r.length,n=a.caml_create_bytes(e);return a.caml_blit_bytes(r,0,n,0,e),n}function d(r){return a.bytes_to_string(s(r))}function v(r){return s(a.bytes_of_string(r))}function m(r,e,n){if(e<0||n<0||e>(r.length-n|0))throw{RE_EXN_ID:"Invalid_argument",_1:"String.sub / Bytes.sub",Error:new Error};var t=a.caml_create_bytes(n);return a.caml_blit_bytes(r,e,t,0,n),t}function _(r,e,n){return a.bytes_to_string(m(r,e,n))}function h(r,e){var n=r+e|0,t=e<0,i=n<0;if(r<0){if(!t)return n;if(i)return n;throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.extend",Error:new Error}}if(t)return n;if(i)throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.extend",Error:new Error};return n}function p(r,e,n){var i=h(h(r.length,e),n),o=a.caml_create_bytes(i),u=e<0?[0|-e,0]:[0,e],c=u[1],f=u[0],l=t.caml_int_min(r.length-f|0,i-c|0);return l>0&&a.caml_blit_bytes(r,f,o,c,l),o}function g(r,e,n,t){if(e<0||n<0||e>(r.length-n|0))throw{RE_EXN_ID:"Invalid_argument",_1:"String.fill / Bytes.fill",Error:new Error};return a.caml_fill_bytes(r,e,n,t)}function y(r,e,n,t,i){if(i<0||e<0||e>(r.length-i|0)||t<0||t>(n.length-i|0))throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.blit",Error:new Error};return a.caml_blit_bytes(r,e,n,t,i)}function E(r,e,n,t,i){if(i<0||e<0||e>(r.length-i|0)||t<0||t>(n.length-i|0))throw{RE_EXN_ID:"Invalid_argument",_1:"String.blit / Bytes.blit_string",Error:new Error};return a.caml_blit_string(r,e,n,t,i)}function b(r,e){for(var n=0,t=e.length;n<t;++n)o._1(r,e[n])}function w(r,e){for(var n=0,t=e.length;n<t;++n)o._2(r,n,e[n])}function S(r,e){if(r>=e)return r;throw{RE_EXN_ID:"Invalid_argument",_1:"Bytes.concat",Error:new Error}}function A(r,e){if(!e)return l;for(var n=r.length,t=a.caml_create_bytes(function(r,e,n){for(;;){var t=n,i=r;if(!t)return i;var o=t.tl,a=t.hd;if(!o)return a.length+i|0;n=o,r=S((a.length+e|0)+i|0,i)}}(0,n,e)),i=0,o=e;;){var u=o,c=i;if(!u)return t;var f=u.tl,s=u.hd;if(!f)return a.caml_blit_bytes(s,0,t,c,s.length),t;a.caml_blit_bytes(s,0,t,c,s.length),a.caml_blit_bytes(r,0,t,c+s.length|0,n),o=f,i=(c+s.length|0)+n|0}}function O(r,e){var n=r.length,t=e.length,i=a.caml_create_bytes(n+t|0);return a.caml_blit_bytes(r,0,i,0,n),a.caml_blit_bytes(e,0,i,n,t),i}function R(r){return r>13||r<9?32===r:11!==r}function D(r){for(var e=r.length,n=0;n<e&&R(r[n]);)n=n+1|0;for(var t=e-1|0;t>=n&&R(r[t]);)t=t-1|0;return t>=n?m(r,n,1+(t-n|0)|0):l}function k(r){for(var e=0,n=0,t=r.length;n<t;++n){var i=r[n];e=e+(i>=32?i>92||i<34?i>=127?4:1:i>91||i<35?2:1:i>=11?13!==i?4:2:i>=8?2:4)|0}if(e===r.length)return s(r);var o=a.caml_create_bytes(e);e=0;for(var u=0,c=r.length;u<c;++u){var f=r[u],l=0;if(f>=35)92!==f?f>=127?l=1:o[e]=f:l=2;else if(f>=32)f>=34?l=2:o[e]=f;else if(f>=14)l=1;else switch(f){case 8:o[e]=92,o[e=e+1|0]=98;break;case 9:o[e]=92,o[e=e+1|0]=116;break;case 10:o[e]=92,o[e=e+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:l=1;break;case 13:o[e]=92,o[e=e+1|0]=114}switch(l){case 1:o[e]=92,o[e=e+1|0]=48+(f/100|0)|0,o[e=e+1|0]=48+(f/10|0)%10|0,o[e=e+1|0]=48+f%10|0;break;case 2:o[e]=92,o[e=e+1|0]=f}e=e+1|0}return o}function M(r,e){var n=e.length;if(0===n)return e;for(var t=a.caml_create_bytes(n),i=0;i<n;++i)t[i]=o._1(r,e[i]);return t}function N(r,e){var n=e.length;if(0===n)return e;for(var t=a.caml_create_bytes(n),i=0;i<n;++i)t[i]=o._2(r,i,e[i]);return t}function x(r){return M(i.uppercase_ascii,r)}function I(r){return M(i.lowercase_ascii,r)}function U(r,e){if(0===e.length)return e;var n=s(e);return n[0]=o._1(r,e[0]),n}function C(r){return U(i.uppercase_ascii,r)}function P(r){return U(i.lowercase_ascii,r)}function T(r,e,n,t){for(;;){var i=n;if(i>=e)throw{RE_EXN_ID:"Not_found",Error:new Error};if(r[i]===t)return i;n=i+1|0}}function L(r,e){return T(r,r.length,0,e)}function V(r,e,n,t){for(;;){var i=n;if(i>=e)return;if(r[i]===t)return i;n=i+1|0}}function q(r,e){return V(r,r.length,0,e)}function j(r,e,n){var t=r.length;if(e<0||e>t)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from / Bytes.index_from",Error:new Error};return T(r,t,e,n)}function J(r,e,n){var t=r.length;if(e<0||e>t)throw{RE_EXN_ID:"Invalid_argument",_1:"String.index_from_opt / Bytes.index_from_opt",Error:new Error};return V(r,t,e,n)}function B(r,e,n){for(;;){var t=e;if(t<0)throw{RE_EXN_ID:"Not_found",Error:new Error};if(r[t]===n)return t;e=t-1|0}}function W(r,e){return B(r,r.length-1|0,e)}function F(r,e,n){if(e<-1||e>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from / Bytes.rindex_from",Error:new Error};return B(r,e,n)}function X(r,e,n){for(;;){var t=e;if(t<0)return;if(r[t]===n)return t;e=t-1|0}}function H(r,e){return X(r,r.length-1|0,e)}function z(r,e,n){if(e<-1||e>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rindex_from_opt / Bytes.rindex_from_opt",Error:new Error};return X(r,e,n)}function K(r,e,n){var t=r.length;if(e<0||e>t)throw{RE_EXN_ID:"Invalid_argument",_1:"String.contains_from / Bytes.contains_from",Error:new Error};try{return T(r,t,e,n),!0}catch(r){var i=u.internalToOCamlException(r);if("Not_found"===i.RE_EXN_ID)return!1;throw i}}function G(r,e){return K(r,0,e)}function Y(r,e,n){if(e<0||e>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"String.rcontains_from / Bytes.rcontains_from",Error:new Error};try{return B(r,e,n),!0}catch(r){var t=u.internalToOCamlException(r);if("Not_found"===t.RE_EXN_ID)return!1;throw t}}var Z=a.caml_bytes_compare;function $(r){return M(i.uppercase,r)}function Q(r){return M(i.lowercase,r)}function rr(r){return U(i.uppercase,r)}function er(r){return U(i.lowercase,r)}var nr=a.caml_bytes_equal,tr=a.bytes_to_string,ir=a.bytes_of_string},(r,e,n)=>{n.r(e),n.d(e,{chr:()=>i,compare:()=>l,equal:()=>s,escaped:()=>o,lowercase:()=>a,lowercase_ascii:()=>c,uppercase:()=>u,uppercase_ascii:()=>f});var t=n(49);function i(r){if(r<0||r>255)throw{RE_EXN_ID:"Invalid_argument",_1:"Char.chr",Error:new Error};return r}function o(r){var e=0;if(r>=40){if(92===r)return"\\\\";e=r>=127?1:2}else if(r>=32){if(r>=39)return"\\'";e=2}else if(r>=14)e=1;else switch(r){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:e=1;break;case 13:return"\\r"}switch(e){case 1:var n=[0,0,0,0];return n[0]=92,n[1]=48+(r/100|0)|0,n[2]=48+(r/10|0)%10|0,n[3]=48+r%10|0,t.bytes_to_string(n);case 2:var i=[0];return i[0]=r,t.bytes_to_string(i)}}function a(r){return r>=65&&r<=90||r>=192&&r<=214||r>=216&&r<=222?r+32|0:r}function u(r){return r>=97&&r<=122||r>=224&&r<=246||r>=248&&r<=254?r-32|0:r}function c(r){return r>=65&&r<=90?r+32|0:r}function f(r){return r>=97&&r<=122?r-32|0:r}function l(r,e){return r-e|0}function s(r,e){return 0==(r-e|0)}},(r,e,n)=>{function t(r,e,n){if(e<0||e>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};r[e]=n}function i(r,e){if(e<0||e>=r.length)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return r[e]}function o(r,e,n,t){if(!(n<=0))for(var i=e,o=n+e|0;i<o;++i)r[i]=t}function a(r){if(r<0)throw{RE_EXN_ID:"Invalid_argument",_1:"String.create",Error:new Error};for(var e=new Array(r),n=0;n<r;++n)e[n]=0;return e}function u(r,e,n,t,i){if(!(i<=0))if(r!==n){var o=r.length-e|0;if(i<=o)for(var a=0;a<i;++a)n[t+a|0]=r[e+a|0];else{for(var u=0;u<o;++u)n[t+u|0]=r[e+u|0];for(var c=o;c<i;++c)n[t+c|0]=0}}else{if(e<t){for(var f=(r.length-t|0)-1|0,l=i-1|0,s=f>l?l:f;s>=0;--s)r[t+s|0]=r[e+s|0];return}if(e<=t)return;for(var d=(r.length-e|0)-1|0,v=i-1|0,m=d>v?v:d,_=0;_<=m;++_)r[t+_|0]=r[e+_|0]}}function c(r){var e=r.length,n="",t=e;if(e<=4096&&e===r.length)return String.fromCharCode.apply(null,r);for(var i=0;t>0;){for(var o=t<1024?t:1024,a=new Array(o),u=0;u<o;++u)a[u]=r[u+i|0];n+=String.fromCharCode.apply(null,a),t=t-o|0,i=i+o|0}return n}function f(r,e,n,t,i){if(!(i<=0)){var o=r.length-e|0;if(i<=o)for(var a=0;a<i;++a)n[t+a|0]=r.charCodeAt(e+a|0);else{for(var u=0;u<o;++u)n[t+u|0]=r.charCodeAt(e+u|0);for(var c=o;c<i;++c)n[t+c|0]=0}}}function l(r){for(var e=r.length,n=new Array(e),t=0;t<e;++t)n[t]=r.charCodeAt(t);return n}function s(r,e,n,t,i){for(;;){var o=n;if(o>=t)return i;var a=r[o],u=e[o];if(a>u)return 1;if(a<u)return-1;n=o+1|0}}function d(r,e){var n=r.length,t=e.length;return n===t?s(r,e,0,n,0):n<t?s(r,e,0,n,-1):s(r,e,0,t,1)}function v(r,e){var n=r.length;if(n!==e.length)return!1;for(var t=0;;){var i=t;if(i===n)return!0;if(r[i]!==e[i])return!1;t=i+1|0}}function m(r,e){return d(r,e)>0}function _(r,e){return d(r,e)>=0}function h(r,e){return d(r,e)<0}function p(r,e){return d(r,e)<=0}n.r(e),n.d(e,{bytes_of_string:()=>l,bytes_to_string:()=>c,caml_blit_bytes:()=>u,caml_blit_string:()=>f,caml_bytes_compare:()=>d,caml_bytes_equal:()=>v,caml_bytes_greaterequal:()=>_,caml_bytes_greaterthan:()=>m,caml_bytes_lessequal:()=>p,caml_bytes_lessthan:()=>h,caml_create_bytes:()=>a,caml_fill_bytes:()=>o,get:()=>i,set:()=>t})},(r,e,n)=>{n.r(e),n.d(e,{$$Error:()=>o,caml_as_js_exn:()=>u,internalToOCamlException:()=>a});var t=n(17),i=n(16),o=i.create("Caml_js_exceptions.Error");function a(r){return i.caml_is_extension(r)?r:{RE_EXN_ID:o,_1:r}}function u(r){if(r.RE_EXN_ID===o)return t.some(r._1)}},(r,e,n)=>{function t(r,e){if(e>=r.length||e<0)throw{RE_EXN_ID:"Invalid_argument",_1:"index out of bounds",Error:new Error};return r.charCodeAt(e)}function i(r,e){return String.fromCharCode(e).repeat(r)}n.r(e),n.d(e,{get:()=>t,make:()=>i})},(r,e,n)=>{n.r(e),n.d(e,{entries:()=>a,fromArray:()=>f,fromList:()=>c,get:()=>i,map:()=>l,unsafeDeleteKey:()=>o,values:()=>u});var t=n(17);function i(r,e){if(e in r)return t.some(r[e])}var o=function(r,e){delete r[e]};function a(r){for(var e=Object.keys(r),n=e.length,t=new Array(n),i=0;i<n;++i){var o=e[i];t[i]=[o,r[o]]}return t}function u(r){for(var e=Object.keys(r),n=e.length,t=new Array(n),i=0;i<n;++i)t[i]=r[e[i]];return t}function c(r){for(var e={},n=r;;){var t=n;if(!t)return e;var i=t.hd;e[i[0]]=i[1],n=t.tl}}function f(r){for(var e={},n=r.length,t=0;t<n;++t){var i=r[t];e[i[0]]=i[1]}return e}function l(r,e){for(var n={},t=Object.keys(e),i=t.length,o=0;o<i;++o){var a=t[o];n[a]=r(e[a])}return n}},(r,e,n)=>{function t(r,e){if(0===e)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return r/e|0}function i(r,e){if(0===e)throw{RE_EXN_ID:"Division_by_zero",Error:new Error};return r%e}n.r(e),n.d(e,{div:()=>t,mod_:()=>i})},(r,e,n)=>{n.r(e),n.d(e,{checkInvariantInternal:()=>K,cmp:()=>p,cmpU:()=>h,empty:()=>{},eq:()=>y,eqU:()=>g,every:()=>D,everyU:()=>R,findFirstBy:()=>b,findFirstByU:()=>E,forEach:()=>S,forEachU:()=>w,fromArray:()=>U,get:()=>F,getExn:()=>z,getUndefined:()=>X,getWithDefault:()=>H,has:()=>_,isEmpty:()=>m,keep:()=>$,keepU:()=>Z,keysToArray:()=>C,map:()=>tr,mapU:()=>nr,mapWithKey:()=>or,mapWithKeyU:()=>ir,maxKey:()=>V,maxKeyUndefined:()=>q,maxUndefined:()=>W,maximum:()=>B,merge:()=>Y,mergeMany:()=>v,mergeU:()=>G,minKey:()=>T,minKeyUndefined:()=>L,minUndefined:()=>J,minimum:()=>j,partition:()=>rr,partitionU:()=>Q,reduce:()=>O,reduceU:()=>A,remove:()=>s,removeMany:()=>d,set:()=>u,size:()=>N,some:()=>M,someU:()=>k,split:()=>er,toArray:()=>I,toList:()=>x,update:()=>f,updateU:()=>c,valuesToArray:()=>P});var t=n(13),i=n(17),o=n(55),a=n(57);function u(r,e,n){if(void 0===r)return o.singleton(e,n);var t=r.k;if(e===t)return o.updateValue(r,n);var i=r.v;return e<t?o.bal(u(r.l,e,n),t,i,r.r):o.bal(r.l,t,i,u(r.r,e,n))}function c(r,e,n){if(void 0!==r){var t=r.k;if(e===t){var a=n(i.some(r.v));if(void 0!==a)return o.updateValue(r,i.valFromOption(a));var u=r.l,f=r.r;if(void 0===u)return f;if(void 0===f)return u;var l={contents:f.k},s={contents:f.v},d=o.removeMinAuxWithRef(f,l,s);return o.bal(u,l.contents,s.contents,d)}var v=r.v,m=r.l,_=r.r;if(e<t){var h=c(m,e,n);return m===h?r:o.bal(h,t,v,_)}var p=c(_,e,n);return _===p?r:o.bal(m,t,v,p)}var g=n(void 0);return void 0!==g?o.singleton(e,i.valFromOption(g)):r}function f(r,e,n){return c(r,e,t.__1(n))}function l(r,e){var n=r.k,t=r.l,i=r.r;if(e===n){if(void 0===t)return i;if(void 0===i)return t;var a={contents:i.k},u={contents:i.v},c=o.removeMinAuxWithRef(i,a,u);return o.bal(t,a.contents,u.contents,c)}if(e<n){if(void 0===t)return r;var f=l(t,e);return f===t?r:o.bal(f,n,r.v,i)}if(void 0===i)return r;var s=l(i,e);return o.bal(t,n,r.v,s)}function s(r,e){if(void 0!==r)return l(r,e)}function d(r,e){var n=e.length;if(void 0!==r)for(var t=r,i=0;;){var o=i;if(o>=n)return t;var a=l(t,e[o]);if(void 0===a)return a;i=o+1|0,t=a}}function v(r,e){for(var n=e.length,t=r,i=0;i<n;++i){var o=e[i];t=u(t,o[0],o[1])}return t}var m=o.isEmpty,_=a.has,h=a.cmpU,p=a.cmp,g=a.eqU,y=a.eq,E=o.findFirstByU,b=o.findFirstBy,w=o.forEachU,S=o.forEach,A=o.reduceU,O=o.reduce,R=o.everyU,D=o.every,k=o.someU,M=o.some,N=o.size,x=o.toList,I=o.toArray,U=a.fromArray,C=o.keysToArray,P=o.valuesToArray,T=o.minKey,L=o.minKeyUndefined,V=o.maxKey,q=o.maxKeyUndefined,j=o.minimum,J=o.minUndefined,B=o.maximum,W=o.maxUndefined,F=a.get,X=a.getUndefined,H=a.getWithDefault,z=a.getExn,K=o.checkInvariantInternal,G=a.mergeU,Y=a.merge,Z=o.keepSharedU,$=o.keepShared,Q=o.partitionSharedU,rr=o.partitionShared,er=a.split,nr=o.mapU,tr=o.map,ir=o.mapWithKeyU,or=o.mapWithKey},(r,e,n)=>{n.r(e),n.d(e,{bal:()=>d,balMutate:()=>Or,checkInvariantInternal:()=>tr,cmp:()=>mr,cmpU:()=>vr,concat:()=>X,concatOrJoin:()=>H,copy:()=>u,create:()=>c,eq:()=>hr,eqU:()=>_r,every:()=>q,everyU:()=>V,fillArray:()=>ar,findFirstBy:()=>M,findFirstByU:()=>k,forEach:()=>x,forEachU:()=>N,fromArray:()=>Dr,fromSortedArrayAux:()=>sr,fromSortedArrayRevAux:()=>lr,fromSortedArrayUnsafe:()=>dr,get:()=>pr,getExn:()=>yr,getUndefined:()=>gr,getWithDefault:()=>Er,has:()=>br,isEmpty:()=>R,join:()=>F,keepMap:()=>Y,keepMapU:()=>G,keepShared:()=>K,keepSharedU:()=>z,keysToArray:()=>cr,lengthNode:()=>Q,map:()=>U,mapU:()=>I,mapWithKey:()=>P,mapWithKeyU:()=>C,maxKey:()=>p,maxKeyUndefined:()=>g,maxUndefined:()=>A,maximum:()=>S,minKey:()=>m,minKeyUndefined:()=>_,minUndefined:()=>b,minimum:()=>E,partitionShared:()=>$,partitionSharedU:()=>Z,reduce:()=>L,reduceU:()=>T,removeMinAuxWithRef:()=>O,removeMinAuxWithRootMutate:()=>kr,singleton:()=>f,size:()=>rr,some:()=>J,someU:()=>j,stackAllLeft:()=>D,toArray:()=>ur,toList:()=>nr,updateMutate:()=>Rr,updateValue:()=>s,valuesToArray:()=>fr});var t=n(13),i=n(17),o=n(56);function a(r){return void 0!==r?r.h:0}function u(r){return void 0!==r?{k:r.k,v:r.v,h:r.h,l:u(r.l),r:u(r.r)}:r}function c(r,e,n,t){var i=a(r),o=a(t);return{k:e,v:n,h:i>=o?i+1|0:o+1|0,l:r,r:t}}function f(r,e){return{k:r,v:e,h:1,l:void 0,r:void 0}}function l(r,e){return void 0===e||void 0!==r&&r.h>=e.h}function s(r,e){return r.v===e?r:{k:r.k,v:e,h:r.h,l:r.l,r:r.r}}function d(r,e,n,t){var i=void 0!==r?r.h:0,o=void 0!==t?t.h:0;if(i>(o+2|0)){var u=r.l,f=r.r;return a(u)>=a(f)?c(u,r.k,r.v,c(f,e,n,t)):c(c(u,r.k,r.v,f.l),f.k,f.v,c(f.r,e,n,t))}if(o<=(i+2|0))return{k:e,v:n,h:i>=o?i+1|0:o+1|0,l:r,r:t};var l=t.l,s=t.r;return a(s)>=a(l)?c(c(r,e,n,l),t.k,t.v,s):c(c(r,e,n,l.l),l.k,l.v,c(l.r,t.k,t.v,s))}function v(r){for(;;){var e=r,n=e.l;if(void 0===n)return e.k;r=n}}function m(r){if(void 0!==r)return i.some(v(r))}function _(r){if(void 0!==r)return v(r)}function h(r){for(;;){var e=r,n=e.r;if(void 0===n)return e.k;r=n}}function p(r){if(void 0!==r)return i.some(h(r))}function g(r){if(void 0!==r)return h(r)}function y(r){for(;;){var e=r,n=e.l;if(void 0===n)return[e.k,e.v];r=n}}function E(r){if(void 0!==r)return y(r)}function b(r){if(void 0!==r)return y(r)}function w(r){for(;;){var e=r,n=e.r;if(void 0===n)return[e.k,e.v];r=n}}function S(r){if(void 0!==r)return w(r)}function A(r){if(void 0!==r)return w(r)}function O(r,e,n){var t=r.l;return void 0!==t?d(O(t,e,n),r.k,r.v,r.r):(e.contents=r.k,n.contents=r.v,r.r)}function R(r){return void 0===r}function D(r,e){for(;;){if(void 0===r)return e;e={hd:r,tl:e},r=r.l}}function k(r,e){if(void 0!==r){var n=k(r.l,e);if(void 0!==n)return n;var t=r.k,i=r.v;if(e(t,i))return[t,i];var o=k(r.r,e);return void 0!==o?o:void 0}}function M(r,e){return k(r,t.__2(e))}function N(r,e){for(;;){var n=r;if(void 0===n)return;N(n.l,e),e(n.k,n.v),r=n.r}}function x(r,e){return N(r,t.__2(e))}function I(r,e){if(void 0!==r){var n=I(r.l,e),t=e(r.v),i=I(r.r,e);return{k:r.k,v:t,h:r.h,l:n,r:i}}}function U(r,e){return I(r,t.__1(e))}function C(r,e){if(void 0!==r){var n=r.k,t=C(r.l,e),i=e(n,r.v),o=C(r.r,e);return{k:n,v:i,h:r.h,l:t,r:o}}}function P(r,e){return C(r,t.__2(e))}function T(r,e,n){for(;;){var t=e,i=r;if(void 0===i)return t;var o=i.k,a=i.v,u=i.l,c=i.r;e=n(T(u,t,n),o,a),r=c}}function L(r,e,n){return T(r,e,t.__3(n))}function V(r,e){for(;;){var n=r;if(void 0===n)return!0;if(!e(n.k,n.v))return!1;if(!V(n.l,e))return!1;r=n.r}}function q(r,e){return V(r,t.__2(e))}function j(r,e){for(;;){var n=r;if(void 0===n)return!1;if(e(n.k,n.v))return!0;if(j(n.l,e))return!0;r=n.r}}function J(r,e){return j(r,t.__2(e))}function B(r,e,n){return void 0!==r?d(B(r.l,e,n),r.k,r.v,r.r):f(e,n)}function W(r,e,n){return void 0!==r?d(r.l,r.k,r.v,W(r.r,e,n)):f(e,n)}function F(r,e,n,t){if(void 0===r)return B(t,e,n);if(void 0===t)return W(r,e,n);var i=r.k,o=r.v,a=r.h,u=r.l,f=r.r,l=t.k,s=t.v,v=t.h,m=t.l,_=t.r;return a>(v+2|0)?d(u,i,o,F(f,e,n,t)):v>(a+2|0)?d(F(r,e,n,m),l,s,_):c(r,e,n,t)}function X(r,e){if(void 0===r)return e;if(void 0===e)return r;var n={contents:e.k},t={contents:e.v},i=O(e,n,t);return F(r,n.contents,t.contents,i)}function H(r,e,n,t){return void 0!==n?F(r,e,i.valFromOption(n),t):X(r,t)}function z(r,e){if(void 0!==r){var n=r.k,t=r.v,i=z(r.l,e),o=e(n,t),a=z(r.r,e);return o?F(i,n,t,a):X(i,a)}}function K(r,e){return z(r,t.__2(e))}function G(r,e){if(void 0!==r){var n=r.k,t=r.v,o=G(r.l,e),a=e(n,t),u=G(r.r,e);return void 0!==a?F(o,n,i.valFromOption(a),u):X(o,u)}}function Y(r,e){return G(r,t.__2(e))}function Z(r,e){if(void 0===r)return[void 0,void 0];var n=r.k,t=r.v,i=Z(r.l,e),o=i[1],a=i[0],u=e(n,t),c=Z(r.r,e),f=c[1],l=c[0];return u?[F(a,n,t,l),X(o,f)]:[X(a,l),F(o,n,t,f)]}function $(r,e){return Z(r,t.__2(e))}function Q(r){var e=r.l,n=r.r;return(1+(void 0!==e?Q(e):0)|0)+(void 0!==n?Q(n):0)|0}function rr(r){return void 0!==r?Q(r):0}function er(r,e){for(;;){var n=e,t=r;if(void 0===t)return n;var i=t.k,o=t.v,a=t.l;e={hd:[i,o],tl:er(t.r,n)},r=a}}function nr(r){return er(r,0)}function tr(r){for(;;){var e=r;if(void 0===e)return;var n=e.l,t=e.r,i=a(n)-a(t)|0;if(!(i<=2&&i>=-2))throw{RE_EXN_ID:"Assert_failure",_1:["belt_internalAVLtree.ml",373,4],Error:new Error};tr(n),r=t}}function ir(r,e,n){for(;;){var t=e,i=r,o=i.k,a=i.l,u=i.r,c=void 0!==a?ir(a,t,n):t;n[c]=o;var f=c+1|0;if(void 0===u)return f;e=f,r=u}}function or(r,e,n){for(;;){var t=e,i=r,o=i.l,a=i.r,u=void 0!==o?or(o,t,n):t;n[u]=i.v;var c=u+1|0;if(void 0===a)return c;e=c,r=a}}function ar(r,e,n){for(;;){var t=e,i=r,o=i.l,a=i.k,u=i.r,c=void 0!==o?ar(o,t,n):t;n[c]=[a,i.v];var f=c+1|0;if(void 0===u)return f;e=f,r=u}}function ur(r){if(void 0===r)return[];var e=Q(r),n=new Array(e);return ar(r,0,n),n}function cr(r){if(void 0===r)return[];var e=Q(r),n=new Array(e);return ir(r,0,n),n}function fr(r){if(void 0===r)return[];var e=Q(r),n=new Array(e);return or(r,0,n),n}function lr(r,e,n){switch(n){case 0:return;case 1:var t=r[e];return f(t[0],t[1]);case 2:var i=r[e],o=r[e-1|0],a=i;return{k:o[0],v:o[1],h:2,l:f(a[0],a[1]),r:void 0};case 3:var u=r[e],l=r[e-1|0],s=r[e-2|0],d=l,v=u;return{k:d[0],v:d[1],h:2,l:f(v[0],v[1]),r:f(s[0],s[1])};default:var m=n/2|0,_=lr(r,e,m),h=r[e-m|0],p=lr(r,(e-m|0)-1|0,(n-m|0)-1|0);return c(_,h[0],h[1],p)}}function sr(r,e,n){switch(n){case 0:return;case 1:var t=r[e];return f(t[0],t[1]);case 2:var i=r[e],o=r[e+1|0],a=i;return{k:o[0],v:o[1],h:2,l:f(a[0],a[1]),r:void 0};case 3:var u=r[e],l=r[e+1|0],s=r[e+2|0],d=l,v=u;return{k:d[0],v:d[1],h:2,l:f(v[0],v[1]),r:f(s[0],s[1])};default:var m=n/2|0,_=sr(r,e,m),h=r[e+m|0],p=sr(r,1+(e+m|0)|0,(n-m|0)-1|0);return c(_,h[0],h[1],p)}}function dr(r){return sr(r,0,r.length)}function vr(r,e,n,t){var i=rr(r),o=rr(e);if(i!==o)return i<o?-1:1;for(var a=D(r,0),u=D(e,0);;){var c=u,f=a;if(!f)return 0;if(!c)return 0;var l=c.hd,s=f.hd,d=n(s.k,l.k);if(0!==d)return d;var v=t(s.v,l.v);if(0!==v)return v;u=D(l.r,c.tl),a=D(s.r,f.tl)}}function mr(r,e,n,i){return vr(r,e,n,t.__2(i))}function _r(r,e,n,t){if(rr(r)!==rr(e))return!1;for(var i=D(r,0),o=D(e,0);;){var a=o,u=i;if(!u)return!0;if(!a)return!0;var c=a.hd,f=u.hd;if(0!==n(f.k,c.k)||!t(f.v,c.v))return!1;o=D(c.r,a.tl),i=D(f.r,u.tl)}}function hr(r,e,n,i){return _r(r,e,n,t.__2(i))}function pr(r,e,n){for(;;){var t=r;if(void 0===t)return;var o=n(e,t.k);if(0===o)return i.some(t.v);r=o<0?t.l:t.r}}function gr(r,e,n){for(;;){var t=r;if(void 0===t)return;var i=n(e,t.k);if(0===i)return t.v;r=i<0?t.l:t.r}}function yr(r,e,n){for(;;){var t=r;if(void 0===t)throw{RE_EXN_ID:"Not_found",Error:new Error};var i=n(e,t.k);if(0===i)return t.v;r=i<0?t.l:t.r}}function Er(r,e,n,t){for(;;){var i=r;if(void 0===i)return n;var o=t(e,i.k);if(0===o)return i.v;r=o<0?i.l:i.r}}function br(r,e,n){for(;;){var t=r;if(void 0===t)return!1;var i=n(e,t.k);if(0===i)return!0;r=i<0?t.l:t.r}}function wr(r){var e=r.l;r.l=e.r,e.r=r;var n=a(r.l),t=a(r.r);r.h=(n>t?n:t)+1|0;var i=a(e.l),o=r.h;return e.h=(i>o?i:o)+1|0,e}function Sr(r){var e=r.r;r.r=e.l,e.l=r;var n=a(r.l),t=a(r.r);r.h=(n>t?n:t)+1|0;var i=a(e.r),o=r.h;return e.h=(i>o?i:o)+1|0,e}function Ar(r){var e=a(r.l),n=a(r.r);return r.h=(e>n?e:n)+1|0,r}function Or(r){var e,n,t=r.l,i=r.r,o=a(t),u=a(i);if(o>(2+u|0))return l(t.l,t.r)?Ar(wr(r)):Ar((n=Sr((e=r).l),e.l=n,wr(e)));if(u>(2+o|0)){var c=i.l;return l(i.r,c)?Ar(Sr(r)):Ar(function(r){var e=wr(r.r);return r.r=e,Sr(r)}(r))}return r.h=(o>u?o:u)+1|0,r}function Rr(r,e,n,t){if(void 0===r)return f(e,n);var i=t(e,r.k);if(0===i)return r.v=n,r;var o=r.l,a=r.r;if(i<0){var u=Rr(o,e,n,t);r.l=u}else r.r=Rr(a,e,n,t);return Or(r)}function Dr(r,e){var n=r.length;if(0!==n){var t,i=o.strictlySortedLengthU(r,(function(r,n){return e(r[0],n[0])<0}));t=i>=0?sr(r,0,i):lr(r,(i=0|-i)-1|0,i);for(var a=i;a<n;++a){var u=r[a];t=Rr(t,u[0],u[1],e)}return t}}function kr(r,e){var n=e.r,t=e.l;return void 0!==t?(e.l=kr(r,t),Or(e)):(r.k=e.k,r.v=e.v,n)}},(r,e,n)=>{n.r(e),n.d(e,{$$String:()=>{},Int:()=>{},binarySearchBy:()=>S,binarySearchByU:()=>w,diff:()=>_,diffU:()=>m,intersect:()=>v,intersectU:()=>d,isSorted:()=>c,isSortedU:()=>u,stableSortBy:()=>b,stableSortByU:()=>E,stableSortInPlaceBy:()=>y,stableSortInPlaceByU:()=>g,strictlySortedLength:()=>a,strictlySortedLengthU:()=>o,union:()=>s,unionU:()=>l});var t=n(13),i=n(26);function o(r,e){var n=r.length;if(0===n||1===n)return n;var t=r[0],i=r[1];if(!e(t,i))return e(i,t)?0|-function(r,e,n,t,i){for(;;){var o=n,a=e;if(o>=t)return o;var u=r[o];if(!i(u,a))return o;n=o+1|0,e=u}}(r,i,2,n,e):1;for(var o=i,a=2;;){var u=a,c=o;if(u>=n)return u;var f=r[u];if(!e(c,f))return u;a=u+1|0,o=f}}function a(r,e){return o(r,t.__2(e))}function u(r,e){var n=r.length;if(0===n)return!0;for(var t=0,i=n-1|0;;){var o=t;if(o===i)return!0;if(e(r[o],r[o+1|0])>0)return!1;t=o+1|0}}function c(r,e){return u(r,t.__2(e))}function f(r,e,n,t,o,a,u,c,f){for(var l=e+n|0,s=o+a|0,d=e,v=r[e],m=o,_=t[o],h=c;;){var p=h,g=_,y=m,E=v,b=d;if(f(E,g)<=0){u[p]=E;var w=b+1|0;if(w>=l)return i.blitUnsafe(t,y,u,p+1|0,s-y|0);h=p+1|0,v=r[w],d=w}else{u[p]=g;var S=y+1|0;if(S>=s)return i.blitUnsafe(r,b,u,p+1|0,l-b|0);h=p+1|0,_=t[S],m=S}}}function l(r,e,n,t,o,a,u,c,f){for(var l=e+n|0,s=o+a|0,d=e,v=r[e],m=o,_=t[o],h=c;;){var p=h,g=_,y=m,E=v,b=d,w=f(E,g);if(w<0){u[p]=E;var S=b+1|0,A=p+1|0;if(S<l){h=A,v=r[S],d=S;continue}return i.blitUnsafe(t,y,u,A,s-y|0),(A+s|0)-y|0}if(0!==w){u[p]=g;var O=y+1|0,R=p+1|0;if(!(O<s))return i.blitUnsafe(r,b,u,R,l-b|0),(R+l|0)-b|0;h=R,_=t[O],m=O}else{u[p]=E;var D=b+1|0,k=y+1|0,M=p+1|0;if(!(D<l&&k<s))return D===l?(i.blitUnsafe(t,k,u,M,s-k|0),(M+s|0)-k|0):(i.blitUnsafe(r,D,u,M,l-D|0),(M+l|0)-D|0);h=M,_=t[k],m=k,v=r[D],d=D}}}function s(r,e,n,i,o,a,u,c,f){return l(r,e,n,i,o,a,u,c,t.__2(f))}function d(r,e,n,t,i,o,a,u,c){for(var f=e+n|0,l=i+o|0,s=e,d=r[e],v=i,m=t[i],_=u;;){var h=_,p=v,g=d,y=s,E=c(g,m);if(E<0){var b=y+1|0;if(b>=f)return h;d=r[b],s=b}else if(0!==E){var w=p+1|0;if(w>=l)return h;m=t[w],v=w}else{a[h]=g;var S=y+1|0,A=p+1|0,O=h+1|0;if(!(S<f&&A<l))return O;_=O,m=t[A],v=A,d=r[S],s=S}}}function v(r,e,n,i,o,a,u,c,f){return d(r,e,n,i,o,a,u,c,t.__2(f))}function m(r,e,n,t,o,a,u,c,f){for(var l=e+n|0,s=o+a|0,d=e,v=r[e],m=o,_=t[o],h=c;;){var p=h,g=m,y=v,E=d,b=f(y,_);if(b<0){u[p]=y;var w=p+1|0,S=E+1|0;if(S>=l)return w;h=w,v=r[S],d=S}else if(0!==b){var A=g+1|0;if(!(A<s))return i.blitUnsafe(r,E,u,p,l-E|0),(p+l|0)-E|0;_=t[A],m=A}else{var O=E+1|0,R=g+1|0;if(!(O<l&&R<s))return O===l?p:(i.blitUnsafe(r,O,u,p,l-O|0),(p+l|0)-O|0);_=t[R],m=R,v=r[O],d=O}}}function _(r,e,n,i,o,a,u,c,f){return m(r,e,n,i,o,a,u,c,t.__2(f))}function h(r,e,n,t,i,o){for(var a=0;a<i;++a){for(var u=r[e+a|0],c=(t+a|0)-1|0;c>=t&&o(n[c],u)>0;)n[c+1|0]=n[c],c=c-1|0;n[c+1|0]=u}}function p(r,e,n,t,i,o){if(i<=5)return h(r,e,n,t,i,o);var a=i/2|0,u=i-a|0;return p(r,e+a|0,n,t+a|0,u,o),p(r,e,r,e+u|0,a,o),f(r,e+u|0,a,n,t+a|0,u,n,t,o)}function g(r,e){var n=r.length;if(n<=5)return h(r,0,r,0,n,e);var t=n/2|0,i=n-t|0,o=new Array(i);return p(r,t,o,0,i,e),p(r,0,r,i,t,e),f(r,i,t,o,0,i,r,0,e)}function y(r,e){return g(r,t.__2(e))}function E(r,e){var n=r.slice(0);return g(n,e),n}function b(r,e){return E(r,t.__2(e))}function w(r,e,n){var t=r.length;if(0===t)return-1;if(n(e,r[0])<0)return-1;if(n(e,r[t-1|0])>0)return 0|-(t+1|0);for(var i=0,o=t-1|0;;){var a=o,u=i,c=(u+a|0)/2|0,f=n(e,r[c]);if(0===f)return c;if(f<0){if(a===c)return 0===n(r[u],e)?u:0|-(a+1|0);o=c}else{if(u===c)return 0===n(r[a],e)?a:0|-(a+1|0);i=c}}}function S(r,e,n){return w(r,e,t.__2(n))}},(r,e,n)=>{n.r(e),n.d(e,{A:()=>{},N:()=>{},S:()=>{},add:()=>c,addMutate:()=>O,cmp:()=>b,cmpU:()=>E,compareAux:()=>y,eq:()=>A,eqAux:()=>w,eqU:()=>S,fromArray:()=>R,get:()=>f,getExn:()=>s,getUndefined:()=>l,getWithDefault:()=>d,has:()=>v,merge:()=>g,mergeU:()=>p,remove:()=>m,split:()=>h,splitAux:()=>_});var t=n(27),i=n(13),o=n(17),a=n(56),u=n(55);function c(r,e,n){if(void 0===r)return u.singleton(e,n);var t=r.k;if(e===t)return u.updateValue(r,n);var i=r.v;return e<t?u.bal(c(r.l,e,n),t,i,r.r):u.bal(r.l,t,i,c(r.r,e,n))}function f(r,e){for(;;){var n=r;if(void 0===n)return;var t=n.k;if(e===t)return o.some(n.v);r=e<t?n.l:n.r}}function l(r,e){for(;;){var n=r;if(void 0===n)return;var t=n.k;if(e===t)return n.v;r=e<t?n.l:n.r}}function s(r,e){for(;;){var n=r;if(void 0===n)throw{RE_EXN_ID:"Not_found",Error:new Error};var t=n.k;if(e===t)return n.v;r=e<t?n.l:n.r}}function d(r,e,n){for(;;){var t=r;if(void 0===t)return n;var i=t.k;if(e===i)return t.v;r=e<i?t.l:t.r}}function v(r,e){for(;;){var n=r;if(void 0===n)return!1;var t=n.k;if(e===t)return!0;r=e<t?n.l:n.r}}function m(r,e){if(void 0===r)return r;var n=r.k,t=r.l,i=r.r;if(e!==n)return e<n?u.bal(m(t,e),n,r.v,i):u.bal(t,n,r.v,m(i,e));if(void 0===t)return i;if(void 0===i)return t;var o={contents:i.k},a={contents:i.v},c=u.removeMinAuxWithRef(i,o,a);return u.bal(t,o.contents,a.contents,c)}function _(r,e){var n=e.k,t=e.v,i=e.l,a=e.r;if(r===n)return[i,o.some(t),a];if(r<n){if(void 0===i)return[void 0,void 0,e];var c=_(r,i);return[c[0],c[1],u.join(c[2],n,t,a)]}if(void 0===a)return[e,void 0,void 0];var f=_(r,a);return[u.join(i,n,t,f[0]),f[1],f[2]]}function h(r,e){return void 0!==e?_(r,e):[void 0,void 0,void 0]}function p(r,e,n){if(void 0!==r){if(r.h>=(void 0!==e?e.h:0)){var t=r.k,i=r.v,a=r.l,c=r.r,f=h(t,e);return u.concatOrJoin(p(a,f[0],n),t,n(t,o.some(i),f[1]),p(c,f[2],n))}}else if(void 0===e)return;var l=e.k,s=e.v,d=e.l,v=e.r,m=h(l,r);return u.concatOrJoin(p(m[0],d,n),l,n(l,m[1],o.some(s)),p(m[2],v,n))}function g(r,e,n){return p(r,e,i.__3(n))}function y(r,e,n){for(;;){var i=e,o=r;if(!o)return 0;if(!i)return 0;var a=i.hd,c=o.hd,f=t.caml_string_compare(c.k,a.k);if(0!==f)return f;var l=n(c.v,a.v);if(0!==l)return l;e=u.stackAllLeft(a.r,i.tl),r=u.stackAllLeft(c.r,o.tl)}}function E(r,e,n){var t=u.size(r),i=u.size(e);return t===i?y(u.stackAllLeft(r,0),u.stackAllLeft(e,0),n):t<i?-1:1}function b(r,e,n){return E(r,e,i.__2(n))}function w(r,e,n){for(;;){var t=e,i=r;if(!i)return!0;if(!t)return!0;var o=t.hd,a=i.hd;if(a.k!==o.k||!n(a.v,o.v))return!1;e=u.stackAllLeft(o.r,t.tl),r=u.stackAllLeft(a.r,i.tl)}}function S(r,e,n){return u.size(r)===u.size(e)&&w(u.stackAllLeft(r,0),u.stackAllLeft(e,0),n)}function A(r,e,n){return S(r,e,i.__2(n))}function O(r,e,n){if(void 0===r)return u.singleton(e,n);var t=r.k;if(e===t)return r.k=e,r.v=n,r;var i=r.l,o=r.r;if(e<t){var a=O(i,e,n);r.l=a}else r.r=O(o,e,n);return u.balMutate(r)}function R(r){var e=r.length;if(0!==e){var n,t=a.strictlySortedLengthU(r,(function(r,e){return r[0]<e[0]}));t>=0?n=u.fromSortedArrayAux(r,0,t):(t=0|-t,n=u.fromSortedArrayRevAux(r,t-1|0,t));for(var i=t;i<e;++i){var o=r[i];n=O(n,o[0],o[1])}return n}}},(r,e,n)=>{n.r(e),n.d(e,{binarySearch:()=>m,diff:()=>f,intersect:()=>c,isSorted:()=>o,stableSort:()=>v,stableSortInPlace:()=>d,strictlySortedLength:()=>i,union:()=>u});var t=n(26);function i(r){var e=r.length;if(0===e||1===e)return e;var n=r[0],t=r[1];if(!(n<t))return n>t?0|-function(r,e,n,t){for(;;){var i=n,o=e;if(i>=t)return i;var a=r[i];if(o<=a)return i;n=i+1|0,e=a}}(r,t,2,e):1;for(var i=t,o=2;;){var a=o,u=i;if(a>=e)return a;var c=r[a];if(u>=c)return a;o=a+1|0,i=c}}function o(r){var e=r.length;if(0===e)return!0;for(var n=0,t=e-1|0;;){var i=n;if(i===t)return!0;if(r[i]>r[i+1|0])return!1;n=i+1|0}}function a(r,e,n,i,o,a,u,c){for(var f=e+n|0,l=o+a|0,s=e,d=r[e],v=o,m=i[o],_=c;;){var h=_,p=m,g=v,y=d,E=s;if(y<=p){u[h]=y;var b=E+1|0;if(b>=f)return t.blitUnsafe(i,g,u,h+1|0,l-g|0);_=h+1|0,d=r[b],s=b}else{u[h]=p;var w=g+1|0;if(w>=l)return t.blitUnsafe(r,E,u,h+1|0,f-E|0);_=h+1|0,m=i[w],v=w}}}function u(r,e,n,i,o,a,u,c){for(var f=e+n|0,l=o+a|0,s=e,d=r[e],v=o,m=i[o],_=c;;){var h=_,p=m,g=v,y=d,E=s;if(y<p){u[h]=y;var b=E+1|0,w=h+1|0;if(b<f){_=w,d=r[b],s=b;continue}return t.blitUnsafe(i,g,u,w,l-g|0),(w+l|0)-g|0}if(y!==p){u[h]=p;var S=g+1|0,A=h+1|0;if(!(S<l))return t.blitUnsafe(r,E,u,A,f-E|0),(A+f|0)-E|0;_=A,m=i[S],v=S}else{u[h]=y;var O=E+1|0,R=g+1|0,D=h+1|0;if(!(O<f&&R<l))return O===f?(t.blitUnsafe(i,R,u,D,l-R|0),(D+l|0)-R|0):(t.blitUnsafe(r,O,u,D,f-O|0),(D+f|0)-O|0);_=D,m=i[R],v=R,d=r[O],s=O}}}function c(r,e,n,t,i,o,a,u){for(var c=e+n|0,f=i+o|0,l=e,s=r[e],d=i,v=t[i],m=u;;){var _=m,h=v,p=d,g=s,y=l;if(g<h){var E=y+1|0;if(E>=c)return _;s=r[E],l=E}else if(g!==h){var b=p+1|0;if(b>=f)return _;v=t[b],d=b}else{a[_]=g;var w=y+1|0,S=p+1|0,A=_+1|0;if(!(w<c&&S<f))return A;m=A,v=t[S],d=S,s=r[w],l=w}}}function f(r,e,n,i,o,a,u,c){for(var f=e+n|0,l=o+a|0,s=e,d=r[e],v=o,m=i[o],_=c;;){var h=_,p=m,g=v,y=d,E=s;if(y<p){u[h]=y;var b=h+1|0,w=E+1|0;if(w>=f)return b;_=b,d=r[w],s=w}else if(y!==p){var S=g+1|0;if(!(S<l))return t.blitUnsafe(r,E,u,h,f-E|0),(h+f|0)-E|0;m=i[S],v=S}else{var A=E+1|0,O=g+1|0;if(!(A<f&&O<l))return A===f?h:(t.blitUnsafe(r,A,u,h,f-A|0),(h+f|0)-A|0);m=i[O],v=O,d=r[A],s=A}}}function l(r,e,n,t,i){for(var o=0;o<i;++o){for(var a=r[e+o|0],u=(t+o|0)-1|0;u>=t&&n[u]>a;)n[u+1|0]=n[u],u=u-1|0;n[u+1|0]=a}}function s(r,e,n,t,i){if(i<=5)return l(r,e,n,t,i);var o=i/2|0,u=i-o|0;return s(r,e+o|0,n,t+o|0,u),s(r,e,r,e+u|0,o),a(r,e+u|0,o,n,t+o|0,u,n,t)}function d(r){var e=r.length;if(e<=5)return l(r,0,r,0,e);var n=e/2|0,t=e-n|0,i=new Array(t);return s(r,n,i,0,t),s(r,0,r,t,n),a(r,t,n,i,0,t,r,0)}function v(r){var e=r.slice(0);return d(e),e}function m(r,e){var n=r.length;if(0===n)return-1;if(e<r[0])return-1;if(e>r[n-1|0])return 0|-(n+1|0);for(var t=0,i=n-1|0;;){var o=i,a=t,u=(a+o|0)/2|0,c=r[u];if(e===c)return u;if(e<c){if(o===u)return r[a]===e?a:0|-(o+1|0);i=u}else{if(a===u)return r[o]===e?o:0|-(o+1|0);t=u}}}},(r,e,n)=>{n.r(e),n.d(e,{$$Error:()=>d,anyToExnInternal:()=>i,raiseError:()=>o,raiseEvalError:()=>a,raiseRangeError:()=>u,raiseReferenceError:()=>c,raiseSyntaxError:()=>f,raiseTypeError:()=>l,raiseUriError:()=>s});var t=n(50),i=t.internalToOCamlException;function o(r){throw new Error(r)}function a(r){throw new EvalError(r)}function u(r){throw new RangeError(r)}function c(r){throw new ReferenceError(r)}function f(r){throw new SyntaxError(r)}function l(r){throw new TypeError(r)}function s(r){throw new URIError(r)}var d=t.$$Error},(r,e,n)=>{n.r(e),n.d(e,{Entries:()=>m,React:()=>{},ReactDOMRe:()=>{},Settings:()=>h,showSettings:()=>p,style:()=>d});var t=n(13),i=n(22),o=n(25),a=n(10),u=n(26),c=n(30),f=n(17),l=n(31),s=n(61),d=l;function v(r){var e=u.reduce(r,[[],[]],(function(r,e){var n,o=e.ty,a=e.title,l=e.name;if(0===o.TAG){var v=o._0,m=v.onSubmit;n=["text",v.value,void 0,v.pattern,!0,function(r){return t._1(m,r.value)}]}else{var _=o._0,h=_.onSubmit;n=["checkbox",void 0,_.checked,void 0,!1,function(r){return t._1(h,r.checked)}]}var p=n[5],g={contents:!1},y={title:a,name:l,required:n[4],type:n[0],onChange:function(r){g.contents=!0}},E=n[2];void 0!==E&&(y.checked=f.valFromOption(E));var b=n[3];void 0!==b&&(y.pattern=f.valFromOption(b));var w=n[1];void 0!==w&&(y.value=f.valFromOption(w));var S=i.DOMRe.createDOMElementVariadic("input",f.some(y),[]);return[u.concat(r[0],[i.DOMRe.createDOMElementVariadic("div",{className:d.settingsEntry},[i.DOMRe.createDOMElementVariadic("label",{htmlFor:l},[a]),S])]),u.concat(r[1],[function(r){if(g.contents)return t._1(p,c.getExn(c.flatMap(i.toNode(S),s.ofNode))),void(g.contents=!1)}])]})),n=e[1];return[e[0],function(r){return u.forEach(n,(function(r){return t._1(r,void 0)}))}]}var m={make:v};function _(r){var e=r.onSubmit,n=v([{name:"username",title:"用户名",ty:{TAG:0,_0:{value:a.Username.get(void 0),pattern:"[a-z][_a-z0-9]*",onSubmit:function(r){return a.Username.set(r)}}}},{name:"server",title:"服务器",ty:{TAG:0,_0:{value:a.Server.get(void 0),pattern:"https?://.+",onSubmit:function(r){return a.Server.set(r)}}}},{name:"sync_answers",title:"同步答案",ty:{TAG:1,_0:{checked:a.SyncAnswers.get(void 0),onSubmit:function(r){return a.SyncAnswers.set(r)}}}},{name:"sort_problems",title:"排序答案",ty:{TAG:1,_0:{checked:a.SortProblems.get(void 0),onSubmit:function(r){return a.SortProblems.set(r)}}}},{name:"no_leave_check",title:"拦截切屏检测",ty:{TAG:1,_0:{checked:a.NoLeaveCheck.get(void 0),onSubmit:function(r){return a.NoLeaveCheck.set(r)}}}}]),u=n[1],c=function(r){var e=r.title,n=r.content;return i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,[e]),n])};return i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("form",{onSubmit:function(r){return r.preventDefault(),t._1(e,void 0),t._1(u,void 0)}},[i.DOMRe.createDOMElementVariadic("div",void 0,[n[0]]),i.DOMRe.createDOMElementVariadic("div",{className:d.settingsSubmit},[i.DOMRe.createDOMElementVariadic("div",{className:d.settingsSubmitTip},[i.DOMRe.createDOMElementVariadic("i",void 0,["*更改设置后请刷新页面"])]),i.DOMRe.createDOMElementVariadic("div",void 0,[i.DOMRe.createDOMElementVariadic("button",void 0,["提交"])])])]),i.DOMRe.createDOMElementVariadic("div",{className:d.about},[i.DOMRe.createDOMElementVariadic("p",void 0,[i.DOMRe.createDOMElementVariadic("strong",void 0,["功能特性："])]),i.createElementVariadic(o.UList.make,{children:null},[i.createElement(c,{title:"同步答案：",content:"点击题目显示详细答案，在选项/填空处悬停显示简略答案"}),i.createElement(c,{title:"排序题目：",content:"根据 ID 对题目和选项进行重新排序"}),i.createElement(c,{title:"拦截切屏检测：",content:"随意切换页面、窗口不会被发现"}),i.createElement(c,{title:"拦截上传截图：",content:"仅当用户确认后，才会上传截图"}),i.createElement(c,{title:"拦截异常状态：",content:"即使本地显示异常也不会推送到服务器"})])])])}var h={make:_};function p(r){var e=o.openWin("设置",300,400,void 0,void 0,void 0),n=e[0];e[1].appendChild(c.getExn(i.toNode(i.DOMRe.createDOMElementVariadic("div",{className:o.joinStrings([d.mainBody,d.settings]," ")},[i.createElement(_,{onSubmit:function(r){n.close()}})]))))}},(r,e,n)=>{n.r(e),n.d(e,{Impl:()=>c,asHtmlElement:()=>h,contentEditable:()=>s,dir:()=>v,insertAdjacentElement:()=>g,insertAdjacentHTML:()=>y,insertAdjacentText:()=>E,nodeType:()=>_,ofElement:()=>b,ofNode:()=>p,setContentEditable:()=>d,setDir:()=>m});var t=n(35),i=n(36),o=n(34),a=n(37),u=n(41);function c(r){return{ofElement:o.asHtmlElement,contentEditable:function(r){return i.decodeContentEditable(r.contentEditable)},setContentEditable:function(r,e){r.contentEditable=i.encodeContentEditable(e)},dir:function(r){return i.decodeDir(r.dir)},setDir:function(r,e){r.dir=i.encodeDir(e)}}}var f=t.Impl({});a.Impl({}),u.Impl({});var l=o.Impl({});function s(r){return i.decodeContentEditable(r.contentEditable)}function d(r,e){r.contentEditable=i.encodeContentEditable(e)}function v(r){return i.decodeDir(r.dir)}function m(r,e){r.dir=i.encodeDir(e)}var _=f.nodeType,h=l.asHtmlElement,p=l.ofNode,g=l.insertAdjacentElement,y=l.insertAdjacentHTML,E=l.insertAdjacentText,b=o.asHtmlElement},(r,e,n)=>{n.r(e),n.d(e,{checkInvariantInternal:()=>K,cmp:()=>p,cmpU:()=>h,empty:()=>{},eq:()=>y,eqU:()=>g,every:()=>D,everyU:()=>R,findFirstBy:()=>b,findFirstByU:()=>E,forEach:()=>S,forEachU:()=>w,fromArray:()=>U,get:()=>F,getExn:()=>z,getUndefined:()=>X,getWithDefault:()=>H,has:()=>_,isEmpty:()=>m,keep:()=>$,keepU:()=>Z,keysToArray:()=>C,map:()=>tr,mapU:()=>nr,mapWithKey:()=>or,mapWithKeyU:()=>ir,maxKey:()=>V,maxKeyUndefined:()=>q,maxUndefined:()=>W,maximum:()=>B,merge:()=>Y,mergeMany:()=>v,mergeU:()=>G,minKey:()=>T,minKeyUndefined:()=>L,minUndefined:()=>J,minimum:()=>j,partition:()=>rr,partitionU:()=>Q,reduce:()=>O,reduceU:()=>A,remove:()=>s,removeMany:()=>d,set:()=>u,size:()=>N,some:()=>M,someU:()=>k,split:()=>er,toArray:()=>I,toList:()=>x,update:()=>f,updateU:()=>c,valuesToArray:()=>P});var t=n(13),i=n(17),o=n(63),a=n(55);function u(r,e,n){if(void 0===r)return a.singleton(e,n);var t=r.k;if(e===t)return a.updateValue(r,n);var i=r.v;return e<t?a.bal(u(r.l,e,n),t,i,r.r):a.bal(r.l,t,i,u(r.r,e,n))}function c(r,e,n){if(void 0!==r){var t=r.k;if(e===t){var o=n(i.some(r.v));if(void 0!==o)return a.updateValue(r,i.valFromOption(o));var u=r.l,f=r.r;if(void 0===u)return f;if(void 0===f)return u;var l={contents:f.k},s={contents:f.v},d=a.removeMinAuxWithRef(f,l,s);return a.bal(u,l.contents,s.contents,d)}var v=r.v,m=r.l,_=r.r;if(e<t){var h=c(m,e,n);return m===h?r:a.bal(h,t,v,_)}var p=c(_,e,n);return _===p?r:a.bal(m,t,v,p)}var g=n(void 0);return void 0!==g?a.singleton(e,i.valFromOption(g)):r}function f(r,e,n){return c(r,e,t.__1(n))}function l(r,e){var n=r.k,t=r.l,i=r.r;if(e===n){if(void 0===t)return i;if(void 0===i)return t;var o={contents:i.k},u={contents:i.v},c=a.removeMinAuxWithRef(i,o,u);return a.bal(t,o.contents,u.contents,c)}if(e<n){if(void 0===t)return r;var f=l(t,e);return f===t?r:a.bal(f,n,r.v,i)}if(void 0===i)return r;var s=l(i,e);return a.bal(t,n,r.v,s)}function s(r,e){if(void 0!==r)return l(r,e)}function d(r,e){var n=e.length;if(void 0!==r)for(var t=r,i=0;;){var o=i;if(o>=n)return t;var a=l(t,e[o]);if(void 0===a)return a;i=o+1|0,t=a}}function v(r,e){for(var n=e.length,t=r,i=0;i<n;++i){var o=e[i];t=u(t,o[0],o[1])}return t}var m=a.isEmpty,_=o.has,h=o.cmpU,p=o.cmp,g=o.eqU,y=o.eq,E=a.findFirstByU,b=a.findFirstBy,w=a.forEachU,S=a.forEach,A=a.reduceU,O=a.reduce,R=a.everyU,D=a.every,k=a.someU,M=a.some,N=a.size,x=a.toList,I=a.toArray,U=o.fromArray,C=a.keysToArray,P=a.valuesToArray,T=a.minKey,L=a.minKeyUndefined,V=a.maxKey,q=a.maxKeyUndefined,j=a.minimum,J=a.minUndefined,B=a.maximum,W=a.maxUndefined,F=o.get,X=o.getUndefined,H=o.getWithDefault,z=o.getExn,K=a.checkInvariantInternal,G=o.mergeU,Y=o.merge,Z=a.keepSharedU,$=a.keepShared,Q=a.partitionSharedU,rr=a.partitionShared,er=o.split,nr=a.mapU,tr=a.map,ir=a.mapWithKeyU,or=a.mapWithKey},(r,e,n)=>{n.r(e),n.d(e,{A:()=>{},N:()=>{},S:()=>{},add:()=>c,addMutate:()=>O,cmp:()=>b,cmpU:()=>E,compareAux:()=>y,eq:()=>A,eqAux:()=>w,eqU:()=>S,fromArray:()=>R,get:()=>f,getExn:()=>s,getUndefined:()=>l,getWithDefault:()=>d,has:()=>v,merge:()=>g,mergeU:()=>p,remove:()=>m,split:()=>h,splitAux:()=>_});var t=n(27),i=n(13),o=n(17),a=n(56),u=n(55);function c(r,e,n){if(void 0===r)return u.singleton(e,n);var t=r.k;if(e===t)return u.updateValue(r,n);var i=r.v;return e<t?u.bal(c(r.l,e,n),t,i,r.r):u.bal(r.l,t,i,c(r.r,e,n))}function f(r,e){for(;;){var n=r;if(void 0===n)return;var t=n.k;if(e===t)return o.some(n.v);r=e<t?n.l:n.r}}function l(r,e){for(;;){var n=r;if(void 0===n)return;var t=n.k;if(e===t)return n.v;r=e<t?n.l:n.r}}function s(r,e){for(;;){var n=r;if(void 0===n)throw{RE_EXN_ID:"Not_found",Error:new Error};var t=n.k;if(e===t)return n.v;r=e<t?n.l:n.r}}function d(r,e,n){for(;;){var t=r;if(void 0===t)return n;var i=t.k;if(e===i)return t.v;r=e<i?t.l:t.r}}function v(r,e){for(;;){var n=r;if(void 0===n)return!1;var t=n.k;if(e===t)return!0;r=e<t?n.l:n.r}}function m(r,e){if(void 0===r)return r;var n=r.k,t=r.l,i=r.r;if(e!==n)return e<n?u.bal(m(t,e),n,r.v,i):u.bal(t,n,r.v,m(i,e));if(void 0===t)return i;if(void 0===i)return t;var o={contents:i.k},a={contents:i.v},c=u.removeMinAuxWithRef(i,o,a);return u.bal(t,o.contents,a.contents,c)}function _(r,e){var n=e.k,t=e.v,i=e.l,a=e.r;if(r===n)return[i,o.some(t),a];if(r<n){if(void 0===i)return[void 0,void 0,e];var c=_(r,i);return[c[0],c[1],u.join(c[2],n,t,a)]}if(void 0===a)return[e,void 0,void 0];var f=_(r,a);return[u.join(i,n,t,f[0]),f[1],f[2]]}function h(r,e){return void 0!==e?_(r,e):[void 0,void 0,void 0]}function p(r,e,n){if(void 0!==r){if(r.h>=(void 0!==e?e.h:0)){var t=r.k,i=r.v,a=r.l,c=r.r,f=h(t,e);return u.concatOrJoin(p(a,f[0],n),t,n(t,o.some(i),f[1]),p(c,f[2],n))}}else if(void 0===e)return;var l=e.k,s=e.v,d=e.l,v=e.r,m=h(l,r);return u.concatOrJoin(p(m[0],d,n),l,n(l,m[1],o.some(s)),p(m[2],v,n))}function g(r,e,n){return p(r,e,i.__3(n))}function y(r,e,n){for(;;){var i=e,o=r;if(!o)return 0;if(!i)return 0;var a=i.hd,c=o.hd,f=t.caml_int_compare(c.k,a.k);if(0!==f)return f;var l=n(c.v,a.v);if(0!==l)return l;e=u.stackAllLeft(a.r,i.tl),r=u.stackAllLeft(c.r,o.tl)}}function E(r,e,n){var t=u.size(r),i=u.size(e);return t===i?y(u.stackAllLeft(r,0),u.stackAllLeft(e,0),n):t<i?-1:1}function b(r,e,n){return E(r,e,i.__2(n))}function w(r,e,n){for(;;){var t=e,i=r;if(!i)return!0;if(!t)return!0;var o=t.hd,a=i.hd;if(a.k!==o.k||!n(a.v,o.v))return!1;e=u.stackAllLeft(o.r,t.tl),r=u.stackAllLeft(a.r,i.tl)}}function S(r,e,n){return u.size(r)===u.size(e)&&w(u.stackAllLeft(r,0),u.stackAllLeft(e,0),n)}function A(r,e,n){return S(r,e,i.__2(n))}function O(r,e,n){if(void 0===r)return u.singleton(e,n);var t=r.k;if(e===t)return r.k=e,r.v=n,r;var i=r.l,o=r.r;if(e<t){var a=O(i,e,n);r.l=a}else r.r=O(o,e,n);return u.balMutate(r)}function R(r){var e=r.length;if(0!==e){var n,t=a.strictlySortedLengthU(r,(function(r,e){return r[0]<e[0]}));t>=0?n=u.fromSortedArrayAux(r,0,t):(t=0|-t,n=u.fromSortedArrayRevAux(r,t-1|0,t));for(var i=t;i<e;++i){var o=r[i];n=O(n,o[0],o[1])}return n}}}],e={};function n(t){var i=e[t];if(void 0!==i)return i.exports;var o=e[t]={id:t,exports:{}};return r[t].call(o.exports,o,o.exports,n),o.exports}n.n=r=>{var e=r&&r.__esModule?()=>r.default:()=>r;return n.d(e,{a:e}),e},n.d=(r,e)=>{for(var t in e)n.o(e,t)&&!n.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})},n.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),n.r=r=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var t={};(()=>{n.r(t);var r=n(1),e=n(18),i=n(19),o=n(20),a=n(8),u=n(9),c=function(r,e,n,t){return new(n||(n=Promise))((function(i,o){function a(r){try{c(t.next(r))}catch(r){o(r)}}function u(r){try{c(t.throw(r))}catch(r){o(r)}}function c(r){var e;r.done?i(r.value):(e=r.value,e instanceof n?e:new n((function(r){r(e)}))).then(a,u)}c((t=t.apply(r,e||[])).next())}))};function f(r){return r.forEach((r=>{switch(r.ProblemType){case i.ProblemType.SingleChoice:case i.ProblemType.MultipleChoice:case i.ProblemType.Polling:r.Options.sort(((r,e)=>r.key<e.key?-1:1));break}})),r.sort(((r,e)=>r.problem_id-e.problem_id)),r}(function(){return c(this,void 0,void 0,(function*(){!0===u.NO_LEAVE_CHECK.value&&(document.addEventListener("visibilitychange",(r=>{r.preventDefault(),r.stopImmediatePropagation()}),!0),window.addEventListener("visibilitychange",(r=>{r.preventDefault(),r.stopImmediatePropagation()}),!0));const n=new r.Client;(0,e.hookXHR)((function(r){switch(r.pathname){case"/exam_room/show_paper":this.addEventListener("readystatechange",(()=>{if(this.readyState==XMLHttpRequest.DONE){const e=JSON.stringify((r=JSON.parse(this.responseText),!0===u.SORT_PROBLEMS.value&&(!0===r.data.has_problem_dict?r.data.problems=r.data.problems.sort(((r,e)=>r.id-e.id)).map((r=>(r.problems=f(r.problems),r))):r.data.problems=f(r.data.problems)),r));Object.defineProperties(this,{responseText:{get:()=>e}})}var r})),this.addEventListener("load",(()=>{const e=JSON.parse(this.responseText);(0,a.devLog)("intercept paper",e);const t=new o.UI(e);n.onmessage((r=>{r.forEach((r=>t.updateAnswer(r))),t.updateUI()})),(()=>c(this,void 0,void 0,(function*(){u.EXAM_ID.value=parseInt(r.searchParams.get("exam_id"));const e=yield fetch((0,a.newURL)("/exam_room/cache_results",{exam_id:u.EXAM_ID.value.toString()}).toString()).then((r=>r.json()));n.answerProblem(e.data.results)})))().catch(a.devLog)}));break;case"/exam_room/answer_problem":return r=>c(this,void 0,void 0,(function*(){var e;if("string"==typeof r){const t=JSON.parse(r);if("action"in t)switch(t.action){case 1:case 17:break;default:return console.log("intercept action",t),new Promise((()=>{}))}else"results"in t&&((0,a.devLog)("intercept answers",t),n.answerProblem(null!==(e=t.results)&&void 0!==e?e:[]).catch(a.devLog))}return r}));default:if("upload-z1.qiniup.com"===r.hostname)return r=>c(this,void 0,void 0,(function*(){return r instanceof FormData&&r.get("file")instanceof File?new Promise((e=>{const n=new FileReader;n.onload=()=>(0,o.showConfirmUpload)(n.result,(()=>e(r))),n.readAsDataURL(r.get("file"))})):r}))}})),yield n.watch(1e4)}))})().catch(console.error)})()})();